LINK MODEL "UTILITIES" "711.501"
{
View model_window 0 "Model"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 C28 C15 P522"
element 0 "Name" "Debug"
element 0 "Value" "0"
element 0 "Comment" "set to '1' to print names of executed Transforms"
element 1 "Name" "______________________________1"
element 1 "Value" ""
element 2 "Name" "ICCAP_DEFAULT_SETUP_PAGE"
element 2 "Value" "Extract / Optimize"
element 2 "Comment" "Specifies default active Setup tab: values are 0,1,2,3,4,5 or 'Measure / Simulate', 'Instrument Options', 'Setup Variables', 'Extract / Optimize', 'Plots','Setup GUI Items'"
element 3 "Name" "RETAIN_DATA"
element 3 "Value" "1"
element 3 "Comment" "don't clear meas. data unless it is absolutely necessary"
element 4 "Name" "SIMULATOR"
element 4 "Value" "hpeesofsim"
element 4 "Comment" "required for DUT 'NONLIN_RF_MDLG' to avoid warnings during loading of this ModelFile"
element 5 "Name" "XFORM_LIST_COLS"
element 5 "Value" "18"
element 6 "Name" "______________________________2"
element 6 "Value" ""
element 7 "Name" ""
element 7 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
element 9 "Name" "Data 8"
element 9 "On White" "114" "N"
element 9 "On Black" "114" "N"
element 9 "Symbol" "" "N"
element 9 "Measured" "Default" "N"
element 9 "Simulated" "Default" "N"
element 10 "Name" "Data 9"
element 10 "On White" "14" "N"
element 10 "On Black" "94" "N"
element 10 "Symbol" "" "N"
element 10 "Measured" "Default" "N"
element 10 "Simulated" "Default" "N"
element 11 "Name" "Data 10"
element 11 "On White" "23" "N"
element 11 "On Black" "81" "N"
element 11 "Symbol" "" "N"
element 11 "Measured" "Default" "N"
element 11 "Simulated" "Default" "N"
element 12 "Name" "Data 11"
element 12 "On White" "102" "N"
element 12 "On Black" "50" "N"
element 12 "Symbol" "" "N"
element 12 "Measured" "Default" "N"
element 12 "Simulated" "Default" "N"
element 13 "Name" "Data 12"
element 13 "On White" "27" "N"
element 13 "On Black" "115" "N"
element 13 "Symbol" "" "N"
element 13 "Measured" "Default" "N"
element 13 "Simulated" "Default" "N"
element 14 "Name" "Data 13"
element 14 "On White" "54" "N"
element 14 "On Black" "54" "N"
element 14 "Symbol" "" "N"
element 14 "Measured" "Default" "N"
element 14 "Simulated" "Default" "N"
element 15 "Name" "Data 14"
element 15 "On White" "106" "N"
element 15 "On Black" "106" "N"
element 15 "Symbol" "" "N"
element 15 "Measured" "Default" "N"
element 15 "Simulated" "Default" "N"
element 16 "Name" "Data 15"
element 16 "On White" "120" "N"
element 16 "On Black" "120" "N"
element 16 "Symbol" "" "N"
element 16 "Measured" "Default" "N"
element 16 "Simulated" "Default" "N"
element 17 "Name" "Data 16"
element 17 "On White" "87" "N"
element 17 "On Black" "87" "N"
element 17 "Symbol" "" "N"
element 17 "Measured" "Default" "N"
element 17 "Simulated" "Default" "N"
element 18 "Name" "Data 17"
element 18 "On White" "29" "N"
element 18 "On Black" "79" "N"
element 18 "Symbol" "" "N"
element 18 "Measured" "Default" "N"
element 18 "Simulated" "Default" "N"
element 19 "Name" "Data 18"
element 19 "On White" "81" "N"
element 19 "On Black" "81" "N"
element 19 "Symbol" "" "N"
element 19 "Measured" "Default" "N"
element 19 "Simulated" "Default" "N"
element 20 "Name" "Data 19"
element 20 "On White" "1" "N"
element 20 "On Black" "1" "N"
element 20 "Symbol" "Circle" "N"
element 20 "Measured" "Default" "N"
element 20 "Simulated" "Dot Line" "N"
element 21 "Name" "Data 20"
element 21 "On White" "5" "N"
element 21 "On Black" "0" "N"
element 21 "Symbol" "Reverse Triangle" "N"
element 21 "Measured" "Default" "N"
element 21 "Simulated" "Dot Line" "N"
element 22 "Name" "Data 21"
element 22 "On White" "6" "N"
element 22 "On Black" "6" "N"
element 22 "Symbol" "Star" "N"
element 22 "Measured" "Default" "N"
element 22 "Simulated" "Dot Line" "N"
element 23 "Name" "Data 22"
element 23 "On White" "3" "N"
element 23 "On Black" "3" "N"
element 23 "Symbol" "Triangle" "N"
element 23 "Measured" "Default" "N"
element 23 "Simulated" "Dot Line" "N"
element 24 "Name" "Data 23"
element 24 "On White" "88" "N"
element 24 "On Black" "88" "N"
element 24 "Symbol" "" "N"
element 24 "Measured" "Default" "N"
element 24 "Simulated" "Dot Line" "N"
element 25 "Name" "Data 24"
element 25 "On White" "4" "N"
element 25 "On Black" "4" "N"
element 25 "Symbol" "Cross" "N"
element 25 "Measured" "Default" "N"
element 25 "Simulated" "Dot Line" "N"
element 26 "Name" "Data 25"
element 26 "On White" "25" "N"
element 26 "On Black" "117" "N"
element 26 "Symbol" "Circle" "N"
element 26 "Measured" "Default" "N"
element 26 "Simulated" "Dot Line" "N"
element 27 "Name" "Data 26"
element 27 "On White" "40" "N"
element 27 "On Black" "40" "N"
element 27 "Symbol" "Circle" "N"
element 27 "Measured" "Default" "N"
element 27 "Simulated" "Dot Line" "N"
element 28 "Name" "Data 27"
element 28 "On White" "28" "N"
element 28 "On Black" "28" "N"
element 28 "Symbol" "Circle" "N"
element 28 "Measured" "Default" "N"
element 28 "Simulated" "Dot Line" "N"
element 29 "Name" "Data 28"
element 29 "On White" "114" "N"
element 29 "On Black" "114" "N"
element 29 "Symbol" "Circle" "N"
element 29 "Measured" "Default" "N"
element 29 "Simulated" "Dot Line" "N"
element 30 "Name" "Data 29"
element 30 "On White" "14" "N"
element 30 "On Black" "94" "N"
element 30 "Symbol" "Circle" "N"
element 30 "Measured" "Default" "N"
element 30 "Simulated" "Dot Line" "N"
element 31 "Name" "Data 30"
element 31 "On White" "23" "N"
element 31 "On Black" "81" "N"
element 31 "Symbol" "Circle" "N"
element 31 "Measured" "Default" "N"
element 31 "Simulated" "Dot Line" "N"
element 32 "Name" "Data 31"
element 32 "On White" "102" "N"
element 32 "On Black" "50" "N"
element 32 "Symbol" "Circle" "N"
element 32 "Measured" "Default" "N"
element 32 "Simulated" "Dot Line" "N"
element 33 "Name" "Data 32"
element 33 "On White" "27" "N"
element 33 "On Black" "115" "N"
element 33 "Symbol" "Circle" "N"
element 33 "Measured" "Default" "N"
element 33 "Simulated" "Dot Line" "N"
element 34 "Name" "Data 33"
element 34 "On White" "54" "N"
element 34 "On Black" "54" "N"
element 34 "Symbol" "Circle" "N"
element 34 "Measured" "Default" "N"
element 34 "Simulated" "Dot Line" "N"
element 35 "Name" "Data 34"
element 35 "On White" "106" "N"
element 35 "On Black" "106" "N"
element 35 "Symbol" "Circle" "N"
element 35 "Measured" "Default" "N"
element 35 "Simulated" "Dot Line" "N"
element 36 "Name" "Data 35"
element 36 "On White" "120" "N"
element 36 "On Black" "120" "N"
element 36 "Symbol" "Circle" "N"
element 36 "Measured" "Default" "N"
element 36 "Simulated" "Dot Line" "N"
element 37 "Name" "Data 36"
element 37 "On White" "87" "N"
element 37 "On Black" "87" "N"
element 37 "Symbol" "Circle" "N"
element 37 "Measured" "Default" "N"
element 37 "Simulated" "Dot Line" "N"
element 38 "Name" "Data 37"
element 38 "On White" "29" "N"
element 38 "On Black" "79" "N"
element 38 "Symbol" "Circle" "N"
element 38 "Measured" "Default" "N"
element 38 "Simulated" "Dot Line" "N"
element 39 "Name" "Data 38"
element 39 "On White" "81" "N"
element 39 "On Black" "81" "N"
element 39 "Symbol" "Circle" "N"
element 39 "Measured" "Default" "N"
element 39 "Simulated" "Dot Line" "N"
element 40 "Name" "Data 39"
element 40 "On White" "1" "N"
element 40 "On Black" "1" "N"
element 40 "Symbol" "Triangle" "N"
element 40 "Measured" "Default" "N"
element 40 "Simulated" "Dot Dot Line" "N"
element 41 "Name" "Data 40"
element 41 "On White" "5" "N"
element 41 "On Black" "0" "N"
element 41 "Symbol" "Diamond" "N"
element 41 "Measured" "Default" "N"
element 41 "Simulated" "Dot Dot Line" "N"
element 42 "Name" "Data 41"
element 42 "On White" "6" "N"
element 42 "On Black" "6" "N"
element 42 "Symbol" "X" "N"
element 42 "Measured" "Default" "N"
element 42 "Simulated" "Dot Dot Line" "N"
element 43 "Name" "Data 42"
element 43 "On White" "3" "N"
element 43 "On Black" "3" "N"
element 43 "Symbol" "Reverse Triangle" "N"
element 43 "Measured" "Default" "N"
element 43 "Simulated" "Dot Dot Line" "N"
element 44 "Name" "Data 43"
element 44 "On White" "88" "N"
element 44 "On Black" "88" "N"
element 44 "Symbol" "Circle" "N"
element 44 "Measured" "Default" "N"
element 44 "Simulated" "Dot Dot Line" "N"
element 45 "Name" "Data 44"
element 45 "On White" "4" "N"
element 45 "On Black" "4" "N"
element 45 "Symbol" "" "N"
element 45 "Measured" "Default" "N"
element 45 "Simulated" "Dot Dot Line" "N"
element 46 "Name" "Data 45"
element 46 "On White" "25" "N"
element 46 "On Black" "117" "N"
element 46 "Symbol" "Triangle" "N"
element 46 "Measured" "Default" "N"
element 46 "Simulated" "Dot Dot Line" "N"
element 47 "Name" "Data 46"
element 47 "On White" "40" "N"
element 47 "On Black" "40" "N"
element 47 "Symbol" "Triangle" "N"
element 47 "Measured" "Default" "N"
element 47 "Simulated" "Dot Dot Line" "N"
element 48 "Name" "Data 47"
element 48 "On White" "28" "N"
element 48 "On Black" "28" "N"
element 48 "Symbol" "Triangle" "N"
element 48 "Measured" "Default" "N"
element 48 "Simulated" "Dot Dot Line" "N"
element 49 "Name" "Data 48"
element 49 "On White" "114" "N"
element 49 "On Black" "114" "N"
element 49 "Symbol" "Triangle" "N"
element 49 "Measured" "Default" "N"
element 49 "Simulated" "Dot Dot Line" "N"
element 50 "Name" "Data 49"
element 50 "On White" "14" "N"
element 50 "On Black" "94" "N"
element 50 "Symbol" "Triangle" "N"
element 50 "Measured" "Default" "N"
element 50 "Simulated" "Dot Dot Line" "N"
element 51 "Name" "Data 50"
element 51 "On White" "23" "N"
element 51 "On Black" "81" "N"
element 51 "Symbol" "Triangle" "N"
element 51 "Measured" "Default" "N"
element 51 "Simulated" "Dot Dot Line" "N"
element 52 "Name" "Data 51"
element 52 "On White" "102" "N"
element 52 "On Black" "50" "N"
element 52 "Symbol" "Triangle" "N"
element 52 "Measured" "Default" "N"
element 52 "Simulated" "Dot Dot Line" "N"
element 53 "Name" "Data 52"
element 53 "On White" "27" "N"
element 53 "On Black" "115" "N"
element 53 "Symbol" "Triangle" "N"
element 53 "Measured" "Default" "N"
element 53 "Simulated" "Dot Dot Line" "N"
element 54 "Name" "Data 53"
element 54 "On White" "54" "N"
element 54 "On Black" "54" "N"
element 54 "Symbol" "Triangle" "N"
element 54 "Measured" "Default" "N"
element 54 "Simulated" "Dot Dot Line" "N"
element 55 "Name" "Data 54"
element 55 "On White" "106" "N"
element 55 "On Black" "106" "N"
element 55 "Symbol" "Triangle" "N"
element 55 "Measured" "Default" "N"
element 55 "Simulated" "Dot Dot Line" "N"
element 56 "Name" "Data 55"
element 56 "On White" "120" "N"
element 56 "On Black" "120" "N"
element 56 "Symbol" "Triangle" "N"
element 56 "Measured" "Default" "N"
element 56 "Simulated" "Dot Dot Line" "N"
element 57 "Name" "Data 56"
element 57 "On White" "87" "N"
element 57 "On Black" "87" "N"
element 57 "Symbol" "Triangle" "N"
element 57 "Measured" "Default" "N"
element 57 "Simulated" "Dot Dot Line" "N"
element 58 "Name" "Data 57"
element 58 "On White" "29" "N"
element 58 "On Black" "79" "N"
element 58 "Symbol" "Triangle" "N"
element 58 "Measured" "Default" "N"
element 58 "Simulated" "Dot Dot Line" "N"
element 59 "Name" "Data 58"
element 59 "On White" "81" "N"
element 59 "On Black" "81" "N"
element 59 "Symbol" "Triangle" "N"
element 59 "Measured" "Default" "N"
element 59 "Simulated" "Dot Dot Line" "N"
element 60 "Name" "Data 59"
element 60 "On White" "1" "N"
element 60 "On Black" "1" "N"
element 60 "Symbol" "Reverse Triangle" "N"
element 60 "Measured" "Default" "N"
element 60 "Simulated" "Dashed Line" "N"
element 61 "Name" "Data 60"
element 61 "On White" "5" "N"
element 61 "On Black" "0" "N"
element 61 "Symbol" "Star" "N"
element 61 "Measured" "Default" "N"
element 61 "Simulated" "Dashed Line" "N"
element 62 "Name" "Data 61"
element 62 "On White" "6" "N"
element 62 "On Black" "6" "N"
element 62 "Symbol" "Cross" "N"
element 62 "Measured" "Default" "N"
element 62 "Simulated" "Dashed Line" "N"
element 63 "Name" "Data 62"
element 63 "On White" "3" "N"
element 63 "On Black" "3" "N"
element 63 "Symbol" "Diamond" "N"
element 63 "Measured" "Default" "N"
element 63 "Simulated" "Dashed Line" "N"
element 64 "Name" "Data 63"
element 64 "On White" "88" "N"
element 64 "On Black" "88" "N"
element 64 "Symbol" "Triangle" "N"
element 64 "Measured" "Default" "N"
element 64 "Simulated" "Dashed Line" "N"
element 65 "Name" "Data 64"
element 65 "On White" "4" "N"
element 65 "On Black" "4" "N"
element 65 "Symbol" "Circle" "N"
element 65 "Measured" "Default" "N"
element 65 "Simulated" "Dashed Line" "N"
element 66 "Name" "Data 65"
element 66 "On White" "25" "N"
element 66 "On Black" "117" "N"
element 66 "Symbol" "Reverse Triangle" "N"
element 66 "Measured" "Default" "N"
element 66 "Simulated" "Dashed Line" "N"
element 67 "Name" "Data 66"
element 67 "On White" "40" "N"
element 67 "On Black" "40" "N"
element 67 "Symbol" "Reverse Triangle" "N"
element 67 "Measured" "Default" "N"
element 67 "Simulated" "Dashed Line" "N"
element 68 "Name" "Data 67"
element 68 "On White" "28" "N"
element 68 "On Black" "28" "N"
element 68 "Symbol" "Reverse Triangle" "N"
element 68 "Measured" "Default" "N"
element 68 "Simulated" "Dashed Line" "N"
element 69 "Name" "Data 68"
element 69 "On White" "114" "N"
element 69 "On Black" "114" "N"
element 69 "Symbol" "Reverse Triangle" "N"
element 69 "Measured" "Default" "N"
element 69 "Simulated" "Dashed Line" "N"
element 70 "Name" "Data 69"
element 70 "On White" "14" "N"
element 70 "On Black" "94" "N"
element 70 "Symbol" "Reverse Triangle" "N"
element 70 "Measured" "Default" "N"
element 70 "Simulated" "Dashed Line" "N"
element 71 "Name" "Data 70"
element 71 "On White" "23" "N"
element 71 "On Black" "81" "N"
element 71 "Symbol" "Reverse Triangle" "N"
element 71 "Measured" "Default" "N"
element 71 "Simulated" "Dashed Line" "N"
element 72 "Name" "Data 71"
element 72 "On White" "102" "N"
element 72 "On Black" "50" "N"
element 72 "Symbol" "Reverse Triangle" "N"
element 72 "Measured" "Default" "N"
element 72 "Simulated" "Dashed Line" "N"
element 73 "Name" "Data 72"
element 73 "On White" "27" "N"
element 73 "On Black" "115" "N"
element 73 "Symbol" "Reverse Triangle" "N"
element 73 "Measured" "Default" "N"
element 73 "Simulated" "Dashed Line" "N"
element 74 "Name" "Data 73"
element 74 "On White" "54" "N"
element 74 "On Black" "54" "N"
element 74 "Symbol" "Reverse Triangle" "N"
element 74 "Measured" "Default" "N"
element 74 "Simulated" "Dashed Line" "N"
element 75 "Name" "Data 74"
element 75 "On White" "106" "N"
element 75 "On Black" "106" "N"
element 75 "Symbol" "Reverse Triangle" "N"
element 75 "Measured" "Default" "N"
element 75 "Simulated" "Dashed Line" "N"
element 76 "Name" "Data 75"
element 76 "On White" "120" "N"
element 76 "On Black" "120" "N"
element 76 "Symbol" "Reverse Triangle" "N"
element 76 "Measured" "Default" "N"
element 76 "Simulated" "Dashed Line" "N"
element 77 "Name" "Data 76"
element 77 "On White" "87" "N"
element 77 "On Black" "87" "N"
element 77 "Symbol" "Reverse Triangle" "N"
element 77 "Measured" "Default" "N"
element 77 "Simulated" "Dashed Line" "N"
element 78 "Name" "Data 77"
element 78 "On White" "29" "N"
element 78 "On Black" "79" "N"
element 78 "Symbol" "Reverse Triangle" "N"
element 78 "Measured" "Default" "N"
element 78 "Simulated" "Dashed Line" "N"
element 79 "Name" "Data 78"
element 79 "On White" "81" "N"
element 79 "On Black" "81" "N"
element 79 "Symbol" "Reverse Triangle" "N"
element 79 "Measured" "Default" "N"
element 79 "Simulated" "Dashed Line" "N"
element 80 "Name" "Data 79"
element 80 "On White" "1" "N"
element 80 "On Black" "1" "N"
element 80 "Symbol" "Diamond" "N"
element 80 "Measured" "Default" "N"
element 80 "Simulated" "Dot Dashed Line" "N"
element 81 "Name" "Data 80"
element 81 "On White" "5" "N"
element 81 "On Black" "0" "N"
element 81 "Symbol" "X" "N"
element 81 "Measured" "Default" "N"
element 81 "Simulated" "Dot Dashed Line" "N"
element 82 "Name" "Data 81"
element 82 "On White" "6" "N"
element 82 "On Black" "6" "N"
element 82 "Symbol" "" "N"
element 82 "Measured" "Default" "N"
element 82 "Simulated" "Dot Dashed Line" "N"
element 83 "Name" "Data 82"
element 83 "On White" "3" "N"
element 83 "On Black" "3" "N"
element 83 "Symbol" "Star" "N"
element 83 "Measured" "Default" "N"
element 83 "Simulated" "Dot Dashed Line" "N"
element 84 "Name" "Data 83"
element 84 "On White" "88" "N"
element 84 "On Black" "88" "N"
element 84 "Symbol" "Reverse Triangle" "N"
element 84 "Measured" "Default" "N"
element 84 "Simulated" "Dot Dashed Line" "N"
element 85 "Name" "Data 84"
element 85 "On White" "4" "N"
element 85 "On Black" "4" "N"
element 85 "Symbol" "Triangle" "N"
element 85 "Measured" "Default" "N"
element 85 "Simulated" "Dot Dashed Line" "N"
element 86 "Name" "Data 85"
element 86 "On White" "25" "N"
element 86 "On Black" "117" "N"
element 86 "Symbol" "Diamond" "N"
element 86 "Measured" "Default" "N"
element 86 "Simulated" "Dot Dashed Line" "N"
element 87 "Name" "Data 86"
element 87 "On White" "40" "N"
element 87 "On Black" "40" "N"
element 87 "Symbol" "Diamond" "N"
element 87 "Measured" "Default" "N"
element 87 "Simulated" "Dot Dashed Line" "N"
element 88 "Name" "Data 87"
element 88 "On White" "28" "N"
element 88 "On Black" "28" "N"
element 88 "Symbol" "Diamond" "N"
element 88 "Measured" "Default" "N"
element 88 "Simulated" "Dot Dashed Line" "N"
element 89 "Name" "Data 88"
element 89 "On White" "114" "N"
element 89 "On Black" "114" "N"
element 89 "Symbol" "Diamond" "N"
element 89 "Measured" "Default" "N"
element 89 "Simulated" "Dot Dashed Line" "N"
element 90 "Name" "Data 89"
element 90 "On White" "14" "N"
element 90 "On Black" "94" "N"
element 90 "Symbol" "Diamond" "N"
element 90 "Measured" "Default" "N"
element 90 "Simulated" "Dot Dashed Line" "N"
element 91 "Name" "Data 90"
element 91 "On White" "23" "N"
element 91 "On Black" "81" "N"
element 91 "Symbol" "Diamond" "N"
element 91 "Measured" "Default" "N"
element 91 "Simulated" "Dot Dashed Line" "N"
element 92 "Name" "Data 91"
element 92 "On White" "102" "N"
element 92 "On Black" "50" "N"
element 92 "Symbol" "Diamond" "N"
element 92 "Measured" "Default" "N"
element 92 "Simulated" "Dot Dashed Line" "N"
element 93 "Name" "Data 92"
element 93 "On White" "27" "N"
element 93 "On Black" "115" "N"
element 93 "Symbol" "Diamond" "N"
element 93 "Measured" "Default" "N"
element 93 "Simulated" "Dot Dashed Line" "N"
element 94 "Name" "Data 93"
element 94 "On White" "54" "N"
element 94 "On Black" "54" "N"
element 94 "Symbol" "Diamond" "N"
element 94 "Measured" "Default" "N"
element 94 "Simulated" "Dot Dashed Line" "N"
element 95 "Name" "Data 94"
element 95 "On White" "106" "N"
element 95 "On Black" "106" "N"
element 95 "Symbol" "Diamond" "N"
element 95 "Measured" "Default" "N"
element 95 "Simulated" "Dot Dashed Line" "N"
element 96 "Name" "Data 95"
element 96 "On White" "120" "N"
element 96 "On Black" "120" "N"
element 96 "Symbol" "Diamond" "N"
element 96 "Measured" "Default" "N"
element 96 "Simulated" "Dot Dashed Line" "N"
element 97 "Name" "Data 96"
element 97 "On White" "87" "N"
element 97 "On Black" "87" "N"
element 97 "Symbol" "Diamond" "N"
element 97 "Measured" "Default" "N"
element 97 "Simulated" "Dot Dashed Line" "N"
element 98 "Name" "Data 97"
element 98 "On White" "29" "N"
element 98 "On Black" "79" "N"
element 98 "Symbol" "Diamond" "N"
element 98 "Measured" "Default" "N"
element 98 "Simulated" "Dot Dashed Line" "N"
element 99 "Name" "Data 98"
element 99 "On White" "81" "N"
element 99 "On Black" "81" "N"
element 99 "Symbol" "Diamond" "N"
element 99 "Measured" "Default" "N"
element 99 "Simulated" "Dot Dashed Line" "N"
element 100 "Name" "Data 99"
element 100 "On White" "1" "N"
element 100 "On Black" "1" "N"
element 100 "Symbol" "Star" "N"
element 100 "Measured" "Default" "N"
element 100 "Simulated" "Long Dashed Line" "N"
element 101 "Name" "Data 100"
element 101 "On White" "5" "N"
element 101 "On Black" "0" "N"
element 101 "Symbol" "Cross" "N"
element 101 "Measured" "Default" "N"
element 101 "Simulated" "Long Dashed Line" "N"
element 102 "Name" "Data 101"
element 102 "On White" "6" "N"
element 102 "On Black" "6" "N"
element 102 "Symbol" "Circle" "N"
element 102 "Measured" "Default" "N"
element 102 "Simulated" "Long Dashed Line" "N"
element 103 "Name" "Data 102"
element 103 "On White" "3" "N"
element 103 "On Black" "3" "N"
element 103 "Symbol" "X" "N"
element 103 "Measured" "Default" "N"
element 103 "Simulated" "Long Dashed Line" "N"
element 104 "Name" "Data 103"
element 104 "On White" "88" "N"
element 104 "On Black" "88" "N"
element 104 "Symbol" "Diamond" "N"
element 104 "Measured" "Default" "N"
element 104 "Simulated" "Long Dashed Line" "N"
element 105 "Name" "Data 104"
element 105 "On White" "4" "N"
element 105 "On Black" "4" "N"
element 105 "Symbol" "Reverse Triangle" "N"
element 105 "Measured" "Default" "N"
element 105 "Simulated" "Long Dashed Line" "N"
element 106 "Name" "Data 105"
element 106 "On White" "25" "N"
element 106 "On Black" "117" "N"
element 106 "Symbol" "Star" "N"
element 106 "Measured" "Default" "N"
element 106 "Simulated" "Long Dashed Line" "N"
element 107 "Name" "Data 106"
element 107 "On White" "40" "N"
element 107 "On Black" "40" "N"
element 107 "Symbol" "Star" "N"
element 107 "Measured" "Default" "N"
element 107 "Simulated" "Long Dashed Line" "N"
element 108 "Name" "Data 107"
element 108 "On White" "28" "N"
element 108 "On Black" "28" "N"
element 108 "Symbol" "Star" "N"
element 108 "Measured" "Default" "N"
element 108 "Simulated" "Long Dashed Line" "N"
element 109 "Name" "Data 108"
element 109 "On White" "114" "N"
element 109 "On Black" "114" "N"
element 109 "Symbol" "Star" "N"
element 109 "Measured" "Default" "N"
element 109 "Simulated" "Long Dashed Line" "N"
element 110 "Name" "Data 109"
element 110 "On White" "14" "N"
element 110 "On Black" "94" "N"
element 110 "Symbol" "Star" "N"
element 110 "Measured" "Default" "N"
element 110 "Simulated" "Long Dashed Line" "N"
element 111 "Name" "Data 110"
element 111 "On White" "23" "N"
element 111 "On Black" "81" "N"
element 111 "Symbol" "Star" "N"
element 111 "Measured" "Default" "N"
element 111 "Simulated" "Long Dashed Line" "N"
element 112 "Name" "Data 111"
element 112 "On White" "102" "N"
element 112 "On Black" "50" "N"
element 112 "Symbol" "Star" "N"
element 112 "Measured" "Default" "N"
element 112 "Simulated" "Long Dashed Line" "N"
element 113 "Name" "Data 112"
element 113 "On White" "27" "N"
element 113 "On Black" "115" "N"
element 113 "Symbol" "Star" "N"
element 113 "Measured" "Default" "N"
element 113 "Simulated" "Long Dashed Line" "N"
element 114 "Name" "Data 113"
element 114 "On White" "54" "N"
element 114 "On Black" "54" "N"
element 114 "Symbol" "Star" "N"
element 114 "Measured" "Default" "N"
element 114 "Simulated" "Long Dashed Line" "N"
element 115 "Name" "Data 114"
element 115 "On White" "106" "N"
element 115 "On Black" "106" "N"
element 115 "Symbol" "Star" "N"
element 115 "Measured" "Default" "N"
element 115 "Simulated" "Long Dashed Line" "N"
element 116 "Name" "Data 115"
element 116 "On White" "120" "N"
element 116 "On Black" "120" "N"
element 116 "Symbol" "Star" "N"
element 116 "Measured" "Default" "N"
element 116 "Simulated" "Long Dashed Line" "N"
element 117 "Name" "Data 116"
element 117 "On White" "87" "N"
element 117 "On Black" "87" "N"
element 117 "Symbol" "Star" "N"
element 117 "Measured" "Default" "N"
element 117 "Simulated" "Long Dashed Line" "N"
element 118 "Name" "Data 117"
element 118 "On White" "29" "N"
element 118 "On Black" "79" "N"
element 118 "Symbol" "Star" "N"
element 118 "Measured" "Default" "N"
element 118 "Simulated" "Long Dashed Line" "N"
element 119 "Name" "Data 118"
element 119 "On White" "81" "N"
element 119 "On Black" "81" "N"
element 119 "Symbol" "Star" "N"
element 119 "Measured" "Default" "N"
element 119 "Simulated" "Long Dashed Line" "N"
element 120 "Name" "Data 119"
element 120 "On White" "1" "N"
element 120 "On Black" "1" "N"
element 120 "Symbol" "X" "N"
element 120 "Measured" "Default" "N"
element 120 "Simulated" "Long Dot Dashed Line" "N"
element 121 "Name" "Data 120"
element 121 "On White" "5" "N"
element 121 "On Black" "0" "N"
element 121 "Symbol" "" "N"
element 121 "Measured" "Default" "N"
element 121 "Simulated" "Long Dot Dashed Line" "N"
element 122 "Name" "Data 121"
element 122 "On White" "6" "N"
element 122 "On Black" "6" "N"
element 122 "Symbol" "Triangle" "N"
element 122 "Measured" "Default" "N"
element 122 "Simulated" "Long Dot Dashed Line" "N"
element 123 "Name" "Data 122"
element 123 "On White" "3" "N"
element 123 "On Black" "3" "N"
element 123 "Symbol" "Cross" "N"
element 123 "Measured" "Default" "N"
element 123 "Simulated" "Long Dot Dashed Line" "N"
element 124 "Name" "Data 123"
element 124 "On White" "88" "N"
element 124 "On Black" "88" "N"
element 124 "Symbol" "Star" "N"
element 124 "Measured" "Default" "N"
element 124 "Simulated" "Long Dot Dashed Line" "N"
element 125 "Name" "Data 124"
element 125 "On White" "4" "N"
element 125 "On Black" "4" "N"
element 125 "Symbol" "Diamond" "N"
element 125 "Measured" "Default" "N"
element 125 "Simulated" "Long Dot Dashed Line" "N"
element 126 "Name" "Data 125"
element 126 "On White" "25" "N"
element 126 "On Black" "117" "N"
element 126 "Symbol" "X" "N"
element 126 "Measured" "Default" "N"
element 126 "Simulated" "Long Dot Dashed Line" "N"
element 127 "Name" "Data 126"
element 127 "On White" "40" "N"
element 127 "On Black" "40" "N"
element 127 "Symbol" "X" "N"
element 127 "Measured" "Default" "N"
element 127 "Simulated" "Long Dot Dashed Line" "N"
element 128 "Name" "Data 127"
element 128 "On White" "28" "N"
element 128 "On Black" "28" "N"
element 128 "Symbol" "X" "N"
element 128 "Measured" "Default" "N"
element 128 "Simulated" "Long Dot Dashed Line" "N"
element 129 "Name" "Data 128"
element 129 "On White" "114" "N"
element 129 "On Black" "114" "N"
element 129 "Symbol" "X" "N"
element 129 "Measured" "Default" "N"
element 129 "Simulated" "Long Dot Dashed Line" "N"
element 130 "Name" "Data 129"
element 130 "On White" "14" "N"
element 130 "On Black" "94" "N"
element 130 "Symbol" "X" "N"
element 130 "Measured" "Default" "N"
element 130 "Simulated" "Long Dot Dashed Line" "N"
element 131 "Name" "Data 130"
element 131 "On White" "23" "N"
element 131 "On Black" "81" "N"
element 131 "Symbol" "X" "N"
element 131 "Measured" "Default" "N"
element 131 "Simulated" "Long Dot Dashed Line" "N"
element 132 "Name" "Data 131"
element 132 "On White" "102" "N"
element 132 "On Black" "50" "N"
element 132 "Symbol" "X" "N"
element 132 "Measured" "Default" "N"
element 132 "Simulated" "Long Dot Dashed Line" "N"
element 133 "Name" "Data 132"
element 133 "On White" "27" "N"
element 133 "On Black" "115" "N"
element 133 "Symbol" "X" "N"
element 133 "Measured" "Default" "N"
element 133 "Simulated" "Long Dot Dashed Line" "N"
element 134 "Name" "Data 133"
element 134 "On White" "54" "N"
element 134 "On Black" "54" "N"
element 134 "Symbol" "X" "N"
element 134 "Measured" "Default" "N"
element 134 "Simulated" "Long Dot Dashed Line" "N"
element 135 "Name" "Data 134"
element 135 "On White" "106" "N"
element 135 "On Black" "106" "N"
element 135 "Symbol" "X" "N"
element 135 "Measured" "Default" "N"
element 135 "Simulated" "Long Dot Dashed Line" "N"
element 136 "Name" "Data 135"
element 136 "On White" "120" "N"
element 136 "On Black" "120" "N"
element 136 "Symbol" "X" "N"
element 136 "Measured" "Default" "N"
element 136 "Simulated" "Long Dot Dashed Line" "N"
element 137 "Name" "Data 136"
element 137 "On White" "87" "N"
element 137 "On Black" "87" "N"
element 137 "Symbol" "X" "N"
element 137 "Measured" "Default" "N"
element 137 "Simulated" "Long Dot Dashed Line" "N"
element 138 "Name" "Data 137"
element 138 "On White" "29" "N"
element 138 "On Black" "79" "N"
element 138 "Symbol" "X" "N"
element 138 "Measured" "Default" "N"
element 138 "Simulated" "Long Dot Dashed Line" "N"
element 139 "Name" "Data 138"
element 139 "On White" "81" "N"
element 139 "On Black" "81" "N"
element 139 "Symbol" "X" "N"
element 139 "Measured" "Default" "N"
element 139 "Simulated" "Long Dot Dashed Line" "N"
element 140 "Name" "Data 139"
element 140 "On White" "1" "N"
element 140 "On Black" "1" "N"
element 140 "Symbol" "Cross" "N"
element 140 "Measured" "Default" "N"
element 140 "Simulated" "Solid Line" "N"
element 141 "Name" "Data 140"
element 141 "On White" "5" "N"
element 141 "On Black" "0" "N"
element 141 "Symbol" "Circle" "N"
element 141 "Measured" "Default" "N"
element 141 "Simulated" "Solid Line" "N"
element 142 "Name" "Data 141"
element 142 "On White" "6" "N"
element 142 "On Black" "6" "N"
element 142 "Symbol" "Reverse Triangle" "N"
element 142 "Measured" "Default" "N"
element 142 "Simulated" "Solid Line" "N"
element 143 "Name" "Data 142"
element 143 "On White" "3" "N"
element 143 "On Black" "3" "N"
element 143 "Symbol" "" "N"
element 143 "Measured" "Default" "N"
element 143 "Simulated" "Solid Line" "N"
element 144 "Name" "Data 143"
element 144 "On White" "88" "N"
element 144 "On Black" "88" "N"
element 144 "Symbol" "X" "N"
element 144 "Measured" "Default" "N"
element 144 "Simulated" "Solid Line" "N"
element 145 "Name" "Data 144"
element 145 "On White" "4" "N"
element 145 "On Black" "4" "N"
element 145 "Symbol" "Star" "N"
element 145 "Measured" "Default" "N"
element 145 "Simulated" "Solid Line" "N"
element 146 "Name" "Data 145"
element 146 "On White" "25" "N"
element 146 "On Black" "117" "N"
element 146 "Symbol" "Cross" "N"
element 146 "Measured" "Default" "N"
element 146 "Simulated" "Solid Line" "N"
element 147 "Name" "Data 146"
element 147 "On White" "40" "N"
element 147 "On Black" "40" "N"
element 147 "Symbol" "Cross" "N"
element 147 "Measured" "Default" "N"
element 147 "Simulated" "Solid Line" "N"
element 148 "Name" "Data 147"
element 148 "On White" "28" "N"
element 148 "On Black" "28" "N"
element 148 "Symbol" "Cross" "N"
element 148 "Measured" "Default" "N"
element 148 "Simulated" "Solid Line" "N"
element 149 "Name" "Data 148"
element 149 "On White" "114" "N"
element 149 "On Black" "114" "N"
element 149 "Symbol" "Cross" "N"
element 149 "Measured" "Default" "N"
element 149 "Simulated" "Solid Line" "N"
element 150 "Name" "Data 149"
element 150 "On White" "14" "N"
element 150 "On Black" "94" "N"
element 150 "Symbol" "Cross" "N"
element 150 "Measured" "Default" "N"
element 150 "Simulated" "Solid Line" "N"
}
TABLE "Curve Settings" "711.501"
{
element 0 "Curve" "Curve 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 1 "Curve" "Curve 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 2 "Curve" "Curve 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 3 "Curve" "Curve 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 4 "Curve" "Curve 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 5 "Curve" "Curve 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 6 "Curve" "Curve 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 7 "Curve" "Curve 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 8 "Curve" "Curve 8"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 9 "Curve" "Curve 9"
element 9 "On White" "114" "A"
element 9 "On Black" "114" "A"
element 10 "Curve" "Curve 10"
element 10 "On White" "14" "N"
element 10 "On Black" "94" "N"
element 11 "Curve" "Curve 11"
element 11 "On White" "23" "N"
element 11 "On Black" "81" "N"
element 12 "Curve" "Curve 12"
element 12 "On White" "102" "N"
element 12 "On Black" "50" "N"
element 13 "Curve" "Curve 13"
element 13 "On White" "27" "N"
element 13 "On Black" "115" "N"
element 14 "Curve" "Curve 14"
element 14 "On White" "54" "N"
element 14 "On Black" "54" "N"
element 15 "Curve" "Curve 15"
element 15 "On White" "106" "N"
element 15 "On Black" "106" "N"
element 16 "Curve" "Curve 16"
element 16 "On White" "120" "N"
element 16 "On Black" "120" "N"
element 17 "Curve" "Curve 17"
element 17 "On White" "87" "N"
element 17 "On Black" "87" "N"
element 18 "Curve" "Curve 18"
element 18 "On White" "29" "N"
element 18 "On Black" "79" "N"
element 19 "Curve" "Curve 19"
element 19 "On White" "81" "N"
element 19 "On Black" "81" "N"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
LINK CIRC "Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK PS "Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P15 P100 P100 P100 P100 P100 P100 P100"
}
}
}
LINK MACRO "ABOUT" "711.501"
{
TABLE "Edit Macro Info" "711.501"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 
 ! VERSION:      23.Nov. 2019
 
 
 
 
 ! This ModelFile has been created and is maintained by
 ! ----------------------------------------------------------
 ! 
 ! SisConsult  IngenieurbÃ¼ro - Engineering Office
 ! Dr.-Ing. Franz Sischka
 ! Magstadt
 ! Germany
 ! 
 ! 
 ! ----------------------------------------------------------
 ! contact@SisConsult.de
 ! www.SisConsult.de
 ! ----------------------------------------------------------
}
}
}
LINK MACRO "README" "711.501"
{
TABLE "Edit Macro Info" "711.501"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 
 
 
 !##########################################################
 ! This file serves as a location for centralized, 
 ! re-usable IC-CAP Programs and GUI tools.
 !..................................................................
 ! This enables to have
 !  -> only a single, central location of your key programming code,
 !     for easier programming code maintenance and enhancement.
 !..................................................................
 
 
 
 
 
 ! NOTE: you can save this ModelFile 'UTILITIES'  *without* data!
 ! i.e., when saving this ModelFile, 
 ! enable the check-box 'Save without Measured/Simulated Data'.
 
 
 ! And you can auto-load this ModelFile when starting IC-CAP:
 ! Under Unix,
 !      write a script, which starts IC-CAP,
 !      e.g.  
 !      $ICCAP_ROOT/bin/iccap.exe  path2my_modelfile/my_modelfile.mdl
 ! Under Windows, create an IC-CAP start icon,
 !      right-click on that icon and enter in Properties/Target
 !      C:\ICCAP_ROOT\bin\iccap.exe  path2mymodelfile\my_modelfile.mdl
}
}
}
LINK MACRO "____________________1" "711.501"
{
TABLE "Edit Macro Info" "711.501"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{

}
}
}
LINK DUT "_SEE_MACRO_README_" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "_____________________________________0" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "DIR_FILE_BROWSER" "711.501"
{
View tree_dut 0 "0"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 C15 C15 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P15 P100 P100 P100 P100 P100 P100 P100"
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "DIR_FILE_BROWSER_WindowsStyle" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.7999709682102 5952 6011"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P29 C20 P305 C10"
element 0 "Name" "ErrMsg"
element 0 "Value" ""
element 1 "Name" "Header4Gui"
element 1 "Value" "Select an .mdm file for analyzing its data and (optionally) cutting it into sub-sweeps."
element 2 "Name" "Suffix"
element 2 "Value" "mdm"
element 3 "Name" "Wildcard"
element 3 "Value" "*"
element 4 "Name" "SelPolicy"
element 4 "Value" "Single"
element 5 "Name" "SelFiles"
element 5 "Value" "1"
element 6 "Name" "ActDirPath"
element 6 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/ScaledMdlg_Chalmers_2011-05"
element 7 "Name" "DirNames"
element 7 "Value" "ICCAP_ARRAY[0]"
element 8 "Name" "DirNames_sel"
element 8 "Value" "-1"
element 9 "Name" "__________________1"
element 9 "Value" ""
element 10 "Name" "FileNames"
element 10 "Value" "GaN_Triquint_40Chip2~DC~combined.mdm"
element 11 "Name" "FileNames_sel"
element 11 "Value" "ICCAP_ARRAY[0]"
element 12 "Name" "__________________2"
element 12 "Value" ""
element 13 "Name" "tmpDirFileNames"
element 13 "Value" "ICCAP_ARRAY[0]"
element 14 "Name" "Text4GUI"
element 14 "Value" ""
element 15 "Name" "tmpVar[0]"
element 15 "Value" "gan_triquint_40chip2~dc~combined.mdm"
element 16 "Name" "tmpVar"
element 16 "Value" "ICCAP_ARRAY[1]"
element 17 "Name" "Index[0]"
element 17 "Value" "0"
element 18 "Name" "Index"
element 18 "Value" "ICCAP_ARRAY[1]"
element 19 "Name" "___________________________________"
element 19 "Value" ""
element 20 "Name" "x_Pos"
element 20 "Value" "42"
element 20 "Comment" "position of GUI"
element 21 "Name" "y_Pos"
element 21 "Value" "54"
element 21 "Comment" "position of GUI"
element 22 "Name" ""
element 22 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "GUI_Browse_Dirs_Files"
element 0 "Value" "TL|OR=VE:WD=500:LX=%#15x_Pos:LY=%#15y_Pos|<none>|#16HEADER:#19LA_ErrMsg:#213ED_ActDirPath:#13SEP:#210LI_dirname:#212TL_filenames:#13sep:#17TL_Done|1|0"
element 1 "Name" "GUI_Browse_Dirs_Files.HEADER"
element 1 "Value" "LA|BG=C3:CA=%#210Header4Gui:TO=FH&dummy|<none>|<none>|0|1"
element 2 "Name" "GUI_Browse_Dirs_Files.TL_filenames"
element 2 "Value" "TL|SF=%SelFiles|<none>|#214LI_avail_files:#221TL_Wiildcard_n_Suffix|1"
element 3 "Name" "GUI_Browse_Dirs_Files.TL_filenames.LI_avail_files"
element 3 "Value" "LI|CA=#15Files:IT=%#19FileNames:SX=%#213FileNames_sel:SY=SS:VI=13|<none>|<none>|0"
element 4 "Name" "GUI_Browse_Dirs_Files.TL_filenames.TL_Wiildcard_n_Suffix.Wildcard"
element 4 "Value" "ED|CA=#235Filename Wildcard (case sensitive!):VA=%#18Wildcard:TO=FW&FH|EP=#215Show_Dirs_Files&#17Execute|<none>|1"
element 5 "Name" "GUI_Browse_Dirs_Files.TL_Done"
element 5 "Value" "TL|OR=HO:TO=FH&TT&TR|<none>|#17PB_View:#19PB_Rename:#19PB_Delete:#15space:#19PB_Cancel:#15PB_OK|1"
element 6 "Name" "GUI_Browse_Dirs_Files.TL_Done.PB_Cancel"
element 6 "Value" "PB|CA=#16Cancel:TO=FW&FH|AC=#213GUI_Cancel_OK&#214Execute,Cancel|<none>|0"
element 7 "Name" "GUI_Browse_Dirs_Files.TL_Done.PB_OK"
element 7 "Value" "PB|CA=#12OK:TO=FW&FH|AC=#213GUI_Cancel_OK&#210Execute,OK|<none>|1"
element 8 "Name" "GUI_Browse_Dirs_Files.TL_filenames.TL_Wiildcard_n_Suffix"
element 8 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#18Wildcard:#16Suffix:#15space|1"
element 9 "Name" "GUI_Browse_Dirs_Files.TL_filenames.TL_Wiildcard_n_Suffix.Suffix"
element 9 "Value" "ED|CA=#233Filename Suffix (case sensitive!):VA=%#16Suffix:TO=FW&FH|EP=#215Show_Dirs_Files&#17Execute|<none>|0"
element 10 "Name" "GUI_Browse_Dirs_Files.TL_Done.space"
element 10 "Value" "TL|<none>|<none>|<none>|0"
element 11 "Name" "GUI_Browse_Dirs_Files.ED_ActDirPath"
element 11 "Value" "ED|CA=#235Current Directory Path (Unix style):VA=%#210ActDirPath:TO=FH&dummy|EP=#213GUI_ChangeDir&#19Execute,0|<none>|0"
element 12 "Name" "GUI_Browse_Dirs_Files.SEP"
element 12 "Value" "SE|TO=FH&dummy|<none>|<none>|0"
element 13 "Name" "GUI_Browse_Dirs_Files.LI_dirname"
element 13 "Value" "LI|CA=#266Directories    \174   Just select and click once, no double-click!:IT=%#18DirNames:SX=%#212DirNames_sel:SY=SS:TO=FH&dummy:VI=13|LS=#213GUI_ChangeDir&#19Execute,1|<none>|0"
element 14 "Name" "GUI_Browse_Dirs_Files.LA_ErrMsg"
element 14 "Value" "LA|CA=%#16ErrMsg:FI=DF:FG=C2:TO=FH&dummy|<none>|<none>|0"
element 15 "Name" "GUI_Browse_Dirs_Files.TL_Done.PB_View"
element 15 "Value" "PB|CA=#216View File Header:SF=%SelFiles:TO=FW&FH|AC=#216GUI_Manage_Files&#212Execute,View|<none>|1"
element 16 "Name" "GUI_Browse_Dirs_Files.TL_Done.PB_Rename"
element 16 "Value" "PB|CA=#215  Rename File  :SF=%SelFiles:TO=FW&FH|AC=#216GUI_Manage_Files&#214Execute,Rename|<none>|0"
element 17 "Name" "GUI_Browse_Dirs_Files.TL_Done.PB_Delete"
element 17 "Value" "PB|CA=#218  Delete File(s)  :SF=%SelFiles:TO=FW&FH|AC=#216GUI_Manage_Files&#214Execute,Delete|<none>|0"
element 18 "Name" "GUI_Browse_Dirs_Files.TL_filenames.TL_Wiildcard_n_Suffix.space"
element 18 "Value" "TL|<none>|<none>|<none>|0"
element 19 "Name" "GUI_Browse_Dirs_Files.sep"
element 19 "Value" "SE|TO=FH&dummy|<none>|<none>|0"
element 20 "Name" "GUI_UserCommunication"
element 20 "Value" "TL|HT=600:OR=VE:WD=800|<none>|#17ED_Text|1|1"
element 21 "Name" "GUI_UserCommunication.ED_Text"
element 21 "Value" "ED|EM=ML:ED=F:VA=%#18Text4GUI:FI=FF|<none>|<none>|0"
element 22 "Name" ""
element 22 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 
 ! Based on previous utilities 'SELECT_DIR_FILE_BROWSER' and
 ! 'SELECT_DIR_FILES_BROWSER', this re-written utility
 ! offers a Windows-style file browser, which shows both, 
 ! the further directories in the selected dir,
 ! and -new- also the available files in the selected dir.
 
 
 ! It can be applied to select a single file (SelPolicy="Single")
 ! or to select several files (SelPolicy="Multi").
 ! And also to only select a dirctory (SelPolicy="DirOnly"),
 ! while nevertheless showing the local files (greyed out in the GUI).
 
 ! At the end, 
 ! -> the selected directory is available in Variable 'ActDirPath', while 
 ! -> the selected file (SelPolicy="Single") 
 !    is  available in Variable 'FileNames', and
 ! -> the selected files (SelPolicy="Multi") 
 !    are available in Array 'FileNames'.
 
 
 ! Additonally, like with the MS-Windows FileBrowser, files found during
 ! browsing can be deleted, renamed or looked at.
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 !---In your local Model file, 
 ! - specify the Variables 
 !    DirName            (so that the next call re-uses the old directory)
 !    Suffix             (-same-)
 !    FilenameWildcard   (-same-)
 !
 !    FileName  (to receive the selected filename, when SelPolicy="Single")  
 !or
 !    FileNames (for SelPolicy="Multi")
 !
 !    ErrMsg
 !
 ! - and have a Transform or Macro with these lines:
 
 
 !-------cut here-----------------------------------------------
 !---Define variables 'GUIheader', 'DirName', 'Suffix', 'FilenameWildcard' and 'SelPolicy'
 GUIheader = "my GUI Header"
 DirName   = "C:/temp"		!comment this line out, to keep last selection active
 Suffix    = "txt"
 FilenameWildcard = ""
 SelPolicy = "Single"		! Single, Multi, DirOnly
 ErrMsg    = ""
 
 
 ErrMsg = ""
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(DirName), VAL$(Suffix), VAL$(FilenameWildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 !===Now, do something============================================
 
 
 !---case 'Single'--------------------
 IF VAL$(SelPolicy)=="Single" THEN
   ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
   IF VAL$(ErrMsg)=="" THEN
     !  copy Variables 'ActDirPath' and 'FileNames' to your local ModelFile
     DirName = LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
     FileName= LOOKUP_VAR(VAL$(Path2Utilities)&"/FileNames")
     DirFileName=VAL$(DirName)&"/"&VAL$(FileName)
  
     !---op.system independent path style
     DirFileName=SYS_PATH$(VAL$(DirFileName))
 
     !---do something ...
     GET_STRING "User has selected                                 ",VAL$(DirFileName), dummy
   ELSE
 
     GET_STRING VAL$(ErrMsg) & "   [OK]", dummy
     RETURN_VALUE 0
 
   END IF
 END IF
 
 
 !---case 'Multi'--------------------
 IF VAL$(SelPolicy)=="Multi" THEN
   ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
   IF VAL$(ErrMsg)=="" THEN
     ! 
     !  Copy Variable 'ActDirPath' and Array 'FileNames' to your local ModelFile
     !  NOTE: To copy a complete Array, apply dummy=ARRAY_COPY(remote_array, local_array)
     DirName = LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
     dummy = ARRAY_COPY(VAL$(Path2Utilities)&"/FileNames", "FileNames")
     GET_STRING "User has selected "&VAL$(SIZEOF(FileNames))&" file(s)", dummy
   ELSE
     GET_STRING VAL$(ErrMsg) & "   [OK]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 
 !---case 'DirOnly'--------------------
 
 IF VAL$(SelPolicy)=="DirOnly" THEN
   ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
   IF VAL$(ErrMsg)=="" THEN
     !---Get the selected directory back
     DirName=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
     !---convert to op.system indep. style
     DirName=SYS_PATH$(VAL$(DirName))
 
     GET_STRING "User has selected directory", DirName, dummy
 
   ELSE
     GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 !-------cut here-----------------------------------------------
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________________1" "711.501"
{
}
LINK XFORM "BROWSE_DIR_FILE" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR Header4Gui
 GLOBAL_VAR ActDirPath
 GLOBAL_VAR Wildcard
 GLOBAL_VAR Suffix
 GLOBAL_VAR ErrMsg
 GLOBAL_VAR SelPolicy	!Selection Policy for Filenames List  [Single], [Multi], [DirOnly]
 GLOBAL_VAR SelFiles
 !-------------------------------
 
 
 ErrMsg = ""
 
 
 ! This transform calls a GUI
 ! which offers a directory and file browser.
 ! It returns the selected filename(s)
 ! and the corresponding directory path.
 
 !These GET_STRINGS will be satisfied by the calling Program
 GET_STRING "Enter header of GUI", Header4Gui, Header4Gui
 GET_STRING "Enter starting directory", ActDirPath, ActDirPath
 ActDirPath=SYS_PATH$(VAL$(ActDirPath))		!change to cygwin directory style
 GET_STRING "Enter file name Suffix (e.g. .mdm)", Suffix, Suffix
 GET_STRING "Enter the file name filter Wildcard 
 	-> e.g. *diode*4711* will select files including both, 'diode' and '4711'
 	-> entering nothing will select all files with given file Suffix", Wildcard, Wildcard
 GET_STRING "Selection Policy for Filenames List  [Single], [Multi], [DirOnly]", "Single", SelPolicy
 
 
 
 !----------------------------------
 ICCAP_FUNC("Clean_Up", "Execute")
 Suffix = TRIM$(VAL$(Suffix), ".")	! in case the user had entered the file suffix like e.g. '.txt'
 
 !---set GUI Selection Policy
 ICCAP_FUNC("Adjust_Gui_to_Sel_Policy", "Execute", SelPolicy)
 
 
 !---verify starting directory name
 ICCAP_FUNC("Verify_Dirname", "Execute", VAL$(ActDirPath))
 
 
 !---Identify available files with correct 
 !    filename Wildcard and filename Suffix in start-up directory
 ICCAP_FUNC("Show_Dirs_Files", "Execute")
 
 
 !---Call the GUI 
 ICCAP_FUNC("./GUI_Browse_Dirs_Files", "Display Modal GUI", "Open")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________________2" "711.501"
{
}
LINK XFORM "GUI_ChangeDir" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR ActDirPath
 GLOBAL_VAR DirNames
 GLOBAL_VAR DirNames_sel
 GLOBAL_VAR ErrMsg
 !-------------------------------
 
 ErrMsg = ""
 
 GET_STRING "Change dir due to directly entered user value ? [0]
 	or due to mouse click into GUI, [1]", What2Do
 
 
 !---make directory path operating system independent
 ActDirPath = SYS_PATH$(VAL$(ActDirPath))
 
 
 ICCAP_FUNC("Verify_Dirname", "Execute", VAL$(ActDirPath))
 IF VAL$(ErrMsg)<>"" THEN
   IF VAL(Debug)==1 THEN PRINT "wait 3sec; show error message in DirFileBrowser GUI ..."
   dummy=WAIT(3)		! show the problem to the user by the GUI
 END IF
 
 
 IF What2Do == "1" THEN
   !---change directory
   IF VAL$(DirNames[DirNames_sel])==".." THEN
     !---move one directory back
     LastSlashPos = STRRPOS(VAL$(ActDirPath), "/")
     IF (LastSlashPos-1) > 0 THEN 
       ActDirPath   = SUBSTR$(VAL$(ActDirPath), 1 , LastSlashPos-1)
     END IF
   ELSE
     !---move further down to the specified directory
     ActDirPath = VAL$(ActDirPath)&"/"&VAL$(DirNames[DirNames_sel])
   END IF
 END IF
 
 
 !---remove possible trailing '/'
 IF SUBSTR$(VAL$(ActDirPath), STRLEN(VAL$(ActDirPath)) , STRLEN(VAL$(ActDirPath))) =="/" THEN
   ActDirPath   = SUBSTR$(VAL$(ActDirPath), 1, STRLEN(VAL$(ActDirPath))-1)
 END IF
 
 
 
 
 !---identify the dirs and files in the new directory
 ICCAP_FUNC("Show_Dirs_Files", "Execute")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Show_Dirs_Files" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR ActDirPath
 
 GLOBAL_VAR  DirNames
 GLOBAL_VAR  DirNames_sel
 
 GLOBAL_VAR  FileNames
 GLOBAL_VAR  FileNames_sel
 
 GLOBAL_VAR  Wildcard
 GLOBAL_VAR  Suffix
 
 GLOBAL_VAR  tmpDirFileNames		!used to do all array sorting in the background, without slowing down the GUI
 GLOBAL_VAR  ErrMsg
 
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  Index
 !-------------------------------
 
 ErrMsg = ""
 DIMENSION_ARRAY(FileNames, 1)
 FileNames[0] = "searching ...  pls. wait ..."
 
 Suffix = TRIM$(VAL$(Suffix), ".")	! in case the user had entered the file suffix like e.g. '.txt'
 
 !---unselect all
 DirNames_sel =-1
 FileNames_sel=-1
 
 
 IF VAL(Debug)==1 THEN PRINT "### Identify the sub-directories in current 'DirNames_sel'"
 !    Execute the unix 'cd' command, 
 !    followed by the 'ls -p' command (which returns the found dirnames (with appended /)) and also the filenames)
 ls_dirfilenames = SYSTEM$("cd "&VAL$(ActDirPath) &"
 ls -p   2> /dev/null")			!  ' 2> /dev/null'  suppress error messages
 
 !---cut the big single string of the 'ls' command (with many new-lines-characters) into its components
 dummy = CUTSTR(ls_dirfilenames, tmpDirFileNames)
 
 !---keep only the directory names
 DirNames=""
 i=0
 max_i=SIZEOF(tmpDirFileNames)
 WHILE i < max_i
   IF STRPOS(VAL$(tmpDirFileNames[i]), "/") == 0 THEN 
     dummy=ARRAY_REMOVE_AT(tmpDirFileNames, i)
     i = i - 1
     max_i = max_i -1
   END IF
   i = i + 1
 END WHILE
 
 
 !---re-sort directories case-insensitively
 IF SIZEOF(tmpDirFileNames)>0 THEN
   dummy=ARRAY_COPY(tmpDirFileNames, tmpVar)
   FOR i=0 TO SIZEOF(tmpVar)-1
     tmpVar[i]=LWC$(VAL$(tmpVar[i]))
   NEXT i
   dummy=ARRAY_SORT_STR(tmpVar, Index)
   dummy=ARRAY_REORDER(tmpDirFileNames, Index)
 END IF
 
 !---insert the ".." dir path
 dummy=ARRAY_INSERT_AT(tmpDirFileNames, "..", 0)
 
 
 !---copy result to DirNames
 !                  from         to
 dummy=ARRAY_COPY(tmpDirFileNames, DirNames)
 
 
 
 IF VAL(Debug)==1 THEN PRINT "### In current 'DirNames_sel', identify the filenames matching the Wildcard"
 !     and the Suffix, and export them to FileNames
 !    Execute the unix 'cd' command, followed by the 'ls -p' command (which returns the found filenames, and also matching dirnames (with appended /))
 !    Note: if no file extensions are specified, ls also returns directory names !
 IF (VAL$(Wildcard)=="") AND (VAL$(Suffix))=="" THEN
   ls_dirfilenames = SYSTEM$("cd "&VAL$(ActDirPath) &"
   ls -p   2> /dev/null")
 ELSE
   ls_dirfilenames = SYSTEM$("cd "&VAL$(ActDirPath) &"
   ls -p *"&VAL$(Wildcard)&"*"&VAL$(Suffix)&"  2> /dev/null")
 END IF
 
 
 !---cut the big single string of the 'ls' command (with many new-lines-characters) into its components
 dummy = CUTSTR(ls_dirfilenames, tmpDirFileNames)
 
 
 !---keep only the filenames
 FileNames=""
 
 max_i=SIZEOF(tmpDirFileNames)
 IF max_i>500 THEN 	!this is a practical limit to avoid too long waiting times
   GET_STRING " NOTE: there are "&VAL$(max_i)&" directories/files at current dir location
 	This may slow down the program execution... 
 	Hit [OK] to continue", dummy
 END IF
 
 
 i=0
 WHILE i < max_i
   IF STRPOS(VAL$(tmpDirFileNames[i]), "/") > 0 THEN 
     dummy=ARRAY_REMOVE_AT(tmpDirFileNames, i)
     i = i - 1
     max_i = max_i -1
   END IF
   i = i + 1
 END WHILE
 
 
 !---re-sort filenames case-insensitively
 IF SIZEOF(tmpDirFileNames)>0 THEN
   dummy=ARRAY_COPY(tmpDirFileNames, tmpVar)
   FOR i=0 TO SIZEOF(tmpVar)-1
     tmpVar[i]=LWC$(VAL$(tmpVar[i]))
   NEXT i
   dummy=ARRAY_SORT_STR(tmpVar, Index)
   dummy=ARRAY_REORDER(tmpDirFileNames, Index)
 END IF
 
 IF SIZEOF(tmpDirFileNames)>0 THEN
   !---copy result to FileNames
  !                  from         to
   dummy=ARRAY_COPY(tmpDirFileNames, FileNames)
 END IF
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Verify_Dirname" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ActDirPath
 GLOBAL_VAR  ErrMsg
 !-------------------------------
 
 
 GET_STRING "ActDirPath", ActDirPath
 
 ErrMsg = ""
 
 
 ActDirPath=ASCII$(VAL$(ActDirPath))
 !---exchange a possible "\" in the ActDirPath to default "/"
 badchar="\"
 goodchar="/"
 stringpos=1
 WHILE stringpos>0
   stringpos=STRPOS(VAL$(ActDirPath), VAL$(badchar))
   IF stringpos>0 THEN  
     stringlen=STRLEN(VAL$(ActDirPath))
     ActDirPath=SUBSTR$(VAL$(ActDirPath), 1 ,stringpos-1)&VAL$(goodchar)&SUBSTR$(VAL$(ActDirPath), stringpos+1, stringlen)
   END IF
 END WHILE
 
 
 !---show full path if user had selected '.', i.e. the IC-CAP home directory
 IF (VAL$(ActDirPath)==".") OR (VAL$(ActDirPath)=="") THEN 
   !---get home dir
   ActDirPath=SYSTEM$("pwd")
 END IF
 
 
 !---make directory path operating system independent
 ActDirPath = SYS_PATH$(VAL$(ActDirPath))
 
 
 !---Verify if the entered directory exists at all
 !   If not, then default to current home directory
 dir_fail=SYSTEM("cd "&VAL$(ActDirPath)&" 2> /dev/null")
 IF (dir_fail<>0) OR (VAL$(ActDirPath)=="") THEN 
  IF VAL(Debug)==1 THEN  PRINT "Directory '";ActDirPath;"' not found !"
   ActDirPath=SYSTEM$("pwd")
  IF VAL(Debug)==1 THEN  PRINT "Changing dir to default directory '";ActDirPath;"' instead"
   ErrMsg = "ERROR: dir not found (does dirname include spaces ???); changing to default dir"
   RETURN_VALUE 0
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Adjust_Gui_to_Sel_Policy" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR SelFiles
 
 
 
 
 GET_STRING "Selection Policy for Filenames List  [Single], [Multi], [DirOnly]", SelPolicy
 
 
 
 Path2GUI = "./GUI_Browse_Dirs_Files.TL_filenames.LI_avail_files"
 
 !-------------------------------
 IF SelPolicy=="Multi" THEN
   ICCAP_FUNC(Path2GUI, "Set GUI Options", "SY=ES", "SX=", "SI=FileNames_sel", "")
 END IF
 
 
 !-------------------------------
 IF SelPolicy=="Single" THEN
   ICCAP_FUNC(Path2GUI, "Set GUI Options", "SY=SS", "SX=%FileNames_sel", "SI=", "")
 END IF
 
 
 !-------------------------------
 SelFiles=1
 IF SelPolicy=="DirOnly" THEN SelFiles=0
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Manage_Files" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ActDirPath
 GLOBAL_VAR  FileNames
 GLOBAL_VAR  FileNames_sel
 GLOBAL_VAR  Text4GUI
 !-------------------------
 
 GET_STRING "What to do ?  [Delete], [View], [Rename]", "View", What2Do
 
 
 !---check if nothing was selected
 IF VAL(FileNames_sel)<0 THEN RETURN_VALUE 2
 
 !---DELETE----------------------------------------
 IF What2Do=="Delete" THEN
   GET_STRING "Are you sure to delete the selected files ? [OK], [Cancel]", dummy
 
   IF VAL$(VAL(FileNames_sel))==VAL$(FileNames_sel) THEN 	!SelPolicy="Single"
     FileName=VAL$(FileNames[FileNames_sel])
     !---delete file
     dummy = SYSTEM("cd "&VAL$(ActDirPath) &"
 rm "&VAL$(FileName)&" 2> /dev/null")
 
   ELSE							 	!SelPolicy="Multi"
     i=0
     WHILE i < SIZEOF(FileNames_sel)
       FileName=VAL$(FileNames[FileNames_sel[i]])
       !---delete file
       dummy = SYSTEM("cd "&VAL$(ActDirPath) &"
 rm "&VAL$(FileName)&" 2> /dev/null")
 
       i = i + 1
     END WHILE
   END IF
   ICCAP_FUNC("Show_Dirs_Files", "Execute")
 
   RETURN_VALUE 3
 END IF
 
 !--------------------------------------------
 !---check if only a single file was selected
 IF SIZEOF(FileNames_sel)>1 THEN
   GET_STRING "ERROR: you can only select an individual file for this task!  [OK]", dummy
   RETURN_VALUE 4
 END IF
 
 IF VAL$(VAL(FileNames_sel))==VAL$(FileNames_sel) THEN 	!SelPolicy="Single"
   FileName=VAL$(FileNames[FileNames_sel])
 ELSE
   FileName=VAL$(FileNames[FileNames_sel[0]])
 END IF
 
 
 !---VIEW----------------------------------------
 IF What2Do=="View" THEN
   Text4GUI=SYSTEM$("cd "&VAL$(ActDirPath) &"
 head -30 "&VAL$(FileName))
   Text4GUI= VAL$(Text4GUI)&"
   ...
   ...
   ..."
   !--- opening the GUI
   FileName=VAL$(FileNames[FileNames_sel])
   ICCAP_FUNC("./GUI_UserCommunication", "Display Modeless GUI", "File Header of    "&VAL$(FileName))
 
   RETURN_VALUE 5
 END IF
 
 
 !---RENAME--------------------------------------
 IF What2Do=="Rename" THEN
   GET_STRING "Change .mdm File Name     [OK], [Cancel]", FileName, FileNameNew
 
   dummy=SYSTEM("cd "&VAL$(ActDirPath) &"
 mv "&VAL$(FileName)&" "&VAL$(FileNameNew)&" 2> /dev/null")
 
   ICCAP_FUNC("Show_Dirs_Files", "Execute")
   RETURN_VALUE 6
 END IF
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Cancel_OK" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR ErrMsg
 GLOBAL_VAR SelPolicy
 GLOBAL_VAR FileNames_sel
 !-------------------------------
 
 
 ErrMsg=""
 
 GET_STRING "What to do ?  [OK], [Cancel]", What2Do
 
 !---destroy the GUI
 ICCAP_FUNC("./GUI_Browse_Dirs_Files", "Destroy GUI", "Open")
 
 
 !---
 IF What2Do == "Cancel" THEN
   ErrMsg="User has cancelled the DirFileSelection"
   RETURN_VALUE 0
 END IF
 
 
 !---
 IF What2Do == "OK" THEN
   !common error message for both, SelPolicy=Single and SelPolicy=Multi
   IF (FileNames_sel<0) AND (VAL$(SelPolicy)<>"DirOnly") THEN 
     ErrMsg="User didn't select a File"
     RETURN_VALUE 0
   END IF
 END IF
 
 
 
 !---final works
 !---case 'Single'--------------------
 IF VAL$(SelPolicy)=="Single" THEN
   FileNames=FileNames[FileNames_sel]
 END IF
 
 
 !---case 'Multi'--------------------
 IF VAL$(SelPolicy)=="Multi" THEN
   !---adjust FileNames to match the ones selected by the user
   !                    from         to
   dummy=ARRAY_COPY(FileNames, tmpDirFileNames)
   FileNames=""
   i=0
   WHILE i < SIZEOF(FileNames_sel)
     FileNames="ICCAP_ARRAY["&VAL$(i+1)&"]"
     FileNames[i]=tmpDirFileNames[FileNames_sel[i]]
     i = i + 1
   END WHILE
 END IF
 
 tmpDirFileNames = "ICCAP_ARRAY[0]"
 FileNames_sel   = "ICCAP_ARRAY[0]"
 DirNames        = "ICCAP_ARRAY[0]"
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________________3" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !DIMENSION_ARRAY(DirNames, 0)
 DIMENSION_ARRAY(FileNames, 0)
 DIMENSION_ARRAY(FileNames_sel, 0)
 
 DIMENSION_ARRAY(tmpDirFileNames, 0)
 
 
 DIMENSION_ARRAY(Index, 0)
 
 
 tmpVar = ""
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "Create_Backup_File" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 C10 C10 C10"
element 0 "Name" "ErrMsg"
element 0 "Value" ""
element 1 "Name" ""
element 1 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "Create_Backup_File" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! When saving IC-CAP items applying ICCAP_FUNC(),
 ! IC-CAP does not create a backup file.
 ! When this Program is called right before ICCAP_FUNC(),
 ! it creates a backup file with a user-defined backup extension name.
 
 
 !  HOW TO USE:
 !  ===========
 !
 ! In your Transform, have these lines:
 !
 ! Example: save a Transform 'myXfm' and create a backup
 ! DirFileName = "test.xfm"
 ! BackupExt = "_bak"
 ! ICCAP_FUNC("/UTILITIES/DIR_FILE_BROWSER/Create_Backup_File/Create_Backup_File", "Execute", VAL$(DirFileName), VAL$(BackupExt))
 ! !apply now the conventional IC-CAP saving command:
 ! ICCAP_FUNC("myXfm", "Save As", VAL$(DirFileName))
 !
 ! Note:
 ! this Program works OK for any file name extension (.mdl, .dut, .set  etc.)
 !
 ! Instead of the default Backup Extension '_bak', you can also apply 
 ! e.g.
 !    TimeStamp = SYSTEM$("date +%Y%m%d_%H_%M_%S")
 !    BackupExt = "_bak" & VAL$(TimeStamp)
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 GLOBAL_VAR  ErrMsg
 
 
 GET_STRING "DirFileName", DirFileName
 GET_STRING "Backup Extension  [e.g.   _bak]", BackupExt
 
 
 ErrMsg = ""
 
 !---make DirFileName Operating System independent
 DirFileName = SYS_PATH$(VAL$(DirFileName))
 
 
 !---verify if user had specified a file extension
 Dot = SUBSTR$(VAL$(DirFileName), STRLEN(VAL$(DirFileName))-3, STRLEN(VAL$(DirFileName))-3)
 IF VAL$(Dot) <> "." THEN
   ErrMsg = "ERROR in Xfm '"&WHOAMI()&"':
    missing file name extension   [filename.ext]  !!!
    ==>  no backup was saved !"
    GET_STRING VAL$(ErrMsg )&"   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---if DirFileName exists already, create a backup
 DirFileName_wo_ext = SUBSTR$(VAL$(DirFileName), 1, STRLEN(VAL$(DirFileName))-4)
 File_ext           = SUBSTR$(VAL$(DirFileName), STRLEN(VAL$(DirFileName))-2, STRLEN(VAL$(DirFileName)))
 RetVal = SYSTEM("if [ -f "&VAL$(DirFileName) &" ] ; then mv -f " & VAL$(DirFileName) & " " & VAL$(DirFileName_wo_ext) & VAL$(BackupExt) & "." & VAL$(File_ext) & "; fi")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
}
LINK DUT "_____________________________________1" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "PEL_UTILITIES" "711.501"
{
View tree_dut 0 "0"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 C15 C15 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P15 P100 P100 P100 P100 P100 P100 P100"
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "VERIFY_INPUTS_OUTPUTS" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 C10 C10 C10"
element 0 "Name" "tmpVar[0]"
element 0 "Value" "freq"
element 1 "Name" "tmpVar[1]"
element 1 "Value" "dummy2"
element 2 "Name" "tmpVar[2]"
element 2 "Value" "dummy1"
element 3 "Name" "tmpVar"
element 3 "Value" "ICCAP_ARRAY[3]"
element 4 "Name" "ErrMsg"
element 4 "Value" ""
element 5 "Name" "___________________________________"
element 5 "Value" ""
element 6 "Name" ""
element 6 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,890,-166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! This Setup holds centralized standard Input/Output setting verifications
 
 ! Info about how to call these central Programs can be found on top
 ! of each Program
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________0" "711.501"
{
}
LINK XFORM "___Diode______________________" "711.501"
{
}
LINK XFORM "Diode_DC" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Diode_DC", "Execute", VAL$(Path2Setup))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Diode_DC[0])<>1 THEN RETURN_VALUE -1
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  ErrMsg
 
 GET_STRING "Path2Setup", Path2Setup
 
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 
 !---check if Input 'va' is present
 va_Present=1
 ErrMsg=""
 va_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/va", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Input 'va' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 
 !---verify if va is swept
 va_Sweep = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/va", "Sweep Type", ErrMsg)
 IF VAL$(va_Sweep)=="CON" THEN
    GET_STRING "ERROR: Input 'va' is constant, and not swept, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 
 !---check if Input 'vc' is present
 vc_Present=1
 ErrMsg=""
 vc_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vc", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Input 'vc' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 
 !---check if Output 'ia' is present
 ia_Present=1
 ErrMsg=""
 ia_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ia", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Output 'ia' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 
 !---find 1st Output and check if meas. data are loaded---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", tmpVar
 tmp = DATASET("quiet "&VAL$(Path2Setup)&"/"&VAL$(tmpVar[0]))
 IF MEAN(tmp.M)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 
 
 !---set Node names  (just in case ... )
 ICCAP_FUNC(VAL$(Path2Setup)&"/va", "STFV", "+ Node", "A")
 ICCAP_FUNC(VAL$(Path2Setup)&"/va", "STFV", "- Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vc", "STFV", "+ Node", "C")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vc", "STFV", "- Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ia", "STFV", "To Node", "A")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ia", "STFV", "From Node", "GROUND")
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Diode_CV" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Diode_CV", "Execute", VAL$(Path2Setup))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Diode_CV[0])<>1 THEN RETURN_VALUE -1
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  ErrMsg
 
 GET_STRING "Path2Setup", Path2Setup
 
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 
 !---check if Input 'vac' is present
 ErrMsg=""
 vac_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vac", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Input 'vac' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 
 !---check if Output 'cac' is present
 ErrMsg=""
 ia_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/cac", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Output 'cac' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 
 !---check if meas. data are loaded
 tmp = DATASET("quiet "&VAL$(Path2Setup)&"/cac")
 IF MEAN(tmp.M)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 
 !---set Node names
 ICCAP_FUNC(VAL$(Path2Setup)&"/vac", "STFV", "+ Node", "A")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vac", "STFV", "- Node", "C")
 ICCAP_FUNC(VAL$(Path2Setup)&"/cac", "STFV", "High Node", "A")
 ICCAP_FUNC(VAL$(Path2Setup)&"/cac", "STFV", "Low Node",  "C")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Diode_Spar" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Diode_Spar", "Execute", VAL$(Path2Setup), VAL$(SIMULATOR))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Diode_Spar[0])<>1 THEN RETURN_VALUE -1
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  ErrMsg
 
 GET_STRING "Path2Setup", Path2Setup
 GET_STRING "Simulator", Simulator
 
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 ErrMsg=""
 
 !---verify Input and Output names
 va_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/va", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Input 'va' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 vc_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vc", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Input 'vc' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 freq_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/freq", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Input 'freq' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 Sdeemb_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S_deemb", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Output 'S_deemb' available, please correct this!    [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 ia_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ia", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
    GET_STRING "ERROR: no Output 'ia' available.
    For standardization reason, such an Output with 0 data will be added next  [OK], [Cancel]", dummy
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "ia")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ia", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ia", "STFV", "Unit", "n/a")
 END IF
 
 
 !---handle DC simulation capabilities in Spar Setup
 ICCAP_FUNC(VAL$(Path2Setup)&"/ia", "STFV", "Type", "B")
 ICCAP_FUNC(VAL$(Path2Setup), "Clear Data/Simulated")
 IF VAL$(Simulator)=="hpspice" ORELSE VAL$(Simulator)=="spice2" ORELSE VAL$(Simulator)=="spice3" THEN
   ICCAP_FUNC(VAL$(Path2Setup)&"/ia", "STFV", "Type", "M")
 END IF
 
 
 !---check if meas. data are loaded
 tmp = DATASET("quiet "&VAL$(Path2Setup)&"/S_deemb")
 IF MEAN(tmp.M.11)==0 THEN
   GET_STRING "ERROR: no meas. data loaded!  [OK]", dummy
    RETURN_VALUE 0
 END IF
 
 
 
 !---set Node names (just in case ... )
 ICCAP_FUNC(VAL$(Path2Setup)&"/va", "STFV", "+ Node", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vc", "STFV", "+ Node", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 1", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 2", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ia", "STFV", "To Node", "P1")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "___Bipolar_____________________" "711.501"
{
}
LINK XFORM "Bipolar_DC" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Bipolar_DC", "Execute", VAL$(Path2Setup))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Bipolar_DC[0])<>1 THEN RETURN_VALUE -1
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 
 GET_STRING "Path2Setup", Path2Setup
 
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 !---find 1st Output and check if meas. data are loaded---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", tmpVar
 data = DATASET("quiet "&VAL$(Path2Setup)&"/"&VAL$(tmpVar[0]))
 IF MEAN(data.M)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---if not present, add Input ve------------------------------
 ErrMsg=""
 Test_ve_presence = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ve", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING "For standardization, an Input 've' will be added   [OK]", dummy
   ICCAP_FUNC(VAL$(Path2Setup), "New Input", "ve")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ve", "STFV", "Mode", "V")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ve", "STFV", "Sweep Type", "CON")
 END IF
 
 
 !---if not present, add Input vs------------------------------
 ErrMsg=""
 Test_vs_presence = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vs", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING "For standardization, an Input 'vs' will be added   [OK]", dummy
   ICCAP_FUNC(VAL$(Path2Setup), "New Input", "vs")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vs", "STFV", "Mode", "V")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vs", "STFV", "Sweep Type", "CON")
 END IF
 
 
 !---if not present, add Output is------------------------------
 ErrMsg=""
 Test_is_presence = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/is", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING "For standardization, an Output 'is' will be added   [OK]", dummy
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "is")
   ICCAP_FUNC(VAL$(Path2Setup)&"/is", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/is", "STFV", "Unit", "n/a")
 END IF
 
 
 !---set Node names (just in case ... )-----------------------
 ICCAP_FUNC(VAL$(Path2Setup)&"/vb", "STFV", "+ Node", "B")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vc", "STFV", "+ Node", "C")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ve", "STFV", "+ Node", "E")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vs", "STFV", "+ Node", "S")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ib", "STFV", "To Node", "B")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ic", "STFV", "To Node", "C")
 ICCAP_FUNC(VAL$(Path2Setup)&"/is", "STFV", "To Node", "S")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Bipolar_Spar" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---how2call_this_Program:----------------------------------------------------------
 ! A model variable SIMULATOR needs to exist !!!  with a valid IC-CAP key name for the applied simulator, e.g. hpeesofsim
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Bipolar_Spar", "Execute", VAL$(Path2Setup), VAL$(SIMULATOR))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Bipolar_Spar[0])<>1 THEN RETURN_VALUE -1
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 
 
 
 GET_STRING "Path2Setup", Path2Setup
 GET_STRING "Simulator", Simulator
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 !---verify if Output S_deemb exists
 ErrMsg=""
 S_deemb_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S_deemb", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR: no Output 'S_deemb' available  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---check if meas. data are loaded---------------------------------------
 S_deemb = DATASET("quiet "&VAL$(Path2Setup)&"/S_deemb")
 IF MEAN(S_deemb.M.11)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !  [OK]", dummy
   RETURN_VALUE -2
 END IF
 
 
 !---check if an Output called 'S' has been loaded on error---------------------------------------
 ErrMsg=""
 S_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S", "Mode", ErrMsg)
 IF VAL$(ErrMsg)=="" THEN 
     GET_STRING "ERROR: in Setup "&VAL$(Path2Setup)&",
       there exists an Output named 'S' !
     The default name for de-embedded S-parameters is 'S_deemb'.
     Please correct this  [OK]", dummy
     RETURN_VALUE -3
 END IF
 
 
 !---check if Inputs called 've' or 'vs' have been loaded on error---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   IF (VAL$(tmpVar[i])=="ve") ORELSE (VAL$(tmpVar[i])=="vs") THEN
     GET_STRING "ERROR:  in Setup "&VAL$(Path2Setup)&",
       there are Inputs 've' and/or 'vs' present!
     Please delete them [OK]", dummy
     RETURN_VALUE -1
   END IF
 NEXT i
 tmpVar = ""
 
 
 !---in case of non-ADS simulations, no DC Outputs can be simulated
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   !---case ib
   IF VAL$(tmpVar[i])=="ib" THEN
     IF VAL$(Simulator)=="hpeesofsim" ORELSE VAL$(Simulator)=="hspicemodeads" ORELSE VAL$(Simulator)=="spmodeads" THEN
       ICCAP_FUNC(VAL$(Path2Setup)&"/ib", "STFV", "Type", "B")
     ELSE
       ICCAP_FUNC(VAL$(Path2Setup)&"/ib", "STFV", "Type", "M")
     END IF
     !---set Node name (just in case ...)
     ICCAP_FUNC(VAL$(Path2Setup)&"/ib", "STFV", "To Node", "P1")
   END IF
   !---case ic
   IF VAL$(tmpVar[i])=="ic" THEN
     IF VAL$(Simulator)=="hpeesofsim" ORELSE VAL$(Simulator)=="hspicemodeads" ORELSE VAL$(Simulator)=="spmodeads" THEN
       ICCAP_FUNC(VAL$(Path2Setup)&"/ic", "STFV", "Type", "B")
     ELSE
       ICCAP_FUNC(VAL$(Path2Setup)&"/ic", "STFV", "Type", "M")
     END IF
     !---set Node name (just in case ...)
     ICCAP_FUNC(VAL$(Path2Setup)&"/ic", "STFV", "To Node", "P2")
   END IF
 NEXT i
 
 
 
 !---set Node names (just in case ... )----------------------------------------------
 ICCAP_FUNC(VAL$(Path2Setup)&"/vb",      "STFV", "+ Node", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vb",      "STFV", "- Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vc",      "STFV", "+ Node", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vc",      "STFV", "- Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 1", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 2", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "AC Ground", "GROUND")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________2" "711.501"
{
}
LINK XFORM "___MOSFET_________________________" "711.501"
{
}
LINK XFORM "FET_DC" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program verifies the DC settings of FET transistors
 ! with pins G-D-S
 !      ============
 
 
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/FET_DC", "Execute", VAL$(Path2Setup))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/FET_DC[0])==1 THEN
 !   GET_STRING "Done, all OK !!
 !     Continue with the next Transforms.   [OK]", dummy
 ! END IF
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 
 GET_STRING "Path2Setup", Path2Setup
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 
 !---find 1st Output and check if meas. data are loaded---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", tmpVar
 data = DATASET("quiet "&VAL$(Path2Setup)&"/"&VAL$(tmpVar[0]))
 IF MEAN(data.M)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---if not present, add Input vs------------------------------
 ErrMsg=""
 Test_vs_presence = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vs", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   GET_INT "There is no Input 'vs' present in Setup "&VAL$(Path2Setup)&"
     Enter:
       0    when the data have been measured applying GSG probes,
            and therefore, the Source connection is done in the netlist of DUT/TestCircuit.
            NOTE: this is typical for III/V data
 
       1    to auto-create the Input 'vs' with vs=0V
            NOTE: select this choice if it is a MOS-FET, 
                  measured using Gate and Drain DC needles
                  and you had connected the Source fix to Ground", 0, Create_vs
 
   IF Create_vs==1 THEN
     ICCAP_FUNC(VAL$(Path2Setup), "New Input", "vs")
     ICCAP_FUNC(VAL$(Path2Setup)&"/vs", "STFV", "Mode", "V")
     ICCAP_FUNC(VAL$(Path2Setup)&"/vs", "STFV", "Sweep Type", "CON")
   END IF
 END IF
 
 
 !---if not present, add Output ig------------------------------
 ErrMsg=""
 Test_ig_presence = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ig", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "ig")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Unit", "n/a")
 END IF
 
 
 !---show error if Input 'freq' is present
 ErrMsg=""
 freq_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/freq", "Mode", ErrMsg)
 IF VAL$(ErrMsg)=="" THEN
   GET_STRING "ERROR: there is an Input 'freq' present in Setup  "&VAL$(SetupName)&" !
     Please correct it, and also the possibly existing Spar Output  [OK]", dummy
   RETURN_VALUE -2
 END IF
 
 
 !---set Node names (just in case ... )-----------------------
 LSYNC_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vd", "Mode")
 !   if not LSYNC:
 IF VAL$(LSYNC_Test)<>"P" THEN
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg", "STFV", "+ Node", "G")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg", "STFV", "- Node", "GROUND")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd", "STFV", "+ Node", "D")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd", "STFV", "- Node", "GROUND")
 END IF
 
 ICCAP_FUNC(VAL$(Path2Setup)&"/vs", "STFV", "+ Node", "S")
 ICCAP_FUNC(VAL$(Path2Setup)&"/vs", "STFV", "- Node", "GROUND")
 
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "To Node", "G")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "From Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "To Node", "D")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "From Node", "GROUND")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "FET_Spar" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program verifies the DC settings of FET transistors
 ! with pins G-D-S
 !      ============
 
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/FET_Spar", "Execute", VAL$(Path2Setup), VAL$(SIMULATOR))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/FET_Spar[0])==1 THEN
 !   GET_STRING "Done !   [OK]", dummy
 ! END IF
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 
 
 
 GET_STRING "Path2Setup", Path2Setup
 GET_STRING "Simulator", Simulator
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 !---verify if Output S_deemb exists
 ErrMsg=""
 S_deemb_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S_deemb", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR: no Output 'S_deemb' available  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---verify if Input freq exists
 ErrMsg=""
 freq_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/freq", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR: no Input 'freq' available  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---check if meas. data are loaded---------------------------------------
 S_deemb = DATASET("quiet "&VAL$(Path2Setup)&"/S_deemb")
 IF MEAN(S_deemb.M.11)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !
     Pls. load data, or skip this Setup for modeling    [OK]", dummy  
   RETURN_VALUE -2
 END IF
 
 
 !---check if an Output called 'S' has been loaded on error---------------------------------------
 ErrMsg=""
 S_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S", "Mode", ErrMsg)
 IF VAL$(ErrMsg)=="" THEN 
     GET_STRING "ERROR: in Setup "&VAL$(Path2Setup)&",
       there exists an Output named 'S' !
     The default name for de-embedded S-parameters is 'S_deemb'.
     Please correct this  [OK]", dummy
     RETURN_VALUE -3
 END IF
 
 
 !---check if Input called 'vs' has been loaded on error---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   IF VAL$(tmpVar[i])=="vs" THEN
     GET_STRING "ERROR:  in Setup "&VAL$(Path2Setup)&",
       there is an Input 'vs' present!
     Please delete it [OK]", dummy
     RETURN_VALUE -4
   END IF
 NEXT i
 tmpVar = ""
 
 
 
 !---check if Output 'id' is present
 ErrMsg=""
 ic_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/id", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   !---create Output id
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "id")   
   ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "To Node", "P2")
   !---handle non-ADS case
   IF VAL$(Simulator)<>"hpeesofsim" THEN
       ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Type", "M")
   END IF
   GET_STRING "NOTE: an Output 'id' has been added to Setup "&VAL$(Path2Setup)&" with zero data !  [OK]", dummy
 END IF
 
 
 !---check if Output 'ig' is present
 ErrMsg=""
 ic_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ig", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   !---create Output ig
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "ig")   
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "To Node", "P1")
   !---handle non-ADS case
   IF VAL$(Simulator)<>"hpeesofsim" THEN
       ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Type", "M")
   END IF
   GET_STRING "NOTE: an Output 'ig' has been added with zero data !  [OK]", dummy
 END IF
 
 
 
 
 !---set Node names (just in case ... )----------------------------------------------
 LSYNC_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vd", "Mode")
 !   if not LSYNC:
 IF VAL$(LSYNC_Test)<>"P" THEN
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg",    "STFV", "+ Node", "P1")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg",    "STFV", "- Node", "GROUND")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd",    "STFV", "+ Node", "P2")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd",    "STFV", "- Node", "GROUND")
 END IF
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig",      "STFV", "To Node", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig",      "STFV", "From Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id",      "STFV", "To Node", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id",      "STFV", "From Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 1", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 2", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "AC Ground", "GROUND")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________3" "711.501"
{
}
LINK XFORM "___HEMT_________________________" "711.501"
{
}
LINK XFORM "HEMT_DC" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program verifies the DC settings of HEMT transistors
 ! with measurement/simulation pins Gate & Drain  (Source = GND)
 !                                  ====   =====   ======
 
 
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/HEMT_DC", "Execute", VAL$(Path2Setup))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/HEMT_DC[0])==1 THEN
 !   GET_STRING "Done, all OK !!
 !     Continue with the next Transforms.   [OK]", dummy
 ! END IF
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 
 GET_STRING "Path2Setup", Path2Setup
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 !---find 1st Output and check if meas. data are loaded---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", tmpVar
 data = DATASET("quiet "&VAL$(Path2Setup)&"/"&VAL$(tmpVar[0]))
 IF MEAN(data.M)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 
 !---if not present, add Output ig------------------------------
 ErrMsg=""
 Test_ig_presence = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ig", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "ig")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Unit", "n/a")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Type", "B")
   GET_STRING "There is no Output 'ig' present in the .mdm file.
    For standardization reasons, such an Output with zero data has been added  [OK]", dummy
 END IF
 
 
 !---verify nr. of Inputs---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", tmpVar
 IF SIZEOF(tmpVar)>2 THEN
   InputNames=""
   FOR i=0 TO SIZEOF(tmpVar)-1
     InputNames = VAL$(InputNames) & VAL$(tmpVar[i])&", "
   NEXT i
   GET_STRING "There are more than 2 DC Bias Inputs present:
   ==>   "&VAL$(InputNames)&"
   Default is 2 DC Inputs: 'vg' and 'vd'
   plus, optionally, an Input 'Temp' for temperature modeling.
   Hit
     [Cancel] to stop and verify
     [OK]     to continue", dummy
 END IF
 
 
 !---show error if Input 'freq' is present
 ErrMsg=""
 freq_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/freq", "Mode", ErrMsg)
 IF VAL$(ErrMsg)=="" THEN
   GET_STRING "ERROR: there is an Input 'freq' present in Setup  "&VAL$(SetupName)&" !
     Please correct it, and also the possibly existing Spar Output  [OK]", dummy
   RETURN_VALUE -2
 END IF
 
 
 !---set Node names (just in case ... )-----------------------
 LSYNC_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vd", "Mode")
 !   if not LSYNC:
 IF VAL$(LSYNC_Test)<>"P" THEN
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg", "STFV", "+ Node", "G")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg", "STFV", "- Node", "GROUND")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd", "STFV", "+ Node", "D")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd", "STFV", "- Node", "GROUND")
 END IF
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "To Node", "G")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "From Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Type", "B")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "To Node", "D")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "From Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Type", "B")
 
 
 !---verify Mode setting of Outputs
 Mode_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ig", "Mode")
 IF VAL$(Mode_Test) <> "B" THEN 
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Type", "B")
   ICCAP_FUNC(VAL$(Path2Setup), "Clear Data/Simulated")
 END IF
 
 Mode_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/id", "Mode")
 IF VAL$(Mode_Test) <> "B" THEN 
   ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Type", "B")
   ICCAP_FUNC(VAL$(Path2Setup), "Clear Data/Simulated")
 END IF
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HEMT_Spar" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program verifies the DC settings of HEMT transistors
 ! with measurement/simulation pins G & D  (Source = GND)
 !                                  =====
 
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/HEMT_Spar", "Execute", VAL$(Path2Setup), VAL$(SIMULATOR))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/HEMT_Spar[0])==1 THEN
 !   GET_STRING "Done, all OK !!
 !     Continue with the next Transforms.   [OK]", dummy
 ! END IF
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 
 
 
 GET_STRING "Path2Setup", Path2Setup
 GET_STRING "Simulator", Simulator
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 
 !---verify if Output S_deemb exists
 ErrMsg=""
 S_deemb_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S_deemb", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR: no Output 'S_deemb' available  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---verify if Input freq exists
 ErrMsg=""
 freq_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/freq", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR: no Input 'freq' available  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---check if meas. data are loaded---------------------------------------
 S_deemb = DATASET("quiet "&VAL$(Path2Setup)&"/S_deemb")
 IF MEAN(S_deemb.M.11)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !
      Pls. load data, or skip this Setup    [OK]", dummy  
   RETURN_VALUE -2
 END IF
 
 
 !---check if an Output called 'S' has been loaded on error---------------------------------------
 ErrMsg=""
 S_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S", "Mode", ErrMsg)
 IF VAL$(ErrMsg)=="" THEN 
     GET_STRING "ERROR: in Setup "&VAL$(Path2Setup)&",
       there exists an Output named 'S' !
     The default name for de-embedded S-parameters is 'S_deemb'.
     Please correct this  [OK]", dummy
     RETURN_VALUE -3
 END IF
 
 
 !---verify nr. of Inputs---------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", tmpVar
 IF SIZEOF(tmpVar)>3 THEN
   InputNames=""
   FOR i=0 TO SIZEOF(tmpVar)-1
     InputNames = VAL$(InputNames) & VAL$(tmpVar[i])&", "
   NEXT i
   GET_STRING "There are more than 3 Inputs present:
   ==>   "&VAL$(InputNames)&"
   Default is 3 Inputs: 'freg', 'vg' and 'vd',
   plus, optionally, an Input 'Temp' for temperature modeling.
   Hit
     [Cancel] to stop and verify
     [OK]     to continue", dummy
 END IF
 
 
 !---check if Output 'id' is present
 ErrMsg=""
 ic_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/id", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   !---create Output id
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "id")   
   ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "To Node", "P2")
   ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Type", "B")
   !---handle non-ADS case
   IF VAL$(Simulator)<>"hpeesofsim" THEN
       ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Type", "M")
   END IF
   GET_STRING "NOTE: an Output 'id' has been added to Setup "&VAL$(Path2Setup)&" with zero data !  [OK]", dummy
 END IF
 
 
 !---check if Output 'ig' is present
 ErrMsg=""
 ic_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ig", "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   !---create Output ig
   ICCAP_FUNC(VAL$(Path2Setup), "New Output", "ig")   
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Mode", "I")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "To Node", "P1")
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Type", "B")
   !---handle non-ADS case
   IF VAL$(Simulator)<>"hpeesofsim" THEN
       ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Type", "M")
   END IF
   GET_STRING "There is no Output 'ig' present in the .mdm file.
    For standardization reasons, such an Output with zero data has been added  [OK]", dummy
 END IF
 
 
 
 
 !---set Node names (just in case ... )----------------------------------------------
 LSYNC_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/vd", "Mode")
 !   if not LSYNC:
 IF VAL$(LSYNC_Test)<>"P" THEN
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg",    "STFV", "+ Node", "P1")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vg",    "STFV", "- Node", "GROUND")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd",    "STFV", "+ Node", "P2")
   ICCAP_FUNC(VAL$(Path2Setup)&"/vd",    "STFV", "- Node", "GROUND")
 END IF
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig",      "STFV", "To Node", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/ig",      "STFV", "From Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id",      "STFV", "To Node", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/id",      "STFV", "From Node", "GROUND")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 1", "P1")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Port 2", "P2")
 ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "AC Ground", "GROUND")
 
 !---verify Mode setting of Outputs
 Mode_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/ig", "Mode")
 IF VAL$(Mode_Test) <> "B" THEN 
   ICCAP_FUNC(VAL$(Path2Setup)&"/ig", "STFV", "Type", "B")
   ICCAP_FUNC(VAL$(Path2Setup), "Clear Data/Simulated")
 END IF
 
 Mode_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/id", "Mode")
 IF VAL$(Mode_Test) <> "B" THEN 
   ICCAP_FUNC(VAL$(Path2Setup)&"/id", "STFV", "Type", "B")
   ICCAP_FUNC(VAL$(Path2Setup), "Clear Data/Simulated")
 END IF
 
 Mode_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/S_deemb", "Mode")
 IF VAL$(Mode_Test) <> "B" THEN 
   ICCAP_FUNC(VAL$(Path2Setup)&"/S_deemb", "STFV", "Type", "B")
   ICCAP_FUNC(VAL$(Path2Setup), "Clear Data/Simulated")
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________4" "711.501"
{
}
LINK XFORM "___PassiveComp_____________________" "711.501"
{
}
LINK XFORM "Passive_Spar" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---how2call_this_Program:----------------------------------------------------------
 ! Path2Setup = WHOIS(".", "Parent Setup")
 ! ReqSparOutputName = "S_deemb"
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Passive_Spar", "Execute", VAL$(Path2Setup), VAL$(ReqSparOutputName))
 ! IF VAL(/UTILITIES/PEL_UTILITIES/VERIFY_INPUTS_OUTPUTS/Passive_Spar[0])<>1 THEN RETURN_VALUE -1
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  tmpVar
 
 GET_STRING "Path2Setup", Path2Setup
 GET_STRING "Requested Spar Output Name", ReqSparOutputName
 
 
 PRINT "Verifying Settings ... pls. wait ..."
 
 
 !===verify Outputs====================================================
 !---verify if requested Spar Output Name exists
 Path2ReqSparOutput = VAL$(Path2Setup)&"/"&VAL$(ReqSparOutputName)
 ErrMsg=""
 dummy = LOOKUP_TABLE_VAL(VAL$(Path2ReqSparOutput), "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR: no Output '"&VAL$(ReqSparOutputName)&"' available  [OK]", dummy
   RETURN_VALUE -2
 END IF
 
 
 !---set Node names (just in case ... )----------------------------------------------
 ICCAP_FUNC(VAL$(Path2ReqSparOutput), "STFV", "Port 1", "P1")
 ICCAP_FUNC(VAL$(Path2ReqSparOutput), "STFV", "Port 2", "P2")
 ICCAP_FUNC(VAL$(Path2ReqSparOutput), "STFV", "AC Ground", "GROUND")
 
 
 !---set Data Type (just in case ... )----------------------------------------------
 ICCAP_FUNC(VAL$(Path2ReqSparOutput), "STFV", "Type", "B")
 
 
 !---check if meas. data are loaded---------------------------------------
 MeasData = DATASET("quiet "&VAL$(Path2ReqSparOutput))
 IF MEAN(MeasData.M.11)==0 THEN
   GET_STRING "ERROR: no meas. data loaded in Setup "&VAL$(Path2Setup)&" !  [OK]", dummy
   RETURN_VALUE -3
 END IF
 
 
 
 !---delete further Outputs with S-Param data---------------------------------------------------------------
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   ErrMsg=""
   S_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/"&VAL$(tmpVar[i]), "Mode", ErrMsg)
   IF (VAL$(ErrMsg)=="") ANDALSO (VAL$(S_Test)=="S") ANDALSO (VAL$(tmpVar[i])<>VAL$(ReqSparOutputName)) THEN 
     GET_STRING "ERROR: there exists also an Output named '"&VAL$(tmpVar[i])&"' !
     Delete it  ?   [OK], [Cancel]", dummy
     ICCAP_FUNC(VAL$(Path2Setup)&"/"&VAL$(tmpVar[i]), "Delete")
   END IF
 NEXT i
 
 
 !===verify Inputs====================================================
 !---verify if default Input 'freq' exists
 Path2Input = VAL$(Path2Setup)&"/freq"
 ErrMsg=""
 dummy = LOOKUP_TABLE_VAL(VAL$(Path2Input), "Mode", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR: no Input with default name 'freq' exists  [OK]", dummy
   RETURN_VALUE -4
 END IF
 
 
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", tmpVar
 !---verify if DC Bias Inputs exist
 IF SIZEOF(tmpVar)==1 THEN
   GET_STRING "WARNING: seems there are no DC Inputs with 0V DC Bias !
          -> They are not a must, but recommended, to avoid simulator error messages referring to 'unconnected nodes'
             Background: IC-CAP always adds a Bias-TEE to S-Parameter simulations                 [OK]", dummy
 END IF
 
 
 !---verify voltage mode and set port names
 N_DC_Bias = 0
 N_other_Inputs = 0
 FOR i=0 TO SIZEOF(tmpVar)-1
   DC_Bias_Test = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/"&VAL$(tmpVar[i]), "Mode", ErrMsg)
   IF (VAL$(ErrMsg)=="") ANDALSO (VAL$(DC_Bias_Test)=="V") THEN 
     N_DC_Bias = N_DC_Bias + 1
     IF N_DC_Bias <= 2 THEN
       ICCAP_FUNC(VAL$(Path2Setup)&"/"&VAL$(tmpVar[i]), "STFV", "+ Node", "P"&VAL$(N_DC_Bias))
     ELSE
       GET_STRING "ERROR: seems there are more than 2 DC Bias Inputs present !!!    [OK]", dummy
       RETURN_VALUE -6
     END IF
   ELSE
     IF VAL$(tmpVar[i])<> "freq" THEN
       N_other_Inputs = N_other_Inputs + 1
     END IF
   END IF
 NEXT i
 IF N_other_Inputs<>0 THEN
   GET_STRING "NOTE: seems there are more Inputs than 'freq' and 'DC Biasing' !!!
             Please verify !    [OK]", dummy
   RETURN_VALUE -7
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "REORDER_SWEEPS" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.197973713034 4200 3926"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 C10 C10 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 ! Suppose an IC-CAP MOS Setup with e.g. 1st sweep vd, 2nd sweep vg and 3rd sweep vb.
 ! A standard plot would be like id vs. vd (what is the 1st sweep)
 ! However, in some cases, you also may want to have a plot where id is shown vs. vg (originally the 2nd sweep),
 ! or vs. vb (what was the 3rd sweep).
 !
 ! Program 'REORDER_DATA' handles this kind of data re-organization,
 ! and additionally, provides the correct information for the Plot to
 ! avoid wrong point-to-point interconnection lines.
 
 ! See Plot '_Reordered_Data_' in this Setup to check the Plot 
 ! of the re-ordered data.
 
 
 ! 'REORDER_DATA' is located here in UTILITIES.mdl, because it can be
 ! re-used for any kind of data re-ordering.
 ! With this central program location, a change/modification/enhancement
 ! done here will operate immediately in all loaded ModelFiles.
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! NOTE:
 ! 'REORDER_DATA' does not work for complex data (e.g. impedance measurement)
 ! and also not for >1 dimensional data (e.g. NxN S-parameter)
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! This example is how to call 'REORDER_DATA' from your own ModelFile.
 ! An id-vd Setup for a MOS/MESFET is assumed in this example,
 ! and we want data for a Plot id-vg.
 ! Application: re-use the id-vd data for id-vg modeling, without a 2nd measurement !
 
 
 ! This means:
 !---the standard Plot is:   
 !     'X Data'   (typically the 1storder sweep, e.g. Input 'vd')
 !     'Y Data 0' (typically the measured data, e.g. Output 'id.M')
 !     'Y Data 1' (typically the simulated data, e.g. Output 'id.S')
 
 
 !---and the requested new Plot is:   
 !     'X Data'   (the 2nd, 3rd etc. order sweep, e.g. Input 'vg')
 !     'Y Data 0' (typically the measured data, e.g. Output 'id.M')
 !     'Y Data 1' (typically the simulated data, e.g. Output 'id.S')
 
 
 
 !==> here we go:
 
 !-------cut here-------------------------------------------
 !---prepare the data for Transform REORDER_DATA
 COMPLEX Orig_Data.B[SIZEOF(id)]
 FOR i=0 TO SIZEOF(Orig_Data)-1
   !              Ydata.M + j * requested new x-axis data
   !              Ydata.S + j * requested new 'Curve Data', typically the 1st order stimulus of the original data
   Orig_Data.M[i]=id.M[i] + j * vg[i]
   Orig_Data.S[i]=id.S[i] + j * vd[i]
 NEXT i
 
 
 
 !---call central Program and return the result
 RETURN  EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", Orig_Data)
 
 ! NOTE:  the format, returned from this very Program, is:
 !     IMAG(ProgramName.M) re-ordered, enter to new Plot as 'X Data'
 !     IMAG(ProgramName.S) additional, enter to new Plot as  Plot 'Curve Data' (for correct data points line interconnections)
 !     REAL(ProgramName.M) re-ordered, enter to new Plot as  Plot 'Y Data 0'
 !     REAL(ProgramName.S) re-ordered, enter to new Plot as  Plot 'Y Data 1'
 
}
dataset
{
datasize BOTH 1480 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "________________________0" "711.501"
{
}
LINK XFORM "REORDER_DATA" "711.501"
{
View block_edit 0 "0,175"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! This Programs receives a data set 'Data_Orig',
 ! with a REAL.M and REAL.S to later become the Plot Y-axis,
 ! and IMAG.M to later become the Plot X-axis,
 ! while IMAG.S to later become the 'Curve Data' info.
 
 ! Example:
 ! we have a MOS id-vg Setup (vg: 1st order sweep, vd: 2nd order sweep)
 ! and a conventional Plot id-vg.
 ! But, we want from these data also a Plot id-vd (vd: 1st order sweep, vg: 2nd order sweep)
 
 
 ! This Program receives the 'Data_Orig' in the format:   
 !     REAL(Data_Orig.M) Plot 'Y Data 0'
 !     REAL(Data_Orig.S) Plot 'Y Data 1'
 !     IMAG(Data_Orig.M) Plot 'X Data'  (requested 1st order sweep)
 !     optional:         (to show correct stimuli values when 'Legend' is switched on in the new Plot):
 !     IMAG(Data_Orig.S) Plot 'Curve Data' (original 1st order sweep)
 !
 ! It will sort the array 'Data_Orig' to the
 ! 'Data_Organized' format:   
 !     REAL(Data_Organized.M) Plot 'Y Data 0'
 !     REAL(Data_Organized.S) Plot 'Y Data 1'
 !     IMAG(Data_Organized.M) Plot 'X Data'
 !     IMAG(Data_Organized.S) Plot 'Curve Data'
 
 ! IMPORTANT NOTICE:
 ! The Program does not work for LSYNC sweeps !!!
 ! ==============================================
 
 GET_DATASET "", Data_Orig
 
 
 !---exit before the FOR loop below gets into problems
 IF SIZEOF(Data_Orig)<2 THEN RETURN Data_Orig
 
 
 COMPLEX Data_Organized.B[SIZEOF(Data_Orig)]
 iJump=0
 N=0
 N1=0
 FOR i = 0 TO SIZEOF(Data_Orig)-1
   IF (i==0) AND (IMAG(Data_Orig.M[0])==IMAG(Data_Orig.M[1])) THEN
     !---find out jumping index
     FOR iJump=1 TO SIZEOF(Data_Orig)-1
       EXIT IF IMAG(Data_Orig.M[iJump])<>IMAG(Data_Orig.M[0])
     NEXT iJump
   END IF
 
   !---exit loop if data are already ordered
   IF iJump==0 THEN Data_Organized=Data_Orig
   EXIT IF iJump==0
 
   !==================================================================================
   !---perform ordering for meas. and simul. data, for x-Axis and Curve Data
   !   y-axis~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   Data_Organized.M[i]=REAL(Data_Orig.M[N1+N*iJump]) + j*IMAG(Data_Orig.M[N1+N*iJump])
   !   requested x-axis and 'Curve Data'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   Data_Organized.S[i]=REAL(Data_Orig.S[N1+N*iJump]) + j*IMAG(Data_Orig.S[N1+N*iJump])
   !   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   !==================================================================================
   N = N + 1
   IF N==SIZEOF(Data_Orig)//iJump THEN 
     N=0
     N1 = N1 + 1
   END IF
 NEXT i
 
 
 !---if IMAG(Data_Orig.S) is not defined in the orig. data set,
 !   provide standard CurveData info and save it into IMAG(Data_Organized.S)
 IF MEAN(IMAG(Data_Orig.S))==0 THEN
   N=0
   Data_Organized.S[0]=REAL(Data_Organized.S[0])+j*0
   FOR i=1 TO SIZEOF(Data_Organized)-1
     IF IMAG(Data_Organized.M[i])==IMAG(Data_Organized.M[0]) THEN N = N + 1
     Data_Organized.S[i]=REAL(Data_Organized.S[i])+j*N
   NEXT i
 END IF
 
 
 RETURN Data_Organized
}
dataset
{
datasize BOTH 510 1 1
type MEAS
type SIMU
}
}
list PLOT "_Reordered_Data_"
}
LINK XFORM "SPLIT_2ndORDER_SWEEPS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 !  see under
 !
 !  PLOT_UTILITIES/SPLIT_2ndORDER_SWEEPS
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK PLOT "_Reordered_Data_" "711.501"
{
View plot_window 0 "66,167,15176,14317,{AUTO|XY|-1.000 , 500.0m,3,5: 0.000 , 140.0f,7,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(REORDER_DATA.M)!!X Data"
element "# of Traces" "8"
element "Curve Data" "IMAG(REORDER_DATA.S)!!Curve Data"
element "Header" "Plot of Re-Ordered Data"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(REORDER_DATA.M)!!Y Data 0"
element "Y Data 1" "REAL(REORDER_DATA.S)!!Y Data 1"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "REORDER_DATA"
}
data "711.501"
{
}
}
LINK DAT "SYNCHRONIZE_SETUPS" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P270 P410 C10"
element 0 "Name" "DutNames"
element 0 "Value" ""
element 1 "Name" "SetupNames"
element 1 "Value" ""
element 2 "Name" "InputNames"
element 2 "Value" ""
element 3 "Name" "InstrOptMasterSetup"
element 3 "Value" "/HEMT_MEASUREMENT_MASTER__1/NWA_deemb_dummies/dummy_open"
element 4 "Name" "freqMasterSetup"
element 4 "Value" "/HEMT_MEASUREMENT_MASTER__1/NWA_deemb_dummies/dummy_open"
element 5 "Name" "tmpVar"
element 5 "Value" ""
element 6 "Name" "___________________________________"
element 6 "Value" ""
element 7 "Name" ""
element 7 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,1377,173"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "HOW2USE_Copy_Instr_Options" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! ---copy this Transform into your local ModelFile and execute it there---
 
 
 ! This Program calls a central Program in UTILITIES.mdl,
 ! which copies the Instrument Options (cal.set etc.) of the local 
 ! master Setup into all other Setups of the local Model 
 
 
 GLOBAL_VAR  tmpDir
 
 GET_STRING "Enter tmp directory for file handling ('.' means your home directory)", tmpDir, tmpDir
 
 
 Path2Setup = WHOIS(".", "Parent Setup")		!returns full path to SetupName
 GET_STRING "Verify /Model/DUT/Setup of MASTER Instrument Options", Path2Setup, InstrOptionsMaster
 
 Path2Utilities = "/UTILITIES/PEL_UTILITIES/SYNCHRONIZE_SETUPS/COPY_INSTR_OPTIONS"
 ICCAP_FUNC(VAL$(Path2Utilities), "Execute", VAL$(tmpDir), VAL$(InstrOptionsMaster))
 
 
 GET_STRING "Done, Instrument Options in all Setups are now synchronized ! [OK]", dummy
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "COPY_INSTR_OPTIONS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !  This Transform copies the Instrument Options 
 !  (cal.set etc.) of a master Setup (Variable 'InstrOptMasterSetup') 
 !  into all other Setups of the Model.
 
 
 GLOBAL_VAR  DutNames
 GLOBAL_VAR  SetupNames
 GLOBAL_VAR  InstrOptMasterSetup
 
 
 GET_STRING "enter tmp directory for file handling", tmpDir
 GET_STRING "enter /Model/DUT/Setup of MASTER Instrument Options", InstrOptMasterSetup
 
 
 ModelName=VAL$(InstrOptMasterSetup)&"/../.."
 
 !---save instrument options of Master Setup
 ICCAP_FUNC(VAL$(InstrOptMasterSetup)&"/InstrumentOptions", "Write to File", VAL$(tmpDir)&"/tmp.iot")
 
 
 ICCAP_FIND_CHILDREN "/"&VAL$(ModelName), "DUT", DutNames
 
 FOR iDut=0 TO SIZEOF(DutNames)-1
   !---identify 'SetupNames' of current DutName
   ICCAP_FIND_CHILDREN "/"&VAL$(ModelName)&"/"&VAL$(DutNames[iDut]), "Setup", SetupNames
   IF VAL$(SetupNames)<>"" THEN
     FOR iSetup=0 TO SIZEOF(SetupNames)-1
       !---read instrument options from file for each Setup
       ICCAP_FUNC("/"&VAL$(ModelName)&"/"&VAL$(DutNames[iDut])&"/"&VAL$(SetupNames[iSetup])&"/InstrumentOptions", "Read from File", VAL$(tmpDir)&"/tmp.iot")
     NEXT iSetup
   END IF
 NEXT iDut
 
 
 !---clean-up
 DutNames   = ""
 SetupNames = ""
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "HOW2USE_Copy_Input_freq" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! ---copy this Transform into your local ModelFile and execute it there---
 
 
 ! This Program calls a central Program in UTILITIES.mdl,
 ! which copies the Input 'freq' of the local Master Setup 
 ! into all other Setups of the local Model 
 
 
 
 Path2Setup = WHOIS(".", "Parent Setup")		!returns full path to SetupName
 GET_STRING "Verify /Model/DUT/Setup of MASTER Input 'freq'", Path2Setup, InputFreqMasterSetup
 
 Path2Utilities = "/UTILITIES/PEL_UTILITIES/SYNCHRONIZE_SETUPS/COPY_INPUT_freq"
 ICCAP_FUNC(VAL$(Path2Utilities), "Execute", VAL$(InputFreqMasterSetup))
 
 GET_STRING "Done, Inputs 'freq' in all Setups are now synchronized ! [OK]", dummy
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "COPY_INPUT_freq" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !  This Transform copies the Input 'freq' of a master Setup (Variable 'freqMasterSetup') 
 !  into all other Setups of the Model which host an Input 'freq'.
 
 
 GLOBAL_VAR  freqMasterSetup
 GLOBAL_VAR  DutNames
 GLOBAL_VAR  SetupNames
 GLOBAL_VAR  InputNames
 GLOBAL_VAR  tmpVar
 
 
 GET_STRING "enter /Model/DUT/Setup of MASTER Input 'freq'", freqMasterSetup
 
 
 !---get ModelName
 dummy = CUTSTR(VAL$(freqMasterSetup), tmpVar, "/")
 ModelName="/"&VAL$(tmpVar[1])
 
 !---identify 'DutNames' of current ModelName
 ICCAP_FIND_CHILDREN "/"&VAL$(ModelName), "DUT", DutNames
 FOR iDut=0 TO SIZEOF(DutNames)-1
   Path2Dut = VAL$(ModelName)&"/"&VAL$(DutNames[iDut])
 
   !---identify 'SetupNames' of current DutName
   ICCAP_FIND_CHILDREN VAL$(Path2Dut), "Setup", SetupNames
   FOR iSetup=0 TO SIZEOF(SetupNames)-1
     Path2Setup=VAL$(Path2Dut)&"/"&VAL$(SetupNames[iSetup])
 
     !---skip freqMasterSetup
     IF VAL$(Path2Setup)==VAL$(freqMasterSetup) THEN CONTINUE
 
     !---identify Inputs of current SetupName
     ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", InputNames
     FOR iInput=0 TO SIZEOF(InputNames)-1
       IF VAL$(InputNames[iInput])=="freq" THEN
         !---replace local Input 'freq' by Master Input 'freq'
         ICCAP_FUNC(VAL$(Path2Setup)&"/freq", "Delete")
         ICCAP_FUNC(VAL$(freqMasterSetup)&"/freq", "Copy", VAL$(Path2Setup)&"/freq")
       END IF
     NEXT iInput
   NEXT iSetup
 NEXT iDut
 
 
 !---clean-up
 DutNames   = ""
 SetupNames = ""
 InputNames = ""
 tmpVar     = ""
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "SIMULATE_MODELFILE" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 C16 P198 C10"
element 0 "Name" "ModelName"
element 0 "Value" "ASM_HEMT_MODELING"
element 1 "Name" "DutNames[0]"
element 1 "Value" "_SanAn_N45PA_4X50_25C_"
element 2 "Name" "DutNames[1]"
element 2 "Value" "________________________________0"
element 3 "Name" "DutNames[2]"
element 3 "Value" "INITIALIZE"
element 4 "Name" "DutNames[3]"
element 4 "Value" "________________________________1"
element 5 "Name" "DutNames[4]"
element 5 "Value" "CONTACT_RESISTANCES"
element 6 "Name" "DutNames[5]"
element 6 "Value" "________________________________2"
element 7 "Name" "DutNames[6]"
element 7 "Value" "RG_RD_RS"
element 8 "Name" "DutNames[7]"
element 8 "Value" "________________________________3"
element 9 "Name" "DutNames[8]"
element 9 "Value" "DC_MODELING"
element 10 "Name" "DutNames[9]"
element 10 "Value" "DC_MODELING_LSYNC"
element 11 "Name" "DutNames[10]"
element 11 "Value" "DC_PULSED"
element 12 "Name" "DutNames[11]"
element 12 "Value" "DC_ModelRobustness"
element 13 "Name" "DutNames[12]"
element 13 "Value" "________________________________4"
element 14 "Name" "DutNames[13]"
element 14 "Value" "SPAR_MODELING"
element 15 "Name" "DutNames[14]"
element 15 "Value" "SPAR_MODELING_LSYNC"
element 16 "Name" "DutNames[15]"
element 16 "Value" "SPAR_ModelRobustness"
element 17 "Name" "DutNames[16]"
element 17 "Value" "________________________________5"
element 18 "Name" "DutNames[17]"
element 18 "Value" "NONLIN_RF_MDLG"
element 19 "Name" "DutNames[18]"
element 19 "Value" "________________________________6"
element 20 "Name" "DutNames[19]"
element 20 "Value" "FINISH_MDLG"
element 21 "Name" "DutNames[20]"
element 21 "Value" "________________________________7"
element 22 "Name" "DutNames[21]"
element 22 "Value" "________________________________8"
element 23 "Name" "DutNames[22]"
element 23 "Value" "__DUTs_below_are_dynamically_copied_from_UTILITIES"
element 24 "Name" "DutNames[23]"
element 24 "Value" "aux_NONLIN_RF_MDLG"
element 25 "Name" "DutNames[24]"
element 25 "Value" "aux_TRANSISTOR_SPAR_MDLG"
element 26 "Name" "DutNames"
element 26 "Value" "ICCAP_ARRAY[25]"
element 27 "Name" "DutNames_sel[0]"
element 27 "Value" "8"
element 28 "Name" "DutNames_sel[1]"
element 28 "Value" "9"
element 29 "Name" "DutNames_sel[2]"
element 29 "Value" "10"
element 30 "Name" "DutNames_sel[3]"
element 30 "Value" "13"
element 31 "Name" "DutNames_sel[4]"
element 31 "Value" "14"
element 32 "Name" "DutNames_sel"
element 32 "Value" "ICCAP_ARRAY[5]"
element 33 "Name" "SetupNames[0]"
element 33 "Value" "Spar_all_freq_bias_LSYNC"
element 34 "Name" "SetupNames"
element 34 "Value" "ICCAP_ARRAY[1]"
element 35 "Name" "OutputNames[0]"
element 35 "Value" "id"
element 36 "Name" "OutputNames[1]"
element 36 "Value" "ig"
element 37 "Name" "OutputNames[2]"
element 37 "Value" "S_deemb"
element 38 "Name" "OutputNames[3]"
element 38 "Value" "T"
element 39 "Name" "OutputNames"
element 39 "Value" "ICCAP_ARRAY[4]"
element 40 "Name" "Notes"
element 40 "Value" "==>  now simulating: Dut_5/Setup_1 ..."
element 41 "Name" "__________________1"
element 41 "Value" ""
element 42 "Name" "GUI_xPos"
element 42 "Value" "20"
element 43 "Name" "GUI_yPos"
element 43 "Value" "20"
element 44 "Name" "__________________2"
element 44 "Value" ""
element 45 "Name" ""
element 45 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "SELECT_DUTs_4_SIMUL"
element 0 "Value" "TL|HT=500:OR=VE:TO=TT&TL:LX=%#18GUI_xPos:LY=%#18GUI_yPos|<none>|#212TL_OK_Cancel:#219LA_Sel_Duts_4_Simul:#18LA_Notes:#220LI_Sel_Duts_4_Export|1|0"
element 1 "Name" "SELECT_DUTs_4_SIMUL.LA_Sel_Duts_4_Simul"
element 1 "Value" "LA|CA=#280- Select the DUTs which you want to be simulated.\012- Then, hit  [OK, Simulate]:FG=C6:TO=FW&FH&TL|<none>|<none>|0"
element 2 "Name" "SELECT_DUTs_4_SIMUL.LI_Sel_Duts_4_Export"
element 2 "Value" "LI|IT=%#18DutNames:SI=%#212DutNames_sel:SY=ES|<none>|<none>|0"
element 3 "Name" "SELECT_DUTs_4_SIMUL.TL_OK_Cancel.PB_OK"
element 3 "Value" "PB|CA=#212OK, Simulate:TO=FW&FH&TR|AC=#212PB_OK_Cancel&#210Execute,OK|<none>|1"
element 4 "Name" "SELECT_DUTs_4_SIMUL.TL_OK_Cancel"
element 4 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#15Space:#19PB_Cancel:#15PB_OK|1"
element 5 "Name" "SELECT_DUTs_4_SIMUL.TL_OK_Cancel.PB_Cancel"
element 5 "Value" "PB|CA=#16Cancel:TO=FW&FH&TR|AC=#212PB_OK_Cancel&#214Execute,Cancel|<none>|0"
element 6 "Name" "SELECT_DUTs_4_SIMUL.TL_OK_Cancel.Space"
element 6 "Value" "TL|<none>|<none>|<none>|0"
element 7 "Name" "SELECT_DUTs_4_SIMUL.LA_Notes"
element 7 "Value" "LA|CA=%#15Notes:FG=C6:TO=FH&dummy|<none>|<none>|0|1"
element 8 "Name" ""
element 8 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,2247,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! This Setup opens a GUI for the selected Model,
 ! in which the user defines the DUTs to be simulated.
 
 ! Useful when having loaded a new set of Model Parameters
 ! and interested in the fit for the loaded meas. data.
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 
 ! ---copy this Transform into your local ModelFile and execute it there---
 
 ModelName = WHOIS(".", "Parent Model")
 
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/SIMULATE_MODELFILE/SIMULATE_MODELFILE", "Execute", VAL$(ModelName))
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "SIMULATE_MODELFILE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! Simulate all Setups in a Model 
 ! which include at least one Output of type 'S' or 'B'.
 ! Setups without any Outputs are ignored.
 
 GLOBAL_VAR   ModelName
 GLOBAL_VAR   DutNames
 GLOBAL_VAR   Notes
 
 
 
 
 ModelName = TRIM$(VAL$(ModelName), "/")
 GET_STRING "Enter Modelname", ModelName, ModelName
 
 ModelName = VAL$(TRIM$(VAL$(ModelName), "/"))
 Notes = "======================="
 
 ICCAP_FIND_CHILDREN "/"&VAL$(ModelName), "DUT", DutNames
 
 
 !---open GUI
 ICCAP_FUNC("./SELECT_DUTs_4_SIMUL", "Display Modeless GUI", "Select DUTs for being simulated")
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________2" "711.501"
{
}
LINK XFORM "PB_OK_Cancel" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 GET_STRING "What to do ? [OK], [Cancel]", Answer
 
 IF VAL$(Answer)=="OK" THEN ICCAP_FUNC("do_simulate", "Execute")
 
 ICCAP_FUNC("./SELECT_DUTs_4_SIMUL", "Destroy GUI", "Select DUTs for being simulated")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "do_simulate" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! This simulates all Setups in a Model 
 ! which include at least one Output of type 'S' or 'B'.
 ! Setups without any Outputs are ignored.
 
 GLOBAL_VAR   ModelName
 GLOBAL_VAR   DutNames
 GLOBAL_VAR   DutNames_sel
 GLOBAL_VAR   SetupNames
 GLOBAL_VAR   OutputNames
 GLOBAL_VAR   Notes
 
 N=0                 ! counter for nr. of simulated Setups
 FOR iDut=0 TO SIZEOF(DutNames_sel)-1
   !---identify Setups
   Path2Dut = "/"&VAL$(ModelName)&"/"&VAL$(DutNames[DutNames_sel[iDut]])
   ICCAP_FIND_CHILDREN VAL$(Path2Dut), "Setup", SetupNames
   FOR iSetup=0 TO SIZEOF(SetupNames)-1
     Path2Setup=VAL$(Path2Dut)&"/"&VAL$(SetupNames[iSetup])
     !---close all plots so that they cannot complain about missing .M data
     ICCAP_FUNC(VAL$(Path2Setup),"Close All")
     !---identify Outputs
     ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", OutputNames
     Setup_simulatable=0
     FOR iOutput=0 TO SIZEOF(OutputNames)-1
       Path2Output=VAL$(Path2Setup)&"/"&VAL$(OutputNames[iOutput])
       !---simulate if at least one Output has Data Type 'B' or 'S'
       DataType=LOOKUP_TABLE_VAL(VAL$(Path2Output), "Type")
       IF (VAL$(DataType)<>"M") THEN Setup_simulatable=1
     NEXT iOutput
     IF Setup_simulatable==1 THEN
       !---simulate current Setup
       N = N + 1
       Notes = "==>  now simulating: Dut_"&VAL$(iDut+1)&"/Setup_"&VAL$(iSetup+1)&" ..."
       PRINT "simul. ";Path2Setup
       ICCAP_FUNC(VAL$(Path2Setup), "Simulate")
     END IF
   NEXT iSetup
 NEXT  iDut
 
 
 GET_STRING VAL$(N)&" Setup(s) of "&VAL$(ModelName)&" have been simulated   [OK]",dummy
 
 
 
 !---clean up
 DutNames   = "ICCAP__ARRAY[0]"
 SetupNames = "ICCAP__ARRAY[0]"
 OutputNames= "ICCAP__ARRAY[0]"
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "DEEMB" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.8 8127 6143"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P241 P398 C10"
element 0 "Name" "NOTE:"
element 0 "Value" "the variables below document the last link names"
element 1 "Name" "___________________1"
element 1 "Value" "and are for debugging purpose only"
element 2 "Name" "Path2Stotal"
element 2 "Value" "/Deemb_OPEN_SHORT/total_DUT/import_and_deembed/S.M"
element 3 "Name" "Path2Sopen"
element 3 "Value" "/Deemb_OPEN_SHORT/OPEN/import/S.M"
element 4 "Name" "Path2Sshort"
element 4 "Value" "/Deemb_OPEN_SHORT/SHORT/import/S.M"
element 5 "Name" "ErrMsg"
element 5 "Value" ""
element 6 "Name" "___________________2"
element 6 "Value" ""
element 7 "Name" "VARS_FOR_Xfm_EXEC_ALL_Sdeemb"
element 7 "Value" ""
element 8 "Name" "Deemb_Methods[0]"
element 8 "Value" "Open only"
element 9 "Name" "Deemb_Methods[1]"
element 9 "Value" "Open_Short"
element 10 "Name" "Deemb_Methods"
element 10 "Value" "ICCAP_ARRAY[2]"
element 11 "Name" "Deemb_Methods_sel"
element 11 "Value" "1"
element 12 "Name" "Path2Model"
element 12 "Value" "/PD_Meas"
element 13 "Name" "DutNames[0]"
element 13 "Value" "INITIALIZE"
element 14 "Name" "DutNames[1]"
element 14 "Value" "_________________________1"
element 15 "Name" "DutNames[2]"
element 15 "Value" "dummy"
element 16 "Name" "DutNames[3]"
element 16 "Value" "DUT_mINFdBm"
element 17 "Name" "DutNames[4]"
element 17 "Value" "DUT_0dBm"
element 18 "Name" "DutNames[5]"
element 18 "Value" "DUT_2dBm"
element 19 "Name" "DutNames[6]"
element 19 "Value" "DUT_4dBm"
element 20 "Name" "DutNames[7]"
element 20 "Value" "DUT_6dBm"
element 21 "Name" "DutNames[8]"
element 21 "Value" "DUT_8dBm"
element 22 "Name" "DutNames[9]"
element 22 "Value" "DUT_10dBm"
element 23 "Name" "DutNames[10]"
element 23 "Value" "_________________________2"
element 24 "Name" "DutNames[11]"
element 24 "Value" "EXPORT_TO_mdm"
element 25 "Name" "DutNames[12]"
element 25 "Value" "_________________________3"
element 26 "Name" "DutNames[13]"
element 26 "Value" "Post_Meas_Data_Inspection"
element 27 "Name" "DutNames"
element 27 "Value" "ICCAP_ARRAY[14]"
element 28 "Name" "SetupNames[0]"
element 28 "Value" "fwd_all"
element 29 "Name" "SetupNames[1]"
element 29 "Value" "rev_all"
element 30 "Name" "SetupNames[2]"
element 30 "Value" "spar_all"
element 31 "Name" "SetupNames"
element 31 "Value" "ICCAP_ARRAY[3]"
element 32 "Name" "XfmNames[0]"
element 32 "Value" "DISPLAY_PLOTS"
element 33 "Name" "XfmNames[1]"
element 33 "Value" "________________________1"
element 34 "Name" "XfmNames[2]"
element 34 "Value" "___aux___________"
element 35 "Name" "XfmNames[3]"
element 35 "Value" "Z10"
element 36 "Name" "XfmNames[4]"
element 36 "Value" "Z10_to_CR"
element 37 "Name" "XfmNames"
element 37 "Value" "ICCAP_ARRAY[5]"
element 38 "Name" "___________________3"
element 38 "Value" ""
element 39 "Name" ""
element 39 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,1127,584"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 
 ! Utilities for 2x2, 3x3 and 4x4 Spar de-embedding
 
 
 !######################################################################
 ! IMPORTANT NOTE:
 ! Because de-embedding does not make sense for simulated data,
 ! the currently programmed Transform work only for measurement data !!!
 !######################################################################
 
 
 
 ! The de-embedding programs are able to handle DC-biased TOTAL-DUT
 ! S-parameters and non-biased S-parameter data of the de-embedding dummies. 
 ! ### The only prerequisite is that the frequency points are identical
 ! ### in the total-measurement and in the dummy-measurements.
 
 
 ! NOTE:
 ! -----
 ! It is highly recommended to *not simply* deembed the de-embedding
 ! dummies, but to verify first, if 
 ! -> the OPEN dummy contains nothing but parallel parasitics, and if 
 ! -> the SHORT dummy contains nothing but series parasitics.
 
 
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "README_MatrixConversions" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 !  The formulae below convert matrices with any number of ports
 !  Special Acknowledgements 
 !  to Dave van Goor and Luuk Tiemeijer, NXP Eindhoven  (March 2007)
 
 
 !Path2Data="/myModel/myDut/mySetup/mySpar_Output"
 
 !S to Z
 !=========================================
 !  Z0 = 50
 !  tmpS = DATASET("quiet "&VAL$(Path2Data))
 !  E = tmpS^0		!define an identity matrix
 !  !do the calc.
 !  tmpZ = Z0*(E+tmpS)//(E-tmpS)
 !  RETURN tmpZ
 
 
 !Z to S
 !=========================================
 !  Z0 = 50
 !  tmpZ = DATASET("quiet "&VAL$(Path2Data))
 !  E = tmpZ^0		!define an identity matrix
 !  !do the calc.
 !  tmpS = (tmpZ-Z0*E)//(tmpZ+Z0*E)
 !  RETURN tmpS
 
 
 !S to Y
 !=========================================
 !  Z0 = 50
 !  tmpS = DATASET("quiet "&VAL$(Path2Data))
 !  E = tmpS^0		!define an identity matrix
 !  !do the calc.
 !  tmpY = 1//Z0*(E-tmpS)//(E+tmpS)
 !  RETURN tmpY
 
 
 !Y to S
 !=========================================
 !  Z0 = 50
 !  tmpY = DATASET("quiet "&VAL$(Path2Data))
 !  E = tmpY^0		!define an identity matrix
 !  !do the calc.
 !  tmpS = (tmpY^-1-Z0*E)//(tmpY^-1+Z0*E)
 !       = (E-Z0*tmpY)//(E+Z0*tmpY)
 !  RETURN tmpS
  
 
 !Z to Y
 !=========================================
 !  tmpZ = DATASET("quiet "&VAL$(Path2Data))
 !  !do the calc.
 !  tmpY = tmpZ^-1
 !  RETURN tmpY
 
 
 
 !Y to Z
 !=========================================
 !  tmpY = DATASET("quiet "&VAL$(Path2Data))
 !  !do the calc.
 !  tmpZ = tmpY^-1
 !  RETURN tmpZ
 
 
 
 
 
 
 !#######################################################################
 !---CAUTION: the Y-matrix is not defined for a impedance-to-ground-only 
 !            TwoPort like this:
 !  o---o---o
 !      â´
 !     | | Z
 !      â¬      
 !  o---o---o
 !
 !---and the Z-matrix is not defined for a series-impedance-only 
 !       __   TwoPort like this:
 !  o---|__|---o
 !       Z
 !  o----------o
 !################################################################
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 !######################################################################
 ! IMPORTANT NOTE:
 ! Because de-embedding does not make sense for simulated data,
 ! the currently programmed Transform work only for measurement data !!!
 !######################################################################
 
 
 !---cut here -----------------------------------------
 
 !---Spar OPEN Dummy De-embedding:
 Path2Utilities = "/UTILITIES/PEL_UTILITIES/DEEMB/S_deemb_open"
 Path2SparTotal = "/DIODE_MEAS_MASTER/NWA_Spar/Spar_Diode_on/S.M"
 Path2SparOpen  = "/DIODE_MEAS_MASTER/NWA_deemb_dummies/dummy_open/S.M"
 !---call the central de-embedding program in UTILITIES
 !   and return the de-embedded result
 Sdeemb = EVALUATE_TRANSFORM(Path2Utilities, Path2SparTotal, Path2SparOpen)
 
 RETURN Sdeemb
 
 
 
 
 !---cut here -----------------------------------------
 
 !---Spar OPEN-SHORT Dummy De-embedding:
 Path2Utilities = "/UTILITIES/PEL_UTILITIES/DEEMB/S_deemb_open_short"
 Path2SparTotal = "/DIODE_MEAS_MASTER/NWA_Spar/Spar_Diode_on/S.M"
 Path2SparOpen  = "/DIODE_MEAS_MASTER/NWA_deemb_dummies/dummy_open/S.M"
 Path2SparShort = "/DIODE_MEAS_MASTER/NWA_deemb_dummies/dummy_short/S.M"
 !---call the central de-embedding program in UTILITIES
 !   and return the de-embedded result
 Sdeemb = EVALUATE_TRANSFORM(Path2Utilities, Path2SparTotal, Path2SparOpen, Path2SparShort)
 
 RETURN Sdeemb
 
 
 
 !---cut here -----------------------------------------
 
 !---LCRZ Open only De-embedding:
 !   ==============
 Compensation = "Open"	! choice: [Open] or [Open/Short]
 Ztotal = zac_total    ! link to measured total impedance
 Zopen  = ../OPEN/zac  ! link to measured OPEN
 Zdut = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/DEEMB/LCRZ_deemb", VAL$(Compensation), Ztotal, Zopen, Zshort)
 
 RETURN Zdut
 
 
 !---cut here -----------------------------------------
 
 !---LCRZ Open/Short De-embedding:
 !   ===============
 Compensation = "Open/Short"	! choice: [Open] or [Open/Short]
 Ztotal = zac_total    ! link to measured total impedance
 Zopen  = ../OPEN/zac  ! link to measured OPEN
 Zshort = ../SHORT/zac ! link to measured SHORT
 Zdut = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/DEEMB/LCRZ_deemb", VAL$(Compensation), Ztotal, Zopen, Zshort)
 
 RETURN Zdut
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________1" "711.501"
{
}
LINK XFORM "S_deemb_open" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 UPDATE_EXPLICIT                  
 
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Transform de-embeds a DUT from an OPEN dummy ...
 ! The idea is:
 ! Ydut = Ytotal-Yopen
 !
 ! The program is able to handle DC-biased TOTAL-DUT
 ! S-parameters and non-biased DUMMY data. 
 ! The only prerequisite is that the frequency points are identical
 ! in the total-measurement and in the dummy-measurements.
 ! IT IS ABLE TO HANDLE TWO-, THREE- AND FOURPORT S-PARAMETER DATA
 ! ------------------------------------------------------------------
 
 ErrMsg=""
 
 GET_STRING "Enter Path and Name of S_total Output", Path2Stotal		! path incl. output name
 GET_STRING "Enter Path and Name of S_open Output",  Path2Sopen
 Z0=50
 
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~begin of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---linking to S_total data
 S_total      = DATASET("quiet "&VAL$(Path2Stotal), ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_open:  Wrong path to S_total data  <Cancel>",dummy
   RETURN_VALUE 0
 END IF
 
 !---consider the case of no meas. data avaiable
 IF MEAN(S_total.M.11)==0 THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_open:  S_total data seem to be all '0' <Cancel>",dummy
   RETURN S_total	!return un-deembedded data instead of 'RETURN_VALUE 0' to avoid collisions in calling PEL which expects a data array!!
 END IF
 
 !---check if freq.values match
 ICCAP_FUNC("check_freq_match", "Execute", VAL$(Path2Stotal), VAL$(Path2Sopen), "n/a")
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 
 SizeStotal = SIZEOF(S_total)
 DimStotal  = ROWSOF(S_total)
 IF VAL(Debug)==1 THEN PRINT "-> found S.";DimStotal;DimStotal;" data  [NOTE: possible Spars: 2x2, 3x3, 4x4]"
 
 !call array resizing
 ICCAP_FUNC("S_open_resized", "Execute", VAL$(Path2Sopen), VAL$(SizeStotal), VAL$(DimStotal))
 
 
 !---first of all, we need the identity matrix
 E = S_total^0 	!that's lousy, but simple
 
 
 IF VAL(Debug)==1 THEN PRINT "  de-embedding DUT from OPEN dummy ..."
 !calc Y_total
 Y_total=1//Z0*(E - S_total)//(E + S_total) 		!s-param's incl. bias sweeps
 
 !calc. Y_open
 Y_open=1//Z0*(E - S_open_resized)//(E + S_open_resized)
 
 
 !perform de-embedding
 Y_dut = Y_total - Y_open
 
 
 ! convert Y_dut back to S_dut
 S_dut = (Y_dut^-1 - Z0*E)//(Y_dut^-1 + Z0*E)
 
 IF VAL(Debug)==1 THEN PRINT "  S_deemb_open done!"
 
 RETURN S_dut
}
dataset
{
datasize MEAS 7236 2 2
type MEAS
}
}
member XFORM "S_open_resized"
}
LINK XFORM "S_deemb_open_short" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 UPDATE_EXPLICIT                
 
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Transform de-embeds a DUT first from an OPEN dummy 
 ! and then from a SHORT dummy device.
 ! The idea is:
 ! Zdut = Z(Ytotal-Yopen) - Z(Yshort-Yopen)
 !
 ! The program is able to handle DC-biased TOTAL-DUT
 ! S-parameters and non-biased DUMMY data. 
 ! The only prerequisite is that the frequency points are identical
 ! in the total-measurement and in the dummy-measurements.
 ! IT IS ABLE TO HANDLE TWO-, THREE- AND FOURPORT S-PARAMETER DATA
 ! ------------------------------------------------------------------
 
 ErrMsg=""
 
 GET_STRING "Enter Path and Name of S_total Output", Path2Stotal		! path incl. output name
 GET_STRING "Enter Path and Name of S_open Output",  Path2Sopen
 GET_STRING "Enter Path and Name of S_short Output", Path2Sshort
 Z0=50
 
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~begin of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---linking to data
 S_total=DATASET("quiet "&VAL$(Path2Stotal), ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_open_short:  Wrong path to S_total data  <Cancel>",dummy
   RETURN_VALUE 0
 END IF
 
 !---consider the case of no meas. data avaiable
 IF MEAN(S_total.M.11)==0 THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_open:  S_total data seem to be all '0' <Cancel>",dummy
   RETURN S_total	!return un-deembedded data instead of 'RETURN_VALUE 0' to avoid collisions in calling PEL which expects a data array!!
 END IF
 
 !---check if freq.values match
 ICCAP_FUNC("check_freq_match", "Execute", VAL$(Path2Stotal), VAL$(Path2Sopen), VAL$(Path2Sshort))
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 
 
 SizeStotal = SIZEOF(S_total)
 DimStotal  = ROWSOF(S_total)
 IF VAL(Debug)==1 THEN PRINT "-> found S.";DimStotal;DimStotal;" data  [NOTE: possible Spars: 2x2, 3x3, 4x4]"
 
 !call array resizing
 ICCAP_FUNC("S_open_resized",  "Execute", VAL$(Path2Sopen),  VAL$(SizeStotal), VAL$(DimStotal))
 ICCAP_FUNC("S_short_resized", "Execute", VAL$(Path2Sshort), VAL$(SizeStotal), VAL$(DimStotal))
 
 
 !---first of all, we need the identity matrix
 E = S_total^0 	!that's lousy, but simple
 
 !===========================================
 IF VAL(Debug)==1 THEN PRINT "  de-embedding DUT from OPEN dummy ..."
 !calc Y_total
 Y_total=1//Z0*(E - S_total)//(E + S_total) 		!s-param's incl. bias sweeps
 
 !calc. Y_open
 Y_open=1//Z0*(E - S_open_resized)//(E + S_open_resized)
 
 !perform de-embedding
 Y_dut_wo_open = Y_total - Y_open
 
 
 !===========================================
 IF VAL(Debug)==1 THEN PRINT "  de-embedding SHORT dummy from OPEN dummy ..."
 Y_short_resized=1//Z0*(E - S_short_resized)//(E + S_short_resized)
 
 Y_open_resized=1//Z0*(E - S_open_resized)//(E + S_open_resized)
 
 
 !perform de-embedding
 Y_short_wo_open = Y_short_resized - Y_open_resized
 
 
 !===========================================
 IF VAL(Debug)==1 THEN PRINT "  de-embedding DUT from SHORT ..."
 Z_dut_wo_open   = Y_dut_wo_open^-1
 Z_short_wo_open = Y_short_wo_open^-1
 
 !perform de-embedding
 Z_dut = Z_dut_wo_open - Z_short_wo_open
 
 
 
 
 !---convert Z_dut back to S_dut
 E = Z_dut^0 !         identity matrix
 S_dut = (Z_dut - Z0*E)//(Z_dut + Z0*E)
 
 
 
 IF VAL(Debug)==1 THEN PRINT "  S_deemb_open_short done!"
 
 RETURN S_dut
}
dataset
{
datasize MEAS 7236 2 2
type MEAS
}
}
member XFORM "S_open_resized"
member XFORM "S_short_resized"
}
LINK XFORM "___________________2" "711.501"
{
}
LINK XFORM "S_deemb_short" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 UPDATE_EXPLICIT                  
 
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Transform de-embeds a DUT from a SHORT dummy ...
 ! The idea is:
 ! Zdut = Ztotal - Zshort
 !
 ! The program is able to handle DC-biased TOTAL-DUT
 ! S-parameters and non-biased DUMMY data. 
 ! The only prerequisite is that the frequency points are identical
 ! in the total-measurement and in the dummy-measurements.
 ! IT IS ABLE TO HANDLE TWO-, THREE- AND FOURPORT S-PARAMETER DATA
 ! ------------------------------------------------------------------
 
 ErrMsg=""
 
 GET_STRING "Enter Path and Name of S_total Output", Path2Stotal		! path incl. output name
 GET_STRING "Enter Path and Name of S_short Output", Path2Sshort
 Z0=50
 
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~begin of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---linking to S_total data
 S_total      = DATASET("quiet "&VAL$(Path2Stotal), ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_short:  Wrong path to S_total data  <Cancel>",dummy
   RETURN_VALUE 0
 END IF
 
 !---consider the case of no meas. data avaiable
 IF MEAN(S_total.M.11)==0 THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_open:  S_total data seem to be all '0' <Cancel>",dummy
   RETURN S_total	!return un-deembedded data instead of 'RETURN_VALUE 0' to avoid collisions in calling PEL which expects a data array!!
 END IF
 
 !---check if freq.values match
 ICCAP_FUNC("check_freq_match", "Execute", VAL$(Path2Stotal), "n/a", VAL$(Path2Sshort))
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 
 
 SizeStotal = SIZEOF(S_total)
 DimStotal  = ROWSOF(S_total)
 IF VAL(Debug)==1 THEN PRINT "-> found S.";DimStotal;DimStotal;" data  [NOTE: possible Spars: 2x2, 3x3, 4x4]"
 
 !call array resizing
 ICCAP_FUNC("S_short_resized", "Execute", VAL$(Path2Sshort), VAL$(SizeStotal), VAL$(DimStotal))
 
 
 !---first of all, we need the identity matrix
 E = S_total^0 	!that's lousy, but simple
 
 IF VAL(Debug)==1 THEN PRINT "  de-embedding DUT from SHORT dummy ..."
 !calc Z_total
 Z_total=Z0*(E + S_total)//(E - S_total) 		!s-param's incl. bias sweeps
 
 !calc. Z_short
 Z_short=Z0*(E + S_short_resized)//(E - S_short_resized)
 
 
 !perform de-embedding
 Z_dut = Z_total - Z_short
 
 
 ! convert Z_dut back to S_dut
 S_dut = (Z_dut - Z0*E)//(Z_dut + Z0*E)
 
 IF VAL(Debug)==1 THEN PRINT "  S_deemb_short done!"
 
 RETURN S_dut
}
dataset
{
datasize MEAS 216 2 2
type MEAS
}
}
member XFORM "S_short_resized"
}
LINK XFORM "S_deemb_short_open" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 UPDATE_EXPLICIT 
 
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This transform de-embeds a DUT first from a SHORT dummy
 ! and then from an OPEN dummy device.
 ! The idea is:
 ! Ydut = Y(Ztotal-Zshort) - Y(Zopen-Zshort)
 !
 ! The program is able to handle DC-biased TOTAL-DUT
 ! S-parameters and non-biased DUMMY data. 
 ! The only prerequisite is that the frequency points are identical
 ! in the total-measurement and in the dummy-measurements.
 ! IT IS ABLE TO HANDLE TWO-, THREE- AND FOURPORT S-PARAMETER DATA
 ! ------------------------------------------------------------------
 
 ErrMsg=""
 
 GET_STRING "Enter Path and Name of S_total Output", Path2Stotal		! path incl. output name
 GET_STRING "Enter Path and Name of S_short Output", Path2Sshort
 GET_STRING "Enter Path and Name of S_open Output",  Path2Sopen
 Z0=50
 
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~begin of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---linking to data
 S_total=DATASET("quiet "&VAL$(Path2Stotal), ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_open_short:  Wrong path to S_total data  <Cancel>",dummy
   RETURN_VALUE 0
 END IF
 
 !---consider the case of no meas. data avaiable
 IF MEAN(S_total.M.11)==0 THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_deemb_open:  S_total data seem to be all '0' <Cancel>",dummy
   RETURN S_total	!return un-deembedded data instead of 'RETURN_VALUE 0' to avoid collisions in calling PEL which expects a data array!!
 END IF
 
 !---check if freq.values match
 ICCAP_FUNC("check_freq_match", "Execute", VAL$(Path2Stotal), VAL$(Path2Sopen), VAL$(Path2Sshort))
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 
 
 SizeStotal = SIZEOF(S_total)
 DimStotal  = ROWSOF(S_total)
 IF VAL(Debug)==1 THEN PRINT "-> found S.";DimStotal;DimStotal;" data  [NOTE: possible Spars: 2x2, 3x3, 4x4]"
 
 !call array resizing
 ICCAP_FUNC("S_open_resized",  "Execute", VAL$(Path2Sopen),  VAL$(SizeStotal), VAL$(DimStotal))
 ICCAP_FUNC("S_short_resized", "Execute", VAL$(Path2Sshort), VAL$(SizeStotal), VAL$(DimStotal))
 
 
 !---first of all, we need the identity matrix
 E = S_total^0 	!that's lousy, but simple
 
 !===========================================
 IF VAL(Debug)==1 THEN PRINT "  de-embedding DUT from SHORT dummy ..."
 !calc Z_total
 Z_total=Z0*(E + S_total)//(E - S_total) 		!s-param's incl. bias sweeps
 
 !calc. Z_short
 Z_short=Z0*(E + S_short_resized)//(E - S_short_resized)
 
 !perform de-embedding
 Z_dut_wo_short = Z_total - Z_short
 
 
 !===========================================
 IF VAL(Debug)==1 THEN PRINT "  de-embedding OPEN dummy from SHORT dummy ..."
 Z_open_resized=Z0*(E + S_open_resized)//(E - S_open_resized)
 
 Z_short_resized=Z0*(E + S_short_resized)//(E - S_short_resized)
 
 
 !perform de-embedding
 Z_open_wo_short = Z_open_resized - Z_short_resized
 
 
 !===========================================
 IF VAL(Debug)==1 THEN PRINT "  de-embedding DUT from OPEN ..."
 Y_dut_wo_short  = Z_dut_wo_short^-1
 Y_open_wo_short = Z_open_wo_short^-1
 
 !perform de-embedding
 Y_dut = Y_dut_wo_short - Y_open_wo_short
 
 
 
 
 !---convert Y_dut back to S_dut
 E = Y_dut^0 !         identity matrix
 S_dut = (Y_dut^-1 - Z0*E)//(Y_dut^-1 + Z0*E)
 
 
 
 IF VAL(Debug)==1 THEN PRINT "  S_deemb_short_open done!"
 
 RETURN S_dut
}
dataset
{
datasize MEAS 216 2 2
type MEAS
}
}
member XFORM "S_open_resized"
member XFORM "S_short_resized"
}
LINK XFORM "___________________3" "711.501"
{
}
LINK XFORM "LCRZ_deemb" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 !--- OPEN/SHORT compensation for LCRZ-Meters-------------------------------
 ! after
 ! Keysight, "Impedance Measurement Handbook", 4th Edition, 2014
 
 
 GET_STRING  "Compensation  [Open] or [Open/Short]", Compensation
 GET_DATASET "Ztotal", Z_total
 GET_DATASET "Zopen",  Z_open
 IF VAL$(Compensation)=="Open/Short" THEN
   GET_DATASET "Zshort", Z_short
 END IF
 
 
 !---double-up Z_open and Z_short depending opn 2nd order sweep of Z_total
 COMPLEX Z_open_big.M[SIZEOF(Z_total)]
 ifreq=0
 FOR i=0 TO SIZEOF(Z_open_big)-1
   Z_open_big[i]=Z_open[ifreq]		!index ifreq: S-params w/o bias sweeps
   ifreq=ifreq+1
   IF ifreq>=SIZEOF(Z_open) THEN ifreq=0
 NEXT i
 
 
 IF VAL$(Compensation)=="Open/Short" THEN
   COMPLEX Z_short_big.M[SIZEOF(Z_total)]
   ifreq=0
   FOR i=0 TO SIZEOF(Z_short_big)-1
     Z_short_big[i]=Z_short[ifreq]		!index ifreq: S-params w/o bias sweeps
     ifreq=ifreq+1
     IF ifreq>=SIZEOF(Z_short) THEN ifreq=0
   NEXT i
 END IF
 
 
 !---apply the off-stripping
 !              __
 !         o---|__|--o---o <---
 !           Z_short |         |
 !                   -      -------
 !Z_total     Z_open| |    | Z_dut |
 !                   -      -------
 !                   |         |
 !         o---------o---o <---
 
 COMPLEX Z_dut.B[SIZEOF(Z_total)]
 IF VAL$(Compensation)=="Open" THEN
   !---open-only compensation:
   IF MEAN(Z_total.M)<>0 THEN
     FOR i=0 TO SIZEOF(Z_dut)-1
       Z_dut.M[i] = (Z_open_big.M[i]*Z_total.M[i]) / (Z_open_big.M[i] - Z_total.M[i])
     NEXT i
   END IF
   IF MEAN(Z_total.S)<>0 THEN
     FOR i=0 TO SIZEOF(Z_dut)-1
       Z_dut.S[i] = (Z_open_big.S[i]*Z_total.S[i]) / (Z_open_big.S[i] - Z_total.S[i])
     NEXT i
   END IF
 
 END IF
 
 
 IF VAL$(Compensation)=="Open/Short" THEN
   !---open-short compensation:
   IF MEAN(Z_total.M)<>0 THEN
     FOR i=0 TO SIZEOF(Z_dut)-1
       Z_dut.M[i] = (Z_short_big.M[i] - Z_total.M[i])//(Z_total.M[i] - Z_open_big.M[i]) * Z_open_big.M[i]
     NEXT i
   END IF
   IF MEAN(Z_total.S)<>0 THEN
     FOR i=0 TO SIZEOF(Z_dut)-1
       Z_dut.S[i] = (Z_short_big.S[i] - Z_total.S[i])//(Z_total.S[i] - Z_open_big.S[i]) * Z_open_big.S[i]
     NEXT i
   END IF
 
 END IF
 
 
 
 RETURN Z_dut
}
dataset
{
datasize BOTH 11900 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "___________________4" "711.501"
{
}
LINK XFORM "___________________5" "711.501"
{
}
LINK XFORM "HOW2USE_EXEC_ALL_Sdeemb" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! STEP 1
 !============================================
 ! in each S-Parameter Setup, add 2 Setup Variables
 ! MDM_EXPORT_XFORM_DATA = 1
 ! MDM_XFORM_LIST        = S_deemb S A GND GROUND n/a B
 
 
 
 ! STEP 2
 !============================================
 ! add a Macro called e.g. EXEC_ALL_S_deemb with following contents:
 !   call central utility to execute all Transforms 'S_deemb'
 Path2Model = WHOIS(".", "Parent Model")		!returns full path to ModelName
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/DEEMB/EXEC_ALL_Sdeemb", "Execute", VAL$(Path2Model))
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "EXEC_ALL_Sdeemb" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Path2Model
 GLOBAL_VAR  DutNames
 GLOBAL_VAR  SetupNames
 GLOBAL_VAR  XfmNames
 
 
 GET_STRING "Path2Model", VAL$(Path2Model), Path2Model
 
 !---execute all 'S_deemb' Transforms
 ICCAP_FIND_CHILDREN VAL$(Path2Model), "DUT",   DutNames
 FOR iDut=0 TO SIZEOF(DutNames)-1
   Path2Dut = VAL$(Path2Model)&"/"&VAL$(DutNames[iDut])
   ICCAP_FIND_CHILDREN Path2Dut, "Setup",   SetupNames
   FOR iSetup=0 TO SIZEOF(SetupNames)-1
     Path2Setup = VAL$(Path2Dut)&"/"&VAL$(SetupNames[iSetup])
     ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Transform",   XfmNames
     FOR iXfm=0 TO SIZEOF(XfmNames)-1
       Path2Xfm = VAL$(Path2Setup)&"/"&VAL$(XfmNames[iXfm])
       IF VAL$(XfmNames[iXfm])=="S_deemb" THEN 
         ICCAP_FUNC("Transform "&VAL$(Path2Xfm), "Execute")
         PRINT "exec. ";Path2Xfm
       END IF
     NEXT iXfm
   NEXT iSetup
 NEXT iDut
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___" "711.501"
{
}
LINK XFORM "___aux______________" "711.501"
{
}
LINK XFORM "S_open_resized" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 ! This Program resizes a Two-, Three- or FourPort S-Parameter array. 
 ! Application: de-embedding of biased S-Par data
 !              from non-biased S-Par data of De-embedding Dummies.
 
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ErrMsg=""
 
 GET_STRING "Enter Path and Name of S_open Output", Path2Sopen
 GET_INT    "Enter Size of S_total", SizeStotal
 GET_INT    "Enter Dimension of S_total", DimStotal
 
 
 IF VAL(Debug)==1 THEN PRINT "  linking to S_OPEN data..."
 S_dummy_open = DATASET("quiet "&VAL$(Path2Sopen), ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_open_resized:  Wrong path to S_dummy_OPEN data  <Cancel>",dummy
 
 
 IF VAL(Debug)==1 THEN PRINT "  Resizing arrays of OPEN DUMMY by a factor of ";SizeStotal//SIZEOF(S_dummy_open);" DC bias points ..."
 
 IF DimStotal==2 THEN COMPLEX S_dummy_open_big.M.22[SizeStotal]
 IF DimStotal==3 THEN COMPLEX S_dummy_open_big.M.33[SizeStotal]
 IF DimStotal==4 THEN COMPLEX S_dummy_open_big.M.44[SizeStotal]
 
 
 ifreq=0
 i=0
 WHILE i < SizeStotal
   S_dummy_open_big.11[i]=S_dummy_open.11[ifreq]   	!index ifreq: S-params w/o bias sweeps
   S_dummy_open_big.12[i]=S_dummy_open.12[ifreq]
   S_dummy_open_big.21[i]=S_dummy_open.21[ifreq]
   S_dummy_open_big.22[i]=S_dummy_open.22[ifreq]
 
   IF (DimStotal==3) OR (DimStotal==4) THEN
     S_dummy_open_big.13[i]=S_dummy_open.13[ifreq]
     S_dummy_open_big.23[i]=S_dummy_open.23[ifreq]
     S_dummy_open_big.31[i]=S_dummy_open.31[ifreq]
     S_dummy_open_big.32[i]=S_dummy_open.32[ifreq]
     S_dummy_open_big.33[i]=S_dummy_open.33[ifreq]
   END IF
 
   IF DimStotal==4 THEN
     S_dummy_open_big.14[i]=S_dummy_open.14[ifreq]
     S_dummy_open_big.24[i]=S_dummy_open.24[ifreq]
     S_dummy_open_big.34[i]=S_dummy_open.34[ifreq]
     S_dummy_open_big.41[i]=S_dummy_open.41[ifreq]
     S_dummy_open_big.42[i]=S_dummy_open.42[ifreq]
     S_dummy_open_big.43[i]=S_dummy_open.43[ifreq]
     S_dummy_open_big.44[i]=S_dummy_open.44[ifreq]
   END IF
 
   ifreq=ifreq+1
   IF ifreq>=SIZEOF(S_dummy_open) THEN ifreq=0
 
   i = i + 1
 END WHILE
 
 
 RETURN S_dummy_open_big
}
dataset
{
datasize MEAS 7236 2 2
type MEAS
}
}
list XFORM "S_deemb_short_open"
list XFORM "S_deemb_open"
list XFORM "S_deemb_open_short"
}
LINK XFORM "S_short_resized" "711.501"
{
View block_edit 0 "0,186"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 ! This Program resizes a Two-, Three- or FourPort S-Parameter array. 
 ! Application: de-embedding of biased S-Par data
 !              from non-biased S-Par data of De-embedding Dummies.
 
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ErrMsg=""
 
 GET_STRING "Enter Path and Name of S_short Output", Path2Sshort
 GET_INT    "Enter Size of S_total", SizeStotal
 GET_INT    "Enter Dimension of S_total", DimStotal
 
 
 IF VAL(Debug)==1 THEN PRINT "  linking to S_short data..."
 S_dummy_short = DATASET("quiet "&VAL$(Path2Sshort), ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN GET_STRING "ERROR in PEL_UTILITIES/DEEMB/S_short_resized:  Wrong path to S_dummy_short data  <Cancel>",dummy
 
 
 IF VAL(Debug)==1 THEN PRINT "  Resizing arrays of SHORT DUMMY by a factor of ";SizeStotal//SIZEOF(S_dummy_short);" DC bias points ..."
 
 IF DimStotal==2 THEN COMPLEX S_dummy_short_big.M.22[SizeStotal]
 IF DimStotal==3 THEN COMPLEX S_dummy_short_big.M.33[SizeStotal]
 IF DimStotal==4 THEN COMPLEX S_dummy_short_big.M.44[SizeStotal]
 
 
 ifreq=0
 i=0
 WHILE i < SizeStotal
   S_dummy_short_big.11[i]=S_dummy_short.11[ifreq]   	!index ifreq: S-params w/o bias sweeps
   S_dummy_short_big.12[i]=S_dummy_short.12[ifreq]
   S_dummy_short_big.21[i]=S_dummy_short.21[ifreq]
   S_dummy_short_big.22[i]=S_dummy_short.22[ifreq]
 
   IF (DimStotal==3) OR (DimStotal==4) THEN
     S_dummy_short_big.13[i]=S_dummy_short.13[ifreq]
     S_dummy_short_big.23[i]=S_dummy_short.23[ifreq]
     S_dummy_short_big.31[i]=S_dummy_short.31[ifreq]
     S_dummy_short_big.32[i]=S_dummy_short.32[ifreq]
     S_dummy_short_big.33[i]=S_dummy_short.33[ifreq]
   END IF
 
   IF DimStotal==4 THEN
     S_dummy_short_big.14[i]=S_dummy_short.14[ifreq]
     S_dummy_short_big.24[i]=S_dummy_short.24[ifreq]
     S_dummy_short_big.34[i]=S_dummy_short.34[ifreq]
     S_dummy_short_big.41[i]=S_dummy_short.41[ifreq]
     S_dummy_short_big.42[i]=S_dummy_short.42[ifreq]
     S_dummy_short_big.43[i]=S_dummy_short.43[ifreq]
     S_dummy_short_big.44[i]=S_dummy_short.44[ifreq]
   END IF
 
   ifreq=ifreq+1
   IF ifreq>=SIZEOF(S_dummy_short) THEN ifreq=0
 
   i = i + 1
 END WHILE
 
 
 RETURN S_dummy_short_big
}
dataset
{
datasize MEAS 7236 2 2
type MEAS
}
}
list XFORM "S_deemb_short"
list XFORM "S_deemb_short_open"
list XFORM "S_deemb_open_short"
}
LINK XFORM "check_freq_match" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ErrMsg=""
 
 GET_STRING "Enter Path and Name of S_total Output", Path2Stotal
 GET_STRING "Enter Path and Name of S_open Output",  Path2Sopen
 GET_STRING "Enter Path and Name of S_short Output", Path2Sshort
 
 !---set flags
 DeembOpen=1
 IF VAL$(Path2Sopen) == "n/a" THEN DeembOpen=0
 DeembShort=1
 IF VAL$(Path2Sshort) == "n/a" THEN DeembShort=0
 
 
 !---link to Inputs 'freq'
 all_freq_Stotal = DATASET("quiet "&VAL$(Path2Stotal)&"/../freq", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN GET_STRING "ERROR in PEL_UTILITIES/DEEMB/check_freq_match:  
 	Input 'freq' does not exist in Setup of Stotal  <Cancel>",dummy
 
 IF DeembOpen==1 THEN
   freq_Sopen = DATASET("quiet "&VAL$(Path2Sopen)&"/../freq", ErrMsg)
   IF VAL$(ErrMsg)<>"" THEN GET_STRING "ERROR in PEL_UTILITIES/DEEMB/check_freq_match:  
 	Input 'freq' does not exist in Setup of Sopen  <Cancel>",dummy
 END IF
 
 IF DeembShort==1 THEN
   freq_Sshort = DATASET("quiet "&VAL$(Path2Sshort)&"/../freq", ErrMsg)
   IF VAL$(ErrMsg)<>"" THEN GET_STRING "ERROR in PEL_UTILITIES/DEEMB/check_freq_match:  
 	Input 'freq' does not exist in Setup of Sshort  <Cancel>",dummy
 END IF
 
 
 !---verify if freq is 1st order sweep in Stotal
 freq_sweep_order = LOOKUP_TABLE_VAL(VAL$(Path2Stotal)&"/../freq", "Sweep Order")
 IF VAL(freq_sweep_order) <> 1 THEN 
   GET_STRING "ERROR in PEL_UTILITIES/DEEMB/check_freq_match:  
 	Input 'freq' of Stotal is not 1st order  <Cancel>",dummy
 END IF
 
 
 !---identifying the frequency values in Stotal
 !   (assuming freq is first sweep!!)
 NrPts_freq_Stotal=SIZEOF(all_freq_Stotal)	!covering the case that TOTAL has only a single DC bias
 FOR i=1 TO SIZEOF(all_freq_Stotal)-1
   IF all_freq_Stotal[i]==all_freq_Stotal[0] THEN
     NrPts_freq_Stotal=i
     BREAK
   END IF
 NEXT i
 !PRINT NrPts_freq_Stotal
 
 !---creating array freq_Stotal, including all freq.pts of all_freq_Stotal *only once*
 COMPLEX freq_Stotal[NrPts_freq_Stotal]
 FOR i=0 TO NrPts_freq_Stotal-1
   freq_Stotal[i]=all_freq_Stotal[i]
 NEXT i
 !PRINT "freq_Stotal=";freq_Stotal
 
 
 !---verifying the match of the values in Inputs 'freq'
 IF DeembOpen==1 THEN
   IF COMPLEX_EQUAL(freq_Stotal, freq_Sopen)==0 THEN 
     ErrMsg="ERROR: freq. values in Setup of OPEN dummy don't match those of Setup S_total!
 	Hint: Apply DataManagement (Export & selective Import) to match them."
     GET_STRING VAL$(ErrMsg)&" [Cancel]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 IF DeembShort==1 THEN
   IF COMPLEX_EQUAL(freq_Stotal, freq_Sshort)==0 THEN 
     ErrMsg="ERROR: freq. values in Setup of SHORT dummy don't match those of Setup S_total!
 	Hint: Apply DataManagement (Export & selective Import) to match them."
     GET_STRING VAL$(ErrMsg)&" [Cancel]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 IF (DeembOpen==1) AND (DeembShort==1) THEN
   IF COMPLEX_EQUAL(freq_Sopen, freq_Sshort)==0 THEN 
     ErrMsg="ERROR: freq. values in Setup of SHORT dummy don't match those of Setup S_open!
 	Hint: Apply DataManagement (Export & selective Import) to match them."
     GET_STRING VAL$(ErrMsg)&" [Cancel]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 IF VAL(Debug)==1 THEN PRINT "  freq. match OK"
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "S2PI_XTOR" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "4.3152019844082 16606 14298"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P162 C10 C10"
element 0 "Name" "ErrMsg"
element 0 "Value" ""
element 1 "Name" "___________________________________"
element 1 "Value" ""
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_PI_Schematic_Xtor"
element 0 "Value" "TL|<none>|<none>|#212LA_Schematic|1|0"
element 1 "Name" "TL_PI_Schematic_Xtor.LA_Schematic"
element 1 "Value" "LA|CA=#3293Transistor \012inner PI Schematic\012        ___\012P1 o-o-\174___\174-o----o-o P2\012     \174  Z12  \174    \174\012     -       -    -\012 Z10\174 \174    / \174 \134 \174 \174Z20\012     -     \134 v /  -\012     \174    Gm -    \174\012     \174       \174    \174\012    ---     ---  ---:FI=FF|<none>|<none>|0"
element 2 "Name" ""
element 2 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 ! This Setup holds centralized off-strippings 
 ! for transistor inner-PI schematics
 ! -> of bipolar (simplified, neglecting CBCext),
 ! -> MOS and MESFET/HEMT transistors with quasistatic 
 !     and non-quasistatic approach.
 
 
 ! See 'Spar2Schematic_vs_Meas' or 'Spar2Schematic_B'
 ! for details about the returned dataset.
 
 
 ! Notes:
 ! You find pre-defined Plots, 
 ! ready for being copy-pasted into your own modeling project, 
 ! in tab 'Plots'.
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 !---in your Modelfile, add a Transform and copy-paste the PEL lines below:
 
 !===contents of your local Transform 'Spar2Schematic_vs_Mean'============================
 
 
 !---check if meas. Spar are valid
 IF MEAN(S_deemb.M.11)==0 THEN RETURN
 
 !---link to outer parasitics
 LB=0
 LC=0
 LE=0
 RB=MAIN.RBX
 RC=MAIN.RCX
 RE=MAIN.RE
 XtorType = "Bip"		![Bip]  or  [MOS], [HEMT]
 Quasistat= "y"		![y] or [n],  for Bip: [y]
 Path2Setup = WHOIS(".", "Parent Setup")			!returns full path to SetupName
 !---call central program to strip-off outer parasitics 
 !   from meas.(only!) Spar and convert result to inner PI schematic
 !   Further, calculate mean value of off-stripped, inner PI meas. data
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_XTOR/Spar2Schematic_vs_Mean", freq, S_deemb.B, LB, LC, LE, RB, RC, RE, VAL$(XtorType), VAL$(Quasistat), VAL$(Path2Setup))
 
 
 
 
 !===contents of your local Transform  'Spar2Schematic_B'=================================
 
 !---check if data are of type 'B'
 DataType = LOOKUP_TABLE_VAL("S_deemb", "Type")
 IF VAL$(DataType)<>"B" THEN RETURN
 
 
 !---link to outer parasitics
 LG=1f
 LD=1f
 LS=1f
 RG=1m
 RD=1m
 RS=1m
 
 XtorType="MOS"	!Selection: "Bip" or "MOS" or 'HEMT'
 Quasistat="y"	!Selection: "n"   or "y",   for Bip  select 'y'
 
 !---call central program to provide the inner PI schematic components
 !   For MOS, the outer parasitics are stripped-off from meas. and simul.Spar
 !   For Bip, no off-stripping is applied due to the bias-dpendent RBB'
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_XTOR/Spar2Schematic_B", freq, S_deemb.B, LG, LD, LS, RG, RD, RS, XtorType, Quasistat)
 
 
 
 
 !==============================================================================
 !===if you also want to plot the intermediate results==========================
 !==============================================================================
 
 
 !===contents of your local Transform  'Spar_stripped_off'=================================
 
 !---this Program is auto-executed once Spar_stripped_off in UTILITIES has changed.
 !   It enables the plotting of the off-stripped S-parameters
 RETURN /UTILITIES/PEL_UTILITIES/S2PI_XTOR/Spar_stripped_off
 
 
 
 
 
 !===contents of your local Transform  'PI_Impedances'=================================
 
 !---this Program is auto-executed once PI_Impedances in UTILITIES has changed.
 !   It enables the plotting of the PI Impedances in RI Plots
 RETURN /UTILITIES/PEL_UTILITIES/S2PI_XTOR/PI_Impedances
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member XFORM "PI_Impedances"
member XFORM "Spar_stripped_off"
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "Spar2Schematic_vs_Mean" "711.501"
{
View block_edit 0 "35030,821"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 
 !===this Program strips off the outer parasitic C, L and R from the meas. S_deemb,
 !   and returns the transistor inner-PI schematic parameters in section 'M' (Measured),
 !   while the mean value of the off-stripped meas. data is returned in section 'S' (Simulated)
 !   It is used in transistor modeling step SPAR_MODELING/Init_Spar_Modeling/Mdlg_ext_C_L
 
 
 !---this is answered by the calling Program
 GET_DATASET "freq", freq
 GET_DATASET "Spar", S_deemb
 GET_REAL    "LG", LG
 GET_REAL    "LD", LD
 GET_REAL    "LS", LS
 GET_REAL    "RG", RG
 GET_REAL    "RD", RD
 GET_REAL    "RS", RS
 
 GET_STRING  "[Bip]  or  [MOS]  or  [HEMT]", XtorType
 GET_STRING  "MOS Quasistat:   [y] or [n]", Quasistat
 
 GET_STRING  "Path2Setup", Path2Setup
 
 
 
 !---verify answers
 ErrMsg="ERROR: XtorType is neither 'Bip' nor 'MOS' nor 'HEMT'  [OK]"
 IF VAL$(XtorType)=="Bip"  THEN ErrMsg=""
 IF VAL$(XtorType)=="MOS"  THEN ErrMsg=""
 IF VAL$(XtorType)=="HEMT" THEN ErrMsg=""
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING "ERROR: XtorType is neither 'Bip' nor 'MOS' nor 'HEMT'   [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 !---correct for bipolar
 IF VAL$(XtorType)=="Bip" THEN Quasistat="y"
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---perform the conversion into PI schematic
 tmp = EVALUATE_TRANSFORM("PI_Components", freq, S_deemb, LG, LD, LS, RG, RD, RS, XtorType, Quasistat)
 !      tmp.B.11 = R10.B + j*C10.B
 !      tmp.B.12 = R12.B + j*C12.B
 !      tmp.B.21 = GM.B  + j*TAU.B
 !      tmp.B.22 = R20.B + j*C20.B
 R10_M = REAL(tmp.M.11)
 C10_M = IMAG(tmp.M.11)
 
 R12_M = REAL(tmp.M.12)
 C12_M = IMAG(tmp.M.12)
 
 GM_M  = REAL(tmp.M.21)
 TAU_M = IMAG(tmp.M.21)
 
 R20_M = REAL(tmp.M.22)
 C20_M = IMAG(tmp.M.22)
 
 
 !====================================================================================
 !---calculate target values (mean values of meas. params)
 !   for optimization from off-stripped meas. S_deemb
 COMPLEX R10_Target.M[SIZEOF(freq)]
 COMPLEX C10_Target.M[SIZEOF(freq)]
 COMPLEX R12_Target.M[SIZEOF(freq)]
 COMPLEX C12_Target.M[SIZEOF(freq)]
 COMPLEX GM_Target.M[SIZEOF(freq)]
 COMPLEX TAU_Target.M[SIZEOF(freq)]
 COMPLEX R20_Target.M[SIZEOF(freq)]
 COMPLEX C20_Target.M[SIZEOF(freq)]
 
 !---get nr. freq sweeps and calc min. and max freq. for mean calculation
 Sweep1Pts= USERC_num_of_points(1, VAL$(Path2Setup))
 freqMin=MIN(freq)+0.2*(MAX(freq)-MIN(freq))
 freqMax=MAX(freq)-0.2*(MAX(freq)-MIN(freq))
 
 
 !---calc. target values
 FOR i=0 TO SIZEOF(freq)-1
   IF freq[i]==MIN(freq) THEN
     N=0
     R10_Target_tmp=0
     C10_Target_tmp=0
     R12_Target_tmp=0
     C12_Target_tmp=0
     GM_Target_tmp=0
     TAU_Target_tmp=0
     R20_Target_tmp=0
     C20_Target_tmp=0
     FOR ifreq=i TO i + (Sweep1Pts-1)
       !---calc. mean value for act. biasing, between freqMin and freqMax
       IF (freq[ifreq]>freqMin) AND (freq[ifreq]<freqMax) THEN
         R10_Target_tmp = R10_Target_tmp+R10_M[ifreq]
         C10_Target_tmp = C10_Target_tmp+C10_M[ifreq]
         R12_Target_tmp = R12_Target_tmp+R12_M[ifreq]
         C12_Target_tmp = C12_Target_tmp+C12_M[ifreq]
         GM_Target_tmp  = GM_Target_tmp +GM_M[ifreq]
         TAU_Target_tmp = TAU_Target_tmp+TAU_M[ifreq]
         R20_Target_tmp = R20_Target_tmp+R20_M[ifreq]
         C20_Target_tmp = C20_Target_tmp+C20_M[ifreq]
         N = N + 1
       END IF
     NEXT ifreq
   END IF
 
   R10_Target[i] = R10_Target_tmp//N
   C10_Target[i] = C10_Target_tmp//N
   R12_Target[i] = R12_Target_tmp//N
   C12_Target[i] = C12_Target_tmp//N
   GM_Target[i]  = GM_Target_tmp//N
   TAU_Target[i] = TAU_Target_tmp//N
   R20_Target[i] = R20_Target_tmp//N
   C20_Target[i] = C20_Target_tmp//N
 NEXT i
 
 
 !---finally, return the meas. data inner-PI schematic values (Type 'M') and the mean targets (Type 'S')
 !   in a 2x2 array for Plot and PlotOptimizer
 !
 COMPLEX tmp.B.22[SIZEOF(S_deemb)]
 FOR i=0 TO SIZEOF(tmp) - 1
   tmp.M.11[i] = REAL(R10_M[i])      + j*REAL(C10_M[i])
   tmp.S.11[i] = REAL(R10_Target[i]) + j*REAL(C10_Target[i])
   tmp.M.12[i] = REAL(R12_M[i])      + j*REAL(C12_M[i])
   tmp.S.12[i] = REAL(R12_Target[i]) + j*REAL(C12_Target[i])
   tmp.M.21[i] = REAL(GM_M[i])       + j*REAL(TAU_M[i])
   tmp.S.21[i] = REAL(GM_Target[i])  + j*REAL(TAU_Target[i])
   tmp.M.22[i] = REAL(R20_M[i])      + j*REAL(C20_M[i])
   tmp.S.22[i] = REAL(R20_Target[i]) + j*REAL(C20_Target[i])
 NEXT i
 
 RETURN tmp
 
 !      tmp.11 = R10 + j*C10
 !      tmp.12 = R12 + j*C12
 !      tmp.21 = GM  + j*TAU
 !      tmp.22 = R20 + j*C20
 
 ! ===MOS/HEMT quasistatic========================================================
 !                     ___
 ! G o-------o----||--|___|---o---------------------------o------o--o D
 !           |   |C12  R12    |                           |      |
 !           -   |            |                           |      |
 !      R10 | |  |            -                           |      |
 !           -   |          /   \                         -      |
 !           |   |          \   / vGS*GM*exp(-j*2PI*TAU) | |    ---
 !           o   |            -                           - R20 --- C20
 !           |   |            |                           |      |
 !      C10 ---  |vGiS        |                           |      |
 !          ---  |            |                           |      |
 !           |   v            |                           |      |
 !          ---              ---                         ---    ---
 
 ! ===MOS/HEMT non-quasistatic========================================================
 !                   ___
 ! G o-------o--||--|___|---o----------------------------o------o--o D
 !           |  C12  R12    |                            |      |
 !           -              |                            |      |
 !      R10 | |             -                            |      |
 !           -            /   \                          -      |
 !           |            \   / vGiS*GM*exp(-j*2PI*TAU) | |    ---
 !           o              -                            - R20 --- C20
 !           |   |          |                            |      |
 !      C10 ---  |vGiS      |                            |      |
 !          ---  |          |                            |      |
 !           |   v          |                            |      |
 !          ---            ---                          ---    ---
 
 ! 
 ! ===PI schematic of Bipolar, simplified: negleced RBB & CBCexternal =========================
 !                        ___ 
 !  Bi o-----o----o--||--|___|--o---------------------------o------o--o C
 !     |     |    |  C12  R12   |                           |      |      
 !     |     -   ---            -                           -      |
 ! vBiE|    | |  ---          /   \                        | |    ---
 !     | R10 -    |C10        \   /vBiE*GM*exp(-j*2PI*TAU)  - R20 ---C20
 !     |     |    |             -                           |      |
 !     v     |    |             |                           |      |
 !    ---   ---  ---           ---                         ---    ---
}
dataset
{
datasize BOTH 1664 2 2
type MEAS
type SIMU
}
}
}
LINK XFORM "Spar2Schematic_B" "711.501"
{
View block_edit 0 "0,7706"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !---this program returns the inner PI schematic components for both, meas. and simul.
 !   For MOS, the outer parasitics are stripped-off from deembedded meas. and simul.Spar
 !   For Bip, no off-stripping is applied due to the bias-dpendent RBB'
 
 GLOBAL_VAR  ErrMsg
 
 !---this is answered by the calling Program
 GET_DATASET "freq", freq
 GET_DATASET "Spar", S_deemb
 GET_REAL    "LG", LG
 GET_REAL    "LD", LD
 GET_REAL    "LS", LS
 GET_REAL    "RG", RG
 GET_REAL    "RD", RD
 GET_REAL    "RS", RS
 
 GET_STRING  "[Bip]  or  [MOS]  or  [HEMT]", XtorType
 GET_STRING  "MOS Quasistat:   [y] or [n]", Quasistat
 
 
 !---verify answers
 ErrMsg="ERROR: XtorType is neither 'Bip' nor 'MOS' nor 'HEMT'   [OK]"
 IF VAL$(XtorType)=="Bip" THEN ErrMsg=""
 IF VAL$(XtorType)=="MOS" THEN ErrMsg=""
 IF VAL$(XtorType)=="HEMT" THEN ErrMsg=""
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING "ERROR: XtorType is neither 'Bip' nor 'MOS' nor 'HEMT'    [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 !---correct for bipolar
 IF VAL$(XtorType)=="Bip" THEN Quasistat="y"
 
 !---perform the conversion into PI schematic
 RETURN EVALUATE_TRANSFORM("PI_Components", freq, S_deemb, LG, LD, LS, RG, RD, RS, XtorType, Quasistat)
 
 !      X.11 = R10 + j*C10
 !      X.12 = R12 + j*C12
 !      X.21 = GM  + j*TAU
 !      X.22 = R20 + j*C20
 
 ! ===MOS/HEMT quasistatic========================================================
 !                     ___
 ! G o-------o----||--|___|---o---------------------------o------o--o D
 !           |   |C12  R12    |                           |      |
 !           -   |            |                           |      |
 !      R10 | |  |            -                           |      |
 !           -   |          /   \                         -      |
 !           |   |          \   / vGS*GM*exp(-j*2PI*TAU) | |    ---
 !           o   |            -                           - R20 --- C20
 !           |   |            |                           |      |
 !      C10 ---  |vGiS        |                           |      |
 !          ---  |            |                           |      |
 !           |   v            |                           |      |
 !          ---              ---                         ---    ---
 
 ! ===MOS/HEMT non-quasistatic========================================================
 !                   ___
 ! G o-------o--||--|___|---o----------------------------o------o--o D
 !           |  C12  R12    |                            |      |
 !           -              |                            |      |
 !      R10 | |             -                            |      |
 !           -            /   \                          -      |
 !           |            \   / vGiS*GM*exp(-j*2PI*TAU) | |    ---
 !           o              -                            - R20 --- C20
 !           |   |          |                            |      |
 !      C10 ---  |vGiS      |                            |      |
 !          ---  |          |                            |      |
 !           |   v          |                            |      |
 !          ---            ---                          ---    ---
 
 ! 
 ! ===simplified Bipolar, neglecting CBCexternal =========================
 !                        ___ 
 !  Bi o-----o----o--||--|___|--o---------------------------o------o--o C
 !     |     |    |  C12  R12   |                           |      |      
 !     |     -   ---            -                           -      |
 ! vBiE|    | |  ---          /   \                        | |    ---
 !     | R10 -    |C10        \   /vBiE*GM*exp(-j*2PI*TAU)  - R20 ---C20
 !     |     |    |             -                           |      |
 !     v     |    |             |                           |      |
 !    ---   ---  ---           ---                         ---    ---
}
dataset
{
datasize BOTH 7236 2 2
type MEAS
type SIMU
}
}
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "___aux________________" "711.501"
{
}
LINK XFORM "PI_Components" "711.501"
{
View block_edit 0 "150181,6653"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !===this Program strips off the outer parasitic L and R from the S-params
 !  and returns the inner-PI schematic component values.
 !  For details, see the sketched schematics below
 
 
 !---this is answered by the calling Program
 GET_DATASET "freq", freq
 GET_DATASET "Spar", S_deemb_total
 GET_REAL    "LG", LG
 GET_REAL    "LD", LD
 GET_REAL    "LS", LS
 GET_REAL    "RG", RG
 GET_REAL    "RD", RD
 GET_REAL    "RS", RS
 
 GET_STRING  "[Bip]  or  [MOS]  or  [HEMT]", XtorType
 GET_STRING  "Quasistat:   [y] or [n]", Quasistat
 
 
 
 !===strip-off the parasitic Rx and Lx, around the inner PI schematic, from meas. and simulated S_deemb_total
 !---convert to Zpar
 z=TWOPORT(S_deemb_total, "S", "Z")
 
 !---subtract series components
 FOR i=0 TO SIZEOF(z)-1
   z.M.11[i]=z.M.11[i]-(RG+RS + j*2*PI*freq[i]*(LG+LS))
   z.M.12[i]=z.M.12[i]-(RS    + j*2*PI*freq[i]*(LS))
   z.M.21[i]=z.M.21[i]-(RS    + j*2*PI*freq[i]*(LS))
   z.M.22[i]=z.M.22[i]-(RD+RS + j*2*PI*freq[i]*(LD+LS))
 
   IF MEAN(S_deemb_total.S.11)<>0 THEN
     z.S.11[i]=z.S.11[i]-(RG+RS + j*2*PI*freq[i]*(LG+LS))
     z.S.12[i]=z.S.12[i]-(RS    + j*2*PI*freq[i]*(LS))
     z.S.21[i]=z.S.21[i]-(RS    + j*2*PI*freq[i]*(LS))
     z.S.22[i]=z.S.22[i]-(RD+RS + j*2*PI*freq[i]*(LD+LS))
   END IF
 NEXT i
 
 !---convert back to Spar 
 s=TWOPORT(z, "Z", "S")
 
 
 !---store off-stripped Spars
 ICCAP_FUNC("Spar_stripped_off", "Execute", s)
 
 
 !===calculate inner PI schematic's complex impedances from stripped-off  meas. and simulated S_deemb_total
 !---convert the stripped-off S-parameters to Y
 y = TWOPORT(s, "S", "Y")
 
 
 !---calculate the complex impedances and the complex Gm
 ! ===inner PI schematic===
 !                 ___
 ! P1 o-------o---|___|---o------o--o P2
 !            |    Z12    |       |
 !            -           -       -
 !       Z10 | |        / | \    | | Z20
 !            -         \ v /Gm   -
 !            |           -       |
 !            |           |       |
 !           ---         ---     ---
 
 
 Z_10 = (y.11 + y.12)^-1	!impedance  port1 -> GND
 Y_10 =  y.11 + y.12		!admittance port1 -> GND
 Z_12 = (-y.12)^-1		!impedance  port1 -> port2
 Gm_quasistat  = y.21 - y.12	!
 Y_20 = y.22 + y.12		!admittance port2 -> GND
 
 
 !--export PI Impedances to Transform PI_Impedances for separate plot capabilities
 ICCAP_FUNC("PI_Impedances", "Execute", Z_10.B, Z_12.B, Y_20.B^-1)
 
 
 
 ! ===solve for Rxy ,  Cxy , GM  and TAU===
 ! calculate the Cxx, Rxx, GM and TAU for the following inner transistor PI schematic
 ! 
 ! ===MOS/HEMT quasistatic========================================================
 !                     ___
 ! G o-------o----||--|___|---o---------------------------o------o--o D
 !           |   |C12  R12    |                           |      |
 !           -   |            |                           |      |
 !      R10 | |  |            -                           |      |
 !           -   |          /   \                         -      |
 !           |   |          \   / vGS*GM*exp(-j*2PI*TAU) | |    ---
 !           o   |            -                           - R20 --- C20
 !           |   |            |                           |      |
 !      C10 ---  |vGS         |                           |      |
 !          ---  |            |                           |      |
 !           |   v            |                           |      |
 !          ---              ---                         ---    ---
 
 ! ===MOS/HEMT non-quasistatic========================================================
 !                   ___
 ! G o-------o--||--|___|---o----------------------------o------o--o D
 !           |  C12  R12    |                            |      |
 !           -              |                            |      |
 !      R10 | |             -                            |      |
 !           -            /   \                          -      |
 !           |            \   / vGiS*GM*exp(-j*2PI*TAU) | |    ---
 !           o              -                            - R20 --- C20
 !           |   |          |                            |      |
 !      C10 ---  |vGiS      |                            |      |
 !          ---  |          |                            |      |
 !           |   v          |                            |      |
 !          ---            ---                          ---    ---
 
 ! 
 ! ===PI schematic of Bipolar, simplified: negleced RBB & CBCexternal =========================
 !                        ___ 
 !  Bi o-----o----o--||--|___|--o---------------------------o------o--o C
 !     |     |    |  C12  R12   |                           |      |      
 !     |     -   ---            -                           -      |
 ! vBiE|    | |  ---          /   \                        | |    ---
 !     | R10 -    |C10        \   /vBiE*GM*exp(-j*2PI*TAU)  - R20 ---C20
 !     |     |    |             -                           |      |
 !     v     |    |             |                           |      |
 !    ---   ---  ---           ---                         ---    ---
 
 IF VAL$(XtorType)=="Bip" THEN
   !---for Bipolar-------
   R10_ = (REAL(Y_10))^-1
   C10_ = IMAG(Y_10) // (2PI*freq)
 ELSE
   !---for MOS and HEMT----------
   R10_ = REAL(Z_10)
   C10_ = -(IMAG(Z_10))^-1 // (2PI*freq)
 END IF
 
 
 R12_ = REAL(Z_12)
 C12_ = -(IMAG(Z_12))^-1 // (2PI*freq)
 
 
 IF VAL$(Quasistat) == "n" THEN
   nonquasistat_compens = (1+j*(2PI*freq)*R10_*C10_)
   Gm_nonquasistat = Gm_quasistat * nonquasistat_compens
   GM_  = MAG(Gm_nonquasistat)
   TAU_ = -PH(Gm_nonquasistat) // (2PI*freq)
 ELSE
   GM_  = MAG(Gm_quasistat)
   TAU_ = -PH(Gm_quasistat) // (2PI*freq)
 END IF
 
 R20_ = REAL(REAL(Y_20))^-1		! we need to take the REAL(math conversion) because of rounding problems in PEL, which could add small IMAG parts, which affect the REAL part after e.g. calculating the inverse
 C20_ = IMAG(Y_20) // (2PI*freq)
 
 
 !---finally, return the data inner-PI schematic values, 'M' (Measured) and 'S' (Simulated),
 !   in a 2x2 array for Plot and PlotOptimizer
 COMPLEX tmp.B.22[SIZEOF(S_deemb_total)]
 FOR i =0 TO SIZEOF(tmp) - 1
   tmp.M.11[i] = REAL(R10_.M[i]) + j*REAL(C10_.M[i])
   tmp.S.11[i] = REAL(R10_.S[i]) + j*REAL(C10_.S[i])
   tmp.M.12[i] = REAL(R12_.M[i]) + j*REAL(C12_.M[i])
   tmp.S.12[i] = REAL(R12_.S[i]) + j*REAL(C12_.S[i])
   tmp.M.21[i] =  REAL(GM_.M[i]) + j*REAL(TAU_.M[i])
   tmp.S.21[i] =  REAL(GM_.S[i]) + j*REAL(TAU_.S[i])
   tmp.M.22[i] = REAL(R20_.M[i]) + j*REAL(C20_.M[i])
   tmp.S.22[i] = REAL(R20_.S[i]) + j*REAL(C20_.S[i])
 NEXT i
 
 
 RETURN tmp
 
 !      tmp.B.11 = R10.B + j*C10.B
 !      tmp.B.12 = R12.B + j*C12.B
 !      tmp.B.21 = GM.B  + j*TAU.B
 !      tmp.B.22 = R20.B + j*C20.B
}
dataset
{
datasize BOTH 7236 2 2
type MEAS
type SIMU
}
}
list PLOT "_C10_"
list PLOT "_R10_"
list PLOT "_C12_"
list PLOT "_R12_"
list PLOT "_TAU_"
list PLOT "_GM_AC_"
list PLOT "_R20_"
list PLOT "_C20_"
}
LINK XFORM "Spar_stripped_off" "711.501"
{
View block_edit 0 "0,7155"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 
 ! This Program acts like a data base 
 ! to host the S-parameters which are
 ! stripped-off from the external L, R and C.
 ! 
 ! It enables the plotting of the stripped-off S-Parameters.
 
 
 GET_DATASET "Spar_stripped_off", tmp
 
 RETURN tmp
}
dataset
{
datasize BOTH 7236 2 2
type MEAS
type SIMU
}
}
list XFORM "HOW2USE"
list PLOT "S11_stripped_off"
list PLOT "S12_stripped_off"
list PLOT "S21_stripped_off"
list PLOT "S22_stripped_off"
}
LINK XFORM "PI_Impedances" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 
 ! This Program acts like a data base 
 ! to host the impedances Z10, Z12 and Z20
 ! of the PI-Components 
 ! This enables the plotting of the impedances in RI-Plots.
 
 
 ! ===transistor inner PI schematic=================
 !                 ___
 ! P1 o-------o---|___|---o------o--o P2
 !            |    Z12    |       |
 !            -           -       -
 !       Z10 | |        / | \    | | Z20
 !            -         \ v /Gm   -
 !            |           -       |
 !            |           |       |
 !           ---         ---     ---
 !
 !      PI_Imped.11 = Z10
 !      PI_Imped.12 = Z12
 !      PI_Imped.22 = Z20
 
 
 
 GET_DATASET "PI Impedance Z_10", Z_10
 GET_DATASET "PI Impedance Z_12", Z_12
 GET_DATASET "PI Impedance Z_20", Z_20
 
 
 !---return impedances
 COMPLEX PI_Imped.B.22[SIZEOF(Z_10)]
 FOR i=0 TO SIZEOF(PI_Imped)-1
   PI_Imped.M.11[i] = Z_10.M[i]
   PI_Imped.S.11[i] = Z_10.S[i]
   PI_Imped.M.12[i] = Z_12.M[i]
   PI_Imped.S.12[i] = Z_12.S[i]
   PI_Imped.M.22[i] = Z_20.M[i]
   PI_Imped.S.22[i] = Z_20.S[i]
 NEXT i
 
 RETURN PI_Imped
 !   PI_Imped.11 = Z_10     Impedance Port1 -> Ground
 !   PI_Imped.12 = Z_12     Impedance Port1 -> Port2
 !   PI_Imped.22 = Z_20     Impedance Port2 -> Ground
 
}
dataset
{
datasize BOTH 7236 2 2
type MEAS
type SIMU
}
}
list XFORM "HOW2USE"
list PLOT "Z10"
list PLOT "Z12"
list PLOT "Z20"
}
LINK XFORM "____________________3" "711.501"
{
}
LINK PLOT "_MP_S_stripped_off_" "711.501"
{
View plot_window 0 "803,107,18230,18309"
View draw_ds 0 "B,0,-4092"
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "0"
element "Orientation" "H"
element "Plots Per Row" "2"
element "Header" "Spar stripped-off from ext. components"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "S11_stripped_off"
element "Plot 1" "S12_stripped_off"
element "Plot 2" "S21_stripped_off"
element "Plot 3" "S22_stripped_off"
}
HYPTABLE "Multi GUI Table"
{
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S11_stripped_off" "711.501"
{
View plot_window 0 "4,23,28067,24095"
View draw_ds 0 "B,4459,-4092"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "3" "N"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "1" "N"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "5" "N"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S11 stripped-off"
element "Footer" ""
element "Smith Data 0" "S_deemb.m.11"
element "Smith Data 1" "S_deemb.s.11"
element "Smith Data 2" "Spar_stripped_off.m.11"
element "Smith Data 3" "Spar_stripped_off.s.11!!_"
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 1
PlotOptimizerTraceSet "Smith Data 0" "T" "Smith Data 1"
}
member XFORM "Spar_stripped_off"
}
LINK PLOT "S12_stripped_off" "711.501"
{
View plot_window 0 "4,23,28067,24095"
View draw_ds 0 "B,7663,-4092"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "3" "N"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "1" "N"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "5" "N"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S12 stripped-off"
element "Footer" ""
element "Polar Data 0" "S_deemb.m.12"
element "Polar Data 1" "S_deemb.s.12"
element "Polar Data 2" "Spar_stripped_off.m.12"
element "Polar Data 3" "Spar_stripped_off.s.12!!_"
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 1
PlotOptimizerTraceSet "Polar Data 0" "T" "Polar Data 1"
}
member XFORM "Spar_stripped_off"
}
LINK PLOT "S21_stripped_off" "711.501"
{
View plot_window 0 "4,23,28067,24095"
View draw_ds 0 "B,10833,-4092"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "3" "N"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "1" "N"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "5" "N"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S21 stripped-off"
element "Footer" ""
element "Polar Data 0" "S_deemb.m.21"
element "Polar Data 1" "S_deemb.s.21"
element "Polar Data 2" "Spar_stripped_off.m.21"
element "Polar Data 3" "Spar_stripped_off.s.21!!_"
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 1
PlotOptimizerTraceSet "Polar Data 0" "T" "Polar Data 1"
}
member XFORM "Spar_stripped_off"
}
LINK PLOT "S22_stripped_off" "711.501"
{
View plot_window 0 "4,23,28067,24095"
View draw_ds 0 "B,14003,-4092"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "3" "N"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "1" "N"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "5" "N"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S22 stripped-off"
element "Footer" ""
element "Smith Data 0" "S_deemb.m.22"
element "Smith Data 1" "S_deemb.s.22"
element "Smith Data 2" "Spar_stripped_off.m.22"
element "Smith Data 3" "Spar_stripped_off.s.22!!_"
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 1
PlotOptimizerTraceSet "Smith Data 0" "T" "Smith Data 1"
}
member XFORM "Spar_stripped_off"
}
LINK PLOT "_MP_Zxx_" "711.501"
{
View plot_window 0 "4,23,32311,10929,{Z10:AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC&Z12:AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC&Z20:AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC}"
View draw_ds 0 "B,17220,-4092"
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "3"
element "# of GUIs" "0"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" "PI Impedances"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "Z10"
element "Plot 1" "Z12"
element "Plot 2" "Z20"
}
HYPTABLE "Multi GUI Table"
{
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "Z10" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC}"
View draw_ds 0 "B,0,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line" "A"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z10"
element "Footer" ""
element "RI Data 0" "PI_Impedances.M.11"
element "RI Data 1" "PI_Impedances.S.11"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_Impedances"
}
LINK PLOT "Z12" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC}"
View draw_ds 0 "B,2978,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line" "A"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z12"
element "Footer" ""
element "RI Data 0" "PI_Impedances.M.12"
element "RI Data 1" "PI_Impedances.S.12"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_Impedances"
}
LINK PLOT "Z20" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC}"
View draw_ds 0 "B,5969,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line" "A"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z20"
element "Footer" ""
element "RI Data 0" "PI_Impedances.M.22"
element "RI Data 1" "PI_Impedances.S.22"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_Impedances"
}
LINK PLOT "_MP_PiComponents_" "711.501"
{
View plot_window 0 "__iccapDataBlock"
TABLE "ICVIEWDATA"
{
4,23,40009,27886,{_C10_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_R10_:MAN|XY| 75.88MEG, 25.00G,5,5: 42.14 , 120.0G,6,4: 0.000 , 1.000 ,4,5&_C12_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_R12_:AUTO|XY| 1.000G, 5.000G,4,5: 7.338m, 200.0 ,4,5: 0.000 , 1.000 ,4,5&_GM_AC_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_TAU_:AUTO|XY| 82.23MEG, 5.000G,5,5: 0.000 , 10.00p,5,4: 0.000 , 1.000 ,4,5&_C20_:AUTO|XY| 92.27MEG
, 500.0MEG,5,5: 2.950a, 800.0f,5,4: 0.000 , 1.000 ,4,5&_R20_:AUTO|XY| 1.000 , 39.81MEG,4,5: 53.90 , 8.000K,6,4: 0.000 , 1.000 ,4,5}
__iccapDataBlockEnd
}
View draw_ds 0 "B,8960,0"
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "8"
element "# of GUIs" "0"
element "Orientation" "H"
element "Plots Per Row" "4"
element "Header" "PI Schematic Components"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_C10_"
element "Plot 1" "_R10_"
element "Plot 2" "_C12_"
element "Plot 3" "_R12_"
element "Plot 4" "_GM_AC_"
element "Plot 5" "_TAU_"
element "Plot 6" "_C20_"
element "Plot 7" "_R20_"
}
HYPTABLE "Multi GUI Table"
{
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_C10_" "711.501"
{
View plot_window 0 "4,23,10135,10118"
View draw_ds 0 "B,12523,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.11)!!C10.M"
element "Y Data 1" "IMAG(PI_Components.S.11)!!C10.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
}
LINK PLOT "_R10_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_R10_:MAN|XY| 75.88MEG, 25.00G,5,5: 42.14 , 120.0G,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,5100"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.11)!!R10.M"
element "Y Data 1" "REAL(PI_Components.S.11)!!R10.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
}
LINK PLOT "_C12_" "711.501"
{
View plot_window 0 "4,23,10135,10118"
View draw_ds 0 "B,4180,5100"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.12)!!C12.M"
element "Y Data 1" "IMAG(PI_Components.S.12)!!C12.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
}
LINK PLOT "_R12_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_R12_:AUTO|XY| 1.000G, 5.000G,4,5: 7.338m, 200.0 ,4,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,8353,5100"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.12)!!R12.M"
element "Y Data 1" "REAL(PI_Components.S.12)!!R12.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
}
LINK PLOT "_TAU_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_TAU_:AUTO|XY| 82.23MEG, 5.000G,5,5: 0.000 , 10.00p,5,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,12546,5100"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "TAU"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.21)!!TAU.Mt"
element "Y Data 1" "IMAG(PI_Components.S.21)!!TAU.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
}
LINK PLOT "_GM_AC_" "711.501"
{
View plot_window 0 "4,23,9005,8990"
View draw_ds 0 "B,0,10200"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "GM"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.21)!!GM_AC.M"
element "Y Data 1" "REAL(PI_Components.S.21)!!GM_AC.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
}
LINK PLOT "_R20_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_R20_:AUTO|XY| 1.000 , 39.81MEG,4,5: 53.90 , 8.000K,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,4479,10200"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.22)!!R20.M"
element "Y Data 1" "REAL(PI_Components.S.22)!!R20.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
}
LINK PLOT "_C20_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_C20_:AUTO|XY| 92.27MEG, 500.0MEG,5,5: 2.950a, 800.0f,5,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,8672,10200"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.22)!!C20.M"
element "Y Data 1" "IMAG(PI_Components.S.22)!!C20.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
PlotError IsErrorRelative 0 
}
member XFORM "PI_Components"
}
data "711.501"
{
}
}
LINK DAT "S2PI_S2TEE" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "9.8881555634302 3635 32764"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P193 P413 C10"
element 0 "Name" "ErrMsg"
element 0 "Value" ""
element 1 "Name" "____________________________1"
element 1 "Value" ""
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_PI_Schematic_L12"
element 0 "Value" "TL|<none>|<none>|#212LA_Schematic|1|1"
element 1 "Name" "TL_PI_Schematic_L12.LA_Schematic"
element 1 "Value" "LA|CA=#3344 port1   __          port2\012  o---o-\174__\174--/\134/\134---o---o\012      \174  R12   L12   \174\012 C10 ---            --- C20\012     ---            ---\012      \174              \174\012      -              -\012 R10 \174 \174            \174 \174 R20\012      -              -\012      \174              \174\012     ---            ---:FI=FF|<none>|<none>|0"
element 2 "Name" "TL_PI_Schematic"
element 2 "Value" "TL|<none>|<none>|#212LA_Schematic|1|0"
element 3 "Name" "TL_PI_Schematic.LA_Schematic"
element 3 "Value" "LA|CA=#3200 port1    __    port2\012  o---o--\174__\174--o---o\012      \174  Z12   \174\012      -        -\012  Z10\174 \174      \174 \174Z20\012      -        -\012      \174        \174\012     ---      ---:FI=FF|<none>|<none>|0"
element 4 "Name" "TL_PI_Schematic_C12"
element 4 "Value" "TL|<none>|<none>|#212LA_Schematic|1|2"
element 5 "Name" "TL_PI_Schematic_C12.LA_Schematic"
element 5 "Value" "LA|CA=#3333 port1   __         port2\012  o---o-\174__\174---\174\174---o---o\012      \174  R12   C12  \174\012 C10 ---           --- C20\012     ---           ---\012      \174             \174\012      -             -\012 R10 \174 \174           \174 \174 R20\012      -             -\012      \174             \174\012     ---           ---:FI=FF|<none>|<none>|0"
element 6 "Name" ""
element 6 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 ! Notes:
 ! You find pre-defined Plots, ready for copy-paste
 ! into your own modeling project, in tab 'Plots'
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !###################################################################
 ! Note:  see also the Plots in this Setup, ready for copy-paste !!!
 !###################################################################
 
 !---how to call S_to_PI:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! convert S-par into impedances of a PI schematic
 !
 ! port1    __      port2
 !  o---o--|__|--o---o
 !      |   Z12  |
 !      -        - 
 !  Z10| |      | |Z20
 !      -        -
 !      |        |
 !     ---      ---
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/S_to_PI", freq, S_deemb)
 
 
 
 !#############################################################################
 
 !---how to call PI_to_CLR:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This transform converts the measured data,
 ! already converted to PI schematic impedances, 
 ! into the following simple inductor or capacitor schematic
 ! (depending on Variable 'Branch12'):
 !                L12
 !               \/\/
 ! port1   __   /    \       port2
 !  o---o-|__|-o      o-o---o
 !      |  R12  \    /  |
 ! C10 ---       -||-  --- C20
 !     ---       C12   ---
 !      |               |
 !      -               -
 ! R10 | |             | | R20
 !      -               -
 !      |               |
 !     ---             ---
 Branch12 = "R+L"   ! Choice:  "R+L" or "R+C"
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/PI_to_CLR", freq, S_to_PI, VAL$(Branch12))
 
 
 
 !###############################################################################################################
 
 !---how to call S_to_TEE:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! convert S-par into impedances of a TEE schematic
 !
 ! port1 __   12  __    port2
 !  o---|__|--o--|__|---o
 !       Z1   |   Z2
 !            - 
 !           | |Z12Gnd
 !            -
 !            |
 !           ---
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/S_to_TEE", freq, S_deemb)
 
 
 !#############################################################################
 
 !---how to call TEE_to_CLR:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This transform converts the measured data,
 ! already converted to TEE schematic impedances, 
 ! into the following simple inductor or capacitor schematic
 ! (depending on Variable 'Branch12'):
 
 !              L1                 L2
 !             \/\/               \/\/
 ! port1 __   /    \    12       /    \   __   port2
 !  o---|__|-o      o---o-------o      o-|__|---o
 !       R1   \    /    |        \    /   R2
 !             -||-    ---C12Gnd  -||-
 !              C1     ---         C2
 !                      |
 !                      -
 !                     | |R12Gnd
 !                      -
 !                      |
 !                     ---
 Branch12 = "R+L"   ! Choice:  "R+L" or "R+C"
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/TEE_to_CLR", freq, S_to_TEE, VAL$(Branch12))
 
 
 
 !###############################################################################################################
 
 !---how to call OnePort:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ViewFromPort = "P1"   !View from  [P1] or [P2]
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/OnePort", freq, S_deemb, VAL$(ViewFromPort))
 ! index_11:  1-Port Spar
 ! index_12:  1-Port Impedance
 ! index_21:  Series Resistor
 ! index_22:  Series Series Inductor + j * Series Capacitor
 
 
 
 !###############################################################################################################
 
 !---how to call the 3-Port Utilities:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !Y_to_Imped_3P:
 Imped = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/Y_to_Imped_3P", Y)
 !Imped_to_RLC_3P:
 Imped = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/Imped_to_RLC_3P", Imped, freq)
 
 
 
 !###############################################################################################################
 
 !---how to call the N-Port S-to-Y Conversion:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !S_to_Y:
 Y     = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/S2PI_S2TEE/S_to_Y", S_deemb)
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member XFORM "OnePort"
member XFORM "S_to_PI"
member XFORM "S_to_TEE"
}
LINK XFORM "___________________1" "711.501"
{
}
LINK XFORM "___________________2" "711.501"
{
}
LINK XFORM "___2Port_______________" "711.501"
{
}
LINK XFORM "S_to_PI" "711.501"
{
View block_edit 0 "30301,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 GET_DATASET "freq", freq
 GET_DATASET "Spar", S_deemb
 
 
 ! convert S-par into impedances of a PI schematic
 !
 ! port1    __      port2
 !  o---o--|__|--o---o
 !      |   Z12  |
 !      -        - 
 !  Z10| |      | |Z20
 !      -        -
 !      |        |
 !     ---      ---
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 
 
 COMPLEX Z.B.22[SIZEOF(S_deemb)]
 
 IF MEAN(S_deemb.M.11)<>0 THEN 
   YM = TwoPort(S_deemb.M, "S", "Y")
   FOR i=0 TO SIZEOF(YM)-1
     YxyM = 0.5*(YM.12[i] + YM.21[i])
     IF YM.11[i]+YxyM <> 0 THEN Z.M.11[i] = (YM.11[i]+YxyM)^-1	!Z10.M
     IF YxyM <>0 THEN Z.M.12[i] = -(YxyM)^-1			!Z12.M
     IF YM.22[i]+YxyM <> 0 THEN Z.M.22[i] = (YM.22[i]+YxyM)^-1	!Z20.M
   NEXT i
 END IF
 
 IF MEAN(S_deemb.S.11)<>0 THEN 
   YS = TwoPort(S_deemb.S, "S", "Y")
   FOR i=0 TO SIZEOF(YS)-1
     YxyS = 0.5*(YS.12[i] + YS.21[i])
     IF YS.11[i]+YxyS <> 0 THEN Z.S.11[i] = (YS.11[i]+YxyS)^-1	!Z10.S
     IF YxyS <>0 THEN Z.S.12[i] = -(YxyS)^-1			!Z12.S
     IF YS.22[i]+YxyS <> 0 THEN Z.S.22[i] = (YS.22[i]+YxyS)^-1	!Z20.S
   NEXT i
 END IF
 
 
 
 RETURN Z
 
 ! Z.11  = Z10
 ! Z.12  = Z12
 ! Z.22  = Z20
 
 
 ! port1    __      port2
 !  o---o--|__|--o---o
 !      |   Z12  |
 !      -        - 
 !  Z10| |      | |Z20
 !      -        -
 !      |        |
 !     ---      ---
}
dataset
{
datasize BOTH 24 2 2
type MEAS
type SIMU
}
}
list XFORM "HOW2USE"
list PLOT "Z10"
list PLOT "Z12"
list PLOT "Z20"
}
LINK XFORM "PI_to_CLR" "711.501"
{
View block_edit 0 "32021,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 GET_DATASET "freq", freq
 GET_DATASET "S_to_PI", Z
 GET_STRING  "[R+L] or [R+C]", Branch12
 
 
 ! This transform converts the measured data,
 ! already converted to PI schematic impedances, 
 ! into the following simple inductor or capacitor schematic
 ! (depending on Variable 'Branch12'):
 
 !                L12
 !               \/\/
 ! port1   __   /    \       port2
 !  o---o-|__|-o      o-o---o
 !      |  R12  \    /  |
 ! C10 ---       -||-  --- C20
 !     ---       C12   ---
 !      |               |
 !      -               -
 ! R10 | |             | | R20
 !      -               -
 !      |               |
 !     ---             ---
 !
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 
 IF VAL$(Branch12)<>"R+L" ANDALSO VAL$(Branch12)<>"R+C" THEN
   GET_STRING "ERROR in "&VAL$(WHOAMI())&": Port1->Port2 Branch Keyword [R+L], [R+C] not defined correctly !  [OK]", dummy
   COMPLEX tmp.B.22[SIZEOF(Z)]
   RETURN tmp
 END IF
 
 !---meas. data
 IF MEAN(Z.M.11)<>0 THEN 
   FOR i=0  TO SIZEOF(Z)-1
     C10M = 0
     IF IMAG(Z.M.11[i]) <> 0  THEN C10M = -(IMAG(Z.M.11[i])*2*PI*freq[i])^-1	!C10  port1 to GND
     R10M = REAL(Z.M.11[i])
     IF VAL$(Branch12)=="R+L" THEN L12M = IMAG(Z.M.12[i])//(2*PI*freq[i])        !L12  port1 to port2
     C12M = 0
     IF VAL$(Branch12)=="R+C" ANDALSO IMAG(Z.M.12[i])<>0 THEN C12M = -(IMAG(Z.M.12[i])*2*PI*freq[i])^-1     !C12  port1 to Port2
     R12M = REAL(Z.M.12[i])
     C20M = 0
     IF IMAG(Z.M.22[i]) <> 0  THEN C20M = -(IMAG(Z.M.22[i])*2*PI*freq[i])^-1	!C20  port1 to GND
     R20M = REAL(Z.M.22[i])
 
     !---re-use array 'Z' and fill it with schematic component values
     Z.M.11[i] = REAL(R10M) + j*REAL(C10M)	!apply REAL() to cancel PEL calculation rounding errors
     IF VAL$(Branch12)=="R+L" THEN Z.M.12[i] = REAL(R12M) + j*REAL(L12M)
     IF VAL$(Branch12)=="R+C" THEN Z.M.12[i] = REAL(R12M) + j*REAL(C12M)
     Z.M.21[i] = 0				
     Z.M.22[i] = REAL(R20M) + j*REAL(C20M)
   NEXT i
 END IF
 
 !---simul.data
 IF MEAN(Z.S.11)<>0 THEN 
   FOR i=0  TO SIZEOF(Z)-1
     C10S = 0
     IF IMAG(Z.S.11[i]) <> 0  THEN C10S = -(IMAG(Z.S.11[i])*2*PI*freq[i])^-1	!C10  port1 to GND
     R10S = REAL(Z.S.11[i])
     IF VAL$(Branch12)=="R+L" THEN L12S = IMAG(Z.S.12[i])//(2*PI*freq[i])        !L12  port1 to port2
     C12S = 0
     IF VAL$(Branch12)=="R+C" ANDALSO IMAG(Z.S.12[i])<>0 THEN C12S = -(IMAG(Z.S.12[i])*2*PI*freq[i])^-1     !C12  port1 to Port2
     R12S = REAL(Z.S.12[i])
     C20S = 0
     IF IMAG(Z.S.22[i]) <> 0  THEN C20S = -(IMAG(Z.S.22[i])*2*PI*freq[i])^-1	!C20  port1 to GND
     R20S = REAL(Z.S.22[i])
 
     !---re-use array 'Z' and fill it with schematic component values
     Z.S.11[i] = REAL(R10S) + j*REAL(C10S)	!apply REAL() to cancel PEL calculation rounding errors
     IF VAL$(Branch12)=="R+L" THEN Z.S.12[i] = REAL(R12S) + j*REAL(L12S)
     IF VAL$(Branch12)=="R+C" THEN Z.S.12[i] = REAL(R12S) + j*REAL(C12S)
     Z.S.21[i] = 0				
     Z.S.22[i] = REAL(R20S) + j*REAL(C20S)
   NEXT i
 END IF
 
 RETURN Z
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !                                     Z.11 = R10 + j*C10
 !    IF VAL$(Branch12)=="R+L" THEN    Z.12 = R12 + j*L12
 !    IF VAL$(Branch12)=="R+C" THEN    Z.12 = R12 + j*C12
 !                                     Z.21 = 0				
 !                                     Z.22 = R20 + j*C20
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !
 !                L12
 !               \/\/
 ! port1   __   /    \       port2
 !  o---o-|__|-o      o-o---o
 !      |  R12  \    /  |
 ! C10 ---       -||-  --- C20
 !     ---       C12   ---
 !      |               |
 !      -               -
 ! R10 | |             | | R20
 !      -               -
 !      |               |
 !     ---             ---
}
dataset
{
datasize BOTH 101 2 2
type MEAS
type SIMU
}
}
list PLOT "C10_"
list PLOT "R10_"
list PLOT "L12_"
list PLOT "R12_"
list PLOT "C12_"
list PLOT "C20_"
list PLOT "R20_"
}
LINK XFORM "S_to_TEE" "711.501"
{
View block_edit 0 "30301,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 GET_DATASET "freq", freq
 GET_DATASET "Spar", S_deemb
 
 
 ! convert S-par into impedances of a TEE schematic
 !
 ! port1 __   12  __    port2
 !  o---|__|--o--|__|---o
 !       Z1   |   Z2
 !            - 
 !           | |Z12Gnd
 !            -
 !            |
 !           ---
 !
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 
 
 COMPLEX Z.B.22[SIZEOF(S_deemb)]
 
 IF MEAN(S_deemb.M.11)<>0 THEN 
   ZM = TwoPort(S_deemb.M, "S", "Z")
   FOR i=0 TO SIZEOF(ZM)-1
     ZxyM = 0.5*(ZM.12[i] + ZM.21[i])
     Z.M.11[i] = ZM.11[i] - ZxyM   	!Z1
     Z.M.12[i] = ZxyM		!Z12Gnd
     Z.M.22[i] = ZM.22[i] - ZxyM   	!Z2
   NEXT i
 END IF
 
 IF MEAN(S_deemb.S.11)<>0 THEN 
   ZS = TwoPort(S_deemb.S, "S", "Z")
   FOR i=0 TO SIZEOF(ZS)-1
     ZxyS = 0.5*(ZS.12[i] + ZS.21[i])
     Z.S.11[i] = ZS.11[i] - ZxyS	!Z1
     Z.S.12[i] = ZxyS		!Z12Gnd
     Z.S.22[i] = ZS.22[i] - ZxyS	!Z2
   NEXT i
 END IF
 
 
 RETURN Z
 
 ! Z.11  =  Z1
 ! Z.12  =  Z12Gnd
 ! Z.22  =  Z2
 !
 ! port1 __   12  __    port2
 !  o---|__|--o--|__|---o
 !       Z1   |   Z2
 !            - 
 !           | |Z12Gnd
 !            -
 !            |
 !           ---
}
dataset
{
datasize BOTH 85 2 2
type MEAS
type SIMU
}
}
list XFORM "HOW2USE"
list PLOT "Z1"
list PLOT "Z12Gnd"
list PLOT "Z2"
}
LINK XFORM "TEE_to_CLR" "711.501"
{
View block_edit 0 "32021,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 GET_DATASET "freq", freq
 GET_DATASET "S_to_TEE", Z
 GET_STRING  "[R+L] or [R+C]", Branch12
 
 
 ! This transform converts the measured data,
 ! already converted to TEE schematic impedances, 
 ! into the following simple inductor or capacitor schematic
 ! (depending on Variable 'Branch12'):
 
 !              L1                 L2
 !             \/\/               \/\/
 ! port1 __   /    \    12       /    \   __   port2
 !  o---|__|-o      o---o-------o      o-|__|---o
 !       R1   \    /    |        \    /   R2
 !             -||-    ---C12Gnd  -||-
 !              C1     ---         C2
 !                      |
 !                      -
 !                     | |R12Gnd
 !                      -
 !                      |
 !                     ---
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 
 IF VAL$(Branch12)<>"R+L" ANDALSO VAL$(Branch12)<>"R+C" THEN
   GET_STRING "ERROR in "&VAL$(WHOAMI())&": Port1->Port2 Branch Keyword [R+L], [R+C] not defined correctly !  [OK]", dummy
   COMPLEX tmp.B.22[SIZEOF(Z)]
   RETURN tmp
 END IF
 
 
 !---meas. data
 IF MEAN(Z.M.11)<>0 THEN 
   FOR i=0  TO SIZEOF(Z)-1
     R1M = REAL(Z.M.11[i])                                                 !R1 at Port1
     IF VAL$(Branch12)=="R+L" THEN L1M =   IMAG(Z.M.11[i])//(2*PI*freq[i])        !L1 at Port1
     IF VAL$(Branch12)=="R+C" THEN
       C1M = 0
       IF IMAG(Z.M.11[i])*2*PI*freq[i] <> 0 THEN C1M = -(IMAG(Z.M.11[i])*2*PI*freq[i])^-1     !C1 at Port1
     END IF
     R12GndM =   REAL(Z.M.12[i])
     C12GndM = -(IMAG(Z.M.12[i])*2*PI*freq[i])^-1
     R2M = REAL(Z.M.22[i])                                                 !R2 at Port2
     IF VAL$(Branch12)=="R+L" THEN L2M =   IMAG(Z.M.22[i])//(2*PI*freq[i])      !L2 at Port2
     IF VAL$(Branch12)=="R+C" THEN
       C2M = 0
       IF IMAG(Z.M.22[i])*2*PI*freq[i] <> 0 THEN C2M = -(IMAG(Z.M.22[i])*2*PI*freq[i])^-1     !C2 at Port2
     END IF
     !---re-use array 'Z' and fill it with schematic component values
     IF VAL$(Branch12)=="R+L" THEN Z.M.11[i] = REAL(R1M) + j*REAL(L1M)	    !apply REAL() to cancel PEL calculation rounding errors
     IF VAL$(Branch12)=="R+C" THEN Z.M.11[i] = REAL(R1M) + j*REAL(C1M)
     Z.M.12[i] = REAL(R12GndM) + j*REAL(C12GndM)
     Z.M.21[i] = 0				
     IF VAL$(Branch12)=="R+L" THEN Z.M.22[i] = REAL(R2M) + j*REAL(L2M)
     IF VAL$(Branch12)=="R+C" THEN Z.M.22[i] = REAL(R2M) + j*REAL(C2M)
   NEXT i
 END IF
 
 !---simul.data
 IF MEAN(Z.S.11)<>0 THEN 
   FOR i=0  TO SIZEOF(Z)-1
     R1S = REAL(Z.S.11[i])                                                 !R1 at Port1
     IF VAL$(Branch12)=="R+L" THEN L1S =   IMAG(Z.S.11[i])//(2*PI*freq[i])        !L1 at Port1
     IF VAL$(Branch12)=="R+C" THEN
       C1S = 0
       IF IMAG(Z.S.11[i])*2*PI*freq[i] <> 0 THEN C1S = -(IMAG(Z.S.11[i])*2*PI*freq[i])^-1     !C1 at Port1
     END IF
     R12GndS =   REAL(Z.S.12[i])
     C12GndS = -(IMAG(Z.S.12[i])*2*PI*freq[i])^-1
     R2S = REAL(Z.S.22[i])                                                 !R2 at Port2
     IF VAL$(Branch12)=="R+L" THEN L2S =   IMAG(Z.S.22[i])//(2*PI*freq[i])      !L2 at Port2
     IF VAL$(Branch12)=="R+C" THEN
       C2S = 0
       IF IMAG(Z.S.22[i])*2*PI*freq[i] <> 0 THEN  C2S = -(IMAG(Z.S.22[i])*2*PI*freq[i])^-1     !C2 at Port2
     END IF
     !---re-use array 'Z' and fill it with schematic component values
     IF VAL$(Branch12)=="R+L" THEN Z.S.11[i] = REAL(R1S) + j*REAL(L1S)	    !apply REAL() to cancel PEL calculation rounding errors
     IF VAL$(Branch12)=="R+C" THEN Z.S.11[i] = REAL(R1S) + j*REAL(C1S)
     Z.S.12[i] = REAL(R12GndS) + j*REAL(C12GndS)
     Z.S.21[i] = 0				
     IF VAL$(Branch12)=="R+L" THEN Z.S.22[i] = REAL(R2S) + j*REAL(L2S)
     IF VAL$(Branch12)=="R+C" THEN Z.S.22[i] = REAL(R2S) + j*REAL(C2S)
   NEXT i
 END IF
 
 
 RETURN Z
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !    IF VAL$(Branch12)=="R+L" THEN    Z.11 = R1     + j*L1
 !    IF VAL$(Branch12)=="R+C" THEN    Z.11 = R1     + j*C1
 !                                     Z.12 = R12Gnd + j*C12Gnd				
 !                                     Z.21 = 0
 !    IF VAL$(Branch12)=="R+L" THEN    Z.22 = R2     + j*L2
 !    IF VAL$(Branch12)=="R+C" THEN    Z.22 = R2     + j*C2
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !              L1                 L2
 !             \/\/               \/\/
 ! port1 __   /    \    12       /    \   __   port2
 !  o---|__|-o      o---o-------o      o-|__|---o
 !       R1   \    /    |        \    /   R2
 !             -||-    ---C12Gnd  -||-
 !              C1     ---         C2
 !                      |
 !                      -
 !                     | |R12Gnd
 !                      -
 !                      |
 !                     ---
}
dataset
{
datasize BOTH 688 2 2
type MEAS
type SIMU
}
}
list PLOT "R1_"
list PLOT "C1_"
list PLOT "L1_"
list PLOT "C12Gnd_"
list PLOT "R12Gnd_"
list PLOT "R2_"
list PLOT "C2_"
list PLOT "L2_"
}
LINK XFORM "Z_diff" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 !---calculate differential mode Z-Parameters
 ! special thanks to Dr. RaphaÃ«l Valentin, XYtech Consulting Ltd., Hong Kong
 !
 ! Transformation 2-port Z-Parameters to differential port:
 !    v1 = i1*Z11 + i2*Z12
 !    v2 = i1*Z21 + i2*Z22
 ! be
 !    vdiff = v1 - v2
 ! then
 !    vdiff = i1*(Z11-Z21) - i2*(Z22-Z12)
 ! and
 !    idiff = i1 = -i2
 ! finally	
 !    vdiff = idiff* (Z11-Z12-Z21+Z22)
 ! what gives
 !    Zdiff = Z11-Z12-Z21+Z22
 
 GET_DATASET "Z_deemb", Z_deemb
 
 
 COMPLEX tmp_Zdiff.B[SIZEOF(Z_deemb)]
 
 FOR i=0 TO SIZEOF(tmp_Zdiff)-1
   tmp_Zdiff.M[i] = Z_deemb.M.11[i] - Z_deemb.M.12[i] - Z_deemb.M.21[i] + Z_deemb.M.22[i]
   tmp_Zdiff.S[i] = Z_deemb.S.11[i] - Z_deemb.S.12[i] - Z_deemb.S.21[i] + Z_deemb.S.22[i]
 NEXT i
 
 RETURN tmp_Zdiff
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! Note:
 ! the same result can be obtained by applying the (more complex) formula
 !  tmp_Zdiff = (Y.11 + Y.22 + 2*Y.12) / (Y.11*Y.22 - Y.12^2)
}
dataset
{
datasize BOTH 401 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "Z_comm" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !---calculate common mode Z-Parameters
 
 GET_DATASET "Y_deemb", Y_deemb
 
 
 COMPLEX tmp_Ycomm.B[SIZEOF(Y_deemb)]
 
 
 FOR i=0 TO SIZEOF(tmp_Ycomm)-1
   tmp_Ycomm.M[i] = Y_deemb.M.11[i] + Y_deemb.M.12[i] + Y_deemb.M.21[i] + Y_deemb.M.22[i]
   tmp_Ycomm.S[i] = Y_deemb.S.11[i] + Y_deemb.S.12[i] + Y_deemb.S.21[i] + Y_deemb.S.22[i]
 NEXT i
 
 
 RETURN tmp_Ycomm^-1
}
dataset
{
datasize BOTH 401 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "OnePort" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This program 
 !  -  converts 2-Port S-parameters to a virtual Oneport measurement/simulation,
 !     -> performed at Port1, *with Port2 ideally shorted*
 !        Port1_____
 !        o---|     |---o-|
 !       ==>  |     |
 !        o---|_____|---o
 !        |             |
 !       ---           ---
 !     -> or performed at Port2, *with Port1 ideally shorted*
 !               _____ Port2
 !        |-o---|     |---o
 !              |     |  <==
 !          o---|_____|---o
 !          |             |
 !         ---           ---
 !  -  calculates the Oneport impedance
 !
 !  -  and also the simple schematic interpretation as a
 !     series resistor - inductor
 !           ___R      L
 !     o----|___|----\/\/----o    
 !     
 !     and as a series resistor - capacitor
 !           ___R      C
 !     o----|___|-----||-----o    
 ! 
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 GET_DATASET "freq", freq
 GET_DATASET "S_deemb", S_deemb
 GET_STRING  "View from  [P1], [P2]", ViewFromPort
 
 
 
 !---converting Twoport S-parameters to Oneport
 COMPLEX S_1Port.B[SIZEOF(S_deemb)]
 FOR i=0 TO SIZEOF(S_1Port)-1
   IF MEAN(S_deemb.M.11)<>0 THEN 
     IF VAL$(ViewFromPort)=="P1" THEN
       S_1Port.M[i] = S_deemb.M.11[i] - S_deemb.M.12[i]*S_deemb.M.21[i]*(S_deemb.M.22[i]+1)^-1
     ELSE IF VAL$(ViewFromPort)=="P2" THEN
       S_1Port.M[i] = S_deemb.M.22[i] - S_deemb.M.12[i]*S_deemb.M.21[i]*(S_deemb.M.11[i]+1)^-1
     END IF
   END IF
   IF MEAN(S_deemb.S.11)<>0 THEN 
     IF VAL$(ViewFromPort)=="P1" THEN
       S_1Port.S[i] = S_deemb.S.11[i] - S_deemb.S.12[i]*S_deemb.S.21[i]*(S_deemb.S.22[i]+1)^-1
     ELSE IF VAL$(ViewFromPort)=="P2" THEN
       S_1Port.S[i] = S_deemb.S.22[i] - S_deemb.S.12[i]*S_deemb.S.21[i]*(S_deemb.S.11[i]+1)^-1
     END IF
   END IF
 NEXT i
 
 !---convert S1Port to impedance
 Z_1Port = 50*(1+S_1Port)//(1-S_1Port)
 
 !---get series resistor
 R_1Port = REAL(Z_1Port)
 
 !---get series inductor
 L_1Port = IMAG(Z_1Port)//(2*PI*freq)
 
 !---get series capacitor
 C_1Port = -(IMAG(Z_1Port)*2*PI*freq)^-1
 
 
 
 !---return the results
 COMPLEX tmp.B.22[SIZEOF(S_deemb)]
 FOR i=0 TO SIZEOF(tmp)-1
   tmp.M.11[i]=S_1Port.M[i]       !1-Port Spar
   tmp.S.11[i]=S_1Port.S[i]
   tmp.M.12[i]=Z_1Port.M[i]       !1-Port Impedance
   tmp.S.12[i]=Z_1Port.S[i]
   tmp.M.21[i]=REAL(R_1Port.M[i]) !Series Resistor
   tmp.S.21[i]=REAL(R_1Port.S[i])
   tmp.M.22[i]=REAL(L_1Port.M[i]) + j * REAL(C_1Port.M[i])      !Series Inductor + j * Series Capacitor
   tmp.S.22[i]=REAL(L_1Port.S[i]) + j * REAL(C_1Port.S[i])
 NEXT i
 
 
 RETURN tmp
 ! index_11:  1-Port Spar
 ! index_12:  1-Port Impedance
 ! index_21:  Series Resistor
 ! index_22:  Series Inductor + j * Series Capacitor
}
dataset
{
datasize BOTH 100 2 2
type MEAS
type SIMU
}
}
list XFORM "HOW2USE"
list PLOT "Z1Port"
list PLOT "R1Port"
list PLOT "L1Port"
list PLOT "C1Port"
list PLOT "S1Port"
}
LINK XFORM "___________________3" "711.501"
{
}
LINK XFORM "___3Port_______________" "711.501"
{
}
LINK XFORM "Y_to_Imped_3P" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 GLOBAL_VAR  ErrMsg
 
 
 GET_DATASET "3-Port Y-Parameters", Y
 
 
 !---calculate impedances from 3-Port Y-parameters
 !
 !   given:
 !   i1 = Y11 * v1 + Y12 * v2 + Y13 * v3 
 !   i2 = Y21 * v1 + Y22 * v2 + Y23 * v3
 !   i3 = Y31 * v1 + Y32 * v2 + Y33 * v3
 !
 !   requested             __      
 !          --------------|__|---------------
 !         |               Z12               |
 !  ==     |                                 |     ==
 !  P1 o---o--------o--           --o--------o---o P2
 !  ==     |           |         |           |     ==
 !         |           -         -           |
 !         |       Z13| |       | |Z23       |
 !         |           -         -           |
 !         |           |    3    |           |
 !         |            ----o--o-            |
 !         |                |   \      ==    |
 !         |                |     ---o P3    |  
 !         -                -          ==    - 
 !        | |Z10           | |Z30        Z20| |
 !         -                -                -  
 !         |                |                |        
 !        ---              ---              ---   
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 ErrMsg=""
 !---exit if not 3x3
 IF COLSOF(Y)<>3 THEN
   ErrMsg = "ERROR: data are not 3x3 !!!"
   COMPLEX tmp.B.33[SIZEOF(Y)]
   RETURN tmp
 END IF
 
 
 
 COMPLEX Z.B.33[SIZEOF(Y)]
 FOR i=0 TO SIZEOF(Z)-1
   !---impedances directly to ground (without all other branch impedances to ground)
   Y11M = Y.M.11[i]+Y.M.12[i]+Y.M.13[i]		! Z10
    IF Y11M<>0 THEN Z.M.11[i] = Y11M^-1
 
   Y11S = Y.S.11[i]+Y.S.12[i]+Y.S.13[i]
    IF Y11S<>0 THEN Z.S.11[i] = Y11S^-1
 
   Y22M = Y.M.21[i]+Y.M.22[i]+Y.M.23[i]		! Z20
    IF Y22M<>0 THEN Z.M.22[i] = Y22M^-1
 
   Y22S = Y.S.21[i]+Y.S.22[i]+Y.S.23[i]
    IF Y11S<>0 THEN Z.S.22[i] = Y22S^-1
 
   Y33M = Y.M.31[i]+Y.M.32[i]+Y.M.33[i]		! Z30
    IF Y33M<>0 THEN Z.M.33[i] = Y33M^-1
 
   Y33S = Y.S.31[i]+Y.S.32[i]+Y.S.33[i]
    IF Y33S<>0 THEN Z.S.33[i] = Y33S^-1
 
   !---inter-branch impedances
   IF Y.M.12[i]<>0 THEN Z.M.12[i] = -Y.M.12[i]^-1	! Z12 = Z21
   IF Y.S.12[i]<>0 THEN Z.S.12[i] = -Y.S.12[i]^-1
 
   IF Y.M.13[i]<>0 THEN Z.M.13[i] = -Y.m.13[i]^-1	! Z13 = Z31
   IF Y.S.13[i]<>0 THEN Z.S.13[i] = -Y.S.13[i]^-1
 
   IF Y.M.23[i]<>0 THEN Z.M.23[i] = -Y.M.23[i]^-1	! Z32 = Z23
   IF Y.S.23[i]<>0 THEN Z.S.23[i] = -Y.S.23[i]^-1
 NEXT i
 
 
 RETURN Z
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! Z.11:   Z10
 ! Z.22:   Z20
 ! Z.33:   Z30
 
 ! Z.12:   Z12 = Z21
 ! Z.13:   Z13 = Z31
 ! Z.23:   Z32 = Z23
 
 !                         __      
 !          --------------|__|---------------
 !         |               Z12               |
 !  ==     |                                 |     ==
 !  P1 o---o--------o--           --o--------o---o P2
 !  ==     |           |         |           |     ==
 !         |           -         -           |
 !         |       Z13| |       | |Z23       |
 !         |           -         -           |
 !         |           |    3    |           |
 !         |            ----o--o-            |
 !         |                |   \      ==    |
 !         |                |     ---o P3    |  
 !         -                -          ==    - 
 !        | |Z10           | |Z30        Z20| |
 !         -                -                -  
 !         |                |                |        
 !        ---              ---              ---   
}
dataset
{
datasize BOTH 21672 3 3
type MEAS
type SIMU
}
}
}
LINK XFORM "Imped_to_RLC_3P" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 GLOBAL_VAR  ErrMsg
 
 
 
 GET_DATASET "Impedances", Imped	!--> Input to this Program is usually the result of 'Y_to_Imped_3P'
 GET_DATASET "freq", freq
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This Program converts 3-Port Impedances (calculated by 'Y_to_Imped_3P')
 ! to the component values of the following schematic (inductor between P1&P2 with connection to P3):
 !                          __  12     
 !          ---------------|__|-o-||--------------------
 !         |                R12   C12                   |
 !  ==     |         __                     __          |     ==
 !  P1 o---o--------|__|-o--           --o-|__|---------o---o P2
 !  ==     |         R13    |         |    R23          |     ==
 !         |               <           >                |
 !         |            L13 >         < L23             |
 !         |               <           >                |
 !         |                |    3    |                 |
 !         |                 ----o--o-                  |
 !         |                     |   \         ==       |
 !        ---               C30 ---   -------o P3      ---             
 !    C10 ---                   ---            ==      --- C20         
 !         |                     |                      |              
 !         o10                   o30                  20o           
 !         |                     |                      |  
 !         -                     -                      - 
 !        | |R10                | |R30              R20| |
 !         -                     -                      -  
 !         |                     |                      |        
 !        ---                   ---                    ---   
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 ErrMsg = ""
 
 !---exit if not 3x3 or if array size mismatch
 IF (COLSOF(Imped)<>3) ORELSE (SIZEOF(Imped)<>SIZEOF(freq)) THEN
   ErrMsg = "ERROR: data are not 3x3, or SIZEOF(freq)<>SIZEOF(data) !!!"
   COMPLEX tmp.B.33[SIZEOF(Imped)]
   RETURN tmp
 END IF
 
 
 !---inter-branch
 R12 = REAL(Imped.12)
 ! C12:  see inside the loop below
 R13 = REAL(Imped.13)
 L13 = IMAG(Imped.13)//(2*PI*freq)
 R23 = REAL(Imped.23)
 L23 = IMAG(Imped.23)//(2*PI*freq)
 
 
 !---to ground
 R10 = REAL(Imped.11)
 ! C10:  see inside the loop below
 R20 = REAL(Imped.22)
 ! C20:  see inside the loop below
 R30 = REAL(Imped.33)
 ! C30:  see inside the loop below
 
 
 
 COMPLEX RLC.B.33[SIZEOF(Imped)]
 FOR i=0 TO SIZEOF(RLC)-1
   !---inter-branch
   RLC.M.13[i] = R13.M[i] + j * L13.M[i]
   RLC.S.13[i] = R13.S[i] + j * L13.S[i]
 
   RLC.M.23[i] = R23.M[i] + j * L23.M[i]
   RLC.S.23[i] = R23.S[i] + j * L23.S[i]
 
     C12M = 0
     IF IMAG(Imped.M.12[i]) <> 0 THEN C12M = -(IMAG(Imped.M.12[i])*2*PI*freq[i])^-1
     C12S = 0
     IF IMAG(Imped.S.12[i]) <> 0 THEN C12S = -(IMAG(Imped.S.12[i])*2*PI*freq[i])^-1
   RLC.M.12[i] = R12.M[i] + j * C12M
   RLC.S.12[i] = R12.S[i] + j * C12S
   !---to ground
     C10M = 0
     IF IMAG(Imped.M.11[i]) <> 0 THEN C10M = -(IMAG(Imped.M.11[i])*2*PI*freq[i])^-1
     C10S = 0
     IF IMAG(Imped.S.11[i]) <> 0 THEN C10S = -(IMAG(Imped.S.11[i])*2*PI*freq[i])^-1
   RLC.M.11[i] = R10.M[i] + j * C10M
   RLC.S.11[i] = R10.S[i] + j * C10S
 
     C20M = 0
     IF IMAG(Imped.M.22[i]) <> 0 THEN C20M = -(IMAG(Imped.M.22[i])*2*PI*freq[i])^-1
     C20S = 0
     IF IMAG(Imped.S.22[i]) <> 0 THEN C20S = -(IMAG(Imped.S.22[i])*2*PI*freq[i])^-1
   RLC.M.22[i] = R20.M[i] + j * C20M
   RLC.S.22[i] = R20.S[i] + j * C20S
 
     C30M = 0
     IF IMAG(Imped.M.33[i]) <> 0 THEN C30M = -(IMAG(Imped.M.33[i])*2*PI*freq[i])^-1
     C30S = 0
     IF IMAG(Imped.S.33[i]) <> 0 THEN C30S = -(IMAG(Imped.S.33[i])*2*PI*freq[i])^-1
   RLC.M.33[i] = R30.M[i] + j * C30M
   RLC.S.33[i] = R30.S[i] + j * C30S
 
 NEXT i
 
 
 RETURN RLC
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! inter-branch components (ordered after importance for above schematic):
 ! RLC.13:   R13  + j * L13
 ! RLC.23:   R23  + j * L23
 ! RLC.12:   R12  + j * C12
 
 
 ! to-ground components:
 ! RLC.11:   R10  + j * C10
 ! RLC.22:   R20  + j * C20
 ! RLC.33:   R30  + j * C30
}
dataset
{
datasize BOTH 21672 3 3
type MEAS
type SIMU
}
}
}
LINK XFORM "___________________4" "711.501"
{
}
LINK XFORM "___4Port_______________" "711.501"
{
}
LINK XFORM "Y_to_Imped_4P" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 GLOBAL_VAR  ErrMsg
 
 
 GET_DATASET "4-Port Y-Parameters", Y
 
 
 !---calculate impedances from 4-Port Y-parameters
 !
 !   given:
 !   i1 = Y11 * v1 + Y12 * v2 + Y13 * v3 + Y14 * v4
 !   i2 = Y21 * v1 + Y22 * v2 + Y23 * v3 + Y24 * v4
 !   i3 = Y31 * v1 + Y32 * v2 + Y33 * v3 + Y34 * v4
 !   i4 = Y41 * v1 + Y42 * v2 + Y43 * v3 + Y44 * v4
 !
 !   requested:
 !                             P4
 !                    ---------O---------
 !                  /         /|        /
 !                _/         / -      _/
 !            Z14/_/       _/ |_|Z40 /_/Z24     
 !               /     Z34/_/  |     /       
 ! P1           /  __     /   ---   /         P2
 !  O----------o--|__|-------------o----------O
 !  |         /    Z12  /         /           |
 !  -       _/         /        _/            -
 ! |_|Z10  /_/Z13     /     Z23/_/        Z20|_|
 !  |      /         /         /              |
 ! ---    /         /         /              ---
 !        ---------O---------                
 !                 |P3
 !                 -
 !                |_|Z30 
 !                 | 
 !                ---
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 ErrMsg = ""
 !---exit if not 4x4
 IF COLSOF(Y)<>4 THEN
   ErrMsg = "ERROR: data are not 4x4 !!!"
   COMPLEX tmp.B.44[SIZEOF(Y)]
   RETURN tmp
 END IF
 
 
 
 COMPLEX Z.B.44[SIZEOF(Y)]
 FOR i=0 TO SIZEOF(Z)-1
   !---impedances directly to ground (without all other branch impedances to ground)
   Y11M = Y.M.11[i]+Y.M.12[i]+Y.M.13[i]+Y.M.14[i]	! Z10
    IF Y11M<>0 THEN Z.M.11[i] = Y11M^-1
 
   Y11S = Y.S.11[i]+Y.S.12[i]+Y.S.13[i]+Y.S.14[i]
    IF Y11S<>0 THEN Z.S.11[i] = Y11S^-1
 
   Y22M = Y.M.21[i]+Y.M.22[i]+Y.M.23[i]+Y.M.24[i]	! Z20
    IF Y22M<>0 THEN Z.M.22[i] = Y22M^-1
 
   Y22S = Y.S.21[i]+Y.S.22[i]+Y.S.23[i]+Y.S.24[i]
    IF Y11S<>0 THEN Z.S.22[i] = Y22S^-1
 
   Y33M = Y.M.31[i]+Y.M.32[i]+Y.M.33[i]+Y.M.34[i]	! Z30
    IF Y33M<>0 THEN Z.M.33[i] = Y33M^-1
 
   Y33S = Y.S.31[i]+Y.S.32[i]+Y.S.33[i]+Y.S.34[i]
    IF Y33S<>0 THEN Z.S.33[i] = Y33S^-1
 
   Y44M = Y.M.41[i]+Y.M.42[i]+Y.M.43[i]+Y.M.44[i]	! Z40
    IF Y44M<>0 THEN Z.M.44[i] = Y44M^-1
 
   Y44S = Y.S.41[i]+Y.S.42[i]+Y.S.43[i]+Y.S.44[i]
    IF Y44S<>0 THEN Z.S.44[i] = Y44S^-1
 
   !---inter-branch impedances
   IF Y.M.12[i]<>0 THEN Z.M.12[i] = -Y.M.12[i]^-1	! Z12 = Z21
   IF Y.S.12[i]<>0 THEN Z.S.12[i] = -Y.S.12[i]^-1
 
   IF Y.M.13[i]<>0 THEN Z.M.13[i] = -Y.M.13[i]^-1	! Z13 = Z31
   IF Y.S.13[i]<>0 THEN Z.S.13[i] = -Y.S.13[i]^-1
 
   IF Y.M.14[i]<>0 THEN Z.M.14[i] = -Y.M.14[i]^-1	! Z14 = Z41
   IF Y.S.14[i]<>0 THEN Z.S.14[i] = -Y.S.14[i]^-1
 
   IF Y.M.23[i]<>0 THEN Z.M.23[i] = -Y.M.23[i]^-1	! Z32 = Z23
   IF Y.S.23[i]<>0 THEN Z.S.23[i] = -Y.S.23[i]^-1
 
   IF Y.M.24[i]<>0 THEN Z.M.24[i] = -Y.M.24[i]^-1	! Z32 = Z23
   IF Y.S.24[i]<>0 THEN Z.S.24[i] = -Y.S.24[i]^-1
 
   IF Y.M.34[i]<>0 THEN Z.M.34[i] = -Y.M.34[i]^-1	! Z34 = Z43
   IF Y.S.34[i]<>0 THEN Z.S.34[i] = -Y.S.34[i]^-1
 NEXT i
 
 
 RETURN Z
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! Z.11:   Z10
 ! Z.22:   Z20
 ! Z.33:   Z30
 ! Z.44:   Z40
 
 ! Z.12:   Z12 = Z21
 ! Z.13:   Z13 = Z31
 ! Z.14:   Z14 = Z41
 ! Z.23:   Z32 = Z23
 ! Z.34:   Z34 = Z43
 
 !                             P4
 !                    ---------O---------
 !                  /         /|        /
 !                _/         / -      _/
 !            Z14/_/       _/ |_|Z40 /_/Z24     
 !               /     Z34/_/  |     /       
 ! P1           /  __     /   ---   /         P2
 !  O----------o--|__|-------------o----------O
 !  |         /    Z12  /         /           |
 !  -       _/         /        _/            -
 ! |_|Z10  /_/Z13     /     Z23/_/        Z20|_|
 !  |      /         /         /              |
 ! ---    /         /         /              ---
 !        ---------O---------                
 !                 |P3
 !                 -
 !                |_|Z30 
 !                 | 
 !                ---
}
dataset
{
datasize BOTH 7800 4 4
type MEAS
type SIMU
}
}
}
LINK XFORM "Imped_to_RLC_4P" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 GLOBAL_VAR  ErrMsg
 
 
 
 GET_DATASET "Impedances", Imped	!--> Input to this Program is usually the result of 'Y_to_Imped_4P'
 GET_DATASET "freq", freq
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This Program converts 4-Port Impedances (calculated by 'Y_to_Imped_4P')
 ! to the component values of the following schematic (inductor between P1&P2 with connection to P3, plus guard ring at P4):
 !                                                 ==
 !                                               o P4
 !                                              /  ==
 !                   --------------------------o------------------
 !                  /                         /|                 /
 !                 /                         / |                /
 !                /                         / ---              /
 !              _/                        _/  --- C40        _/
 !             /_/R14                R34 /_/   |            /_/R24
 !             /                         /     -            /
 !           ---                       ---    |_|R40      ---
 !          --- C14               C34 ---      |         --- C24
 !          /             __          /       ---        /
 !         o-------------|__|-o-||---/------------------o
 !         |              R12  C12  /                   |
 !  ==     |         __            /        __          |     ==
 !  P1 o---o--------|__|-o--      /    --o-|__|---------o---o P2
 !  ==     |         R13    |    |    |    R23          |     ==
 !         |               <     |     >                |
 !         |            L13 >    |    < L23             |
 !         |               <     |     >                |
 !         |                |    |    |                 |
 !         |                 ----o--o-                  |
 !         |                     |   \         ==       |
 !        ---               C30 ---   -------o P3      ---             
 !    C10 ---                   ---            ==      --- C20         
 !         |                     |                      |              
 !         o10                   o30                  20o           
 !         |                     |                      |  
 !         -                     -                      - 
 !        |_|R10                |_|R30              R20|_|
 !         |                     |                      |        
 !        ---                   ---                    ---   
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 ErrMsg = ""
 
 !---exit if not 4x4 or if array size mismatch
 IF (COLSOF(Imped)<>4) ORELSE (SIZEOF(Imped)<>SIZEOF(freq)) THEN
   ErrMsg = "ERROR: data are not 4x4, or SIZEOF(freq)<>SIZEOF(data) !!!"
   COMPLEX tmp.B.44[SIZEOF(Imped)]
   RETURN tmp
 END IF
 
 
 !---to ground
 R10 = REAL(Imped.11)
 ! C10:  see inside the loop below
 R20 = REAL(Imped.22)
 ! C20:  see inside the loop below
 R30 = REAL(Imped.33)
 ! C30:  see inside the loop below
 R40 = REAL(Imped.44)
 ! C40:  see inside the loop below
 
 
 !---inter-branch
 R13 = REAL(Imped.13)
 L13 = IMAG(Imped.13)//(2*PI*freq)
 R23 = REAL(Imped.23)
 L23 = IMAG(Imped.23)//(2*PI*freq)
 R12 = REAL(Imped.12)
 ! C12:  see inside the loop below
 R14 = REAL(Imped.14)
 ! C14:  see inside the loop below
 R24 = REAL(Imped.24)
 ! C24:  see inside the loop below
 R34 = REAL(Imped.34)
 ! C12:  see inside the loop below
 
 
 
 COMPLEX RLC.B.44[SIZEOF(Imped)]
 FOR i=0 TO SIZEOF(RLC)-1
   !---P1 to ground: C&R
     C10M = 0
     IF IMAG(Imped.M.11[i]) <> 0 THEN C10M = -(IMAG(Imped.M.11[i])*2*PI*freq[i])^-1
     C10S = 0
     IF IMAG(Imped.S.11[i]) <> 0 THEN C10S = -(IMAG(Imped.S.11[i])*2*PI*freq[i])^-1
   RLC.M.11[i] = R10.M[i] + j * C10M
   RLC.S.11[i] = R10.S[i] + j * C10S
 
   !---P2 to ground: C&R
     C20M = 0
     IF IMAG(Imped.M.22[i]) <> 0 THEN C20M = -(IMAG(Imped.M.22[i])*2*PI*freq[i])^-1
     C20S = 0
     IF IMAG(Imped.S.22[i]) <> 0 THEN C20S = -(IMAG(Imped.S.22[i])*2*PI*freq[i])^-1
   RLC.M.22[i] = R20.M[i] + j * C20M
   RLC.S.22[i] = R20.S[i] + j * C20S
 
   !---P3 to ground: C&R
     C30M = 0
     IF IMAG(Imped.M.33[i]) <> 0 THEN C30M = -(IMAG(Imped.M.33[i])*2*PI*freq[i])^-1
     C30S = 0
     IF IMAG(Imped.S.33[i]) <> 0 THEN C30S = -(IMAG(Imped.S.33[i])*2*PI*freq[i])^-1
   RLC.M.33[i] = R30.M[i] + j * C30M
   RLC.S.33[i] = R30.S[i] + j * C30S
 
   !---P4 to ground: C&R
     C40M = 0
     IF IMAG(Imped.M.44[i]) <> 0 THEN C40M = -(IMAG(Imped.M.44[i])*2*PI*freq[i])^-1
     C40S = 0
     IF IMAG(Imped.S.44[i]) <> 0 THEN C40S = -(IMAG(Imped.S.44[i])*2*PI*freq[i])^-1
   RLC.M.44[i] = R40.M[i] + j * C40M
   RLC.S.44[i] = R40.S[i] + j * C40S
 
 
   !---inter-branch----------------------------------
   !---P1 to P3:   R&L
   RLC.M.13[i] = R13.M[i] + j * L13.M[i]
   RLC.S.13[i] = R13.S[i] + j * L13.S[i]
 
   !---P2 to P3:   R&L
   RLC.M.23[i] = R23.M[i] + j * L23.M[i]
   RLC.S.23[i] = R23.S[i] + j * L23.S[i]
 
   !---P1 to P2:   C&R
     C12M = 0
     IF IMAG(Imped.M.12[i]) <> 0 THEN C12M = -(IMAG(Imped.M.12[i])*2*PI*freq[i])^-1
     R12S = REAL(Imped.S.12[i])
     C12S = 0
     IF IMAG(Imped.S.12[i]) <> 0 THEN C12S = -(IMAG(Imped.S.12[i])*2*PI*freq[i])^-1
   RLC.M.12[i] = R12.M[i] + j * C12M
   RLC.S.12[i] = R12.S[i] + j * C12S
 
   !---P1 to P4:   C&R
     C14M = 0
     IF IMAG(Imped.M.14[i]) <> 0 THEN C14M = -(IMAG(Imped.M.14[i])*2*PI*freq[i])^-1
     R14S = REAL(Imped.S.14[i])
     C14S = 0
     IF IMAG(Imped.S.14[i]) <> 0 THEN C14S = -(IMAG(Imped.S.14[i])*2*PI*freq[i])^-1
   RLC.M.14[i] = R14.M[i] + j * C14M
   RLC.S.14[i] = R14.S[i] + j * C14S
 
   !---P2 to P4:   C&R
     C24M = 0
     IF IMAG(Imped.M.24[i]) <> 0 THEN C24M = -(IMAG(Imped.M.24[i])*2*PI*freq[i])^-1
     R24S = REAL(Imped.S.24[i])
     C24S = 0
     IF IMAG(Imped.S.24[i]) <> 0 THEN C24S = -(IMAG(Imped.S.24[i])*2*PI*freq[i])^-1
   RLC.M.24[i] = R24.M[i] + j * C24M
   RLC.S.24[i] = R24.S[i] + j * C24S
 
   !---P3 to P4:   C&R
     C34M = 0
     IF IMAG(Imped.M.34[i]) <> 0 THEN C34M = -(IMAG(Imped.M.34[i])*2*PI*freq[i])^-1
     R34S = REAL(Imped.S.34[i])
     C34S = 0
     IF IMAG(Imped.S.34[i]) <> 0 THEN C34S = -(IMAG(Imped.S.34[i])*2*PI*freq[i])^-1
   RLC.M.34[i] = R34.M[i] + j * C34M
   RLC.S.34[i] = R34.S[i] + j * C34S
 NEXT i
 
 RETURN RLC
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! inter-branch components (ordered after importance for above schematic):
 ! RLC.13:   R13  + j * L13
 ! RLC.23:   R23  + j * L23
 ! RLC.12:   R12  + j * C12
 ! RLC.14:   R14  + j * C14
 ! RLC.24:   R24  + j * C24
 ! RLC.34:   R34  + j * C34
 
 
 ! to-ground components:
 ! RLC.11:   R10  + j * C10
 ! RLC.22:   R20  + j * C20
 ! RLC.33:   R30  + j * C30
 ! RLC.44:   R40  + j * C40
}
dataset
{
datasize BOTH 7800 4 4
type MEAS
type SIMU
}
}
}
LINK XFORM "___________________5" "711.501"
{
}
LINK XFORM "___nPort_______________" "711.501"
{
}
LINK XFORM "S_to_Y" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 !------------------------------------------------------
 !---convert S-params to Y-params, for any nr. of ports
 !------------------------------------------------------
 
 
 
 GET_DATASET "Spar", Spar.B
 
 
 Z0 = 50
 !---calc. the identity matrix
 E = Spar^0 	!that's lousy, but simple
 !---calc. Multi-Port Y-Parameters
 Ypar =  1//Z0*(E - Spar)//(E + Spar)
 
 
 RETURN Ypar
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! How to interpret the returned dataset:
 ! Ypar.11^-1 = Z1: impedance at Port1 @ all other Ports ideally shorted (R=0)
 ! Ypar.22^-1 = Z2: impedance at Port2 @ all other Ports ideally shorted (R=0)
 ! Ypar.33^-1 = Z3: impedance at Port3 @ all other Ports ideally shorted (R=0)
 !  ...
 !  ...
 ! Ypar.nn^-1 = Zn: impedance at Portn @ all other Ports ideally shorted (R=0)
 !
 ! Ypar.xy^-1 = 
}
dataset
{
datasize BOTH 21672 3 3
type MEAS
type SIMU
}
}
}
LINK XFORM "___________________6" "711.501"
{
}
LINK XFORM "Netlists4Verific" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 RETURN_VALUE 1
 
 
 ******************************************
 .SUBCKT PI_Ckt_CR12 P1=1 P2=2 
 
 C10  1 10 .1p
 R10 10  0 100
 
 C12  1 12 1.2p
 R12 12  2 12
 
 C20  2 20 .2p
 R20 20  0 200
 
 .ENDS
 
 
 
 ******************************************
 .SUBCKT PI_Ckt_LR12 P1=1 P2=2 
 
 C10  1 10 .1p
 R10 10  0 100
 
 L12  1 12 1.2n
 R12 12  2 12
 
 C20  2 20 .2p
 R20 20  0 200
 
 .ENDS
 
 
 
 ***********************************************************************************
 .SUBCKT TEE_Ckt_CR12 P1=1 P2=2 
 
 C1  1 11 1p
 R1 11 12 10
 
 C120  12 120 .12p
 R120 120   0 12
 
 R2 12 22 20
 C2 22  2 2p
 
 .ENDS
 
 
 
 ******************************************
 
 .SUBCKT TEE_Ckt_LR12 P1=1 P2=2 
 
 L1  1 11 1n
 R1 11 12 10
 
 C120  12 120 .12p
 R120 120   0 12
 
 R2 12 22 20
 L2 22  2 2n
 
 .ENDS
 
 
 
 ***3Port************************************
 
 * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 *         3Port SPIRAL INDUCTOR MODEL
 * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 *
 *                          __  12     
 *          ---------------|__|-o-||--------------------
 *         |               RsC12  C12                   |
 *  ==     |         __  11             22  __          |     ==
 *  P1 o---o--------|__|-o--           --o-|__|---------o---o P2
 *  ==     |         R13    |         |    R23          |     ==
 *         |               <           >                |
 *         |            L13 >         < L23             |
 *         |               <           >                |
 *         |                |         |                 |
 *         |                 ----o--o-                  |
 *         |                     |   \         ==       |
 *        ---               C30 ---   -------o P3      ---             
 *    C10 ---                   ---            ==      --- C20         
 *         |                     |                      |              
 *         o10                   o30                  20o           
 *         |                     |                      |  
 *         -                     -                      - 
 *        | |R10                | |R30              R20| |
 *         -                     -                      -  
 *         |                     |                      |        
 *        ---                   ---                    ---   
 
 
 
 subckt SPIRAL_3Port  (P1  P2  P3)
 
 
 *DC path to ground  (just in case)
 Rdummy1 (P1 0) resistor r=(1G)
 Rdummy2 (P2 0) resistor r=(1G)
 Rdummy3 (P3 0) resistor r=(1G)
 
 
 *---inter-branch components
 R13    (P1   11) resistor  r=13
 L13    (11   P3) inductor  l=13n
 C12    (P1   12) capacitor c=12p
 RsC12  (12   P2) resistor  r=12
 L32    (P3   22) inductor  l=32n
 R32    (22   P2) resistor  r=32
   
 
 *---Port1 -> Ground
 C10     (P1  10) capacitor  c=10p
 R10     (10   0) resistor   r=10
 
 *---Port2 -> Ground
 C20     (P2  20)  capacitor  c=20p
 R20     (20   0)  resistor   r=20
 
 *---Port3 -> Ground
 C30    (P3   30) capacitor   c=30p
 R30    (30    0) resistor    r=30
 
 ends SPIRAL_3Port
 
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK PLOT "_MP_Spar_" "711.501"
{
View draw_ds 0 "B,0,-29328"
View plot_window 0 "69,53,25637,21047,{S11:AUTO|RI|RI: 50.00m, 150.0m, 250.0m,5,5,5,5&S12:AUTO|RI|RI: 117.5m, 7.500m, 12.50m,5,5,5,5&S21:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&S22:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "0"
element "Orientation" "H"
element "Plots Per Row" "2"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "S11"
element "Plot 1" "S12"
element "Plot 2" "S21"
element "Plot 3" "S22"
}
HYPTABLE "Multi GUI Table"
{
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S11" "711.501"
{
View plot_window 0 "4,23,9005,8990,{MAN|RI|RI: 50.00m,-50.00m, 150.0m,6,5,6,5}"
View draw_ds 0 "B,0,-26568"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "Smith Data 0" "S_deemb.M.11"
element "Smith Data 1" "S_deemb.S.11"
element "Smith Data 2" ""
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S12" "711.501"
{
View plot_window 0 "4,23,9005,8995,{AUTO|RI|RI: 50.0000m,-50.0000m, 250.000m,5,5,5,5}"
View draw_ds 0 "B,0,-23196"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "Polar Data 0" "S_deemb.M.12"
element "Polar Data 1" "S_deemb.S.12"
element "Polar Data 2" ""
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S21" "711.501"
{
View plot_window 0 "4,23,9005,8990,{MAN|RI|RI: 1.050 ,-50.00m, 100.0m,4,5,4,5}"
View draw_ds 0 "B,0,-19824"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "Polar Data 0" "S_deemb.M.21"
element "Polar Data 1" "S_deemb.S.21"
element "Polar Data 2" ""
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S22" "711.501"
{
View plot_window 0 "4,23,9005,8995,{AUTO|RI|RI: 1.00000 ,-50.0000m, 100.000m,4,5,4,5}"
View draw_ds 0 "B,0,-16452"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "Smith Data 0" "S_deemb.M.22"
element "Smith Data 1" "S_deemb.S.22"
element "Smith Data 2" ""
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_MP_S2PI_" "711.501"
{
View draw_ds 0 "B,0,-13080"
View plot_window 0 "39,364,39479,12445,{Z10:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&Z12:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&Z20:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "3"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "Z10"
element "Plot 1" "Z12"
element "Plot 2" "Z20"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_PI_Schematic"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "Z10" "711.501"
{
View draw_ds 0 "B,0,-10116"
View plot_window 0 "929,370,8998,8998,{AUTO|RI|RI: 0.000 , 0.000 , 100.0K,4,5,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z10"
element "Footer" ""
element "RI Data 0" "S_to_PI.M.11!!Z10.M"
element "RI Data 1" "S_to_PI.S.11!!Z10.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_PI"
}
LINK PLOT "Z12" "711.501"
{
View draw_ds 0 "B,0,-6744"
View plot_window 0 "382,697,10629,8990,{MAN|XY| 700.0 , 820.0 ,6,4:-80.00 , 20.00 ,6,4: 0.000 , 1.000 ,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z12"
element "Footer" ""
element "RI Data 0" "S_to_PI.M.12!!Z12.M"
element "RI Data 1" "S_to_PI.S.12!!Z12.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_PI"
}
LINK PLOT "Z20" "711.501"
{
View draw_ds 0 "B,0,-3372"
View plot_window 0 "716,313,9005,8995"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z20"
element "Footer" ""
element "RI Data 0" "S_to_PI.M.22!!Z20.M"
element "RI Data 1" "S_to_PI.S.22!!Z20.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_PI"
}
LINK PLOT "_MP_PI2CLR_" "711.501"
{
View draw_ds 0 "B,0,0"
View plot_window 0 "4,0,44176,25947"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "6"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "C10_"
element "Plot 1" "L12_"
element "Plot 2" "C20_"
element "Plot 3" "R10_"
element "Plot 4" "R12_"
element "Plot 5" "R20_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_PI_Schematic_L12"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "C10_" "711.501"
{
View plot_window 0 "37,293,9005,8995,{AUTO|XY| 0.00000 , 40.0000G,4,5: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,3576"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.11)!!C10.M"
element "Y Data 1" "IMAG(PI_to_CLR.S.11)!!C10.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
}
LINK PLOT "R10_" "711.501"
{
View plot_window 0 "415,468,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 600.000 ,6,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,7764"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_to_CLR.M.11)!!R10.M"
element "Y Data 1" "REAL(PI_to_CLR.S.11)!!R10.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
}
LINK PLOT "L12_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 100.0MEG, 100.0G,3,9:-4.000n, 8.000n,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,11952"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "L12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.12)!!L12.M"
element "Y Data 1" "IMAG(PI_to_CLR.S.12)!!L12.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
}
LINK PLOT "R12_" "711.501"
{
View plot_window 0 "845,266,9005,8995,{AUTO|XY| 100.000MEG, 10.0000G,2,9: 793.000 , 797.000 ,4,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,16140"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_to_CLR.M.12)!!R12.M"
element "Y Data 1" "REAL(PI_to_CLR.S.12)!!R12.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
}
LINK PLOT "C12_" "711.501"
{
View plot_window 0 "4,23,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9:-4.00000n, 8.00000n,6,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,20328"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.12)!!C12.M"
element "Y Data 1" "IMAG(PI_to_CLR.S.12)!!C12.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
}
LINK PLOT "C20_" "711.501"
{
View plot_window 0 "138,147,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,24516"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.22)!!C20.M"
element "Y Data 1" "IMAG(PI_to_CLR.S.22)!!C20.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
}
LINK PLOT "R20_" "711.501"
{
View plot_window 0 "728,323,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 300.000 ,6,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,28704"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_to_CLR.M.22)!!R20.M"
element "Y Data 1" "REAL(PI_to_CLR.S.22)!!R20.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
}
LINK PLOT "_MP_1Port_" "711.501"
{
View plot_window 0 "4,0,40080,25947,{S_1Port:AUTO|RI|RI: 885.0m,-5.000m, 25.00m,5,5,5,5&Z_1Port:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&R_1Port:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&L_1Port:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC}"
View draw_ds 0 "B,0,32892"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "A"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "2"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "S1Port"
element "Plot 1" "Z1Port"
element "Plot 2" "R1Port"
element "Plot 3" "L1Port"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_OnePort_Schematic_RL"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "Z1Port" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 100.0MEG, 100.0G,3,9:-4.000n, 8.000n,6,4:AUTOMATIC}"
View draw_ds 0 "B,0,36060"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z_1Port"
element "Footer" ""
element "RI Data 0" "OnePort.M.12!!Z_1Port.M"
element "RI Data 1" "OnePort.S.12!!Z_1Port.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "OnePort"
}
LINK PLOT "R1Port" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 100.0MEG, 100.0G,3,9:-20.00 , 100.0 ,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,39432"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R_1Port"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(OnePort.M.21)!!R_1Port.M"
element "Y Data 1" "REAL(OnePort.S.21)!!R_1Port.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "OnePort"
}
LINK PLOT "L1Port" "711.501"
{
View plot_window 0 "4,23,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9:-4.00000n, 8.00000n,6,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,43620"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "L_1Port"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(OnePort.M.22)!!L_1Port.M"
element "Y Data 1" "REAL(OnePort.S.22)!!L_1Port.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "OnePort"
}
LINK PLOT "C1Port" "711.501"
{
View plot_window 0 "4,23,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9:-4.00000n, 8.00000n,6,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,47808"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C_1Port"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(OnePort.M.22)!!C_1Port.M"
element "Y Data 1" "IMAG(OnePort.S.22)!!C_1Port.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "OnePort"
}
LINK PLOT "_MP_S2TEE_" "711.501"
{
View draw_ds 0 "B,0,51996"
View plot_window 0 "83,470,39479,12445,{Z1:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&Z12Gnd:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&Z2:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "3"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "Z1"
element "Plot 1" "Z12Gnd"
element "Plot 2" "Z2"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_TEE_Schematic"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "Z1" "711.501"
{
View draw_ds 0 "B,0,54960"
View plot_window 0 "929,370,8998,8998,{AUTO|RI|RI: 0.000 , 0.000 , 100.0K,4,5,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z1"
element "Footer" ""
element "RI Data 0" "S_to_TEE.M.11!!Z1.M"
element "RI Data 1" "S_to_TEE.S.11!!Z1.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_TEE"
}
LINK PLOT "Z12Gnd" "711.501"
{
View draw_ds 0 "B,0,58332"
View plot_window 0 "382,697,10629,8990,{MAN|XY| 700.0 , 820.0 ,6,4:-80.00 , 20.00 ,6,4: 0.000 , 1.000 ,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z12Gnd"
element "Footer" ""
element "RI Data 0" "S_to_TEE.M.12!!Z12Gnd.M"
element "RI Data 1" "S_to_TEE.S.12!!Z12Gnd.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_TEE"
}
LINK PLOT "Z2" "711.501"
{
View draw_ds 0 "B,0,61704"
View plot_window 0 "716,313,9005,8995"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z20"
element "Footer" ""
element "RI Data 0" "S_to_TEE.M.22!!Z2.M"
element "RI Data 1" "S_to_TEE.S.22!!Z2.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_TEE"
}
LINK PLOT "_MP_TEE2CLR_" "711.501"
{
View draw_ds 0 "B,0,65076"
View plot_window 0 "4,0,44176,25947,{C1:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&C12Gnd:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&C2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&R1:MAN|XY| 10.00MEG, 10.00G,3,9:-10.00 , 10.00 ,4,5: 0.000 , 1.000 ,4,5&R12Gnd:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&R2:MAN|XY| 10.00MEG, 10.00G,3,9:-6.000 , 8.000 ,7,4: 0.000 , 1.000 ,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "6"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "C1_"
element "Plot 1" "C12Gnd_"
element "Plot 2" "C2_"
element "Plot 3" "R1_"
element "Plot 4" "R12Gnd_"
element "Plot 5" "R2_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_TEE_Schematic_C1C2"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "R1_" "711.501"
{
View plot_window 0 "415,468,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 600.000 ,6,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,68652"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R1"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(TEE_to_CLR.M.11)!!R1.M"
element "Y Data 1" "REAL(TEE_to_CLR.S.11)!!R1.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "C1_" "711.501"
{
View plot_window 0 "37,293,9005,8995,{AUTO|XY| 0.00000 , 40.0000G,4,5: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,72840"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C1"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(TEE_to_CLR.M.11)!!C1.M"
element "Y Data 1" "IMAG(TEE_to_CLR.S.11)!!C1.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "L1_" "711.501"
{
View plot_window 0 "37,293,9005,8995,{AUTO|XY| 0.00000 , 40.0000G,4,5: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,77028"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "L1"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(TEE_to_CLR.M.11)!!L1.M"
element "Y Data 1" "IMAG(TEE_to_CLR.S.11)!!L1.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "C12Gnd_" "711.501"
{
View plot_window 0 "37,293,9005,8995,{AUTO|XY| 0.00000 , 40.0000G,4,5: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,81216"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C12Gnd"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(TEE_to_CLR.M.12)!!C12Gnd.M"
element "Y Data 1" "IMAG(TEE_to_CLR.S.12)!!C12Gnd.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "R12Gnd_" "711.501"
{
View plot_window 0 "415,468,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 600.000 ,6,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,85404"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R12Gnd"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(TEE_to_CLR.M.12)!!R12Gnd.M"
element "Y Data 1" "REAL(TEE_to_CLR.S.12)!!R12Gnd.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "R2_" "711.501"
{
View plot_window 0 "415,468,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 600.000 ,6,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,89592"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R2"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(TEE_to_CLR.M.22)!!R2.M"
element "Y Data 1" "REAL(TEE_to_CLR.S.22)!!R2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "C2_" "711.501"
{
View plot_window 0 "37,293,9005,8995,{AUTO|XY| 0.00000 , 40.0000G,4,5: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,93780"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C2"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(TEE_to_CLR.M.22)!!C2.M"
element "Y Data 1" "IMAG(TEE_to_CLR.S.22)!!C2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "L2_" "711.501"
{
View plot_window 0 "37,293,9005,8995,{AUTO|XY| 0.00000 , 40.0000G,4,5: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,97968"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "L2"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(TEE_to_CLR.M.22)!!L2.M"
element "Y Data 1" "IMAG(TEE_to_CLR.S.22)!!L2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "TEE_to_CLR"
}
LINK PLOT "S1Port" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|RI|RI: 1.000 ,-50.00m, 100.0m,4,5,4,5}"
View draw_ds 0 "B,0,102156"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S_deemb 1Port"
element "Footer" ""
element "Smith Data 0" "OnePort.M.11!!S_1Port.M"
element "Smith Data 1" "OnePort.S.11!!S_1Port.S"
element "Smith Data 2" ""
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "OnePort"
}
data "711.501"
{
}
}
LINK DAT "SPAR_KEYFIGURES" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "2.0771179957927 9378 7089"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 C10 C10 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "K_Factor_How2Use" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! This example is how to call 'K_Factor' from your own ModelFile.
 
 !---cut here-----------------------------------------------------------
 
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/K_Factor", S_deemb)
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "K_Factor" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !---Devices with a K-factor K > 1 while  0 < D < 1 are considered as 
 !   unconditionally stable, meaning they will not oscillate due to load mismatch.
 !   In this case, any impedance connected to the ports of the two-port will not 
 !   cause oscillation. 
 !   In general, transistors have K < 1 for certain frequencies,
 !   particularly lower frequencies, and therefore, are only stable 
 !   for certain impedance values. 
 !
 !---Due to its inclusion of all four S-Parameters, the K-Factor can be applied
 !   as a measure for the global S-Parameter fit.
 
 
 GET_DATASET "S_deemb", S_deemb
 
 !---calculate the S-Parameter Determinant
 D = S_deemb.11 * S_deemb.22 - S_deemb.12 * S_deemb.21
 
 !---stability factor K:
 K  = (1 + MAG(D)^2 - MAG(S_deemb.11)^2 - MAG(S_deemb.22)^2)//(2*MAG(S_deemb.12*S_deemb.21))
 
 
 
 RETURN REAL(K) + j*MAG(D)	 ! K-Factor + j*MAG(Determinant)
 
}
dataset
{
datasize BOTH 2912 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "_______________________1" "711.501"
{
}
LINK XFORM "PowerGain_How2Use" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! This example is how to call 'PowerGain' from your own ModelFile.
 
 
 !---cut here-----------------------------------------------------------
 
 ! This Program returns Mason's Power Gain, 
 ! which -different to the Unilateral Gain-
 ! considers power transmission Port1->Port2 and also Port2->Port1.
 
 
 ! ================================================================
 ! Note: in Plots, applying a dB scale, 
 ! IC-CAP applies 20*LOG10   (i.e. voltage dB).
 ! However, Max.Avail.Gain and Mason's Gain are specified as 10*LOG10(MAG)  (i.e. power dB)
 ! Therefore, this Transform returns
 !    10*LOG10(Gmax)
 ! to be displayed in the Plot on a lin. scaled y-axis.
 ! ================================================================
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/PowerGain", S_deemb)
 
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PowerGain" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 ! This Program returns Mason's Power Gain, 
 ! which -different to the Unilateral Gain-
 ! considers power transmission Port1->Port2 and also Port2->Port1.
 ! Special thanks to Dr.Juergen Luginsland from Qimonda for the PEL implementation.
 ! -> Mason's Gain (Gmax in the code below) 
 !    is only defined for  K_Factor K>1 and Stability Sign B>0.
 ! -> MSG (maximum stable gain) is calculated as MAG(S21/S12).
 ! If K>1 and the stability B>0, the result is Gmax = MSG*(K-SQRT(K^2-1)).
 ! For K=1, MSG becomes equal to Gmax.
 ! Note that, because it is a power gain, Mason's PowerGain rolls off 
 !      by 2 decades per decade of freq.
 !     Therefore, when compared with H21, it needs to be displayed by SQRT(U)
 
 GET_DATASET "S_deemb", S_deemb
 
 
 !---first calculate the K-Factor
 KjD = EVALUATE_TRANSFORM("K_Factor", S_deemb)
 !   get the determinant
 determ = IMAG(KjD)
 !   stability factor K:
 stab_fact_K  = REAL(KjD)
 
 !---stability sign B:
 stab_sign_B = 1 + MAG(S_deemb.11)^2 - MAG(S_deemb.22)^2 + MAG(determ)^2
 
 
 ! Stability is given for K > 1 and B > 0.
 !    then maximum available Gain Gmax is defined as: 
 !	Gmax = |(S_deemb21 / S_deemb12)| * (K-SQRT(K^2-1))
 !    else maximum stable Gain is defined as:
 !       Gmax = |(S_deemb21 / S_deemb12)|
 Gmax  = MAG(S_deemb.21//S_deemb.12)^2
 
 FOR i=0 TO SIZEOF(S_deemb)-1
    IF stab_fact_K.m[i] > 1 ANDALSO stab_sign_B.m[i] > 0 THEN
       Gmax.m[i] = Gmax.m[i] * (stab_fact_K.m[i] - SQRT(stab_fact_K.m[i]^2 - 1))
    END IF
    IF stab_fact_K.s[i] > 1 ANDALSO stab_sign_B.s[i] > 0 THEN
       Gmax.s[i] = Gmax.s[i] * (stab_fact_K.s[i] - SQRT(stab_fact_K.s[i]^2 - 1))
    END IF
 NEXT i
 
 !---handle case of meas. or simul data = 0
 IF MEAN(S_deemb.M.11)==0 THEN
   FOR i=0 TO SIZEOF(Gmax)-1
     Gmax.M[i]=0
   NEXT i
 END IF
 IF MEAN(S_deemb.S.11)==0 THEN
   FOR i=0 TO SIZEOF(Gmax)-1
     Gmax.S[i]=0
   NEXT i
 END IF
 
 
 ! ================================================================
 ! Note: in Plots, applying a dB scale, 
 ! IC-CAP applies 20*LOG10   (i.e. voltage dB).
 ! However, Max.Avail.Gain (Mason's Gain) is defined as 10*LOG10(MAG)  (i.e. power dB)
 ! Therefore, this Transform returns
 !    10*LOG10(Gmax)
 ! to be displayed in the Plot on a lin. scaled y-axis.
 ! ================================================================
 RETURN 10*LOG10(MAG(Gmax))
}
dataset
{
datasize BOTH 2912 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "_______________________2" "711.501"
{
}
LINK XFORM "U_How2Use" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! This example is how to call 'U' from your own ModelFile.
 
 
 !---cut here-----------------------------------------------------------
 
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/U", S_deemb)
 
 
}
dataset
{
datasize BOTH 40 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "U" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 ! Mason's Unilateral Power Gain (U) for a linear two-port device.
 ! Power Transmission from Port1->Port2 only.
 
 ! The Unilateral *Power* Gain unit is 'Power'.
 ! Note that, because it is a power gain, Unilateral Gain rolls off 
 !      by 2 decades per decade of freq.
 !     Therefore, when compared with H21, it needs to be displayed by SQRT(U)
 
 
 GET_DATASET "S_deemb", S_deemb
 
 Ypar=TwoPort(S_deemb, "S", "Y")
 U_tmp = 1//4*(MAG(Ypar.21-Ypar.12))^2 * (REAL(Ypar.11)*REAL(Ypar.22)-REAL(Ypar.12)*REAL(Ypar.21))^-1
 U_tmp = REAL(U_tmp)
 
 
 
 
 ! ================================================================
 ! Note: in Plots, applying a dB scale, 
 ! IC-CAP applies 20*LOG10   (i.e. voltage dB).
 ! However, Unilateral Gain is defined as 10*LOG10(MAG)  (i.e. power dB)
 ! Therefore, this Transform returns
 !    10*LOG10(Gmax)
 ! to be displayed in the Plot on a lin. scaled y-axis.
 ! ================================================================
 RETURN 10*LOG10(U_tmp)
}
dataset
{
datasize BOTH 2912 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "_______________________3" "711.501"
{
}
LINK XFORM "VoltageGain_How2Use" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! This example is how to call 'VoltageGain' from your own ModelFile.
 
 
 !---cut here-----------------------------------------------------------
 
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/VoltageGain", S_deemb)
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "VoltageGain" "711.501"
{
View block_edit 0 "0,3661"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 ! Voltage Gain = vPort2/vPort1 @ iPort2=0
 !              = 1 / A.11    ! A-Matrix
 !              = G.21        ! G-Matrix
 !              = gm / gds
 !
 ! This is the max.possible voltage gain if the Port2 load impedance is infinite (iPort2=0)
 ! In practice, it's lower than calculated, due to iPort2<>0 
 ! However, it should be > 1
 
 
 GET_DATASET "S_deemb", S_deemb
 
 
 COMPLEX tmp_VoltageGain_M.M[SIZEOF(S_deemb)]
 IF (MEAN(S_deemb.M.11)<>0) THEN
   !although the result is the same, we rather apply G21, because it's with a stimulating vPort1, while in the A matrix, it's a stimulating vPort2 (!)
   !tmp_A_M = TWOPORT(S_deemb.M, "S", "A")
   !tmp_VoltageGain_M = MAG(tmp_A_M.11^-1)
   tmp_H_M = TWOPORT(S_deemb.M, "S", "H")
   tmp_G_M = tmp_H_M^-1		! the G matrix is the inverse H matrix !
   tmp_VoltageGain_M = MAG(tmp_G_M.21)
 END IF
 
 COMPLEX tmp_VoltageGain_S.S[SIZEOF(S_deemb)]
 IF (MEAN(S_deemb.S.11)<>0) THEN
   !tmp_A_S = TWOPORT(S_deemb.S, "S", "A")
   !tmp_VoltageGain_S = MAG(tmp_A_S.11^-1)
   tmp_H_S = TWOPORT(S_deemb.S, "S", "H")
   tmp_G_S = tmp_H_S^-1		! the G matrix is the inverse H matrix !
   tmp_VoltageGain_S = MAG(tmp_G_S.21)
 END IF
 
 
 COMPLEX tmp_VoltageGain.B[SIZEOF(S_deemb)]
 FOR i=0 TO SIZEOF(tmp_VoltageGain)-1
   tmp_VoltageGain.M[i] = tmp_VoltageGain_M[i]
   tmp_VoltageGain.S[i] = tmp_VoltageGain_S[i]
 NEXT i
 
 RETURN tmp_VoltageGain
}
dataset
{
datasize BOTH 2912 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "_______________________4" "711.501"
{
}
LINK XFORM "DiffMode_Spar" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 ! calculating diff. and comm. Spars out of 2-port Spar
 ! Sdd11 = 0.5 * (S11 - S12 - S21 + S22)
 ! Sdc11 = 0.5 * (S11 + S12 - S21 - S22)
 ! Scd11 = 0.5 * (S11 - S12 + S21 - S22)
 ! Scc11 = 0.5 * (S11 + S12 + S21 + S22)
 
 
 GET_DATASET "S_deemb", S_deemb
 
 
 COMPLEX DiffModeSpar.B.22[SIZEOF(S_deemb)]
 FOR i=0 TO SIZEOF(S_deemb)-1
   ! Sdd11
   DiffModeSpar.M.11[i] = 0.5 * (S_deemb.M.11[i] - S_deemb.M.12[i] - S_deemb.M.21[i] + S_deemb.M.22[i])
   DiffModeSpar.S.11[i] = 0.5 * (S_deemb.S.11[i] - S_deemb.S.12[i] - S_deemb.S.21[i] + S_deemb.S.22[i])
 
   ! Sdc11
   DiffModeSpar.M.12[i] = 0.5 * (S_deemb.M.11[i] + S_deemb.M.12[i] - S_deemb.M.21[i] - S_deemb.M.22[i])
   DiffModeSpar.S.12[i] = 0.5 * (S_deemb.S.11[i] + S_deemb.S.12[i] - S_deemb.S.21[i] - S_deemb.S.22[i])
 
   ! Scd11
   DiffModeSpar.M.21[i] = 0.5 * (S_deemb.M.11[i] - S_deemb.M.12[i] + S_deemb.M.21[i] - S_deemb.M.22[i])
   DiffModeSpar.S.21[i] = 0.5 * (S_deemb.S.11[i] - S_deemb.S.12[i] + S_deemb.S.21[i] - S_deemb.S.22[i])
 
   ! Scc11
   DiffModeSpar.M.22[i] = 0.5 * (S_deemb.M.11[i] + S_deemb.M.12[i] + S_deemb.M.21[i] + S_deemb.M.22[i])
   DiffModeSpar.S.22[i] = 0.5 * (S_deemb.S.11[i] + S_deemb.S.12[i] + S_deemb.S.21[i] + S_deemb.S.22[i])
 NEXT i
 
 RETURN DiffModeSpar
 ! DiffModeSpar.11 = Sdd11 
 ! DiffModeSpar.12 = Sdc11 
 ! DiffModeSpar.21 = Scd11 
 ! DiffModeSpar.22 = Scc11 
}
dataset
{
datasize BOTH 101 2 2
type MEAS
type SIMU
}
}
}
LINK XFORM "_______________________5" "711.501"
{
}
LINK XFORM "fmax_How2Use" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! This example is how to call 'fmax' from your own ModelFile.
 
 
 !---cut here-----------------------------------------------------------
 
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/fmax", freq, S_deemb)
 
 
}
dataset
{
datasize BOTH 40 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "fmax" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !From Wikipedia, 2016-03:
 ! fmax is the maximum oscillation frequency of a device, 
 ! and it is discovered when the Unilateral Gain U(f_max) = 1. 
 ! It is the maximum frequency of oscillation, in a circuit 
 ! - where only one active device is present, 
 ! - the device is embedded in a passive network, 
 ! - and only single sinusoidal signals are of interest.
 
 GET_DATASET "freq", freq
 GET_DATASET "S_deemb", S_deemb
 
 
 !---calc. unilateral gain GU
 Ypar=TwoPort(S_deemb, "S", "Y")
 U_tmp = 1//4*(MAG(Ypar.21-Ypar.12))^2 * (REAL(Ypar.11)*REAL(Ypar.22)-REAL(Ypar.12)*REAL(Ypar.21))^-1
 U_tmp = REAL(U_tmp)
 
 
 !---calc. fmax, and apply SQRT(GU) 
 !   because the unit of Unilateral Gain GU is power
 RETURN SQRT(ABS(U_tmp))*freq
}
dataset
{
datasize BOTH 1664 1 1
type MEAS
type SIMU
}
}
}
data "711.501"
{
}
}
LINK DAT "PARAM_EXTR" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P140 P106 C10"
element 0 "Name" "ErrMsg"
element 0 "Value" ""
element 1 "Name" "X_LOW"
element 1 "Value" "0"
element 2 "Name" "X_HIGH"
element 2 "Value" "0"
element 3 "Name" "OVERRIDE_LIMITS"
element 3 "Value" "Y"
element 4 "Name" ""
element 4 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,287,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIN"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "Start" " 0.000 "
element "Stop" " 0.000 "
element "# of Points" "3696"
element "Step Size" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! This Setup holds centralized standard model param. extraction routines
 
 ! as well as a Program to control the Optimizer 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 3696 1 1
type COMMON
}
}
}
LINK XFORM "___Bip__________________1" "711.501"
{
}
LINK XFORM "calc_beta_static" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 ! static beta calculation for bipolar transistors
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
 
 ! HOW TO USE:
 ! in your Program, have these lines:
 !Min_Beta = -1m
 !Max_Beta = 1000
 !RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/PARAM_EXTR/calc_beta_static", ic.B, ib.B, Min_Beta, Max_Beta)
 
 
 !~~~~~~start of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GET_DATASET "ic", ic
 GET_DATASET "ib", ib
 GET_REAL "Min_Beta", Min_Beta
 GET_REAL "Max_Beta", Max_Beta
 
 
 COMPLEX BetaM[SIZEOF(ic)]
 COMPLEX BetaS[SIZEOF(ic)]
 IF MEAN(ib.M)<>0 THEN BetaM = ic.M//ib.M
 IF MEAN(ib.S)<>0 THEN BetaS = ic.S//ib.S
 
 
 
 COMPLEX Beta.B[SIZEOF(BetaM)]
 FOR i=0 TO SIZEOF(Beta)-1
   Beta.M[i] = BetaM[i]
   Beta.S[i] = BetaS[i]
 
   IF Beta.M[i] > Max_Beta THEN Beta.M[i]=Max_Beta
   IF Beta.S[i] > Max_Beta THEN Beta.S[i]=Max_Beta
   IF Beta.M[i] < Min_Beta THEN Beta.M[i]=Min_Beta
   IF Beta.S[i] < Min_Beta THEN Beta.S[i]=Min_Beta
 NEXT i
 
 RETURN  Beta
}
dataset
{
datasize BOTH 180 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "calc_beta_dyn" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 ! calculation of dynamic beta for bipolar transistors
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
 
 ! HOW TO USE:
 ! in your Program, have these lines:
 !Min_Beta = -1m
 !Max_Beta = 1000
 !RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/PARAM_EXTR/calc_beta_dyn", ic.B, ib.B, Min_Beta, Max_Beta)
 
 
 !~~~~~~start of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 GET_DATASET "ic", ic
 GET_DATASET "ib", ib
 GET_REAL "Min_Beta", Min_Beta
 GET_REAL "Max_Beta", Max_Beta
 
 
 COMPLEX BetaM[SIZEOF(ic)]
 COMPLEX BetaS[SIZEOF(ic)]
 IF MEAN(ib.M)<>0 THEN BetaM = DERIVATIVE(ib.M, ic.M, 1)
 IF MEAN(ib.S)<>0 THEN BetaS = DERIVATIVE(ib.S, ic.S, 1)
 
 
 
 COMPLEX Beta.B[SIZEOF(BetaM)]
 FOR i=0 TO SIZEOF(Beta)-1
   Beta.M[i] = BetaM[i]
   Beta.S[i] = BetaS[i]
 
   IF Beta.M[i] > Max_Beta THEN Beta.M[i]=Max_Beta
   IF Beta.S[i] > Max_Beta THEN Beta.S[i]=Max_Beta
   IF Beta.M[i] < Min_Beta THEN Beta.M[i]=Min_Beta
   IF Beta.S[i] < Min_Beta THEN Beta.S[i]=Min_Beta
 NEXT i
 
 RETURN  Beta
}
dataset
{
datasize BOTH 180 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "calc_RBB" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 ! NOTE: This Transform needs Input "see_under_ExtractOptimize"
 !       as an auxiliar Input  !!!
 !       Its  '# of Points' will be set to to SIZEOF(S11), otherwise, LINFIT() fails
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 GLOBAL_VAR  ErrMsg
 
 
 
 GET_STRING "Path2Setup", Path2Setup
 GET_DATASET "freq", freq
 GET_DATASET "bias*TYPE", bias
 GET_DATASET "S_deemb.B.11", S11
 GET_INT     "Index_vCE_Bias", Index_vCE_Bias
 GET_REAL    "maxfreq4RBB", maxfreq4RBB
 GET_REAL    "Emitter Resistance RE", RE
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !NOTE:  This is the classic GP method to extract RBB'.
 !	A circlefit is applied to the S11 data from lowest frequency
 !	to a given max. frequency. The x-intersection of this 
 !	circle for f->infinite gives RBB'+RE.
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 ErrMsg=""
 
 !---exit if meas. or simul. data are zero
 IF (MEAN(S11.M)==0) OR (MEAN(S11.S)==0) THEN 
   ErrMsg = "ERROR:  meas. or simul. data are zero !!!"
   RETURN
 END IF
 
 
 !---exit if entered maxfreq4RBB is outside the freq. range
 IF (VAL(maxfreq4RBB)<=MIN(freq)) ORELSE (VAL(maxfreq4RBB)>=MAX(freq)) THEN
   ErrMsg="ERROR in /Utilities, Xfm calc_RBB: selected freq. point for RBB calculation 
       is outside the measured freq. range  !"
   GET_STRING VAL$(ErrMsg)&"   [OK]", dummy
     RETURN
 END IF
 
 
 !---set '# of Points' of Input 'see_under_ExtractOptimize' to SIZEOF(S11)
 !   otherwise, LINFIT() fails
 ICCAP_FUNC("see_under_ExtractOptimize", "STFV", "Sweep Type", "LIN")
 ICCAP_FUNC("see_under_ExtractOptimize", "STFV", "# of Points", SIZEOF(S11))
 
 
 Sweep1Pts=USERC_num_of_points(1, VAL$(Path2Setup))	!number of freq.sweep points
 Sweep2Pts=USERC_num_of_points(2, VAL$(Path2Setup))	!number of ib or vbe sweep points
 
 
 !-----------calc index of frequ.range limitation
 !PRINT "fitting circles up to <";maxfreq4RBB;"Hz   ( freq.index= ";
 
 freq_index = 0
 i = 0
 WHILE i < Sweep1Pts
   IF freq[i] <= maxfreq4RBB THEN freq_index = i
   i = i + 1
 END WHILE
 !PRINT freq_index;" )"
 
 
 
 !----------------------------fit circles
 !PRINT "fitting circles to vCE index ";Index_vCE_Bias
 COMPLEX rbb.B[Sweep2Pts]
 COMPLEX spar_subset.B[freq_index+1]
 
 i_BaseBias = 0			! fit rbb loop
 WHILE i_BaseBias < SIZEOF(rbb)
   i_freq = 0			! index for act. circlefit
   WHILE i_freq  <= freq_index
     spar_subset.M[i_freq] = S11.M[i_freq + i_BaseBias*Sweep1Pts + Index_vCE_Bias*Sweep1Pts*Sweep2Pts]
     spar_subset.S[i_freq] = S11.S[i_freq + i_BaseBias*Sweep1Pts + Index_vCE_Bias*Sweep1Pts*Sweep2Pts]
     i_freq = i_freq + 1
   END WHILE
   !PRINT "i_BaseBias = ";i_BaseBias;"; first S11 value: ";spar_subset.M[0];"; last S11 value: ";spar_subset.M[freq_index]
   !---------fitting a circle to the subset of act.freq.sweep
   ! NOTE: circlefit seems to return less reliable results in this application !!!
 
   linM = LINFIT(REAL(spar_subset.M),REAL(REAL(spar_subset.M)^2+IMAG(spar_subset.M)^2),0)
   x0M  = linM[0]//2
   rM   = SQRT(linM[1] + x0M^2)
 
   linS = LINFIT(REAL(spar_subset.S),REAL(spar_subset.S)^2+IMAG(spar_subset.S)^2,0)
   x0S  = linS[0]//2
   rS   = SQRT(linS[1] + x0S^2)
 
   !---------calculating FREQ=infinite x-axis intersection 
 
   rbbM = 50*(1+(x0M - rM))//(1-(x0M - rM)) - RE
   rbbS = 50*(1+(x0S - rS))//(1-(x0S - rS)) - RE
 
   rbb.M[i_BaseBias] = rbbM + j*bias[i_BaseBias*Sweep1Pts]
   rbb.S[i_BaseBias] = rbbS + j*bias[i_BaseBias*Sweep1Pts]
 
   i_BaseBias = i_BaseBias + 1
 END WHILE
 
 
 RETURN rbb  !  RBB   + j * Bias
}
dataset
{
datasize BOTH 14 1 1
type MEAS
type SIMU
}
}
}
LINK XFORM "___CV_____________________" "711.501"
{
}
LINK XFORM "extr_CV" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
 
 ! HOW TO USE:
 ! in your Program, have these lines:
 
 !Path2Setup = WHOIS(".", "Parent Setup")
 !v_bias = vac
 !cap = cac.M
 !ParamName_CJO = "MAIN.CJO" 
 !ParamName_M   = "MAIN.M"
 !ParamName_VJ  = "MAIN.VJ"
 !ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/PARAM_EXTR/extr_CV", "Execute", Path2Setup, v_bias, cap, VAL(X_LOW), VAL(X_HIGH), ParamName_CJO, ParamName_M, ParamName_VJ)
 
 !RETURN_VALUE 1
 
 
 
 
 !~~~~~~start of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This centralized CV extraction program applies line fitting
 ! to transmitted meas. data, limited to a user-defined extraction boxc
 ! (X_LOW, X_HIGH), changes the defined CV Model parameters,
 ! and during the fitting process, calls a simulation of the remote Setup
 ! to show the fitting progress.
 
 
 GET_STRING  "Path2Setup", Path2Setup
 GET_DATASET "bias voltage", x
 GET_DATASET "cap", y
 GET_REAL    "X_LOW", X_LOW
 GET_REAL    "X_HIGH", X_HIGH
 GET_STRING  "CJ_ParamName", "MAIN.CJE", CJ_ParamName
 GET_STRING  "MJ_ParamName", "MAIN.MJE", MJ_ParamName
 GET_STRING  "VJ_ParamName", "MAIN.VJE", VJ_ParamName
 
 
 !---verify if meas. data are available
 IF MEAN(y.M)==0 THEN
   GET_STRING "ERROR: all meas. data are zero !!!  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !~~~extract CV model parameters~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---set conditions for 3rd variable VJ
 VJ_init = .4	! searching-loop start voltage
 VJ_step = .1	! searching-loop initial stepping
 VJ_min = .1	! limit for VJ search
 VJ_max = 2	!  "     "   "   "
 
 
 !===start of VJ loop
 R_best = 0	! init best regr.coeff
 VJ_loop = VJ_init	! init VJ  parameter
 !
 WHILE ABS(VJ_step) > 1m
   !---transform x and y arrays
   tmp_y = LOG(y)		  	!CV transformation formulas
   tmp_x = LOG(1 - x * VJ_loop^-1)
 
   !---initialize sums 
   sx=0            
   sy=0
   sxy=0
   sx2=0
   sy2=0
  
   !---regression loop
   N = 0
   FOR i=0 TO SIZEOF(x)-1               !start of inner loop
     IF x[i] > X_LOW AND x[i] < X_HIGH THEN
       N = N + 1
       sx  = sx  + tmp_x[i]
       sy  = sy  + tmp_y[i]
       sxy = sxy + tmp_x[i] * tmp_y[i]
       sx2 = sx2 + tmp_x[i]^2
       sy2 = sy2 + tmp_y[i]^2  
     END IF      ! consider  x-bounds         
   NEXT i        ! increment inner loop
   !
   !---consider N==0  
   IF N == 0 THEN
     GET_STRING "ERROR: extraction box bounds not defined correctly !!!  [OK]", dummy
     RETURN_VALUE 0
   END IF 
 
   !---calc.slope M and y-intersect B
   !                   !    slope
   M  = (sxy - (sx * sy) / N) / (sx2 - (sx^2) / N)
   M = REAL(M)
   !                   !    y-intersect
   B  = (sy - M * sx) / N  
   B = REAL(B)
   !                   !    regr.coeff.^2
   R2 = REAL(M^2 * (sx2 - (sx^2) / N) / (sy2 - (sy^2) / N))
   R  = REAL(SQRT (R2))
  
   PRINT "trying VJ="; VJ_loop; " yields R="; R
 
   !---set Parameter values and simulate Setup
   CJ_act = EXP(B)
   MJ_act = -M
   VJ_act = VJ_loop
   Path2ModelParams = VAL$(Path2Setup)&"/../../ParameterSet"
   ICCAP_FUNC(VAL$(Path2ModelParams), "STFV", "Value["&VAL$(CJ_ParamName)&"]", CJ_act)
   ICCAP_FUNC(VAL$(Path2ModelParams), "STFV", "Value["&VAL$(MJ_ParamName)&"]", MJ_act)
   ICCAP_FUNC(VAL$(Path2ModelParams), "STFV", "Value["&VAL$(VJ_ParamName)&"]", VJ_act)
   ICCAP_FUNC(VAL$(Path2Setup), "Simulate")
 
 
   !----------------keep params of best R
   IF VJ_loop==VJ_init THEN
     R_best = R		!this is the start condition of the loop
   ELSE
     IF R > R_best THEN  R_best = R
     IF R < R_last THEN  VJ_step = -VJ_step//2	   !change search direction & increment precision
   END IF
   VJ_loop = VJ_loop + VJ_step    	   !set next VJ probe
 
   !----------------check current value of VJ 
   IF (VJ_loop < VJ_min) OR (VJ_loop > VJ_max) THEN VJ_step=1u	!exit the loop
   R_last=R
 END WHILE
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "extr_CJx" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !~~~~~~start of program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This centralized CV extraction program extracts the capacitance
 ! value of a CV measurements as close as possible to vBias=0
 
 
 GET_DATASET "bias voltage", vBias
 GET_DATASET "cap", CV
 
 
 
 Vmin = 1E30
 CJx  = 1E30
 FOR i=0 TO SIZEOF(vBias)-1
   IF VAL(ABS(vBias[i]))< Vmin THEN 
     Vmin = ABS(vBias[i])
     CJx=REAL(CV.M[i])
   END IF
 NEXT i
 
 
 RETURN_VALUE REAL(CJx)
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___FET__________________2" "711.501"
{
}
LINK XFORM "VTH_idvg_lin" "711.501"
{
View block_edit 0 "0,8"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---fit a line to the most linear region of id_vg
 !   The x-intersection is VTH
 
 
 
 GLOBAL_VAR  X_LOW		! for AUTOFIT()
 GLOBAL_VAR  X_HIGH		! for AUTOFIT()
 GLOBAL_VAR  OVERRIDE_LIMITS	! for AUTOFIT()
 GLOBAL_VAR  ErrMsg
 
 
 
 GET_DATASET "vg", vg
 GET_DATASET "id", id
 GET_INT     "TYPE", Type
 
 
 
 ErrMsg = ""
 
 !---check TYPE setting
 IF ABS(MEAN(id))//MEAN(id)<>Type THEN
   ErrMsg="ERROR: 'Type' does not correspond to measured device type"
   RETURN_VALUE -1
 END IF
 
 
 
 vg_abs = ABS(vg)
 id_abs = ABS(id)
 
 !  Note: we apply AUTOFIT to automatically identify the most linear range within the preset XL_OW and X_HIGH limits
 X_LOW=0
 X_HIGH=MAX(vg)
 OVERRIDE_LIMITS="Y"
                   ! NOTE: function AUTOFIT (below) takes box-bounds (X_LOW, X_HIGH) 
                   !       into account, if the variable OVERRIDE_LIMITS is set to "Y"
 !------------------fit the line using regression techniques
 !                     to the most linear part of the data
 tmp=AUTOFIT(vg_abs, id_abs, .1, 0.3) ! x data, y data, flatness number, excluding data range at the range limits (here: .3=30%)
 
 Slope  =tmp[0]
 Yinter =tmp[1]
 R      =tmp[2]     ! regression coefficient
 
 
 Vth = -Yinter//Slope * Type
 
 RETURN_VALUE  Vth
 
 
 ! on a lin Plot (id vs. vg), show the fitted curve
 !RETURN Yinter + vg*Slope
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "VTH_from_ITH" "711.501"
{
View block_edit 0 "0,8"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---get VTH from a given ITH, normalized to W & L
 
 
 GLOBAL_VAR  X_LOW		! for AUTOFIT()
 GLOBAL_VAR  X_HIGH		! for AUTOFIT()
 GLOBAL_VAR  OVERRIDE_LIMITS	! for AUTOFIT()
 GLOBAL_VAR  ErrMsg
 
 
 
 GET_DATASET "vg", vg
 GET_DATASET "id", id
 GET_INT     "TYPE", Type
 GET_REAL    "I_Vth", I_Vth
 GET_REAL    "W", W
 GET_REAL    "L", L
 
 
 ErrMsg = ""
 
 !---check TYPE setting
 IF ABS(MEAN(id))//MEAN(id)<>Type THEN
   ErrMsg="ERROR: 'Type' does not correspond to measured device type"
   RETURN_VALUE -1
 END IF
 
 vg_abs = ABS(vg)
 id_abs = ABS(id)
 
 
 !---normalize target current for VTH calc.
 I_Vth_norm = ABS(I_Vth * W // L)
 
 
 !---check meas. result
 IF MAX(ABS(id_abs))<ABS(I_Vth_norm) THEN
   ErrMsg="ERROR: No id above ITH="&VAL$(ITH)&" available"
   RETURN_VALUE -2
 END IF
 
 
 !---starting with vg index=0 (lowest vg bias), find the first vg value above ITH
 FOR i_Vth=0 TO SIZEOF(vg_abs)-1
   IF ABS(id_abs[i_Vth])>=ABS(I_Vth_norm) THEN BREAK
 NEXT i_Vth
 
 IF i_Vth==0 THEN
   ErrMsg="ERROR: No vg value found above ITH_norm = "&VAL$(I_Vth_norm)
   RETURN_VALUE -3
 END IF
 
 
 !---here comes the VTH calc. formula----------------------------------------------------------
 Nom   = (vg_abs[i_Vth] - vg_abs[i_Vth-1])
 Denom = (id_abs[i_Vth] - id_abs[i_Vth-1])
 VthCalc = vg_abs[i_Vth-1] + Nom // Denom * (I_Vth_norm - id_abs[i_Vth-1])
 !---------------------------------------------------------------------------------------------
 
 
 RETURN_VALUE VthCalc*Type
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________3" "711.501"
{
}
LINK XFORM "quadr_regr" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This Program fits a quadratic polynomium 
 !  y = c0 + c1*x + c2*x^2
 ! to N meas. data points xi/yi
 ! and returns the coefficients c0, c1 and c2.
 !
 !  The regression formula is
 !
 !         A                   *   c    =     b 
 !
 !  /                       \     /  \     /          \ 
 ! | N       S(xi)   S(xi^2) |   | c0 |   |   S(yi)    |
 ! | S(xi)   S(xi^2) S(xi^3) | * | c1 | = |  S(yi*xi)  |
 ! | S(xi^2) S(xi^3) S(xi^4) |   | c2 |   | S(yi*xi^2) |
 !  \                       /     \  /     \          / 
 ! 
 ! what gives for the vector of polynomial coefficients:
 !    c = A^-1 * b
 !
 ! IMPORTANT PRE-REQUISITE:
 ! =========================
 ! - the nr. of x-data must be >= 3
 ! - and at least 3 different values
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 !  HOW TO USE:
 !  ======================
 ! in your Program, have these lines:
 ! c = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/PARAM_EXTR/quadr_regr", my_x_Values, my_y_Values)
 ! c0 = c[0]
 ! c1 = c[1]
 ! c2 = c[2]
 !  y = c0 + c1*x + c2*x^2
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 !---link to data
 GET_DATASET "x", x
 GET_DATASET "y", y
 
 
 COMPLEX A.33[1]
 COMPLEX b[3]
 COMPLEX c[3]
 
 
 !---calc. sums
 Sx = 0
 FOR i=0 TO SIZEOF(x)-1
   Sx = Sx + x[i]
 NEXT i
 
 Sx2 = 0
 FOR i=0 TO SIZEOF(x)-1
   Sx2 = Sx2 + x[i]^2
 NEXT i
 
 Sx3 = 0
 FOR i=0 TO SIZEOF(x)-1
   Sx3 = Sx3 + x[i]^3
 NEXT i
 
 Sx4 = 0
 FOR i=0 TO SIZEOF(x)-1
   Sx4 = Sx4 + x[i]^4
 NEXT i
 
 Sy = 0
 FOR i=0 TO SIZEOF(x)-1
   Sy = Sy + y[i]
 NEXT i
 
 Syx = 0
 FOR i=0 TO SIZEOF(x)-1
   Syx = Syx + y[i]*x[i]
 NEXT i
 
 Syx2 = 0
 FOR i=0 TO SIZEOF(x)-1
   Syx2 = Syx2 + y[i]*x[i]^2
 NEXT i
 
 
 !---fill matrix
 A.11[0] = SIZEOF(x)
 A.12[0] = Sx
 A.13[0] = Sx2
 A.21[0] = Sx
 A.22[0] = Sx2
 A.23[0] = Sx3
 A.31[0] = Sx2
 A.32[0] = Sx3
 A.33[0] = Sx4
 
 
 !---vector b
 b[0] = Sy
 b[1] = Syx
 b[2] = Syx2
 
 
 !---inverse the matrix
 invA = A^-1
 
 
 !---calc result
 c[0] = invA.11[0] * b[0] + invA.12[0] * b[1] + invA.13[0] * b[2]
 c[1] = invA.21[0] * b[0] + invA.22[0] * b[1] + invA.23[0] * b[2]
 c[2] = invA.31[0] * b[0] + invA.32[0] * b[1] + invA.33[0] * b[2]
 
 
 RETURN c
 
 ! to finally get the fitting curve in the calling Program:
 ! y = c[0] + c[1]*x + c[2]*x^2
}
dataset
{
datasize COMMON 3 1 1
type COMMON
}
}
}
LINK XFORM "mean_of_range" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This Program returns the mean of data within a given range
 !
 !  HOW TO USE:
 !  ======================
 ! in your Program, have these lines:
 ! MeanOfRange = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/PARAM_EXTR/mean_of_range", my_yData, my_xData, my_xDataMin, my_xDataMax)
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 GET_DATASET "yData", yData
 GET_DATASET "xData", xData
 
 GET_REAL    "xData Range min", xDataMin
 GET_REAL    "xData Range max", xDataMax
 
 COMPLEX RangeData.M[0]
 FOR i=0 TO SIZEOF(yData)-1
   IF (REAL(xData[i])>=REAL(xDataMin)) ANDALSO (REAL(xData[i])<=REAL(xDataMax)) THEN
     RangeData=COMPLEX_INSERT_AT(RangeData, REAL(yData[i]))
   ELSEIF REAL(xData[i])>REAL(xDataMax) THEN 
     BREAK 
   END IF
 NEXT i
 
 
 
 RETURN_VALUE  MEAN(REAL(RangeData))
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________4" "711.501"
{
}
LINK XFORM "___Optimizer_______________" "711.501"
{
}
LINK XFORM "Manage_Optimizer" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !  this Program calls an optimizer Transform until convergence is reached
 
 
 !  HOW TO USE:
 !  ======================
 ! in your Program, have these lines:
 ! !---define OptimTransform, OptimType and ErrFlag:
 ! OptimName = "requested Transform Name, holding the Optimizer"
 ! OptimType = "L-M"		! choices:  [L-M] = Levenberg-Marquardt (recommended), [G] = Gradient  (coarse)
 ! ErrFlag = "Rel"		! choices:  [Rel] = usually recommended, [Abs]
 ! ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/PARAM_EXTR/Manage_Optimizer", "Execute",  WHOIS(".", "Parent Setup")&"/"&VAL$(OptimName), VAL$(OptimType), VAL$(ErrFlag))
 ! ErrMsg = VAL$(/UTILITIES/PEL_UTILITIES/PARAM_EXTR/ErrMsg)
 ! IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE -1
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  ErrMsg
 
 
 
 GET_STRING "Path to Optimizer Transform", Path2Optim
 GET_STRING "Desired Optimizer Type  [L-M] = Levenberg-Marquardt, [G] = Gradient", OptimType
 GET_STRING "Error Flag  [Abs], [Rel] = usually recommended", ErrFlag
 
 
 ErrMsg=""
 
 !---set Optimizer Type
 IF VAL$(OptimType)=="G" THEN
   ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Optim Mode", "B")
   IF VAL(Debug)==1 THEN PRINT "Gradient Optim."
 ELSE
   ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Optim Mode", "L")
   IF VAL(Debug)==1 THEN PRINT "L-M Optim."
 END IF
 
 
 !---do Optimizer Settings
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "RMS error", "10m")    ! default:  10m
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Max error", "10m")    ! default:  10m
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Max Evals", "25")     ! default:  100
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Param Delta", "10m")  ! default:  1m
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Abs Err Flag", "no")
 IF VAL$(ErrFlag) == "Abs" THEN
   ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Abs Err Flag", "yes")
 END IF
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Print Parameters",   "Never")
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Print Error",        "Never")
 ICCAP_FUNC(VAL$(Path2Optim), "STFV", "Print Sens Results", "Never")
 
 
 
 IF VAL(Debug)==1 THEN PRINT "#*#*# 1.optim ..."
 ICCAP_FUNC(VAL$(Path2Optim), "Auto Set Min Max")	!---autoset Parameter Min and Max
 tmp = EVALUATE_TRANSFORM(VAL$(Path2Optim))	!---execute Optimizer and get fitting error back
 ! optim[0]:  remaining RMS error
 ! optim[1]:  remaining MAX error
 ErrorRMS_last = tmp[0]
 ErrorMAX_last = tmp[1]
 
 
 !---loop until error does not change any more
 i_max = 15
 IF VAL$(OptimType)=="G" THEN i_max=5		!only max 5 iterations for 'Gradient'
 FOR i=2 TO i_max
   IF VAL(Debug)==1 THEN PRINT "#*#*# ";i;".optim ..."
   ICCAP_FUNC(VAL$(Path2Optim), "Auto Set Min Max") !---autoset Parameter Min and Max
   tmp = EVALUATE_TRANSFORM(VAL$(Path2Optim))	 !---execute Optimizer and get fitting error back
   ErrorRMS_now = tmp[0]
   ErrorMAX_now = tmp[1]
   !  exit if RMS error is <1%
   IF VAL(ErrorRMS_last)<>0 THEN
     IF 100*ABS(ErrorRMS_now-ErrorRMS_last)//ErrorRMS_last < .01 THEN BREAK
   END IF
   ErrorRMS_last = ErrorRMS_now
   ErrorMAX_last = ErrorMAX_now
 NEXT i
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________5" "711.501"
{
}
LINK XFORM "___VISU_PARAMS__________________" "711.501"
{
}
LINK XFORM "visu_params" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. '"&VAL$(WHOAMI())&"' ..."
 
 
 !---visualize parameters
 
 GET_DATASET "X", X
 GET_DATASET "Y", Y
 
 
 !---calc y-intercept
 COMPLEX y_inter[SIZEOF(Y)]
 
 FOR i=1 TO SIZEOF(Y)-2
   y_inter[i]=(X[i+1]*Y[i-1]-X[i-1]*Y[i+1])//(X[i+1]-X[i-1])
   y_inter[i]=ABS(10^y_inter[i])
   IF y_inter[i]>10 THEN y_inter[i]=10
 NEXT i
 
 y_inter[0] = y_inter[1]
 y_inter[SIZEOF(y_inter)-1] = y_inter[SIZEOF(y_inter)-2] 
 
 RETURN y_inter
 
}
dataset
{
datasize COMMON 3960 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "COMPARE_PARAMS" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "2.0477780312299 8675 6988"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P29 C27 P575 P193"
element 0 "Name" "ErrMsg"
element 0 "Value" ""
element 1 "Name" "tmpVar"
element 1 "Value" "GaN_6x50u~Mdlg_Result__1a_DC_idvg~20191103_15_07_34.mps"
element 2 "Name" "mps_FileName"
element 2 "Value" "GaN_6x50u~Mdlg_Result__1a_DC_idvg~20191103_15_07_34.mps"
element 3 "Name" "Loaded_mps_FileName4GUI"
element 3 "Value" "GaN_6x50u~Mdlg_Result__1a_DC_idvg~20191103_15_07_34.mps"
element 4 "Name" "mps_FileNames[0]"
element 4 "Value" "GaN_6x50u~Mdlg_Result__1a_DC_idvg~20191103_15_07_34.mps"
element 5 "Name" "mps_FileNames"
element 5 "Value" "ICCAP_ARRAY[1]"
element 6 "Name" "mps_FileNames_sel"
element 6 "Value" "0"
element 7 "Name" "mps_DirName"
element 7 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/DemoData/Data4Mdlg"
element 8 "Name" "mps_DirName4GUI"
element 8 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtor ... _III_V/5c_ASM-HEMT/___ICCAP/data/DemoData/Data4Mdlg"
element 9 "Name" "Action_mps_File[0]"
element 9 "Value" "Load .mps File To See Its Fitting"
element 10 "Name" "Action_mps_File[1]"
element 10 "Value" "Compare Current Param.Values with File Values"
element 11 "Name" "Action_mps_File[2]"
element 11 "Value" "None, only .mps file handling"
element 12 "Name" "Action_mps_File"
element 12 "Value" "ICCAP_ARRAY[3]"
element 13 "Name" "Action_mps_File_sel"
element 13 "Value" "0"
element 14 "Name" "Path2Dut"
element 14 "Value" "/ASM_HEMT_MODELING/DC_MODELING"
element 14 "Comment" "used by SAVE_PARAMS"
element 15 "Name" "Path2Setup"
element 15 "Value" "/ASM_HEMT_MODELING/DC_MODELING/id_vgs__Transfer/Compare_with_Previous/.."
element 15 "Comment" "used by COMPARE_PARAMS"
element 16 "Name" "Path2Xfm"
element 16 "Value" "/ASM_HEMT_MODELING/DC_MODELING/id_vgs__Transfer/Compare_with_Previous"
element 17 "Name" "Plots"
element 17 "Value" "id_vg, logid_vg, gm_vg, ../id_vds__Output/id_vd, ../id_vds__Output/logid_vd, idvg_Fit_Quality"
element 18 "Name" "mps_Keyword"
element 18 "Value" "~Mdlg_Result__1a_DC_idvg~"
element 19 "Name" "ShowAllMpsFiles"
element 19 "Value" "0"
element 20 "Name" "ShowAllMpsFiles_byDate"
element 20 "Value" "0"
element 21 "Name" "ParamValComparison[0][0]"
element 21 "Value" "50"
element 22 "Name" "ParamValComparison[0][1]"
element 22 "Value" "49.68"
element 23 "Name" "ParamValComparison[0][2]"
element 23 "Value" ""
element 24 "Name" "ParamValComparison[0]"
element 24 "Value" "ICCAP_ARRAY[3]"
element 25 "Name" "ParamValComparison[1][0]"
element 25 "Value" "1E-018"
element 26 "Name" "ParamValComparison[1][1]"
element 26 "Value" "2.051E-013"
element 27 "Name" "ParamValComparison[1][2]"
element 27 "Value" "!!!!"
element 28 "Name" "ParamValComparison[1]"
element 28 "Value" "ICCAP_ARRAY[3]"
element 29 "Name" "ParamValComparison[2][0]"
element 29 "Value" "1E-015"
element 30 "Name" "ParamValComparison[2][1]"
element 30 "Value" "5.552E-010"
element 31 "Name" "ParamValComparison[2][2]"
element 31 "Value" "!!!!"
element 32 "Name" "ParamValComparison[2]"
element 32 "Value" "ICCAP_ARRAY[3]"
element 33 "Name" "ParamValComparison[3][0]"
element 33 "Value" "1E-012"
element 34 "Name" "ParamValComparison[3][1]"
element 34 "Value" "1.548E-011"
element 35 "Name" "ParamValComparison[3][2]"
element 35 "Value" "!!!!"
element 36 "Name" "ParamValComparison[3]"
element 36 "Value" "ICCAP_ARRAY[3]"
element 37 "Name" "ParamValComparison[4][0]"
element 37 "Value" "1E-012"
element 38 "Name" "ParamValComparison[4][1]"
element 38 "Value" "1.309E-011"
element 39 "Name" "ParamValComparison[4][2]"
element 39 "Value" "!!!!"
element 40 "Name" "ParamValComparison[4]"
element 40 "Value" "ICCAP_ARRAY[3]"
element 41 "Name" "ParamValComparison[5][0]"
element 41 "Value" "0.001"
element 42 "Name" "ParamValComparison[5][1]"
element 42 "Value" "0.2848"
element 43 "Name" "ParamValComparison[5][2]"
element 43 "Value" "!!!!"
element 44 "Name" "ParamValComparison[5]"
element 44 "Value" "ICCAP_ARRAY[3]"
element 45 "Name" "ParamValComparison[6][0]"
element 45 "Value" "0.001"
element 46 "Name" "ParamValComparison[6][1]"
element 46 "Value" "1.224"
element 47 "Name" "ParamValComparison[6][2]"
element 47 "Value" "!!!!"
element 48 "Name" "ParamValComparison[6]"
element 48 "Value" "ICCAP_ARRAY[3]"
element 49 "Name" "ParamValComparison[7][0]"
element 49 "Value" "0.001"
element 50 "Name" "ParamValComparison[7][1]"
element 50 "Value" "0.04157"
element 51 "Name" "ParamValComparison[7][2]"
element 51 "Value" "!!!!"
element 52 "Name" "ParamValComparison[7]"
element 52 "Value" "ICCAP_ARRAY[3]"
element 53 "Name" "ParamValComparison[8][0]"
element 53 "Value" "25"
element 54 "Name" "ParamValComparison[8][1]"
element 54 "Value" "27"
element 55 "Name" "ParamValComparison[8][2]"
element 55 "Value" ""
element 56 "Name" "ParamValComparison[8]"
element 56 "Value" "ICCAP_ARRAY[3]"
element 57 "Name" "ParamValComparison[9][0]"
element 57 "Value" "2.5E-008"
element 58 "Name" "ParamValComparison[9][1]"
element 58 "Value" "5.637E-008"
element 59 "Name" "ParamValComparison[9][2]"
element 59 "Value" ""
element 60 "Name" "ParamValComparison[9]"
element 60 "Value" "ICCAP_ARRAY[3]"
element 61 "Name" "ParamValComparison[10][0]"
element 61 "Value" "-0.4866"
element 62 "Name" "ParamValComparison[10][1]"
element 62 "Value" "-0.4643"
element 63 "Name" "ParamValComparison[10][2]"
element 63 "Value" ""
element 64 "Name" "ParamValComparison[10]"
element 64 "Value" "ICCAP_ARRAY[3]"
element 65 "Name" "ParamValComparison[11][0]"
element 65 "Value" "1.848"
element 66 "Name" "ParamValComparison[11][1]"
element 66 "Value" "3.674"
element 67 "Name" "ParamValComparison[11][2]"
element 67 "Value" ""
element 68 "Name" "ParamValComparison[11]"
element 68 "Value" "ICCAP_ARRAY[3]"
element 69 "Name" "ParamValComparison[12][0]"
element 69 "Value" "3.018E-009"
element 70 "Name" "ParamValComparison[12][1]"
element 70 "Value" "1.08E-007"
element 71 "Name" "ParamValComparison[12][2]"
element 71 "Value" "!!!!"
element 72 "Name" "ParamValComparison[12]"
element 72 "Value" "ICCAP_ARRAY[3]"
element 73 "Name" "ParamValComparison[13][0]"
element 73 "Value" "0"
element 74 "Name" "ParamValComparison[13][1]"
element 74 "Value" "1.484E-014"
element 75 "Name" "ParamValComparison[13][2]"
element 75 "Value" "!!!!"
element 76 "Name" "ParamValComparison[13]"
element 76 "Value" "ICCAP_ARRAY[3]"
element 77 "Name" "ParamValComparison[14][0]"
element 77 "Value" "190000"
element 78 "Name" "ParamValComparison[14][1]"
element 78 "Value" "525000"
element 79 "Name" "ParamValComparison[14][2]"
element 79 "Value" ""
element 80 "Name" "ParamValComparison[14]"
element 80 "Value" "ICCAP_ARRAY[3]"
element 81 "Name" "ParamValComparison[15][0]"
element 81 "Value" "-1.747"
element 82 "Name" "ParamValComparison[15][1]"
element 82 "Value" "-2.468"
element 83 "Name" "ParamValComparison[15][2]"
element 83 "Value" ""
element 84 "Name" "ParamValComparison[15]"
element 84 "Value" "ICCAP_ARRAY[3]"
element 85 "Name" "ParamValComparison[16][0]"
element 85 "Value" "0.01225"
element 86 "Name" "ParamValComparison[16][1]"
element 86 "Value" "0.009266"
element 87 "Name" "ParamValComparison[16][2]"
element 87 "Value" ""
element 88 "Name" "ParamValComparison[16]"
element 88 "Value" "ICCAP_ARRAY[3]"
element 89 "Name" "ParamValComparison[17][0]"
element 89 "Value" "0.05132"
element 90 "Name" "ParamValComparison[17][1]"
element 90 "Value" "0.04088"
element 91 "Name" "ParamValComparison[17][2]"
element 91 "Value" ""
element 92 "Name" "ParamValComparison[17]"
element 92 "Value" "ICCAP_ARRAY[3]"
element 93 "Name" "ParamValComparison[18][0]"
element 93 "Value" "3.025"
element 94 "Name" "ParamValComparison[18][1]"
element 94 "Value" "3.78"
element 95 "Name" "ParamValComparison[18][2]"
element 95 "Value" ""
element 96 "Name" "ParamValComparison[18]"
element 96 "Value" "ICCAP_ARRAY[3]"
element 97 "Name" "ParamValComparison[19][0]"
element 97 "Value" "0.4625"
element 98 "Name" "ParamValComparison[19][1]"
element 98 "Value" "0.5024"
element 99 "Name" "ParamValComparison[19][2]"
element 99 "Value" ""
element 100 "Name" "ParamValComparison[19]"
element 100 "Value" "ICCAP_ARRAY[3]"
element 101 "Name" "ParamValComparison[20][0]"
element 101 "Value" "0.0272"
element 102 "Name" "ParamValComparison[20][1]"
element 102 "Value" "0.03112"
element 103 "Name" "ParamValComparison[20][2]"
element 103 "Value" ""
element 104 "Name" "ParamValComparison[20]"
element 104 "Value" "ICCAP_ARRAY[3]"
element 105 "Name" "ParamValComparison[21][0]"
element 105 "Value" "16.97"
element 106 "Name" "ParamValComparison[21][1]"
element 106 "Value" "40.86"
element 107 "Name" "ParamValComparison[21][2]"
element 107 "Value" ""
element 108 "Name" "ParamValComparison[21]"
element 108 "Value" "ICCAP_ARRAY[3]"
element 109 "Name" "ParamValComparison[22][0]"
element 109 "Value" "1"
element 110 "Name" "ParamValComparison[22][1]"
element 110 "Value" "0"
element 111 "Name" "ParamValComparison[22][2]"
element 111 "Value" "!!!!"
element 112 "Name" "ParamValComparison[22]"
element 112 "Value" "ICCAP_ARRAY[3]"
element 113 "Name" "ParamValComparison[23][0]"
element 113 "Value" "15300"
element 114 "Name" "ParamValComparison[23][1]"
element 114 "Value" "50000"
element 115 "Name" "ParamValComparison[23][2]"
element 115 "Value" ""
element 116 "Name" "ParamValComparison[23]"
element 116 "Value" "ICCAP_ARRAY[3]"
element 117 "Name" "ParamValComparison[24][0]"
element 117 "Value" "5.906E+017"
element 118 "Name" "ParamValComparison[24][1]"
element 118 "Value" "5E+017"
element 119 "Name" "ParamValComparison[24][2]"
element 119 "Value" ""
element 120 "Name" "ParamValComparison[24]"
element 120 "Value" "ICCAP_ARRAY[3]"
element 121 "Name" "ParamValComparison[25][0]"
element 121 "Value" "4.669E+017"
element 122 "Name" "ParamValComparison[25][1]"
element 122 "Value" "5E+017"
element 123 "Name" "ParamValComparison[25][2]"
element 123 "Value" ""
element 124 "Name" "ParamValComparison[25]"
element 124 "Value" "ICCAP_ARRAY[3]"
element 125 "Name" "ParamValComparison[26][0]"
element 125 "Value" "0.3834"
element 126 "Name" "ParamValComparison[26][1]"
element 126 "Value" "0.155"
element 127 "Name" "ParamValComparison[26][2]"
element 127 "Value" ""
element 128 "Name" "ParamValComparison[26]"
element 128 "Value" "ICCAP_ARRAY[3]"
element 129 "Name" "ParamValComparison[27][0]"
element 129 "Value" "0.5"
element 130 "Name" "ParamValComparison[27][1]"
element 130 "Value" "0.155"
element 131 "Name" "ParamValComparison[27][2]"
element 131 "Value" ""
element 132 "Name" "ParamValComparison[27]"
element 132 "Value" "ICCAP_ARRAY[3]"
element 133 "Name" "ParamValComparison[28][0]"
element 133 "Value" "0.6167"
element 134 "Name" "ParamValComparison[28][1]"
element 134 "Value" "2"
element 135 "Name" "ParamValComparison[28][2]"
element 135 "Value" ""
element 136 "Name" "ParamValComparison[28]"
element 136 "Value" "ICCAP_ARRAY[3]"
element 137 "Name" "ParamValComparison[29][0]"
element 137 "Value" "5"
element 138 "Name" "ParamValComparison[29][1]"
element 138 "Value" "2"
element 139 "Name" "ParamValComparison[29][2]"
element 139 "Value" ""
element 140 "Name" "ParamValComparison[29]"
element 140 "Value" "ICCAP_ARRAY[3]"
element 141 "Name" "ParamValComparison[30][0]"
element 141 "Value" "5.334E-006"
element 142 "Name" "ParamValComparison[30][1]"
element 142 "Value" "1E-006"
element 143 "Name" "ParamValComparison[30][2]"
element 143 "Value" "!!!!"
element 144 "Name" "ParamValComparison[30]"
element 144 "Value" "ICCAP_ARRAY[3]"
element 145 "Name" "ParamValComparison[31][0]"
element 145 "Value" "2"
element 146 "Name" "ParamValComparison[31][1]"
element 146 "Value" "1"
element 147 "Name" "ParamValComparison[31][2]"
element 147 "Value" ""
element 148 "Name" "ParamValComparison[31]"
element 148 "Value" "ICCAP_ARRAY[3]"
element 149 "Name" "ParamValComparison[32][0]"
element 149 "Value" "0.004504"
element 150 "Name" "ParamValComparison[32][1]"
element 150 "Value" "1"
element 151 "Name" "ParamValComparison[32][2]"
element 151 "Value" "!!!!"
element 152 "Name" "ParamValComparison[32]"
element 152 "Value" "ICCAP_ARRAY[3]"
element 153 "Name" "ParamValComparison[33][0]"
element 153 "Value" "0.153"
element 154 "Name" "ParamValComparison[33][1]"
element 154 "Value" "1"
element 155 "Name" "ParamValComparison[33][2]"
element 155 "Value" "!!!!"
element 156 "Name" "ParamValComparison[33]"
element 156 "Value" "ICCAP_ARRAY[3]"
element 157 "Name" "ParamValComparison[34][0]"
element 157 "Value" "1.791"
element 158 "Name" "ParamValComparison[34][1]"
element 158 "Value" "2.5"
element 159 "Name" "ParamValComparison[34][2]"
element 159 "Value" ""
element 160 "Name" "ParamValComparison[34]"
element 160 "Value" "ICCAP_ARRAY[3]"
element 161 "Name" "ParamValComparison[35][0]"
element 161 "Value" "49.9"
element 162 "Name" "ParamValComparison[35][1]"
element 162 "Value" "2.5"
element 163 "Name" "ParamValComparison[35][2]"
element 163 "Value" "!!!!"
element 164 "Name" "ParamValComparison[35]"
element 164 "Value" "ICCAP_ARRAY[3]"
element 165 "Name" "ParamValComparison[36][0]"
element 165 "Value" "2"
element 166 "Name" "ParamValComparison[36][1]"
element 166 "Value" "0"
element 167 "Name" "ParamValComparison[36][2]"
element 167 "Value" "!!!!"
element 168 "Name" "ParamValComparison[36]"
element 168 "Value" "ICCAP_ARRAY[3]"
element 169 "Name" "ParamValComparison[37][0]"
element 169 "Value" "-80"
element 170 "Name" "ParamValComparison[37][1]"
element 170 "Value" "-25"
element 171 "Name" "ParamValComparison[37][2]"
element 171 "Value" ""
element 172 "Name" "ParamValComparison[37]"
element 172 "Value" "ICCAP_ARRAY[3]"
element 173 "Name" "ParamValComparison[38][0]"
element 173 "Value" "5E-007"
element 174 "Name" "ParamValComparison[38][1]"
element 174 "Value" "1E-010"
element 175 "Name" "ParamValComparison[38][2]"
element 175 "Value" "!!!!"
element 176 "Name" "ParamValComparison[38]"
element 176 "Value" "ICCAP_ARRAY[3]"
element 177 "Name" "ParamValComparison[39][0]"
element 177 "Value" "0.2"
element 178 "Name" "ParamValComparison[39][1]"
element 178 "Value" "0.1"
element 179 "Name" "ParamValComparison[39][2]"
element 179 "Value" ""
element 180 "Name" "ParamValComparison[39]"
element 180 "Value" "ICCAP_ARRAY[3]"
element 181 "Name" "ParamValComparison[40][0]"
element 181 "Value" "-80"
element 182 "Name" "ParamValComparison[40][1]"
element 182 "Value" "-50"
element 183 "Name" "ParamValComparison[40][2]"
element 183 "Value" ""
element 184 "Name" "ParamValComparison[40]"
element 184 "Value" "ICCAP_ARRAY[3]"
element 185 "Name" "ParamValComparison[41][0]"
element 185 "Value" "1.183E-007"
element 186 "Name" "ParamValComparison[41][1]"
element 186 "Value" "1E-007"
element 187 "Name" "ParamValComparison[41][2]"
element 187 "Value" ""
element 188 "Name" "ParamValComparison[41]"
element 188 "Value" "ICCAP_ARRAY[3]"
element 189 "Name" "ParamValComparison[42][0]"
element 189 "Value" "5E-006"
element 190 "Name" "ParamValComparison[42][1]"
element 190 "Value" "6.365E-011"
element 191 "Name" "ParamValComparison[42][2]"
element 191 "Value" "!!!!"
element 192 "Name" "ParamValComparison[42]"
element 192 "Value" "ICCAP_ARRAY[3]"
element 193 "Name" "ParamValComparison[43][0]"
element 193 "Value" "0.2"
element 194 "Name" "ParamValComparison[43][1]"
element 194 "Value" "0.1"
element 195 "Name" "ParamValComparison[43][2]"
element 195 "Value" ""
element 196 "Name" "ParamValComparison[43]"
element 196 "Value" "ICCAP_ARRAY[3]"
element 197 "Name" "ParamValComparison[44][0]"
element 197 "Value" "1E-014"
element 198 "Name" "ParamValComparison[44][1]"
element 198 "Value" "5.653E-014"
element 199 "Name" "ParamValComparison[44][2]"
element 199 "Value" "!!!!"
element 200 "Name" "ParamValComparison[44]"
element 200 "Value" "ICCAP_ARRAY[3]"
element 201 "Name" "ParamValComparison[45][0]"
element 201 "Value" "1E-014"
element 202 "Name" "ParamValComparison[45][1]"
element 202 "Value" "5.934E-014"
element 203 "Name" "ParamValComparison[45][2]"
element 203 "Value" "!!!!"
element 204 "Name" "ParamValComparison[45]"
element 204 "Value" "ICCAP_ARRAY[3]"
element 205 "Name" "ParamValComparison[46][0]"
element 205 "Value" "1E-014"
element 206 "Name" "ParamValComparison[46][1]"
element 206 "Value" "9.158E-014"
element 207 "Name" "ParamValComparison[46][2]"
element 207 "Value" "!!!!"
element 208 "Name" "ParamValComparison[46]"
element 208 "Value" "ICCAP_ARRAY[3]"
element 209 "Name" "ParamValComparison[47][0]"
element 209 "Value" "1E-018"
element 210 "Name" "ParamValComparison[47][1]"
element 210 "Value" "7.27E-013"
element 211 "Name" "ParamValComparison[47][2]"
element 211 "Value" "!!!!"
element 212 "Name" "ParamValComparison[47]"
element 212 "Value" "ICCAP_ARRAY[3]"
element 213 "Name" "ParamValComparison[48][0]"
element 213 "Value" "1"
element 214 "Name" "ParamValComparison[48][1]"
element 214 "Value" "0.04382"
element 215 "Name" "ParamValComparison[48][2]"
element 215 "Value" "!!!!"
element 216 "Name" "ParamValComparison[48]"
element 216 "Value" "ICCAP_ARRAY[3]"
element 217 "Name" "ParamValComparison[49][0]"
element 217 "Value" "1E-018"
element 218 "Name" "ParamValComparison[49][1]"
element 218 "Value" "1E-015"
element 219 "Name" "ParamValComparison[49][2]"
element 219 "Value" "!!!!"
element 220 "Name" "ParamValComparison[49]"
element 220 "Value" "ICCAP_ARRAY[3]"
element 221 "Name" "ParamValComparison[50][0]"
element 221 "Value" "1E-018"
element 222 "Name" "ParamValComparison[50][1]"
element 222 "Value" "1E-015"
element 223 "Name" "ParamValComparison[50][2]"
element 223 "Value" "!!!!"
element 224 "Name" "ParamValComparison[50]"
element 224 "Value" "ICCAP_ARRAY[3]"
element 225 "Name" "ParamValComparison[51][0]"
element 225 "Value" "1E-018"
element 226 "Name" "ParamValComparison[51][1]"
element 226 "Value" "1E-015"
element 227 "Name" "ParamValComparison[51][2]"
element 227 "Value" "!!!!"
element 228 "Name" "ParamValComparison[51]"
element 228 "Value" "ICCAP_ARRAY[3]"
element 229 "Name" "ParamValComparison[52][0]"
element 229 "Value" "1E-018"
element 230 "Name" "ParamValComparison[52][1]"
element 230 "Value" "8.628E-016"
element 231 "Name" "ParamValComparison[52][2]"
element 231 "Value" "!!!!"
element 232 "Name" "ParamValComparison[52]"
element 232 "Value" "ICCAP_ARRAY[3]"
element 233 "Name" "ParamValComparison[53][0]"
element 233 "Value" "1E-018"
element 234 "Name" "ParamValComparison[53][1]"
element 234 "Value" "2.01E-015"
element 235 "Name" "ParamValComparison[53][2]"
element 235 "Value" "!!!!"
element 236 "Name" "ParamValComparison[53]"
element 236 "Value" "ICCAP_ARRAY[3]"
element 237 "Name" "ParamValComparison[54][0]"
element 237 "Value" "1E-018"
element 238 "Name" "ParamValComparison[54][1]"
element 238 "Value" "1.012E-013"
element 239 "Name" "ParamValComparison[54][2]"
element 239 "Value" "!!!!"
element 240 "Name" "ParamValComparison[54]"
element 240 "Value" "ICCAP_ARRAY[3]"
element 241 "Name" "ParamValComparison[55][0]"
element 241 "Value" "1E-018"
element 242 "Name" "ParamValComparison[55][1]"
element 242 "Value" "1E-024"
element 243 "Name" "ParamValComparison[55][2]"
element 243 "Value" "!!!!"
element 244 "Name" "ParamValComparison[55]"
element 244 "Value" "ICCAP_ARRAY[3]"
element 245 "Name" "ParamValComparison[56][0]"
element 245 "Value" "1E-018"
element 246 "Name" "ParamValComparison[56][1]"
element 246 "Value" "1E-015"
element 247 "Name" "ParamValComparison[56][2]"
element 247 "Value" "!!!!"
element 248 "Name" "ParamValComparison[56]"
element 248 "Value" "ICCAP_ARRAY[3]"
element 249 "Name" "ParamValComparison[57][0]"
element 249 "Value" "1E-018"
element 250 "Name" "ParamValComparison[57][1]"
element 250 "Value" "6.868E-015"
element 251 "Name" "ParamValComparison[57][2]"
element 251 "Value" "!!!!"
element 252 "Name" "ParamValComparison[57]"
element 252 "Value" "ICCAP_ARRAY[3]"
element 253 "Name" "ParamValComparison[58][0]"
element 253 "Value" "0.9"
element 254 "Name" "ParamValComparison[58][1]"
element 254 "Value" "0.8012"
element 255 "Name" "ParamValComparison[58][2]"
element 255 "Value" ""
element 256 "Name" "ParamValComparison[58]"
element 256 "Value" "ICCAP_ARRAY[3]"
element 257 "Name" "ParamValComparison[59][0]"
element 257 "Value" "0.5"
element 258 "Name" "ParamValComparison[59][1]"
element 258 "Value" "0.0825"
element 259 "Name" "ParamValComparison[59][2]"
element 259 "Value" "!!!!"
element 260 "Name" "ParamValComparison[59]"
element 260 "Value" "ICCAP_ARRAY[3]"
element 261 "Name" "ParamValComparison[60][0]"
element 261 "Value" "0.1"
element 262 "Name" "ParamValComparison[60][1]"
element 262 "Value" "0.282"
element 263 "Name" "ParamValComparison[60][2]"
element 263 "Value" ""
element 264 "Name" "ParamValComparison[60]"
element 264 "Value" "ICCAP_ARRAY[3]"
element 265 "Name" "ParamValComparison[61][0]"
element 265 "Value" "1E+009"
element 266 "Name" "ParamValComparison[61][1]"
element 266 "Value" "0"
element 267 "Name" "ParamValComparison[61][2]"
element 267 "Value" "!!!!"
element 268 "Name" "ParamValComparison[61]"
element 268 "Value" "ICCAP_ARRAY[3]"
element 269 "Name" "ParamValComparison[62][0]"
element 269 "Value" "1E+009"
element 270 "Name" "ParamValComparison[62][1]"
element 270 "Value" "0"
element 271 "Name" "ParamValComparison[62][2]"
element 271 "Value" "!!!!"
element 272 "Name" "ParamValComparison[62]"
element 272 "Value" "ICCAP_ARRAY[3]"
element 273 "Name" "ParamValComparison[63][0]"
element 273 "Value" "1"
element 274 "Name" "ParamValComparison[63][1]"
element 274 "Value" "0"
element 275 "Name" "ParamValComparison[63][2]"
element 275 "Value" "!!!!"
element 276 "Name" "ParamValComparison[63]"
element 276 "Value" "ICCAP_ARRAY[3]"
element 277 "Name" "ParamValComparison"
element 277 "Value" "ICCAP_ARRAY[64]"
element 278 "Name" "RowNames[0]"
element 278 "Value" "R_LOAD"
element 279 "Name" "RowNames[1]"
element 279 "Value" "CTERM_P1"
element 280 "Name" "RowNames[2]"
element 280 "Value" "LTERM_P2"
element 281 "Name" "RowNames[3]"
element 281 "Value" "LG.L"
element 282 "Name" "RowNames[4]"
element 282 "Value" "LD.L"
element 283 "Name" "RowNames[5]"
element 283 "Value" "RS.R"
element 284 "Name" "RowNames[6]"
element 284 "Value" "RG.R"
element 285 "Name" "RowNames[7]"
element 285 "Value" "RD.R"
element 286 "Name" "RowNames[8]"
element 286 "Value" "MAIN.TNOM"
element 287 "Name" "RowNames[9]"
element 287 "Value" "MAIN.TBAR"
element 288 "Name" "RowNames[10]"
element 288 "Value" "MAIN.VOFF"
element 289 "Name" "RowNames[11]"
element 289 "Value" "MAIN.U0"
element 290 "Name" "RowNames[12]"
element 290 "Value" "MAIN.UA"
element 291 "Name" "RowNames[13]"
element 291 "Value" "MAIN.UB"
element 292 "Name" "RowNames[14]"
element 292 "Value" "MAIN.VSAT"
element 293 "Name" "RowNames[15]"
element 293 "Value" "MAIN.UTE"
element 294 "Name" "RowNames[16]"
element 294 "Value" "MAIN.LAMBDA"
element 295 "Name" "RowNames[17]"
element 295 "Value" "MAIN.ETA0"
element 296 "Name" "RowNames[18]"
element 296 "Value" "MAIN.VDSCALE"
element 297 "Name" "RowNames[19]"
element 297 "Value" "MAIN.NFACTOR"
element 298 "Name" "RowNames[20]"
element 298 "Value" "MAIN.CDSCD"
element 299 "Name" "RowNames[21]"
element 299 "Value" "MAIN.RTH0"
element 300 "Name" "RowNames[22]"
element 300 "Value" "MAIN.RDSMOD"
element 301 "Name" "RowNames[23]"
element 301 "Value" "MAIN.VSATACCS"
element 302 "Name" "RowNames[24]"
element 302 "Value" "MAIN.NS0ACCS"
element 303 "Name" "RowNames[25]"
element 303 "Value" "MAIN.NS0ACCD"
element 304 "Name" "RowNames[26]"
element 304 "Value" "MAIN.U0ACCS"
element 305 "Name" "RowNames[27]"
element 305 "Value" "MAIN.U0ACCD"
element 306 "Name" "RowNames[28]"
element 306 "Value" "MAIN.MEXPACCS"
element 307 "Name" "RowNames[29]"
element 307 "Value" "MAIN.MEXPACCD"
element 308 "Name" "RowNames[30]"
element 308 "Value" "MAIN.RDC"
element 309 "Name" "RowNames[31]"
element 309 "Value" "MAIN.GATEMOD"
element 310 "Name" "RowNames[32]"
element 310 "Value" "MAIN.IGSDIO"
element 311 "Name" "RowNames[33]"
element 311 "Value" "MAIN.IGDDIO"
element 312 "Name" "RowNames[34]"
element 312 "Value" "MAIN.NJGS"
element 313 "Name" "RowNames[35]"
element 313 "Value" "MAIN.NJGD"
element 314 "Name" "RowNames[36]"
element 314 "Value" "MAIN.FP2MOD"
element 315 "Name" "RowNames[37]"
element 315 "Value" "MAIN.VOFFFP1"
element 316 "Name" "RowNames[38]"
element 316 "Value" "MAIN.LFP1"
element 317 "Name" "RowNames[39]"
element 317 "Value" "MAIN.U0FP1"
element 318 "Name" "RowNames[40]"
element 318 "Value" "MAIN.VOFFFP2"
element 319 "Name" "RowNames[41]"
element 319 "Value" "MAIN.DFP2"
element 320 "Name" "RowNames[42]"
element 320 "Value" "MAIN.LFP2"
element 321 "Name" "RowNames[43]"
element 321 "Value" "MAIN.U0FP2"
element 322 "Name" "RowNames[44]"
element 322 "Value" "MAIN.CGSO"
element 323 "Name" "RowNames[45]"
element 323 "Value" "MAIN.CGDO"
element 324 "Name" "RowNames[46]"
element 324 "Value" "MAIN.CDSO"
element 325 "Name" "RowNames[47]"
element 325 "Value" "MAIN.CGDL"
element 326 "Name" "RowNames[48]"
element 326 "Value" "MAIN.VDSATCV"
element 327 "Name" "RowNames[49]"
element 327 "Value" "MAIN.CBDO"
element 328 "Name" "RowNames[50]"
element 328 "Value" "MAIN.CBSO"
element 329 "Name" "RowNames[51]"
element 329 "Value" "MAIN.CBGO"
element 330 "Name" "RowNames[52]"
element 330 "Value" "MAIN.CFG"
element 331 "Name" "RowNames[53]"
element 331 "Value" "MAIN.CFD"
element 332 "Name" "RowNames[54]"
element 332 "Value" "MAIN.CFGD"
element 333 "Name" "RowNames[55]"
element 333 "Value" "MAIN.CFGDSM"
element 334 "Name" "RowNames[56]"
element 334 "Value" "MAIN.CFGD0"
element 335 "Name" "RowNames[57]"
element 335 "Value" "MAIN.CJ0"
element 336 "Name" "RowNames[58]"
element 336 "Value" "MAIN.VBI"
element 337 "Name" "RowNames[59]"
element 337 "Value" "MAIN.MZ"
element 338 "Name" "RowNames[60]"
element 338 "Value" "MAIN.AJ"
element 339 "Name" "RowNames[61]"
element 339 "Value" "MAIN.ADOSFP1"
element 340 "Name" "RowNames[62]"
element 340 "Value" "MAIN.ADOSFP2"
element 341 "Name" "RowNames[63]"
element 341 "Value" "MAIN.RGATEMOD"
element 342 "Name" "RowNames"
element 342 "Value" "ICCAP_ARRAY[64]"
element 343 "Name" "ColNames[0]"
element 343 "Value" "Current Param.Values"
element 344 "Name" "ColNames[1]"
element 344 "Value" "Values in .mps File"
element 345 "Name" "ColNames[2]"
element 345 "Value" "Param. Ratio Exceeded"
element 346 "Name" "ColNames"
element 346 "Value" "ICCAP_ARRAY[3]"
element 347 "Name" "ParamValRatio"
element 347 "Value" "5"
element 348 "Name" "ColWidth[0]"
element 348 "Value" "11"
element 349 "Name" "ColWidth[1]"
element 349 "Value" "9"
element 350 "Name" "ColWidth[2]"
element 350 "Value" "12"
element 351 "Name" "ColWidth"
element 351 "Value" "ICCAP_ARRAY[3]"
element 352 "Name" "mps_Contents"
element 352 "Value" ""
element 353 "Name" "txt_HELP"
element 353 "Value" "#############################################################################################"
element 354 "Name" "GUI_xPos"
element 354 "Value" "1212"
element 355 "Name" "GUI_yPos"
element 355 "Value" "416"
element 356 "Name" "________________________1"
element 356 "Value" ""
element 357 "Name" ""
element 357 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_select_mps_files"
element 0 "Value" "TL|OR=VE:WD=600:LX=%#18GUI_xPos:LY=%#18GUI_yPos|CA=#18gui_exit&#17Execute|#210TL_DirName:#16TL_top:#222TL_CurrentlyLoadedFile:#212TL_FileNames:#19TL_Bottom|1|0"
element 1 "Name" "TL_select_mps_files.TL_FileNames.LI_mpsFileNames"
element 1 "Value" "LI|IT=%#213mps_FileNames:SX=%#217mps_FileNames_sel:SY=SS|LS=#214gui_handle_mps&#223Execute,Load_or_Compare|<none>|0"
element 2 "Name" "TL_select_mps_files.TL_Bottom"
element 2 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#215PB_Del_mps_File:#219PB_Renamel_mps_File:#214PB_View_Header:#15Space:#230PB_Continue_with_act_selection|1"
element 3 "Name" "TL_select_mps_files.TL_Bottom.PB_Del_mps_File"
element 3 "Value" "PB|CA=#225Delete Selected .mps File:TO=FW&FH|AC=#214gui_handle_mps&#214Execute,Delete|<none>|0"
element 4 "Name" "TL_select_mps_files.TL_top"
element 4 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#17TL_Left:#18TL_Right|1"
element 5 "Name" "TL_select_mps_files.TL_top.TL_Right.TL_CheckBox_ShowAllMps.CB_Show_all_mps_Files"
element 5 "Value" "CB|CA=#219Show All .mps Files:TS=%ShowAllMpsFiles|TC=#214find_mps_files&#17Execute|<none>|0"
element 6 "Name" "TL_select_mps_files.TL_top.TL_Right"
element 6 "Value" "TL|OR=VE:TO=FH&dummy|<none>|#17PB_Help:#222TL_CheckBox_ShowAllMps:#228ED_Corresponding_mps_Keyword|1"
element 7 "Name" "TL_select_mps_files.TL_top.TL_Right.ED_Corresponding_mps_Keyword"
element 7 "Value" "ED|BG=C8:CA=#271Current Modeling Keyword\072                                          .:ED=F:VA=%#211mps_Keyword:FG=C6:MF=%ShowAllMpsFiles|<none>|<none>|0"
element 8 "Name" "TL_select_mps_files.TL_top.TL_Right.TL_CheckBox_ShowAllMps"
element 8 "Value" "TL|OR=VE:TO=FH&dummy|<none>|#221CB_Show_all_mps_Files:#229CB_Show_all_mps_Files_by_date|1"
element 9 "Name" "TL_select_mps_files.TL_Bottom.PB_Renamel_mps_File"
element 9 "Value" "PB|CA=#225Rename Selected .mps File:TO=FW&FH|AC=#214gui_handle_mps&#214Execute,Rename|<none>|0"
element 10 "Name" "TL_select_mps_files.TL_Bottom.Space"
element 10 "Value" "TL|<none>|<none>|<none>|0"
element 11 "Name" "TL_select_mps_files.TL_Bottom.PB_Continue_with_act_selection"
element 11 "Value" "PB|CA=#214Done, Continue:TO=FH&dummy|AC=#18gui_exit&#17Execute|<none>|0"
element 12 "Name" "TL_select_mps_files.TL_top.TL_Right.TL_CheckBox_ShowAllMps.CB_Show_all_mps_Files_by_date"
element 12 "Value" "CB|CA=#250Order by File-Saved-Date   [@top \075 most recent]:MF=%ShowAllMpsFiles:TS=%ShowAllMpsFiles_byDate|TC=#214find_mps_files&#17Execute|<none>|0"
element 13 "Name" "TL_select_mps_files.TL_FileNames"
element 13 "Value" "TL|CA=#251available .mps Files\072  select to load or compare|<none>|#215LI_mpsFileNames|1"
element 14 "Name" "TL_Show_ParamVal_Difference"
element 14 "Value" "TL|HT=500:WD=480|<none>|#16TL_Top:#220ST_ParamNames_n_Vals:#213TL_Print_Exit|0|1"
element 15 "Name" "TL_Show_ParamVal_Difference.ST_ParamNames_n_Vals"
element 15 "Value" "ST|B1=C3:C1=AR:XC=%#18ColNames:W3=%#18ColWidth:XM=%#218ParamValComparison:LT=BL:B0=C9:C0=AL:G0=BG:C2=AC:B2=C8:XR=%#18RowNames:G2=NG|<none>|<none>|0|1"
element 16 "Name" "TL_Show_ParamVal_Difference.TL_Top.ED_ParamValRatio"
element 16 "Value" "ED|CA=#231Param.Value\012Comparison Ratio:ED=T:VA=%#213ParamValRatio:TO=FW&FH&TR|EP=#216gui_analyze_diff&#17Execute|<none>|0"
element 17 "Name" "TL_Show_ParamVal_Difference.TL_Print_Exit.PB_Print"
element 17 "Value" "PB|CA=#213Print to File:TO=FW&FH&TR|AC=#220gui_print_param_diff&#17Execute|<none>|0"
element 18 "Name" "TL_select_mps_files.TL_top.TL_Left"
element 18 "Value" "TL|OR=VE|<none>|#214TL_LoadCompare:#15Space:#220PB_Recall_Parameters|1"
element 19 "Name" "TL_select_mps_files.TL_top.TL_Left.TL_LoadCompare"
element 19 "Value" "TL|FV=T:OR=HO|<none>|#222RX_mps_Load_or-Compare|1"
element 20 "Name" "TL_select_mps_files.TL_top.TL_Left.TL_LoadCompare.RX_mps_Load_or-Compare"
element 20 "Value" "RX|IT=%#215Action_mps_File:SZ=%#219Action_mps_File_sel:TO=FW&FH|<none>|<none>|0"
element 21 "Name" "TL_select_mps_files.TL_top.TL_Left.PB_Recall_Parameters"
element 21 "Value" "PB|CA=#229Recall Starting Param. Values:TO=FH&dummy|AC=#214gui_handle_mps&#227Execute,Recall_Start_Values|<none>|0"
element 22 "Name" "TL_select_mps_files.TL_CurrentlyLoadedFile.LA_CurrentlyLoadedFile"
element 22 "Value" "LA|CA=%#223Loaded_mps_FileName4GUI:FG=C6|<none>|<none>|0"
element 23 "Name" "TL_select_mps_files.TL_CurrentlyLoadedFile"
element 23 "Value" "TL|FV=T:OR=HO:TO=FH&dummy|<none>|#17LA_Note:#222LA_CurrentlyLoadedFile:#210LA_Pointer:#15Space|0"
element 24 "Name" "TL_select_mps_files.TL_CurrentlyLoadedFile.LA_Note"
element 24 "Value" "LA|CA=#241\075\075>  Currently Loaded .mps File\072:FG=C6:TO=FW&FH|<none>|<none>|0"
element 25 "Name" "TL_select_mps_files.TL_top.TL_Left.Space"
element 25 "Value" "TL|<none>|<none>|<none>|0"
element 26 "Name" "TL_select_mps_files.TL_CurrentlyLoadedFile.Space"
element 26 "Value" "TL|<none>|<none>|<none>|0"
element 27 "Name" "TL_select_mps_files.TL_CurrentlyLoadedFile.LA_Pointer"
element 27 "Value" "LA|CA=#213<\075\075\075:FG=C6:TO=FW&FH|<none>|<none>|0"
element 28 "Name" "TL_Show_ParamVal_Difference.TL_Top"
element 28 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#18LA_Notes:#216ED_ParamValRatio|1"
element 29 "Name" "TL_Show_ParamVal_Difference.TL_Top.LA_Notes"
element 29 "Value" "LA|CA=#298Only Model Parameters are shown.\012Parameters not shown have identical values in both data sets!!:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 30 "Name" "TL_select_mps_files.TL_DirName.LA_mps_DirName"
element 30 "Value" "LA|BG=C8:CA=%#215mps_DirName4GUI:FG=C6|<none>|<none>|0"
element 31 "Name" "TL_select_mps_files.TL_DirName"
element 31 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#210LA_mps_Dir:#214LA_mps_DirName:#15space|1"
element 32 "Name" "TL_select_mps_files.TL_DirName.LA_mps_Dir"
element 32 "Value" "LA|BG=C8:CA=#214Directory\072 :FG=C6:TO=FW&dummy|<none>|<none>|0"
element 33 "Name" "TL_select_mps_files.TL_DirName.space"
element 33 "Value" "TL|<none>|<none>|<none>|0"
element 34 "Name" "TL_mpsContents"
element 34 "Value" "TS|HT=400:WD=600|<none>|#18LA_notes:#214ED_mpsContents|0|2"
element 35 "Name" "TL_mpsContents.LA_notes"
element 35 "Value" "LA|CA=#229Contents of the .mps File\072:TO=FH&dummy|<none>|<none>|0"
element 36 "Name" "TL_mpsContents.ED_mpsContents"
element 36 "Value" "ED|BG=C9:EM=ML:ED=F:VA=%#212mps_Contents:FI=FF|<none>|<none>|0"
element 37 "Name" "TL_select_mps_files.TL_Bottom.PB_View_Header"
element 37 "Value" "PB|CA=#223View Selected .mps File:TO=FW&FH|AC=#214gui_handle_mps&#219Execute,View Header|<none>|0"
element 38 "Name" "GUI_Help"
element 38 "Value" "TS|HT=200:WD=800|<none>|#19lbl_Notes|1|3"
element 39 "Name" "GUI_Help.lbl_Notes"
element 39 "Value" "LA|BG=C9:CA=%#18txt_HELP:FI=FF:FG=C6|<none>|<none>|0"
element 40 "Name" "TL_select_mps_files.TL_top.TL_Right.PB_Help"
element 40 "Value" "PB|CA=#219HELP using this GUI:TO=FW&FH&TR|AC=#16README&#17Execute|<none>|0"
element 41 "Name" "TL_Show_ParamVal_Difference.TL_Print_Exit"
element 41 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#18TL_Space:#18PB_Print:#15PB_OK|1"
element 42 "Name" "TL_Show_ParamVal_Difference.TL_Print_Exit.PB_OK"
element 42 "Value" "PB|CA=#19OK, Done!:TO=FW&FH|AC=#229./TL_Show_ParamVal_Difference&#234Destroy GUI,Model Parameter Values|<none>|0"
element 43 "Name" "TL_Show_ParamVal_Difference.TL_Print_Exit.TL_Space"
element 43 "Value" "TL|<none>|<none>|<none>|0"
element 44 "Name" ""
element 44 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  txt_HELP
 
 
 !###############################################################################
 ! This central UTILITIES utility allows to compare saved ModelParameter sets
 ! (.mps files) against each other.
 ! Useful when doing device modeling with different modeling steps/strategies.
 ! It is written to be model-independent.
 
 ! HOW IT WORKS:
 ! ================
 ! 'SAVE_PARAMS' will save 
 !            your Model's Circuit (.ckt), 
 !            the Model Param. values (.mps), and (if requested),
 !            also the DUT Circuit (.tci) and its Param values (.dps)
 
 ! 'COMPARE_PARAMS' will load 
 !            your Model's Circuit (.ckt), 
 !            the Model Param. values (.mps), and (if present),
 !            also the DUT Circuit (.tci) and its Param values (.dps)
 !  and will display the simulation result in user-defined plots.
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 ! You will only be asked for the name of the .mps file.
 ! The saved/loaded .cir, the .tci and the .dps file name are the same - just the file extension is different
 
 
 ! ==============================================================================
 ! IMPORTANT NOTE: the 'COMPARE_PARAMS' utility calls also 
 !  /UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI    !!!
 ! ==============================================================================
 
 
 
 !--define the contents for Variable txt_HELP, to be displayed in the help GUI 'GUI_Help':
 txt_HELP="#############################################################################################
 
 This GUI allows to compare saved ModelParameter sets against each other.
 It is very useful when doing device modeling with different modeling steps/strategies/results.
 
 ##### VERY IMPORTANT:
       =======================
      Located behind this GUI, and displaying the Plots,
      is the 'GENERAL_MDLG_GUI' of UTILITIES,
      and behind this GUI is the IC-CAP PlotOptimizer, 
       mandatory for the functionning of 'GENERAL_MDLG_GUI'. 
       -> Do not manually modify anything within that PlotOptimizer Window.
       -> Just leave it as it is and where it is !!!
 
 ##### ALSO VERY IMPORTANT:
       =======================
       When closing this GUI, hit simply the Button 'Done, Continue'.
       -> This will close all other GUIs currently opened.
 #############################################################################################"
 
 
 !---call the HELP GUI
 ICCAP_FUNC("./GUI_Help", "Display Modeless GUI", "HELP")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 !#################################################################################
 ! Copy-paste the Save/Load Program code shown below as a Transform into the 
 ! corresponding Setup of your ModelFile. 
 ! Name it e.g. 'Save_Modeling_State'  and  'Compare_with_Previous_Fittings'
 
 ! NOTE: ModelingStep:
 !   - define an individual mdlg. step keyword
 !   - or enter '*' to show all avail.param.files
 !#################################################################################
 
 
 
 !---------------cut here for saving parameters--------------------------------------------------
 UPDATE_EXPLICIT
 
 !---for later model fit comparisons,
 !   execute this Transform to save the current ModelParameter state
 !   into directory 'DataDir'
 
 GLOBAL_VAR  DeviceName
 GLOBAL_VAR  DataDir
 GLOBAL_VAR  ModelingStep
 
 
 
 
 !=====================================================================================
 !---define here the name of the current modeling step, to later identify the saved .mps (& .cir & .tci & .dps) files of this modeling step
 ModelingStep = "~MdlgResult_DC~"
 !=====================================================================================
 !
 mps_FileName = VAL$(DeviceName)&VAL$(ModelingStep)
  TimeStamp=SYSTEM$("date +%Y%m%d_%H_%M_%S")
  mps_FileName = VAL$(mps_FileName)&VAL$(TimeStamp)&".mps"
 mps_DirName = VAL$(DataDir)		!default is to have the .mps ModelParameterFiles in the same dir. as the meas. data
 Path2Dut =  WHOIS(".", "Parent DUT")	!we transfer the DUT name since this includes both, the path to TestCircuitParam and to the ModelParam
 SaveTestCkt = "no"			![yes], [no]=default | Note: default = no, because otherwise, re-loading DC DUT Circuits and Parameters into S-Parameter Setups would corrupt the link to ModelVariables (e.g. central contact resistance ModelVariable) !!!
 				!                    | use [yes] if you know what you do (e.g.: the DUT Circuit and its Parameter values change during mdlg)
 !---call the central ModelParameter saving utility
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/COMPARE_PARAMS/SAVE_PARAMS", "Execute", VAL$(mps_FileName), VAL$(mps_DirName), VAL$(Path2Dut), VAL$(SaveTestCkt))
 
 
 
 RETURN_VALUE 1
 
 
 
 
 !##############################################################################################################
 !##############################################################################################################
 !##############################################################################################################
 
 
 !---------------cut here for comparing parameter values with previous ones--------------------------------------------------
 
 UPDATE_EXPLICIT
 !---execute this Program when you want to compare the current Parameters 
 !   with existing (older) extractions of the same (or other) modeling step(s), 
 !   saved by Xfm 'Save_Modeling_State', and located in directory 'DataDir'
 
 GLOBAL_VAR  DataDir
 GLOBAL_VAR  ModelingStep	!SetupVariable, was defined by Transform 'Save_Modeling_State'
 
 
 !=====================================================================================
 !---define here the details asked by central Transform 'COMPARE_PARAMS' in UTILITIES
 !              -> define 'mps_Keyword' to identify the corresponding, saved .mps files of this modeling step
 mps_Keyword = VAL$(ModelingStep)
 !              -> Plots you want to see when comparing Parameters
 Plots       = "logia_va, ia_va"
 !=====================================================================================
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/COMPARE_PARAMS/COMPARE_PARAMS", "Execute", VAL$(DataDir), VAL$(mps_Keyword), VAL$(Plots), WHOAMI())
 
 
 RETURN_VALUE 1
 
 !--------------------------------------------------------------------------------------------------
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "SAVE_PARAMS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  mps_FileName
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  Path2Dut
 
 
 !===This Program saves the 'ModelParameters' of an open ModelFile,
 !   as mps_FileName into directory mps_DirName  (.mps File),
 !   together with the netlist of tab 'Circuit'  (.ckt File).
 !   If requested, the DutCircuit and the DutParameters of the Setup,
 !   from which the calling Transform is executed, are saved too (.tci and .dps File).
 !   This ensures that the contact resistances netlist and its param. values etc. are saved too.
 !   However, there is a caveat: 
 !   When in 'COMPARE_PARAMS' netlists of different DUTs (e.g. DC, Spar etc. which usually host contact
 !   resistances) are loaded into a 'COMPARE_PARAMS' located in the Setups of e.g. DUT 'CV',
 !   this usually empty 'CV' Test Circuit may remain filled with the DC contact resistance netlist (if the user doesn't watch out !)
 !   Therefore, apply the default 'no' for SaveTestCkt  (unless you know what you do).
 
 
 !---This is answered by the calling Program
 GET_STRING "FileName", mps_FileName, mps_FileName
 GET_STRING "DirName",  mps_DirName, mps_DirName
 GET_STRING "Path2Dut", Path2Dut, Path2Dut
 GET_STRING "Save also Test Circuit and DUT Params ?  [yes], [no]=default", "no", SaveTestCkt
 
 
 !--set local variables
 Path2Model = VAL$(Path2Dut)&"/.."
 
 IF VAL$(mps_DirName)=="." THEN mps_DirName=SYSTEM$("pwd")	! handle case of DirName = '.' (i.e., the user's home directory)
 
 mps_DirFileName = VAL$(mps_DirName)&"/"&VAL$(mps_FileName)
 mps_DirFileName = SYS_PATH$(VAL$(mps_DirFileName))
 !---verify if SYS_PATH$() had worked correctly
 IF VAL$(mps_DirFileName)=="" THEN
   GET_STRING "ERROR: Directory/Filename longer than 256 characters !
    Please correct this [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 
 GET_STRING "-> To save your current model fit into your current .mdm data directory,
  check the file name.
  -> If you want to add comments to the file name, do so just after the time stamp, before the file suffix  .mps
 
    NOTE: Enter * to get a directory browser", mps_DirFileName, mps_DirFileName
 
 
 IF VAL$(mps_DirFileName)=="*" THEN
   GUIheader = "Select Dir for saving current ModelParams and TestCircuitParams"
   DirName   = VAL$(mps_DirName)
   Suffix    = ""
   FilenameWildcard = ""
   SelPolicy = "DirOnly"	! Single, Multi, DirOnly
 
   !############################################################################
   !---Call the central GUI, anticipating its GET_STRINGs
   Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
   ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(DirName), VAL$(Suffix), VAL$(FilenameWildcard), VAL$(SelPolicy))
   !############################################################################
   ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
   IF VAL$(ErrMsg)=="" THEN
     !---Get the selected directory back
     mps_DirName=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
     !---re-compose DirFileName
     mps_DirFileName = VAL$(mps_DirName)&"/"&VAL$(mps_FileName)
     mps_DirFileName = SYS_PATH$(VAL$(mps_DirFileName))	!show path op.sys.independent
     !---give the user a last chance ;-)
     GET_STRING "To save your current ModelParameter values into your current .mdm data directory,
      check the file name:  [OK], [Cancel]", mps_DirFileName, mps_DirFileName
   ELSE
     GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 !---make dirfilename op.sys. independent
 mps_DirFileName = SYS_PATH$(VAL$(mps_DirFileName))
 
 !---if present, cut-off file extension (to re-use this dirfilename for param, circuit and test circuit saving
 FileExtensionLocation = STRPOS(VAL$(mps_DirFileName), ".mps")
 IF FileExtensionLocation>0 THEN
   mps_DirFileName_wo_ext = SUBSTR$(VAL$(mps_DirFileName), 1, FileExtensionLocation-1)
 END IF
 
 
 !---save ModelParameters
 ICCAP_FUNC(VAL$(Path2Model)&"/ParameterSet", "Save As", VAL$(mps_DirFileName_wo_ext)&".mps")
 !---save also the Circuit (the circuit might have changed due to model development during modeling)
 ICCAP_FUNC(VAL$(Path2Model)&"/Circuit",      "Save As", VAL$(mps_DirFileName_wo_ext)&".cir")
 
 
 !---if requested, save also the TestCircuit, and the DUT Parameters (important for documenting the contact resistances, nonlin-RF settings etc)
 IF UPC$(VAL$(SaveTestCkt))=="YES" THEN
   Path2Netlist = VAL$(Path2Dut)&"/TestCircuit"	!path to Tab 'TestCircuit' (DUT Level)
   !   import the netlist from Tab 'Circuit', and verify if it's used
   DutCircuitText = LOOKUP_TABLE_VAL(VAL$(Path2Netlist), "Text")	!"Text" is the keyword to get all the Macro PEL code into the Variable 'x'
   DutCircuitText = TRIM$(VAL$(DutCircuitText ))
   IF VAL$(DutCircuitText)<>"" THEN	!don't save an empty DUT TestCircuit netlist - reason: in DUT 'Finish Mdlg', there is no DUT netlist used. In this case, if we had saved also the TestCircuit netlist, it would overwrite the existing DUT netlists, when we load the final mdlg result later back in DUT DC__, CV__, Spar___,  etc.
     ICCAP_FUNC(VAL$(Path2Netlist), "Save As", VAL$(mps_DirFileName_wo_ext)&".TestCkt.tci")   
     ICCAP_FUNC(VAL$(Path2Dut)&"/DeviceParameterSet", "Save As", VAL$(mps_DirFileName_wo_ext)&".TestCkt.dps")   
   END IF
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "COMPARE_PARAMS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---execute this Program when you want to compare the current Parameters 
 !   with existing (older) extractions, saved in .mps files by Xfm 'Save_Spar_Parameters'
 !
 !   What will happen: the ModelParameters (.mps File) and their netlist (.cir File)
 !   are loaded upon user request, together with the DutParameters and the DutTestCircuit (contact resistances etc.)
 
 
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  mps_DirName4GUI
 GLOBAL_VAR  mps_FileName
 GLOBAL_VAR  Loaded_mps_FileName4GUI
 
 GLOBAL_VAR  mps_Keyword
 GLOBAL_VAR  Plots
 GLOBAL_VAR  Path2Xfm
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  mps_FileNames_sel
 GLOBAL_VAR  ShowAllMpsFiles
 GLOBAL_VAR  ShowAllMpsFiles_byDate
 GLOBAL_VAR  Action_mps_File_sel
 GLOBAL_VAR  ErrMsg
 
 
 !---this is answered by the calling Program
 GET_STRING "mps_DirName", mps_DirName
 GET_STRING "mps_Keyword  [an individual mdlg. step keyword, or '*' to show all avail.param.files]", mps_Keyword
 GET_STRING "Plots", Plots
 GET_STRING "Path2Xfm", Path2Xfm
 
 
 
 
 !---initialize variables
 mps_DirName         = SYS_PATH$(VAL$(mps_DirName))
 mps_FileNames_sel   = -1
 ShowAllMpsFiles     = 0
 ShowAllMpsFiles_byDate  = 0
 Action_mps_File_sel     = 0
 Loaded_mps_FileName4GUI = "Param.Values present at start of this Utility"
 ErrMsg                  = ""
 
 
 Path2Setup = VAL$(Path2Xfm)&"/.."
 
 !---verify if directory name is OK
 dir_fail=SYSTEM("cd "&SYS_PATH$(VAL$(mps_DirName))&" 2> /dev/null")
 IF (dir_fail<>0) OR (VAL$(mps_DirName)=="") THEN 
   GET_STRING "ERROR: Directory 
 "&VAL$(mps_DirName)&"
  not found !   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---if too long, shrink mps_DirName for GUI
 mps_DirName4GUI = VAL$(mps_DirName)
 StringLength = STRLEN(VAL$(mps_DirName4GUI))
 IF VAL(StringLength) > 100 THEN
   mps_DirName4GUI = SUBSTR$(VAL$(mps_DirName4GUI), 1 , 50)&" ... "&SUBSTR$(VAL$(mps_DirName4GUI), StringLength-50, StringLength) 
 END IF
 
 
 !---verify if Variable 'mps_Keyword' is not empty
 IF VAL$(mps_Keyword)=="" THEN
   ErrMsg = "ERROR: Variable 'mps_Keyword' is empty, i.e. no ModelingStep defined"
   GET_STRING VAL$(ErrMsg)&"   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---identify .mps files in requested directory
 IF VAL$(mps_Keyword)<>"*" THEN
   ICCAP_FUNC("find_mps_files", "Execute")
   IF VAL$(ErrMsg)<>"" THEN
     GET_STRING VAL$(ErrMsg)&"   [OK]", dummy
     RETURN_VALUE 0
   END IF
 ELSE
   !---activate selection of all param. files
   ShowAllMpsFiles = 1
   ShowAllMpsFiles_byDate = 1
   ICCAP_FUNC("do_unix_ls_cmnd", "Execute")
 END IF
 
 IF VAL$(Plots)<>"" THEN
   !---show Plots by calling the central GENERAL_MDLG_GUI  from UTILITIES
   !=====================================================================================
   !Plots      was defined by calling Transform and exported here
 
   Parameters = "Compare"	!"Compare": show only MultiPlot incl. comment. Keep PlotOptimizer opened in the background: -> Simulation is possible.
 
   Comment   = "From the separate window, select previously stored fittings, and compare them.
    Select the best fit, and continue with this selection in the next mdlg. step.
 
    ===>  NOTE: When done, hit 'Done, Continue' in the parameter selection window !! <==="
 
   PO_Error   = ""		! Choices: "Relative", "Absolute", "" (keeps last selection)
   !=====================================================================================
   !                                                                                                             path to calling Transform
   ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/START_MDLG_GUI", "Execute", VAL$(Plots), VAL$(Parameters), VAL$(Path2Xfm), VAL$(Comment), VAL$(PO_Error))
   
   
   !---simulate (we make use of having called the GENERAL_MDLG_GUI utility, because it is possible that the user has defined Plots from different Setups)
   Path2FirstPlot=VAL$(../../MDLG_GUI/GENERAL_MDLG_GUI/Path2FirstPlot)
   ICCAP_FUNC(VAL$(Path2FirstPlot)&"/PlotOptimizer", "Simulate All")
 END IF
 
 
 !---for recovering, store current Circuit and ModelParameters of calling ModelFile (don't use ModelParam Memory Store, this would not save the param. limits which might be changed by loaded other .mps files)
 ICCAP_FUNC(VAL$(Path2Setup)&"/../../Circuit",         "Save As", "./tmp.cir")
 ICCAP_FUNC(VAL$(Path2Setup)&"/../../ParameterSet",    "Save As", "./tmp.mps")
 !---store also current DutCircuit and its DutParameters of Parent DUT of calling ModelFile's Setup
 ICCAP_FUNC(VAL$(Path2Setup)&"/../TestCircuit",        "Save As", "./tmp.tci")   
 ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "Save As", "./tmp.dps")   
 
 
 !---open .mps file selection GUI
 ICCAP_FUNC("./TL_select_mps_files", "Display Modeless GUI", "Select .mps file for comparison with current param.values")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________2" "711.501"
{
}
LINK XFORM "find_mps_files" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  mps_FileNames
 GLOBAL_VAR  mps_FileNames_sel
 GLOBAL_VAR  ShowAllMpsFiles
 GLOBAL_VAR  ShowAllMpsFiles_byDate
 GLOBAL_VAR  mps_Keyword
 GLOBAL_VAR  ErrMsg
 
 
 ErrMsg=""
 
 
 !---remember current .mps file selection
 old_mps_FileName=""
 IF VAL(mps_FileNames_sel)>-1 THEN old_mps_FileName = VAL$(mps_FileNames[mps_FileNames_sel])
 
 
 !---unselect all .mps files
 mps_FileNames_sel=-1
 
 !---perform Unix command-------------------------------
 ICCAP_FUNC("do_unix_ls_cmnd", "Execute")
 !------------------------------------------------------
 
 
 !---verify if no .mps files found
 IF (SIZEOF(mps_FileNames)==0) AND (VAL(ShowAllMpsFiles)==0) THEN
   ErrMsg="User has hit Cancel"
   GET_STRING "WARNING: no saved ModelParameter sets for this particular modeling step keyword '"&VAL$(mps_Keyword)&"'
    found in directory '"&SYS_PATH$(VAL$(mps_DirName))&"'
 
    Hit [OK] to show *all* available files", dummy
 
   ErrMsg=""
   ShowAllMpsFiles=1
   ICCAP_FUNC("do_unix_ls_cmnd", "Execute")
 END IF
 
 IF (SIZEOF(mps_FileNames)==0) AND (VAL(ShowAllMpsFiles)==1) THEN
   ErrMsg ="ERROR: no saved ModelParameter sets found in directory
    '"&SYS_PATH$(VAL$(mps_DirName))&"'
   NOTE: the Data and ModelParameter directory is the one
         defined in the Transform of your ModelFile 
         which calls the Program '/UTILITIES/PEL_UTILITIES/COMPARE_PARAMS'"
   RETURN_VALUE 0
 END IF
 
 
 !---recover original .mps file selection
 IF VAL$(old_mps_FileName)<>"" THEN
   FOR i=0 TO SIZEOF(mps_FileNames)-1
     IF VAL$(mps_FileNames[i]) == VAL$(old_mps_FileName) THEN mps_FileNames_sel=i
   NEXT i
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "do_unix_ls_cmnd" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !~~~apply the unix 'ls' command to find the .mps files~~~~~~~~~~~~~~~~~~~~~~~~
 
 GLOBAL_VAR  ShowAllMpsFiles
 GLOBAL_VAR  ShowAllMpsFiles_byDate
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  mps_Keyword
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  mps_FileNames
 
 
 
 !---identify existing Spar fitting  .mps files, including mps_Keyword
 IF VAL(ShowAllMpsFiles)==0 THEN tmpVar=SYSTEM$("ls "&SYS_PATH$(VAL$(mps_DirName))&" | grep "&VAL$(mps_Keyword)&" | grep .mps")
 IF VAL(ShowAllMpsFiles)==1 THEN tmpVar=SYSTEM$("ls "&SYS_PATH$(VAL$(mps_DirName))&" | grep .mps")
 IF VAL(ShowAllMpsFiles_byDate)==1 THEN tmpVar=SYSTEM$("ls -tr "&SYS_PATH$(VAL$(mps_DirName))&" | grep .mps")
 
 !---convert long string to ICCAP_ARRAY (1 entry per found .mps file)
 i=1
 REPEAT
    Loc=STRPOS(VAL$(tmpVar),"
 ", i)
    IF Loc>0 THEN 
       hits=SUBSTR$(VAL$(tmpVar), 1, Loc-1)&" "&SUBSTR$(VAL$(tmpVar), Loc+1)
       i=Loc+1
    END IF
 UNTIL Loc==0
 tmpVar=TRIM$(VAL$(tmpVar))
 
 dummy=CUTSTR(VAL$(tmpVar), mps_FileNames)
 
 IF VAL(ShowAllMpsFiles_byDate)==1 THEN
   !---reorder: latest file at top, for user convenience
   DIMENSION_ARRAY(tmpVar, SIZEOF(mps_FileNames))
   FOR i=0 TO SIZEOF(tmpVar)-1
     tmpVar[i]=SIZEOF(tmpVar)-1-i
   NEXT i
   IF SIZEOF(mps_FileNames)>1 THEN
     RetVal=ARRAY_REORDER(mps_FileNames, tmpVar)
   END IF
 
   tmpVar=""
 END IF
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_handle_mps" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !~~~perform actions on .mps files as requested by the GUI~~~~~~~~~~~~~~~~~~~~~~
 
 
 GLOBAL_VAR  Action_mps_File_sel
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  mps_FileNames
 GLOBAL_VAR  mps_FileName
 GLOBAL_VAR  Loaded_mps_FileName4GUI
 GLOBAL_VAR  mps_FileNames_sel
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  Plots
 GLOBAL_VAR  mps_Contents
 
 
 GET_STRING "Action:   [Load_or_Compare], [Delete], [Recall_Start_Values], [Rename]", "[Load_or_Compare], [View Header]", Action
 
 
 !---exit if no .mps file has been selected
 IF  VAL$(Action)<>"Recall_Start_Values" THEN
   IF VAL(mps_FileNames_sel) == -1 THEN 
 !    GET_STRING "ERROR: no file has been selected !  [OK]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 
 !---split Action 'Load_or_Compare'
 IF VAL$(Action)=="Load_or_Compare" THEN
   IF VAL(Action_mps_File_sel)==0 THEN Action="Load"
   IF VAL(Action_mps_File_sel)==1 THEN Action="Compare"
 END IF
 
 
 !---RECALL START VALUES------------------------------------------------------
 !   always load first the netlist, then the params
 IF VAL$(Action)=="Recall_Start_Values" THEN
   mps_FileNames_sel=-1
 
   !---if available, recall saved (by COMPARE_PARAMS) Circuit
   cir_NotAvailable = SYSTEM("find ./tmp.cir  1> /dev/null 2> /dev/null")
   IF cir_NotAvailable==0 THEN
     ICCAP_FUNC(VAL$(Path2Setup)&"/../../Circuit", "Open", "./tmp.cir")
   END IF
 
   !---recall saved (by COMPARE_PARAMS) ModelParameters in calling ModelFile
   ICCAP_FUNC(VAL$(Path2Setup)&"/../../ParameterSet", "Open", "./tmp.mps")
 
   !---recall also saved DutTestCircuit & its Parameters, if available 
   tci_NotAvailable = SYSTEM("find ./tmp.tci  1> /dev/null 2> /dev/null")
   IF tci_NotAvailable==0 THEN
     ICCAP_FUNC(VAL$(Path2Setup)&"/../TestCircuit", "Open", "./tmp.tci")
   END IF
   dps_NotAvailable = SYSTEM("find ./tmp.dps  1> /dev/null 2> /dev/null")
   IF dps_NotAvailable==0 THEN
     ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "Open", "./tmp.dps")
   END IF
 
 
   IF VAL$(Plots)<>"" THEN
     !---simulate (we make use of having called the GENERAL_MDLG_GUI utility, because it is possible that the user has defined Plots from different Setups)
     PRINT "simulating ..."
     Path2FirstPlot=VAL$(../../MDLG_GUI/GENERAL_MDLG_GUI/Path2FirstPlot)
     ICCAP_FUNC(VAL$(Path2FirstPlot)&"/PlotOptimizer", "Simulate All")
   ELSE
     !---the currently displayed data (of the current Setup) needs to be re-simulated
     ICCAP_FUNC(VAL$(Path2Setup), "Simulate")
   END IF
 
   Loaded_mps_FileName4GUI = "==> Recalled Starting Param. Values <=="
   !---bring GUI back to top level
   ICCAP_FUNC("./TL_select_mps_files", "Display Modeless GUI", "Select .mps file for comparison with current param.values")
 
   RETURN_VALUE 1
 END IF
 !-------------------------------------------------------------------
 
 
 !---prepare mps_FileName for the actions further below
 mps_FileName = VAL$(mps_FileNames[mps_FileNames_sel])
 !   cut-off possible .mps file extension
 FileExtensionLocation = STRPOS(VAL$(mps_FileName), ".mps")
 IF FileExtensionLocation>0 THEN
   mps_FileName_wo_ext = SUBSTR$(VAL$(mps_FileName), 1, FileExtensionLocation-1)
 END IF
 
 
 !---LOAD-------------------------------------------------------------
 !   always load first the netlist, then the params
 IF VAL$(Action)=="Load" THEN
   tmp_mps_DirName = SYS_PATH$(VAL$(mps_DirName))
   !---if available, load first the corresponding .cir file
   cir_DirFileName = VAL$(tmp_mps_DirName)&"/"&VAL$(mps_FileName_wo_ext)&".cir"
   cir_NotAvailable = SYSTEM("find "&VAL$(cir_DirFileName)&" 1> /dev/null 2> /dev/null")
   IF cir_NotAvailable==0 THEN
     IF VAL(Debug)==1 THEN PRINT "   loading Circuit netlist ..."
     ICCAP_FUNC(VAL$(Path2Setup)&"/../../Circuit", "Open", VAL$(cir_DirFileName))
   END IF
 
   !---load selected .mps file
   mps_DirFileName = VAL$(tmp_mps_DirName)&"/"&VAL$(mps_FileName)
   ICCAP_FUNC(VAL$(Path2Setup)&"/../../ParameterSet", "Open", mps_DirFileName)
   IF VAL(Debug)==1 THEN PRINT "   loading model params ..."
 
   !---if available, load also selected .tci and .dps file
   tci_FileName = VAL$(mps_FileName_wo_ext)
   tci_DirFileName = VAL$(tmp_mps_DirName)&"/"&VAL$(tci_FileName)&".TestCkt.tci"
   tci_NotAvailable = SYSTEM("find "&VAL$(tci_DirFileName)&" 1> /dev/null 2> /dev/null")
   IF tci_NotAvailable==0 THEN
     ICCAP_FUNC(VAL$(Path2Setup)&"/../TestCircuit", "Open", VAL$(tci_DirFileName))
     IF VAL(Debug)==1 THEN PRINT "   loading test ckt. ..."
   END IF
   dps_FileName = VAL$(mps_FileName_wo_ext)
   dps_DirFileName = VAL$(tmp_mps_DirName)&"/"&VAL$(dps_FileName)&".TestCkt.dps"
   dps_NotAvailable = SYSTEM("find "&VAL$(dps_DirFileName)&" 1> /dev/null 2> /dev/null")
   IF dps_NotAvailable==0 THEN
     ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "ReadOnlyValues", VAL$(dps_DirFileName))
     IF VAL(Debug)==1 THEN PRINT "   loading test ckt. params ..."
   END IF
 
   IF VAL$(Plots)<>"" THEN
     !---simulate (we make use of having called the GENERAL_MDLG_GUI utility, because it is possible that the user has defined Plots from different Setups)
     Path2FirstPlot=VAL$(../../MDLG_GUI/GENERAL_MDLG_GUI/Path2FirstPlot)
     ICCAP_FUNC(VAL$(Path2FirstPlot)&"/PlotOptimizer", "Simulate All")
   ELSE
     !---the currently displayed data (of the current Setup) needs to be re-simulated
     ICCAP_FUNC(VAL$(Path2Setup), "Simulate")
   END IF
 
   Loaded_mps_FileName4GUI = VAL$(mps_FileName)
 
   !---bring GUI back to top level
   ICCAP_FUNC("./TL_select_mps_files", "Display Modeless GUI", "Select .mps file for comparison with current param.values")
 
   RETURN_VALUE 2
 END IF
 
 
 !---COMPARE-------------------------------------------------------------
 !          compare currently active param.values with values in .mps file
 IF VAL$(Action)=="Compare" THEN
   ICCAP_FUNC("show_param_diff", "Execute")
   RETURN_VALUE 3
 END IF
 
 
 !---DELETE-------------------------------------------------------------
 IF VAL$(Action)=="Delete" THEN
   IF SIZEOF(mps_FileNames)==1 THEN
     !---it's the last .mps file
     GET_STRING "ATTENTION: Do you really want to delete the last available .mps file ?
       [OK] to delete
       [Cancel] to keep the file", dummy 
   ELSE
     !---final question before deleting
     GET_STRING "ATTENTION: Do you really want to delete the file                  
       "&VAL$(mps_FileName)&"  ?
       [OK] to delete
       [Cancel] to keep the file", dummy 
   END IF
 
   !---delete selected .mps file
   mps_DirFileName=SYS_PATH$(VAL$(mps_DirName)&"/"&VAL$(mps_FileName_wo_ext)&".mps")
   dummy=SYSTEM("rm -f "&VAL$(mps_DirFileName))
 
   !---delete also the .cir and the .tci & .dps files (if they exist)
   cir_DirFileName = SYS_PATH$(VAL$(mps_DirName)&"/"&VAL$(mps_FileName_wo_ext)&".cir")
   dummy = SYSTEM("rm -f "&VAL$(cir_DirFileName)&" 2> /dev/null")	!delete and don't show error message (if file did not exist)
   tci_DirFileName = SYS_PATH$(VAL$(mps_DirName)&"/"&VAL$(mps_FileName_wo_ext)&".TestCkt.tci")
   dummy = SYSTEM("rm -f "&VAL$(tci_DirFileName)&" 2> /dev/null")	!delete and don't show error message (if file did not exist)
   dps_DirFileName = SYS_PATH$(VAL$(mps_DirName)&"/"&VAL$(mps_FileName_wo_ext)&".TestCkt.dps")
   dummy = SYSTEM("rm -f "&VAL$(dps_DirFileName)&" 2> /dev/null")	!delete and don't show error message (if file did not exist)
 
   !---delete entry in array for GUI
   dummy=ARRAY_REMOVE_AT(mps_FileNames, mps_FileNames_sel)
   mps_FileNames_sel=-1
   RETURN_VALUE 4
 END IF
 
 
 !---RENAME-------------------------------------------------------------
 IF VAL$(Action)=="Rename" THEN
   !---rename the .mps file
   GET_STRING "Edit .mps File Name                                            [OK], [Cancel]", mps_FileName, mps_FileNameNew
   DirName=SYS_PATH$(VAL$(mps_DirName))
   dummy=SYSTEM("cd "&VAL$(DirName) &"
 mv "&VAL$(mps_FileName)&" "&VAL$(mps_FileNameNew))
   mps_FileNames[mps_FileNames_sel]=VAL$(mps_FileNameNew)
 
   !   cut-off .mps file extension of mps_FileNameNew
   FileExtensionLocation = STRPOS(VAL$(mps_FileNameNew), ".mps")
   IF FileExtensionLocation>0 THEN
     mps_FileNameNew_wo_ext = SUBSTR$(VAL$(mps_FileNameNew), 1, FileExtensionLocation-1)
   END IF
 
   !---rename also the .cir file (if it exists)
   cir_FileName = VAL$(mps_FileName_wo_ext)&".cir"
   cir_FileNameNew = VAL$(mps_FileNameNew_wo_ext)&".cir"
   !---rename only if file exists
   cir_DirFileName = VAL$(DirName)&"/"&VAL$(cir_FileName)
   cir_NotAvailable = SYSTEM("find "&VAL$(cir_DirFileName)&" 1> /dev/null 2> /dev/null")	!dump any unix command output incl. error to /dev/null
   IF cir_NotAvailable==0 THEN
     dummy=SYSTEM("cd "&VAL$(DirName)&"
 mv "&VAL$(cir_FileName)&" "&VAL$(cir_FileNameNew))
   END IF
 
   !---rename also the .tci file (if it exists)
   tci_FileName = VAL$(mps_FileName_wo_ext)&".TestCkt.tci"
   tci_FileNameNew = VAL$(mps_FileNameNew_wo_ext)&".TestCkt.tci"
   !---rename only if file exists
   tci_DirFileName = VAL$(DirName)&"/"&VAL$(tci_FileName)
   tci_NotAvailable = SYSTEM("find "&VAL$(tci_DirFileName)&" 1> /dev/null 2> /dev/null")	!dump any unix command output incl. error to /dev/null
   IF tci_NotAvailable==0 THEN
     dummy=SYSTEM("cd "&VAL$(DirName)&"
 mv "&VAL$(tci_FileName)&" "&VAL$(tci_FileNameNew))
   END IF
 
   !---rename also the .dps file (if it exists)
   dps_FileName = VAL$(mps_FileName_wo_ext)&".TestCkt.dps"
   dps_FileNameNew = VAL$(mps_FileNameNew_wo_ext)&".TestCkt.dps"
   !---rename only if file exists
   dps_DirFileName = VAL$(DirName)&"/"&VAL$(dps_FileName)
   dps_NotAvailable = SYSTEM("find "&VAL$(dps_DirFileName)&" 1> /dev/null 2> /dev/null")	!dump any unix command output incl. error to /dev/null
   IF dps_NotAvailable==0 THEN
     dummy=SYSTEM("cd "&VAL$(DirName)&"
 mv "&VAL$(dps_FileName)&" "&VAL$(dps_FileNameNew))
   END IF
 
   RETURN_VALUE 5
 END IF
 
 
 !---VIEW .mps FILE-------------------------------------------------------------
 IF VAL$(Action)=="View Header" THEN
   mps_DirFileName=SYS_PATH$(VAL$(mps_DirName)&"/"&VAL$(mps_FileName_wo_ext)&".mps")
   mps_Contents = SYSTEM$("cat "&VAL$(mps_DirFileName))
   ! important: it *needs to be a modal GUI*, because we need to clear the variable 'mps_Contents'
   !            If not cleared, it will corrupt the model file due to the " signs in the .mps file confusing the IC-CAP model file structure !!!
   ICCAP_FUNC("./TL_mpsContents", "Display Modal GUI", "mps File Contents")
   mps_Contents = ""
 END IF
 
 
 RETURN_VALUE 0
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "show_param_diff" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program will identify those parameters which are *different* in both files.
 ! Parameters with identical values are ignored !
 
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  mps_FileNames
 GLOBAL_VAR  mps_FileNames_sel
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  ParamValComparison
 GLOBAL_VAR  RowNames
 GLOBAL_VAR  ParamValRatio
 
 
 Path2ModelParamSet = VAL$(Path2Setup)&"/../../ParameterSet"
 
 
 !---store the current param.values to tab 'Memory Stored'
 ICCAP_FUNC(VAL$(Path2ModelParamSet), "Memory Store")
 
 
 !---load the .mps file
 mps_DirFileName = VAL$(mps_DirName)&"/"&VAL$(mps_FileNames[mps_FileNames_sel])
 ICCAP_FUNC(VAL$(Path2ModelParamSet), "ReadOnlyValues", VAL$(mps_DirFileName))
 
 
 !---go thru the param values and compare 
 RowNames = ""
 ParamValComparison = ""
 iParam = 0
 N=0
 LOOP
   ErrStr=""
   ParamName      = LOOKUP_TABLE_VAL(VAL$(Path2ModelParamSet), "Param Name["&VAL$(N)&"]", ErrStr)
   EXIT IF VAL$(ErrStr)<>""		!Last Param
   ! bug in IC-CAP 2013: we need the following line twice
   ParamValueFile = LOOKUP_TABLE_VAL_EVAL(VAL$(Path2ModelParamSet), "Value["&VAL$(N)&"]", ErrStr)
   ParamValueFile = LOOKUP_TABLE_VAL_EVAL(VAL$(Path2ModelParamSet), "Value["&VAL$(N)&"]", ErrStr)
   ParamValue_act = LOOKUP_TABLE_VAL(VAL$(Path2ModelParamSet), "Memory Stored["&VAL$(N)&"]", ErrStr)
 
   !---compare ModelParam values
   IF VAL(ParamValueFile)<>VAL(ParamValue_act) THEN
     PRINT ParamName, ParamValueFile, ParamValue_act
     iParam = iParam + 1
     DIMENSION_ARRAY(RowNames, iParam)
     RowNames[iParam-1] = ParamName
     DIMENSION_ARRAY(ParamValComparison, iParam, 3)
     ParamValComparison[iParam-1][0] = VAL(ParamValue_act)
     ParamValComparison[iParam-1][1] = VAL(ParamValueFile)
   END IF
   N = N + 1
 END LOOP
 ErrStr=""
 
 
 !---recall stored current param.values
 ICCAP_FUNC(VAL$(Path2ModelParamSet), "Memory Recall")
 
 
 !---check param. value difference
 ParamValRatio = 10
 ICCAP_FUNC("gui_analyze_diff", "Execute")
 
 
 !---reset tmp vars
 tmpVar=""
 tmpVar1=""
 tmpVar2=""
 
 
 !---open GUI
 IF SIZEOF(RowNames)>0 THEN
   ICCAP_FUNC("./TL_Show_ParamVal_Difference", "Display Modeless GUI", "Model Parameter Values")
 ELSE
   GET_STRING "No Difference in Parameter Values Found !   [OK]", dummy
 END IF
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_analyze_diff" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 
 GLOBAL_VAR  ParamValComparison
 GLOBAL_VAR  ParamValRatio
 
 
 FOR i=0 TO SIZEOF(ParamValComparison)-1
   ParamValComparison[i][2] = ""
 
   ParamVal1 = VAL(ParamValComparison[i][0])
   ParamVal2 = VAL(ParamValComparison[i][1])
 
   !---add marker if param.values ratio exceeds ParamValRatio
   IF ParamVal1<>0 THEN
     IF ABS(ABS(ParamVal2)//ABS(ParamVal1))>ParamValRatio THEN
       ParamValComparison[i][2] = "   !!!!"
     END IF
   END IF
   IF ParamVal2<>0 THEN
     IF ABS(ABS(ParamVal1)//ABS(ParamVal2))>ParamValRatio THEN
       ParamValComparison[i][2] = "   !!!!"
     END IF
   END IF
 
 
   !---add marker if one of the param.values is 0, and the other is not 0
   IF (ParamVal1==0) ORELSE (ParamVal2==0) THEN
     ParamValComparison[i][2] = "   !!!!"
   END IF
 
 NEXT i
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_print_param_diff" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ColNames
 GLOBAL_VAR  RowNames
 GLOBAL_VAR  ParamValRatio
 GLOBAL_VAR  ParamValComparison
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  mps_FileNames
 GLOBAL_VAR  mps_FileNames_sel
 
 
 GET_STRING "Enter DirFileName for Printing                                          .", VAL$(mps_DirName)&"/__ParamDiff.txt", DirFileName
 
 dummy=SYSTEM("rm "&VAL$(SYS_PATH$(VAL$(DirFileName)))&"  2> /dev/null")
 PRINTER IS VAL$(DirFileName)
 
 ColumnSpace = 17
 
 !---print header
 PRINT ".mps file name: ";mps_FileNames[mps_FileNames_sel]
 PRINT
 PRINT "NOTE: Parameters with identical values in both files are ignored !"
 PRINT
 PRINT "                           Parameter Value Ratio: ";ParamValRatio
 PRINT "ParamName"
 FOR i=0 TO SIZEOF(ColNames)-1
   FOR iSpace=1 TO ColumnSpace*(i+1)
     PRINT " ";
   NEXT iSpace
   PRINT ColNames[i]
 NEXT i
 PRINT "------------------------------------------------------------------------"
 
 !---print param values
 FOR i=0 TO SIZEOF(RowNames)-1
   ParamName = VAL$(RowNames[i])
   PRINT ParamName;
   FOR iSpace=1 TO ColumnSpace-STRLEN(VAL$(ParamName))
     PRINT "_";
   NEXT iSpace
   FOR iParam=0 TO SIZEOF(ParamValComparison[0])-1
     Value = VAL$(ParamValComparison[i][iParam])
     PRINT Value;
     FOR iSpace=1 TO ColumnSpace-STRLEN(VAL$(Value))
       PRINT "_";
     NEXT iSpace
   NEXT iParam
   PRINT
 NEXT i
 
 PRINTER IS CRT
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_exit" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  Plots
 
 
 mps_FileNames_sel=-1
 
 
 GET_STRING "REMINDER: 
  -> to continue with the currently selected param. values 
     (with the fitting currently shown in the Plots),
          hit [OK]
  -> to return back to the GUI,
          hit [Cancel]", dummy
 
 
 !---close the GUI
 ICCAP_FUNC("./TL_select_mps_files", "Destroy GUI", "Select .mps file for comparison with current param.values")
 
 
 IF VAL$(Plots)<>"" THEN
   ICCAP_FUNC("../../MDLG_GUI/GENERAL_MDLG_GUI/GUI_OK_Cancel", "Execute", "OK")
 END IF
 
 
 
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________3" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "Exec. Xfm '"&VAL$(WHOAMI("PartName"))&"'..."
 
 ! For simplicity, we apply 'Program' and not 'Program2'
 
 !---clean up Variables and ICCAP_ARRAYs
 mps_FileNames   = ""
 RowNames        = ""
 ParamValComparison = ""
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "LOAD_PARAMS_KEEP_MIN_MAX" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P29 C15 P149 C10"
element 0 "Name" "ModelName"
element 0 "Value" "/HICUM2_Extract"
element 1 "Name" "ParamNames[0]"
element 1 "Value" "Cparasdemo.C"
element 2 "Name" "ParamNames[1]"
element 2 "Value" "R_Tnode.R"
element 3 "Name" "ParamNames[2]"
element 3 "Value" "MAIN.TNOM"
element 4 "Name" "ParamNames[3]"
element 4 "Value" "MAIN.DT"
element 5 "Name" "ParamNames[4]"
element 5 "Value" "MAIN.C10"
element 6 "Name" "ParamNames[5]"
element 6 "Value" "MAIN.MCF"
element 7 "Name" "ParamNames[6]"
element 7 "Value" "MAIN.QP0"
element 8 "Name" "ParamNames[7]"
element 8 "Value" "MAIN.ICH"
element 9 "Name" "ParamNames[8]"
element 9 "Value" "MAIN.HF0"
element 10 "Name" "ParamNames[9]"
element 10 "Value" "MAIN.HFE"
element 11 "Name" "ParamNames[10]"
element 11 "Value" "MAIN.HFC"
element 12 "Name" "ParamNames[11]"
element 12 "Value" "MAIN.HJEI"
element 13 "Name" "ParamNames[12]"
element 13 "Value" "MAIN.AHJEI"
element 14 "Name" "ParamNames[13]"
element 14 "Value" "MAIN.RHJEI"
element 15 "Name" "ParamNames[14]"
element 15 "Value" "MAIN.HJCI"
element 16 "Name" "ParamNames[15]"
element 16 "Value" "MAIN.IBEIS"
element 17 "Name" "ParamNames[16]"
element 17 "Value" "MAIN.MBEI"
element 18 "Name" "ParamNames[17]"
element 18 "Value" "MAIN.IREIS"
element 19 "Name" "ParamNames[18]"
element 19 "Value" "MAIN.MREI"
element 20 "Name" "ParamNames[19]"
element 20 "Value" "MAIN.IBEPS"
element 21 "Name" "ParamNames[20]"
element 21 "Value" "MAIN.MBEP"
element 22 "Name" "ParamNames[21]"
element 22 "Value" "MAIN.IREPS"
element 23 "Name" "ParamNames[22]"
element 23 "Value" "MAIN.MREP"
element 24 "Name" "ParamNames[23]"
element 24 "Value" "MAIN.TBHREC"
element 25 "Name" "ParamNames[24]"
element 25 "Value" "MAIN.IBCIS"
element 26 "Name" "ParamNames[25]"
element 26 "Value" "MAIN.MBCI"
element 27 "Name" "ParamNames[26]"
element 27 "Value" "MAIN.IBCXS"
element 28 "Name" "ParamNames[27]"
element 28 "Value" "MAIN.MBCX"
element 29 "Name" "ParamNames[28]"
element 29 "Value" "MAIN.IBETS"
element 30 "Name" "ParamNames[29]"
element 30 "Value" "MAIN.ABET"
element 31 "Name" "ParamNames[30]"
element 31 "Value" "MAIN.TUNODE"
element 32 "Name" "ParamNames[31]"
element 32 "Value" "MAIN.FAVL"
element 33 "Name" "ParamNames[32]"
element 33 "Value" "MAIN.QAVL"
element 34 "Name" "ParamNames[33]"
element 34 "Value" "MAIN.RBI0"
element 35 "Name" "ParamNames[34]"
element 35 "Value" "MAIN.RBX"
element 36 "Name" "ParamNames[35]"
element 36 "Value" "MAIN.FGEO"
element 37 "Name" "ParamNames[36]"
element 37 "Value" "MAIN.FDQR0"
element 38 "Name" "ParamNames[37]"
element 38 "Value" "MAIN.FCRBI"
element 39 "Name" "ParamNames[38]"
element 39 "Value" "MAIN.FQI"
element 40 "Name" "ParamNames[39]"
element 40 "Value" "MAIN.RE"
element 41 "Name" "ParamNames[40]"
element 41 "Value" "MAIN.RCX"
element 42 "Name" "ParamNames[41]"
element 42 "Value" "MAIN.ITSS"
element 43 "Name" "ParamNames[42]"
element 43 "Value" "MAIN.MSF"
element 44 "Name" "ParamNames[43]"
element 44 "Value" "MAIN.ISCS"
element 45 "Name" "ParamNames[44]"
element 45 "Value" "MAIN.MSC"
element 46 "Name" "ParamNames[45]"
element 46 "Value" "MAIN.TSF"
element 47 "Name" "ParamNames[46]"
element 47 "Value" "MAIN.RSU"
element 48 "Name" "ParamNames[47]"
element 48 "Value" "MAIN.CSU"
element 49 "Name" "ParamNames[48]"
element 49 "Value" "MAIN.CJEI0"
element 50 "Name" "ParamNames[49]"
element 50 "Value" "MAIN.VDEI"
element 51 "Name" "ParamNames[50]"
element 51 "Value" "MAIN.ZEI"
element 52 "Name" "ParamNames[51]"
element 52 "Value" "MAIN.AJEI"
element 53 "Name" "ParamNames[52]"
element 53 "Value" "MAIN.CJEP0"
element 54 "Name" "ParamNames[53]"
element 54 "Value" "MAIN.VDEP"
element 55 "Name" "ParamNames[54]"
element 55 "Value" "MAIN.ZEP"
element 56 "Name" "ParamNames[55]"
element 56 "Value" "MAIN.AJEP"
element 57 "Name" "ParamNames[56]"
element 57 "Value" "MAIN.CJCI0"
element 58 "Name" "ParamNames[57]"
element 58 "Value" "MAIN.VDCI"
element 59 "Name" "ParamNames[58]"
element 59 "Value" "MAIN.ZCI"
element 60 "Name" "ParamNames[59]"
element 60 "Value" "MAIN.VPTCI"
element 61 "Name" "ParamNames[60]"
element 61 "Value" "MAIN.CJCX0"
element 62 "Name" "ParamNames[61]"
element 62 "Value" "MAIN.VDCX"
element 63 "Name" "ParamNames[62]"
element 63 "Value" "MAIN.ZCX"
element 64 "Name" "ParamNames[63]"
element 64 "Value" "MAIN.VPTCX"
element 65 "Name" "ParamNames[64]"
element 65 "Value" "MAIN.CJS0"
element 66 "Name" "ParamNames[65]"
element 66 "Value" "MAIN.VDS"
element 67 "Name" "ParamNames[66]"
element 67 "Value" "MAIN.ZS"
element 68 "Name" "ParamNames[67]"
element 68 "Value" "MAIN.VPTS"
element 69 "Name" "ParamNames[68]"
element 69 "Value" "MAIN.CBEPAR"
element 70 "Name" "ParamNames[69]"
element 70 "Value" "MAIN.FBCPAR"
element 71 "Name" "ParamNames[70]"
element 71 "Value" "MAIN.CBCPAR"
element 72 "Name" "ParamNames[71]"
element 72 "Value" "MAIN.FBEPAR"
element 73 "Name" "ParamNames[72]"
element 73 "Value" "MAIN.T0"
element 74 "Name" "ParamNames[73]"
element 74 "Value" "MAIN.DT0H"
element 75 "Name" "ParamNames[74]"
element 75 "Value" "MAIN.TBVL"
element 76 "Name" "ParamNames[75]"
element 76 "Value" "MAIN.TEF0"
element 77 "Name" "ParamNames[76]"
element 77 "Value" "MAIN.GTFE"
element 78 "Name" "ParamNames[77]"
element 78 "Value" "MAIN.THCS"
element 79 "Name" "ParamNames[78]"
element 79 "Value" "MAIN.AHC"
element 80 "Name" "ParamNames[79]"
element 80 "Value" "MAIN.FTHC"
element 81 "Name" "ParamNames[80]"
element 81 "Value" "MAIN.RCI0"
element 82 "Name" "ParamNames[81]"
element 82 "Value" "MAIN.VLIM"
element 83 "Name" "ParamNames[82]"
element 83 "Value" "MAIN.VCES"
element 84 "Name" "ParamNames[83]"
element 84 "Value" "MAIN.VPT"
element 85 "Name" "ParamNames[84]"
element 85 "Value" "MAIN.DELCK"
element 86 "Name" "ParamNames[85]"
element 86 "Value" "MAIN.TR"
element 87 "Name" "ParamNames[86]"
element 87 "Value" "MAIN.VCBAR"
element 88 "Name" "ParamNames[87]"
element 88 "Value" "MAIN.ICBAR"
element 89 "Name" "ParamNames[88]"
element 89 "Value" "MAIN.ACBAR"
element 90 "Name" "ParamNames[89]"
element 90 "Value" "MAIN.ALQF"
element 91 "Name" "ParamNames[90]"
element 91 "Value" "MAIN.ALIT"
element 92 "Name" "ParamNames[91]"
element 92 "Value" "MAIN.FLNQS"
element 93 "Name" "ParamNames[92]"
element 93 "Value" "MAIN.KF"
element 94 "Name" "ParamNames[93]"
element 94 "Value" "MAIN.AF"
element 95 "Name" "ParamNames[94]"
element 95 "Value" "MAIN.CFBE"
element 96 "Name" "ParamNames[95]"
element 96 "Value" "MAIN.KFRE"
element 97 "Name" "ParamNames[96]"
element 97 "Value" "MAIN.AFRE"
element 98 "Name" "ParamNames[97]"
element 98 "Value" "MAIN.FLCONO"
element 99 "Name" "ParamNames[98]"
element 99 "Value" "MAIN.LATB"
element 100 "Name" "ParamNames[99]"
element 100 "Value" "MAIN.LATL"
element 101 "Name" "ParamNames[100]"
element 101 "Value" "MAIN.VGB"
element 102 "Name" "ParamNames[101]"
element 102 "Value" "MAIN.F1VG"
element 103 "Name" "ParamNames[102]"
element 103 "Value" "MAIN.F2VG"
element 104 "Name" "ParamNames[103]"
element 104 "Value" "MAIN.ZETACT"
element 105 "Name" "ParamNames[104]"
element 105 "Value" "MAIN.VGE"
element 106 "Name" "ParamNames[105]"
element 106 "Value" "MAIN.ZETABET"
element 107 "Name" "ParamNames[106]"
element 107 "Value" "MAIN.VGC"
element 108 "Name" "ParamNames[107]"
element 108 "Value" "MAIN.VGS"
element 109 "Name" "ParamNames[108]"
element 109 "Value" "MAIN.DVGBE"
element 110 "Name" "ParamNames[109]"
element 110 "Value" "MAIN.ZETAHJEI"
element 111 "Name" "ParamNames[110]"
element 111 "Value" "MAIN.ZETAVGBE"
element 112 "Name" "ParamNames[111]"
element 112 "Value" "MAIN.ALT0"
element 113 "Name" "ParamNames[112]"
element 113 "Value" "MAIN.KT0"
element 114 "Name" "ParamNames[113]"
element 114 "Value" "MAIN.ZETACI"
element 115 "Name" "ParamNames[114]"
element 115 "Value" "MAIN.ALVS"
element 116 "Name" "ParamNames[115]"
element 116 "Value" "MAIN.ALCES"
element 117 "Name" "ParamNames[116]"
element 117 "Value" "MAIN.ZETARBI"
element 118 "Name" "ParamNames[117]"
element 118 "Value" "MAIN.ZETARBX"
element 119 "Name" "ParamNames[118]"
element 119 "Value" "MAIN.ZETARCX"
element 120 "Name" "ParamNames[119]"
element 120 "Value" "MAIN.ZETARE"
element 121 "Name" "ParamNames[120]"
element 121 "Value" "MAIN.ZETARTH"
element 122 "Name" "ParamNames[121]"
element 122 "Value" "MAIN.ALRTH"
element 123 "Name" "ParamNames[122]"
element 123 "Value" "MAIN.ZETACX"
element 124 "Name" "ParamNames[123]"
element 124 "Value" "MAIN.ALFAV"
element 125 "Name" "ParamNames[124]"
element 125 "Value" "MAIN.ALQAV"
element 126 "Name" "ParamNames[125]"
element 126 "Value" "MAIN.ALB"
element 127 "Name" "ParamNames[126]"
element 127 "Value" "MAIN.FLCOMP"
element 128 "Name" "ParamNames[127]"
element 128 "Value" "MAIN.RTH"
element 129 "Name" "ParamNames[128]"
element 129 "Value" "MAIN.CTH"
element 130 "Name" "ParamNames[129]"
element 130 "Value" "MAIN.FLSH"
element 131 "Name" "ParamNames"
element 131 "Value" "ICCAP_ARRAY[130]"
element 132 "Name" "ParamMins[0]"
element 132 "Value" ""
element 133 "Name" "ParamMins[1]"
element 133 "Value" ""
element 134 "Name" "ParamMins[2]"
element 134 "Value" ""
element 135 "Name" "ParamMins[3]"
element 135 "Value" ""
element 136 "Name" "ParamMins[4]"
element 136 "Value" "0.000"
element 137 "Name" "ParamMins[5]"
element 137 "Value" "1.000E-030"
element 138 "Name" "ParamMins[6]"
element 138 "Value" "1.000E-030"
element 139 "Name" "ParamMins[7]"
element 139 "Value" "0.000"
element 140 "Name" "ParamMins[8]"
element 140 "Value" "0.000"
element 141 "Name" "ParamMins[9]"
element 141 "Value" "0.000"
element 142 "Name" "ParamMins[10]"
element 142 "Value" "0.000"
element 143 "Name" "ParamMins[11]"
element 143 "Value" "0.000"
element 144 "Name" "ParamMins[12]"
element 144 "Value" "0.000"
element 145 "Name" "ParamMins[13]"
element 145 "Value" "1.000E-030"
element 146 "Name" "ParamMins[14]"
element 146 "Value" "0.000"
element 147 "Name" "ParamMins[15]"
element 147 "Value" "0.000"
element 148 "Name" "ParamMins[16]"
element 148 "Value" "1.000E-030"
element 149 "Name" "ParamMins[17]"
element 149 "Value" "0.000"
element 150 "Name" "ParamMins[18]"
element 150 "Value" "1.000E-030"
element 151 "Name" "ParamMins[19]"
element 151 "Value" "0.000"
element 152 "Name" "ParamMins[20]"
element 152 "Value" "1.000E-030"
element 153 "Name" "ParamMins[21]"
element 153 "Value" "0.000"
element 154 "Name" "ParamMins[22]"
element 154 "Value" "1.000E-030"
element 155 "Name" "ParamMins[23]"
element 155 "Value" "0.000"
element 156 "Name" "ParamMins[24]"
element 156 "Value" "0.000"
element 157 "Name" "ParamMins[25]"
element 157 "Value" "1.000E-030"
element 158 "Name" "ParamMins[26]"
element 158 "Value" "0.000"
element 159 "Name" "ParamMins[27]"
element 159 "Value" "1.000E-030"
element 160 "Name" "ParamMins[28]"
element 160 "Value" "0.000"
element 161 "Name" "ParamMins[29]"
element 161 "Value" "0.000"
element 162 "Name" "ParamMins[30]"
element 162 "Value" "0.000"
element 163 "Name" "ParamMins[31]"
element 163 "Value" "0.000"
element 164 "Name" "ParamMins[32]"
element 164 "Value" "0.000"
element 165 "Name" "ParamMins[33]"
element 165 "Value" "0.000"
element 166 "Name" "ParamMins[34]"
element 166 "Value" "0.000"
element 167 "Name" "ParamMins[35]"
element 167 "Value" "0.000"
element 168 "Name" "ParamMins[36]"
element 168 "Value" "-500.0m"
element 169 "Name" "ParamMins[37]"
element 169 "Value" "0.000"
element 170 "Name" "ParamMins[38]"
element 170 "Value" "0.000"
element 171 "Name" "ParamMins[39]"
element 171 "Value" "0.000"
element 172 "Name" "ParamMins[40]"
element 172 "Value" "0.000"
element 173 "Name" "ParamMins[41]"
element 173 "Value" "0.000"
element 174 "Name" "ParamMins[42]"
element 174 "Value" "1.000E-030"
element 175 "Name" "ParamMins[43]"
element 175 "Value" "0.000"
element 176 "Name" "ParamMins[44]"
element 176 "Value" "1.000E-030"
element 177 "Name" "ParamMins[45]"
element 177 "Value" "0.000"
element 178 "Name" "ParamMins[46]"
element 178 "Value" "0.000"
element 179 "Name" "ParamMins[47]"
element 179 "Value" "0.000"
element 180 "Name" "ParamMins[48]"
element 180 "Value" "0.000"
element 181 "Name" "ParamMins[49]"
element 181 "Value" "1.000E-030"
element 182 "Name" "ParamMins[50]"
element 182 "Value" "1.000E-030"
element 183 "Name" "ParamMins[51]"
element 183 "Value" "1.000"
element 184 "Name" "ParamMins[52]"
element 184 "Value" "0.000"
element 185 "Name" "ParamMins[53]"
element 185 "Value" "1.000E-030"
element 186 "Name" "ParamMins[54]"
element 186 "Value" "1.000E-030"
element 187 "Name" "ParamMins[55]"
element 187 "Value" "1.000"
element 188 "Name" "ParamMins[56]"
element 188 "Value" "0.000"
element 189 "Name" "ParamMins[57]"
element 189 "Value" "1.000E-030"
element 190 "Name" "ParamMins[58]"
element 190 "Value" "1.000E-030"
element 191 "Name" "ParamMins[59]"
element 191 "Value" "1.000E-030"
element 192 "Name" "ParamMins[60]"
element 192 "Value" "0.000"
element 193 "Name" "ParamMins[61]"
element 193 "Value" "1.000E-030"
element 194 "Name" "ParamMins[62]"
element 194 "Value" "1.000E-030"
element 195 "Name" "ParamMins[63]"
element 195 "Value" "1.000E-030"
element 196 "Name" "ParamMins[64]"
element 196 "Value" "0.000"
element 197 "Name" "ParamMins[65]"
element 197 "Value" "1.000E-030"
element 198 "Name" "ParamMins[66]"
element 198 "Value" "1.000E-030"
element 199 "Name" "ParamMins[67]"
element 199 "Value" "1.000E-030"
element 200 "Name" "ParamMins[68]"
element 200 "Value" "0.000"
element 201 "Name" "ParamMins[69]"
element 201 "Value" "0.000"
element 202 "Name" "ParamMins[70]"
element 202 "Value" "0.000"
element 203 "Name" "ParamMins[71]"
element 203 "Value" "0.000"
element 204 "Name" "ParamMins[72]"
element 204 "Value" "0.000"
element 205 "Name" "ParamMins[73]"
element 205 "Value" ""
element 206 "Name" "ParamMins[74]"
element 206 "Value" ""
element 207 "Name" "ParamMins[75]"
element 207 "Value" "0.000"
element 208 "Name" "ParamMins[76]"
element 208 "Value" "1.000E-030"
element 209 "Name" "ParamMins[77]"
element 209 "Value" "0.000"
element 210 "Name" "ParamMins[78]"
element 210 "Value" "1.000E-030"
element 211 "Name" "ParamMins[79]"
element 211 "Value" "0.000"
element 212 "Name" "ParamMins[80]"
element 212 "Value" "1.000E-030"
element 213 "Name" "ParamMins[81]"
element 213 "Value" "1.000E-030"
element 214 "Name" "ParamMins[82]"
element 214 "Value" "0.000"
element 215 "Name" "ParamMins[83]"
element 215 "Value" "1.000E-030"
element 216 "Name" "ParamMins[84]"
element 216 "Value" "1.000E-030"
element 217 "Name" "ParamMins[85]"
element 217 "Value" "0.000"
element 218 "Name" "ParamMins[86]"
element 218 "Value" "0.000"
element 219 "Name" "ParamMins[87]"
element 219 "Value" "0.000"
element 220 "Name" "ParamMins[88]"
element 220 "Value" "1.000E-030"
element 221 "Name" "ParamMins[89]"
element 221 "Value" "1.000E-030"
element 222 "Name" "ParamMins[90]"
element 222 "Value" "1.000E-030"
element 223 "Name" "ParamMins[91]"
element 223 "Value" "0.000"
element 224 "Name" "ParamMins[92]"
element 224 "Value" "0.000"
element 225 "Name" "ParamMins[93]"
element 225 "Value" "1.000E-030"
element 226 "Name" "ParamMins[94]"
element 226 "Value" "-2.000"
element 227 "Name" "ParamMins[95]"
element 227 "Value" "0.000"
element 228 "Name" "ParamMins[96]"
element 228 "Value" "1.000E-030"
element 229 "Name" "ParamMins[97]"
element 229 "Value" "0.000"
element 230 "Name" "ParamMins[98]"
element 230 "Value" "0.000"
element 231 "Name" "ParamMins[99]"
element 231 "Value" "0.000"
element 232 "Name" "ParamMins[100]"
element 232 "Value" "1.000E-030"
element 233 "Name" "ParamMins[101]"
element 233 "Value" ""
element 234 "Name" "ParamMins[102]"
element 234 "Value" ""
element 235 "Name" "ParamMins[103]"
element 235 "Value" "-10.00"
element 236 "Name" "ParamMins[104]"
element 236 "Value" "1.000E-030"
element 237 "Name" "ParamMins[105]"
element 237 "Value" "-10.00"
element 238 "Name" "ParamMins[106]"
element 238 "Value" "1.000E-030"
element 239 "Name" "ParamMins[107]"
element 239 "Value" "1.000E-030"
element 240 "Name" "ParamMins[108]"
element 240 "Value" "-10.00"
element 241 "Name" "ParamMins[109]"
element 241 "Value" "-10.00"
element 242 "Name" "ParamMins[110]"
element 242 "Value" "-10.00"
element 243 "Name" "ParamMins[111]"
element 243 "Value" ""
element 244 "Name" "ParamMins[112]"
element 244 "Value" ""
element 245 "Name" "ParamMins[113]"
element 245 "Value" "-10.00"
element 246 "Name" "ParamMins[114]"
element 246 "Value" ""
element 247 "Name" "ParamMins[115]"
element 247 "Value" ""
element 248 "Name" "ParamMins[116]"
element 248 "Value" "-10.00"
element 249 "Name" "ParamMins[117]"
element 249 "Value" "-10.00"
element 250 "Name" "ParamMins[118]"
element 250 "Value" "-10.00"
element 251 "Name" "ParamMins[119]"
element 251 "Value" "-10.00"
element 252 "Name" "ParamMins[120]"
element 252 "Value" "-10.00"
element 253 "Name" "ParamMins[121]"
element 253 "Value" "-10.00"
element 254 "Name" "ParamMins[122]"
element 254 "Value" "-10.00"
element 255 "Name" "ParamMins[123]"
element 255 "Value" ""
element 256 "Name" "ParamMins[124]"
element 256 "Value" ""
element 257 "Name" "ParamMins[125]"
element 257 "Value" ""
element 258 "Name" "ParamMins[126]"
element 258 "Value" "0.000"
element 259 "Name" "ParamMins[127]"
element 259 "Value" "0.000"
element 260 "Name" "ParamMins[128]"
element 260 "Value" "0.000"
element 261 "Name" "ParamMins[129]"
element 261 "Value" "0.000"
element 262 "Name" "ParamMins"
element 262 "Value" "ICCAP_ARRAY[130]"
element 263 "Name" "ParamMaxs[0]"
element 263 "Value" ""
element 264 "Name" "ParamMaxs[1]"
element 264 "Value" ""
element 265 "Name" "ParamMaxs[2]"
element 265 "Value" ""
element 266 "Name" "ParamMaxs[3]"
element 266 "Value" ""
element 267 "Name" "ParamMaxs[4]"
element 267 "Value" "1.000"
element 268 "Name" "ParamMaxs[5]"
element 268 "Value" "10.00"
element 269 "Name" "ParamMaxs[6]"
element 269 "Value" "1.000"
element 270 "Name" "ParamMaxs[7]"
element 270 "Value" ""
element 271 "Name" "ParamMaxs[8]"
element 271 "Value" ""
element 272 "Name" "ParamMaxs[9]"
element 272 "Value" ""
element 273 "Name" "ParamMaxs[10]"
element 273 "Value" ""
element 274 "Name" "ParamMaxs[11]"
element 274 "Value" "100.0"
element 275 "Name" "ParamMaxs[12]"
element 275 "Value" "100.0"
element 276 "Name" "ParamMaxs[13]"
element 276 "Value" "10.00"
element 277 "Name" "ParamMaxs[14]"
element 277 "Value" "100.0"
element 278 "Name" "ParamMaxs[15]"
element 278 "Value" "1.000"
element 279 "Name" "ParamMaxs[16]"
element 279 "Value" "10.00"
element 280 "Name" "ParamMaxs[17]"
element 280 "Value" "1.000"
element 281 "Name" "ParamMaxs[18]"
element 281 "Value" "10.00"
element 282 "Name" "ParamMaxs[19]"
element 282 "Value" "1.000"
element 283 "Name" "ParamMaxs[20]"
element 283 "Value" "10.00"
element 284 "Name" "ParamMaxs[21]"
element 284 "Value" "1.000"
element 285 "Name" "ParamMaxs[22]"
element 285 "Value" "10.00"
element 286 "Name" "ParamMaxs[23]"
element 286 "Value" ""
element 287 "Name" "ParamMaxs[24]"
element 287 "Value" "1.000"
element 288 "Name" "ParamMaxs[25]"
element 288 "Value" "10.00"
element 289 "Name" "ParamMaxs[26]"
element 289 "Value" "1.000"
element 290 "Name" "ParamMaxs[27]"
element 290 "Value" "10.00"
element 291 "Name" "ParamMaxs[28]"
element 291 "Value" "1.000"
element 292 "Name" "ParamMaxs[29]"
element 292 "Value" ""
element 293 "Name" "ParamMaxs[30]"
element 293 "Value" "1.000"
element 294 "Name" "ParamMaxs[31]"
element 294 "Value" ""
element 295 "Name" "ParamMaxs[32]"
element 295 "Value" ""
element 296 "Name" "ParamMaxs[33]"
element 296 "Value" ""
element 297 "Name" "ParamMaxs[34]"
element 297 "Value" ""
element 298 "Name" "ParamMaxs[35]"
element 298 "Value" ""
element 299 "Name" "ParamMaxs[36]"
element 299 "Value" "100.0"
element 300 "Name" "ParamMaxs[37]"
element 300 "Value" "1.000"
element 301 "Name" "ParamMaxs[38]"
element 301 "Value" "1.000"
element 302 "Name" "ParamMaxs[39]"
element 302 "Value" ""
element 303 "Name" "ParamMaxs[40]"
element 303 "Value" ""
element 304 "Name" "ParamMaxs[41]"
element 304 "Value" "1.000"
element 305 "Name" "ParamMaxs[42]"
element 305 "Value" "10.00"
element 306 "Name" "ParamMaxs[43]"
element 306 "Value" "1.000"
element 307 "Name" "ParamMaxs[44]"
element 307 "Value" "10.00"
element 308 "Name" "ParamMaxs[45]"
element 308 "Value" ""
element 309 "Name" "ParamMaxs[46]"
element 309 "Value" ""
element 310 "Name" "ParamMaxs[47]"
element 310 "Value" ""
element 311 "Name" "ParamMaxs[48]"
element 311 "Value" ""
element 312 "Name" "ParamMaxs[49]"
element 312 "Value" "10.00"
element 313 "Name" "ParamMaxs[50]"
element 313 "Value" "1.000"
element 314 "Name" "ParamMaxs[51]"
element 314 "Value" ""
element 315 "Name" "ParamMaxs[52]"
element 315 "Value" ""
element 316 "Name" "ParamMaxs[53]"
element 316 "Value" "10.00"
element 317 "Name" "ParamMaxs[54]"
element 317 "Value" "1.000"
element 318 "Name" "ParamMaxs[55]"
element 318 "Value" ""
element 319 "Name" "ParamMaxs[56]"
element 319 "Value" ""
element 320 "Name" "ParamMaxs[57]"
element 320 "Value" "10.00"
element 321 "Name" "ParamMaxs[58]"
element 321 "Value" "1.000"
element 322 "Name" "ParamMaxs[59]"
element 322 "Value" "100.0"
element 323 "Name" "ParamMaxs[60]"
element 323 "Value" ""
element 324 "Name" "ParamMaxs[61]"
element 324 "Value" "10.00"
element 325 "Name" "ParamMaxs[62]"
element 325 "Value" "1.000"
element 326 "Name" "ParamMaxs[63]"
element 326 "Value" "100.0"
element 327 "Name" "ParamMaxs[64]"
element 327 "Value" ""
element 328 "Name" "ParamMaxs[65]"
element 328 "Value" "10.00"
element 329 "Name" "ParamMaxs[66]"
element 329 "Value" "1.000"
element 330 "Name" "ParamMaxs[67]"
element 330 "Value" "100.0"
element 331 "Name" "ParamMaxs[68]"
element 331 "Value" ""
element 332 "Name" "ParamMaxs[69]"
element 332 "Value" "1.000"
element 333 "Name" "ParamMaxs[70]"
element 333 "Value" ""
element 334 "Name" "ParamMaxs[71]"
element 334 "Value" "1.000"
element 335 "Name" "ParamMaxs[72]"
element 335 "Value" ""
element 336 "Name" "ParamMaxs[73]"
element 336 "Value" ""
element 337 "Name" "ParamMaxs[74]"
element 337 "Value" ""
element 338 "Name" "ParamMaxs[75]"
element 338 "Value" ""
element 339 "Name" "ParamMaxs[76]"
element 339 "Value" "10.00"
element 340 "Name" "ParamMaxs[77]"
element 340 "Value" ""
element 341 "Name" "ParamMaxs[78]"
element 341 "Value" "10.00"
element 342 "Name" "ParamMaxs[79]"
element 342 "Value" "1.000"
element 343 "Name" "ParamMaxs[80]"
element 343 "Value" ""
element 344 "Name" "ParamMaxs[81]"
element 344 "Value" "10.00"
element 345 "Name" "ParamMaxs[82]"
element 345 "Value" "1.000"
element 346 "Name" "ParamMaxs[83]"
element 346 "Value" ""
element 347 "Name" "ParamMaxs[84]"
element 347 "Value" "10.00"
element 348 "Name" "ParamMaxs[85]"
element 348 "Value" ""
element 349 "Name" "ParamMaxs[86]"
element 349 "Value" "1.000"
element 350 "Name" "ParamMaxs[87]"
element 350 "Value" "1.000"
element 351 "Name" "ParamMaxs[88]"
element 351 "Value" "10.00"
element 352 "Name" "ParamMaxs[89]"
element 352 "Value" "1.000"
element 353 "Name" "ParamMaxs[90]"
element 353 "Value" "1.000"
element 354 "Name" "ParamMaxs[91]"
element 354 "Value" "1.000"
element 355 "Name" "ParamMaxs[92]"
element 355 "Value" ""
element 356 "Name" "ParamMaxs[93]"
element 356 "Value" "10.00"
element 357 "Name" "ParamMaxs[94]"
element 357 "Value" "-1.000"
element 358 "Name" "ParamMaxs[95]"
element 358 "Value" ""
element 359 "Name" "ParamMaxs[96]"
element 359 "Value" "10.00"
element 360 "Name" "ParamMaxs[97]"
element 360 "Value" "1.000"
element 361 "Name" "ParamMaxs[98]"
element 361 "Value" ""
element 362 "Name" "ParamMaxs[99]"
element 362 "Value" ""
element 363 "Name" "ParamMaxs[100]"
element 363 "Value" "10.00"
element 364 "Name" "ParamMaxs[101]"
element 364 "Value" ""
element 365 "Name" "ParamMaxs[102]"
element 365 "Value" ""
element 366 "Name" "ParamMaxs[103]"
element 366 "Value" "10.00"
element 367 "Name" "ParamMaxs[104]"
element 367 "Value" "10.00"
element 368 "Name" "ParamMaxs[105]"
element 368 "Value" "10.00"
element 369 "Name" "ParamMaxs[106]"
element 369 "Value" "10.00"
element 370 "Name" "ParamMaxs[107]"
element 370 "Value" "10.00"
element 371 "Name" "ParamMaxs[108]"
element 371 "Value" "10.00"
element 372 "Name" "ParamMaxs[109]"
element 372 "Value" "10.00"
element 373 "Name" "ParamMaxs[110]"
element 373 "Value" "10.00"
element 374 "Name" "ParamMaxs[111]"
element 374 "Value" ""
element 375 "Name" "ParamMaxs[112]"
element 375 "Value" ""
element 376 "Name" "ParamMaxs[113]"
element 376 "Value" "10.00"
element 377 "Name" "ParamMaxs[114]"
element 377 "Value" ""
element 378 "Name" "ParamMaxs[115]"
element 378 "Value" ""
element 379 "Name" "ParamMaxs[116]"
element 379 "Value" "10.00"
element 380 "Name" "ParamMaxs[117]"
element 380 "Value" "10.00"
element 381 "Name" "ParamMaxs[118]"
element 381 "Value" "10.00"
element 382 "Name" "ParamMaxs[119]"
element 382 "Value" "10.00"
element 383 "Name" "ParamMaxs[120]"
element 383 "Value" "10.00"
element 384 "Name" "ParamMaxs[121]"
element 384 "Value" "10.00"
element 385 "Name" "ParamMaxs[122]"
element 385 "Value" "10.00"
element 386 "Name" "ParamMaxs[123]"
element 386 "Value" ""
element 387 "Name" "ParamMaxs[124]"
element 387 "Value" ""
element 388 "Name" "ParamMaxs[125]"
element 388 "Value" ""
element 389 "Name" "ParamMaxs[126]"
element 389 "Value" ""
element 390 "Name" "ParamMaxs[127]"
element 390 "Value" ""
element 391 "Name" "ParamMaxs[128]"
element 391 "Value" ""
element 392 "Name" "ParamMaxs[129]"
element 392 "Value" "2.000"
element 393 "Name" "ParamMaxs"
element 393 "Value" "ICCAP_ARRAY[130]"
element 394 "Name" "___________________________________"
element 394 "Value" ""
element 395 "Name" ""
element 395 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! March 2014   -Si-
 
 
 ! When loading a parameter set into IC-CAP,
 ! and selecting 'Read Values Only', the current 
 ! limits defined in the columns 'Min' and 'Max'
 ! will be extended without a warning, when a loaded param. value
 ! is *outside* this limits range.
 
 
 
 ! The Transforms in this Setup provide a workaround
 ! to keep the param. value limits unchanged, and to rather
 ! clamp the loaded param. value.
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! in your ModelFile, create a Transform with the following contents:
 
 
 !~~~~~~~~~~~~~~~~~~~cut here~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ModelName = WHOIS(".", "Parent Model")
 
 
 !---save the current Min and Max limits
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/LOAD_PARAMS_KEEP_MIN_MAX/Import_Limits", "Execute", VAL$(ModelName))
 
 
 
 !---load a new parameter set
 ICCAP_FUNC("./ParameterSet", "ReadOnlyValues")
 
 
 GET_STRING "The saved Min. and Max. ModelParameter limits will now be loaded back.
   If the new ModelParameter values are outside the saved limits, they will be clamped.
   ==>  In this case, you will get an IC-CAP warning, which you should accept.   [OK]", dummy
 
 
 
 !---load back the saved Min and Max limits
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/LOAD_PARAMS_KEEP_MIN_MAX/Export_Back", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "Import_Limits" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  ModelName
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ParamMins
 GLOBAL_VAR  ParamMaxs
 
 
 !---this program gets the param names and min&max values of loaded ModelName
 
 GET_STRING "Enter /ModelName", ModelName, ModelName
 
 
 ParamNames=""
 ParamMins=""
 ParamMaxs=""
 
 
 N=0
 ErrStr=""
 WHILE VAL$(ErrStr)==""
   ParamName = LOOKUP_TABLE_VAL("/"&VAL$(ModelName)&"/ParameterSet", "Param Name["&VAL$(N)&"]", ErrStr)
   ParamMin  = LOOKUP_TABLE_VAL("/"&VAL$(ModelName)&"/ParameterSet", "Min["&VAL$(N)&"]", ErrStr)
   ParamMax  = LOOKUP_TABLE_VAL("/"&VAL$(ModelName)&"/ParameterSet", "Max["&VAL$(N)&"]", ErrStr)
   IF VAL$(ErrStr)=="" THEN
     DIMENSION_ARRAY("ParamNames",  N+1)
     DIMENSION_ARRAY("ParamMins", N+1)
     DIMENSION_ARRAY("ParamMaxs", N+1)
     ParamNames[N] = ParamName
     ParamMins[N]  = ParamMin
     ParamMaxs[N]  = ParamMax
   END IF
   N = N + 1
 END WHILE
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Export_Back" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  ModelName
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ParamMins
 GLOBAL_VAR  ParamMaxs
 
 
 !---this program exports the min&max param. values back to the loaded ModelName
 
 Path2Param = "/"&VAL$(ModelName)&"/ParameterSet"
 
 FOR i=0 TO SIZEOF(ParamNames)-1
   ICCAP_FUNC(VAL$(Path2Param), "STFV", "Min["  &VAL$(ParamNames[i])&"]", "")
   ICCAP_FUNC(VAL$(Path2Param), "STFV", "Max["  &VAL$(ParamNames[i])&"]", "")
 
   ICCAP_FUNC(VAL$(Path2Param), "STFV", "Min["  &VAL$(ParamNames[i])&"]", VAL$(ParamMins[i]))
   ICCAP_FUNC(VAL$(Path2Param), "STFV", "Max["  &VAL$(ParamNames[i])&"]", VAL$(ParamMaxs[i]))
 NEXT i
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "STOP_PEL_EXECUTION" "711.501"
{
View in_out 0 "0.59881673812546 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P161 P405 C10"
element 0 "Name" "RequestedStopAction"
element 0 "Value" "STOP"
element 0 "Comment" "used for feedback from Xfm StopButton_Check !!"
element 1 "Name" "ErrStr"
element 1 "Value" ""
element 2 "Name" "STOP_Actions[0]"
element 2 "Value" "CONTINUE"
element 3 "Name" "STOP_Actions[1]"
element 3 "Value" "STOP"
element 4 "Name" "STOP_Actions[2]"
element 4 "Value" "STEP until next prober move was performed"
element 5 "Name" "STOP_Actions[3]"
element 5 "Value" "STEP until next measurement was performed"
element 6 "Name" "STOP_Actions"
element 6 "Value" "ICCAP_ARRAY[4]"
element 7 "Name" "STOP_Actions_sel"
element 7 "Value" "1"
element 8 "Name" "________________________1"
element 8 "Value" ""
element 9 "Name" "GUI_x_Pos"
element 9 "Value" "400"
element 10 "Name" "GUI_y_Pos"
element 10 "Value" "211"
element 11 "Name" ""
element 11 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "GUI_STOP_Actions"
element 0 "Value" "TL|OR=VE:WD=130:LX=%#19GUI_x_Pos:LY=%#19GUI_y_Pos|CA=#218./GUI_STOP_Actions&#218Destroy Single GUI|#18LA_Notes:#13Sep:#210RX_Actions:#15PB_OK|1|0"
element 1 "Name" "GUI_STOP_Actions.LA_Notes"
element 1 "Value" "LA|CA=#216Program Halted !:FG=C6|<none>|<none>|1"
element 2 "Name" "GUI_STOP_Actions.Sep"
element 2 "Value" "SE|OR=HO|<none>|<none>|0"
element 3 "Name" "GUI_STOP_Actions.RX_Actions"
element 3 "Value" "RX|CA=#224\012Make Your Choice\072:IT=%#212STOP_Actions:SZ=%#216STOP_Actions_sel|LS=#218./GUI_STOP_Actions&#218Destroy Single GUI|<none>|0"
element 4 "Name" "GUI_STOP_Actions.PB_OK"
element 4 "Value" "PB|CA=#12OK:TO=FW&FH&TR|AC=#218./GUI_STOP_Actions&#218Destroy Single GUI|<none>|0"
element 5 "Name" ""
element 5 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,691,926"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! Hitting the conventional *red STOP* button in the IC-CAP Status Window,
 ! should be considered like an *Emergency STOP Button*, 
 ! because the currently running Transform/Macro is stopped
 ! at an unknown program line number.
 ! Even worse, for nested loops: once an inner loop has been stopped,
 ! the outer loop(s), calling (again) the inner loop(s), will continue to work !!!
 ! Therefore: users hit the *red STOP* button many times, until IC-CAP finally stops.
 
 
 ! Since IC-AP 2009U1, you can add action buttons to the Status window,
 ! which can be applied to stopping nested program loops at well-defined
 ! program lines.
 
 ! This is done by the StopButton_xxx Transforms in this Setup.
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! Copy from Transform 'DEMO_Meas_Spar' or 'DEMO_DC_CV' 
 ! the corresponding lines (enclosed by by ####### markers) 
 ! into your own measurement/modeling project
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "DEMO_DC_CV" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! Copy the program lines between the ###### markers to your own program
 
 
 
 
 
 !===DC&CV WAFERSCANNING LOOP EXAMPLE=============
 
 
 
 !#########################################################################################
 !---initialize the STOP button
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Init", "Execute")
 !#########################################################################################
 
 
 !---MEASUREMENT LOOP  etc.--------------------------
 
 FOR iDie= 1 TO 100
   PRINT "Die:"; iDie
 
   FOR iSubSite= 1 TO 10
     PRINT " SubSite:"; iSubSite
 
 
     !##########################################################################################################
     IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) <> "STEP until next measurement was performed" THEN
       ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Check", "Execute")
     END IF
     IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
     !##########################################################################################################
 
     FOR iMatrix = 1 TO 4
       PRINT "  Matrix Switching #";iMatrix
       FOR iMeasure = 1 TO 3
         !---perform the measurement
         PRINT "   Meas.#:"; iMeasure; "...   hit the new green Interaction Button on the Status Window"
         dummy = WAIT(1)       ! this emulates an ICCAP_FUNC() calling a measurement in your ModelFile
 
 
         !##########################################################################################################
         IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) <> "STEP until next prober move was performed" THEN
          ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Check", "Execute")
         END IF
         IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
         !##########################################################################################################
 
 
       NEXT iMeasure
 
 
       !##########################################################################################################
       IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
       !##########################################################################################################
 
 
     NEXT iMatrix
 
     !##########################################################################################################
     IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
     !##########################################################################################################
 
 
   NEXT iSubSite
 
 
 !##########################################################################################################
 IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
 !##########################################################################################################
 
 
 NEXT iDie
 
 
 !##########################################################################################################
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Finish", "Execute")
 !##########################################################################################################
 
 
 GET_STRING "Program "&WHOAMI("PartName")&" is finished !  [OK]", dummy
 
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "DEMO_Meas_Spar" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! Copy the program lines between the ###### markers to your own program
 
 
 !===S-PAR WAFER SCANNING LOOP EXAMPLE=============
 
 
 
 !########## initialize the STOP button ###############################################################################
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Init", "Execute")
 !########## initialize the STOP button ###############################################################################
 
 
 !~~~MEASUREMENT LOOP~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !   Note: it is assumed that the prober's wafer map is applied, 
 !         defining the dies and subsites to be measured.
 !         IC-CAP just sends a 'move next' command to the prober,
 !         and the prober steps to the next die, next sub-site(s), next die etc.
 !         At program start, the prober has already contacted 
 !         (manually) the first meas. site.
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 FOR iDieSubsite= 1 TO 100
 
 
   !---move prober 
   IF iDieSubsite>1 THEN PRINT "Die/Subsite move #"; iDieSubsite
 
 
   !########## check the STOP button ################################################################################################
   IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) <> "STEP until next measurement was performed" THEN
     ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Check", "Execute")
   END IF
   IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
   !########## check the STOP button ################################################################################################
 
 
   FOR iMeasure = 1 TO 3
     !---perform the measurement
     PRINT "  Meas.#:"; iMeasure; "...   hit the new green Interaction Button on the Status Window"
     dummy = WAIT(1)       ! this emulates an ICCAP_FUNC() calling a measurement in your ModelFile
 
 
     !########## check the STOP button ################################################################################################
     IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) <> "STEP until next prober move was performed" THEN
       ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Check", "Execute")
     END IF
     IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
     !########## check the STOP button ################################################################################################
 
 
 
   NEXT iMeasure
 
 
   !########## check the STOP button ################################################################################################
   IF VAL$(/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/RequestedStopAction) == "STOP" THEN BREAK
   !########## check the STOP button ################################################################################################
 
 
 NEXT iDieSubsite
 
 
 !########## remove the STOP button ################################################################################################
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/STOP_PEL_EXECUTION/StopButton_Finish", "Execute")
 !########## remove the STOP button ################################################################################################
 
 
 GET_STRING "Program "&WHOAMI("PartName")&" is finished !  [OK]", dummy
 
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___aux_______________" "711.501"
{
}
LINK XFORM "StopButton_Init" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  STOP_Actions
 GLOBAL_VAR  STOP_Actions_sel
 GLOBAL_VAR  RequestedStopAction	
 
 
 !---set STOP_Actions
 DIMENSION_ARRAY(STOP_Actions, 4)
 STOP_Actions[0] = "CONTINUE"
 STOP_Actions[1] = "STOP"
 STOP_Actions[2] = "STEP until next prober move was performed"
 STOP_Actions[3] = "STEP until next measurement was performed"
 
 
 
 !---initialize
 STOP_Actions_sel=-1
 RequestedStopAction="CONTINUE"
 
 
 !---create a Variable at the IC-CAP/Main/SystemVariable hierarchy (works only there !!!)
 !   This variable will hold the nr. of hits on the Status Button
 ICCAP_FUNC("/", "CreateVariableTableVariable", "ICCAP_STATUS_BUTTON_a")
 
 ! initialize it 
 ICCAP_FUNC("/", "SetVariableTableValue", "ICCAP_STATUS_BUTTON_a", "")
 
 
 
 !---create Control Button on Status Window
 ! NOTE: Built-in icons and their keywords are:
 ! pause, stop, play, skip, fskip, rskip, rec 
 ICCAP_FUNC("/", "Create Status Button", "myIcons > myIcon1", "Hit to interact with a running PEL", "stop", "a") 
 
 
 !---bring StatusWindow to top level
 ICCAP_FUNC("/", "Status Window")
 
 PRINT "A new, green user-defined Stop Button has been added to Status Window !
 When being hit, the modeling of the current inductor will be first finished,
 and before loading the next inductor, a window will pop up,
 allowing the user to decide how to proceed !"
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "StopButton_Check" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  ICCAP_STATUS_BUTTON_a	!Variable in IC-CAP/Tools/SystemVariables hierarchy, required for user-defined STOP button
 GLOBAL_VAR  RequestedStopAction
 GLOBAL_VAR  STOP_Actions
 GLOBAL_VAR  STOP_Actions_sel
 
 
 RequestedStopAction=""
 
 !---react if user has hit the Interaction Button on the Status Window
 IF VAL$(ICCAP_STATUS_BUTTON_a) <> "" THEN
   ICCAP_FUNC("./GUI_STOP_Actions", "Display Single Modal GUI")
 
   IF VAL(STOP_Actions_sel)==0 THEN 
     ICCAP_STATUS_BUTTON_a = ""
     RequestedStopAction = VAL$(STOP_Actions[STOP_Actions_sel])
   ELSE IF VAL(STOP_Actions_sel)==1 THEN 
     RequestedStopAction = VAL$(STOP_Actions[STOP_Actions_sel])
   ELSE IF VAL(STOP_Actions_sel)==2 THEN 
     ICCAP_STATUS_BUTTON_a =  1	 ! i.e. the next StopButton_Check will halt
     RequestedStopAction = VAL$(STOP_Actions[STOP_Actions_sel])
   ELSE IF VAL(STOP_Actions_sel)==3 THEN 
     ICCAP_STATUS_BUTTON_a =  1	 ! i.e. the next StopButton_Check will halt
     RequestedStopAction = VAL$(STOP_Actions[STOP_Actions_sel])
   END IF
 END IF
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "StopButton_Finish" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 GLOBAL_VAR  ErrStr
 
 !---delete Control Button
 ICCAP_FUNC("/", "Remove Status Button", "myIcons > myIcon1")
 
 
 !---delete Variable
 !Very important, first check, if this Variable really exists !!!
 ErrStr=""
 dummy=LOOKUP_VAR("ICCAP_STATUS_BUTTON_a", ErrStr)
 IF VAL$(ErrStr)=="" THEN
   ICCAP_FUNC("/", "SetTableFieldValue", "Name[ICCAP_STATUS_BUTTON_a]", "") 
 END IF
 
 
 PRINT "User-defined Stop Button has been removed from Status Window!"
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "____________________3" "711.501"
{
}
LINK XFORM "README_Basics" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! ---from the IC-CAP Manual pages--------------------------
 
 
 ! ADDING ICONS TO THE STATUS WINDOW
 ! ======================================
 ! Since IC-AP 2009U1, you can add action buttons to the Status window.
 
 ! The IC-CAP/Status window runs in a different process space 
 ! than the main IC-CAP program. 
 ! Because of this, you can press buttons or select menus on the Status window 
 ! while IC-CAP is compute bound and becomes unresponsive. 
 ! If the reason for IC-CAP being compute bound is that a long PEL sequence 
 ! you have written is in progress, you may use custom Status menus/icons 
 ! to signal to IC-CAP. 
 ! You may then check intermittently in your PEL code sequence 
 ! for any of these menu/icon actions. 
 
 ! You can add and manage customized menus (each with a toolbar icon) 
 ! to the IC-CAP/Status window by using the ICCAP_FUNC() actions 
 ! -> Create Status Button, 
 ! -> Remove Status Button, and 
 ! -> Remove All Status Buttons 
 
 
 ! Each custom menu is assigned a specific alphanumeric character (A-Z, a-z, or 0-9). 
 ! Each time you call ICCAP_STATUS_BUTTON_QUEUE$() in PEL, 
 ! you will receive a string of these characters representing 
 ! which buttons have been pressed since the last call. 
 
 ! For example if you have 3 buttons with characters 'a', 'b', and 'c' 
 ! and the user pressed the button for 'a' followed by the button for 'b' 
 ! in between two calls to ICCAP_STATUS_BUTTON_QUEUE$(), 
 ! the 2nd call will return the string "ab". 
 
 ! If no buttons have been pushed since the last call it will return an empty string (""). 
 
 ! For more details, see the StatusButtons.mdl file in the examples/misc directory 
 ! =============================================================================
 
 ! In addition to checking for menu/icon presses using ICCAP_STATUS_BUTTON_QUEUE$() 
 ! which communicates the order in which buttons are pressed, 
 ! you can also create specifically named variables in the 
 ! IC-CAP/Main/Tools/SystemVariables level (Main window Tools > System Variables). 
 ! This specifically named variable is ICCAP_STATUS_BUTTON_   
 ! prepended to the character tied to the menu/icon. 
 ! For example if you create a button tied to the character 'a', 
 ! then each time that icon is pressed, the variable ICCAP_STATUS_BUTTON_x 
 ! in the top level System variables (if it exists) will be incremented. 
 ! This is done automatically without needing to code anything in PEL, 
 ! however it will only happen while PEL is running, or when IC-CAP is idle. 
 ! It will not happen during simulation, optimization, or within PEL function calls. 
 ! 
 ! For more details, see the 'AdvancedStatusButtons.mdl' file in the example/misc directory.
 ! =============================================================================
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "README_Create" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! ---from the IC-CAP Manual pages--------------------------
 
 ! Create Status Button
 ! =====================
 ! Adds a customized menu pick and associated icon to the status window. 
 ! If the menu pick has already been added, the menu is simply updated.
 
 ! Each call requires a menupick, a tool tip, an icon image name, 
 ! and a single alphanumeric character. 
 
 ! ICCAP_FUNC("/", "Create Status Button", "My Menu>Do it!", "my Hint", "IconImageName", "a") 
 
 ! The menupick is a simple string with the > character as a sub-menu delimiter. 
 ! Thus "My Menu>Do it!" will create a menu 'Do it!' under the menu 'My Menu', 
 ! and 'Do it!' will appear in the status window menubar. 
 ! This string is what differentiates the menus from one another. 
 ! A "Create Status Button" command executed with a menupick 
 ! that is already on the status window, will simply update the menupick 
 ! (you could change the icon image or the character sent).
 
 ! The tool tip 'my Hint' is a simple string that will display 
 ! when the mouse lingers over the icon as a help for what the icon will do.
 
 ! The icon image name 'IconImageName' can be one of the standard images already 
 ! in the IC-CAP system, or may refer to an icon of your own creation. 
 ! IC-CAP will look for custom bitmaps in the following directories: 
 ! $HOME/hpeesof/custom/bitmaps, 
 ! $ICCAP_ROOT/iccap/bitmaps, or 
 ! $ICCAP_ROOT/hpeesof/custom/bitmaps. 
 ! Simply copy a  .png (most recommended), .jpg or .gif file to one of these directories 
 ! and pass the name before this extension to the icon image 
 ! and the image will appear as the icon image for the custom button.
 ! Note: the icon has to be in the directory before IC-CAP is launched!
 
 ! The single alphanumeric character 'a' will be used to differentiate the buttons 
 ! in PEL. It is possible to assign multiple buttons with the same character, 
 ! but it will be impossible to differentiate which buttons were pressed 
 ! in PEL if this is done. PEL only can interpret the button presses 
 ! based on these key characters. 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "README_CheckQueue" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! ---from the IC-CAP Manual pages--------------------------
 
 ! ButtonSequence=ICCAP_STATUS_BUTTON_QUEUE$()
 ! ================================================
 ! Returns the string of IC-CAP/Status custom menu/icons selections 
 ! that have been made since the last call. 
 ! Each character in the string represents one button press or menu selection. 
 
 ! If the string is empty ("") then no custom buttons have been pressed 
 ! since it was last called. 
 
 ! NOTE: 
 ! Each call to ICCAP_STATUS_BUTTON_QUEUE$() clears the queue at the same time.
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "README_Remove" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! ---from the IC-CAP Manual pages--------------------------
 
 ! Remove Status Button
 ! =========================
 ! Removes a customized menu pick previously added with 'Create Status Button'.
 
 ! Each call requires using the exact name as the previously created button. 
 ! If you try to remove a menu that has not been created, no action will occur.
 
 ! Example
 ! ICCAP_FUNC("/", "Remove Status Button", "My Menu>Do it!") 
 
 
 
 
 ! Removing All Buttons
 ! ===========================
 ! ICCAP_FUNC("/", "Remove All Status Buttons") 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "CLEAN_UP" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 C13 P237 C10"
element 0 "Name" "DutNames"
element 0 "Value" ""
element 1 "Name" "SetupNames"
element 1 "Value" ""
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,691,926"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "HOW_TO_USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 !============================================================
 ! CleanUp_AllSetupVars
 !============================================================
 ! When loading meas. data into your modeling project,
 ! and when ICCAP_VALUES are included in the .mdm data files,
 ! which are not defined in the hierarchy of your model file,
 ! IC-CAP auto-creates SetupVariables from the children of ICCAP_VALUES.
 ! 
 ! ==> To clean up all Setup Variables below the Keyword Variable 
 ! called e.g. 'Variables_below_stem_from_the_mdm_file',
 ! in all Setups of the ModelFile, 
 ! have a Transform with following PEL code:
 
 
 VarNameKeyword = "Variables_below_stem_from_the_mdm_file"
 Path2Model = WHOIS(".", "Parent Model")		!returns full path to ModelName
 N = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/CLEAN_UP/CleanUp_AllSetupVars", VAL$(VarNameKeyword), VAL$(Path2Model))
 
 GET_STRING "Cleaning-Up Setup Variables was required for in total "&VAL$(REAL(N[0]))&" Variable(s)   [OK]", dummy
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___" "711.501"
{
}
LINK XFORM "CleanUp_AllSetupVars" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  DutNames
 GLOBAL_VAR  SetupNames
 
 
 GET_STRING "VarNameKeyword", VarNameKeyword
 GET_STRING "Path2Model", Path2Model
 
 
 !---identify all DUTs in the Model file
 ICCAP_FIND_CHILDREN VAL$(Path2Model), "DUT", DutNames
 
 
 N=0
 FOR iDut=0 TO SIZEOF(DutNames)-1
   Path2Dut = VAL$(Path2Model)&"/"&VAL$(DutNames[iDut])
   !---identify all Setups in the current DUT
   ICCAP_FIND_CHILDREN VAL$(Path2Dut), "Setup", SetupNames
   FOR iSetup=0 TO SIZEOF(SetupNames)-1
     Path2Setup = VAL$(Path2Dut)&"/"&VAL$(SetupNames[iSetup])
 
     !---find location of Variable VarName
     i=0
     ErrMsg=""
     WHILE VAL$(ErrMsg)==""
       actVarName =LOOKUP_TABLE_VAL(VAL$(Path2Setup), "Name["&VAL$(i)&"]", ErrMsg)
       EXIT IF VAL$(actVarName)==VAL$(VarNameKeyword)
       i = i + 1
     END WHILE
 
     IF VAL$(ErrMsg)=="" THEN
       !---delete Variables below VarName
       i = i + 1
       LOOP
       actVarName =LOOKUP_TABLE_VAL(VAL$(Path2Setup), "Name["&VAL$(i)&"]")
         EXIT IF (VAL$(actVarName)=="")
         !---delete
         N = N + 1
         ICCAP_FUNC(VAL$(Path2Setup), "SetTableFieldValue", "Name["&VAL$(actVarName)&"]", "") 
       END LOOP
     END IF
 
   NEXT iSetup
 NEXT iDut
 
 
 !---clean up
 IF VAL(Debug)==0 THEN
   DutNames = ""
   SetupNames = ""
 END IF
 
 
 RETURN_VALUE N
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "FFT" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "0.75301204819277 2593 2570"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 P221 P229 C10"
element 0 "Name" "M"
element 0 "Value" "11"
element 1 "Name" "___________________________________"
element 1 "Value" ""
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,768,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README_FFT" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 Some recapitulation about the Fourier Transform:
 ---------------------------------------------------------
 
 
 
 TIME DOMAIN			FREQUENCY DOMAIN
 -----------			----------------
 
 time interval resolution 'tstep'	NWA bandwidth    1/tstep
 time period 'tp'			NWA freq. steps  1/tp
 
  |tstep|                                  |      1/tstep       |
   \  /					  **
    ||                                              *  *
    *****                                          *    *
    *   *                                  ****** *      * *****
 ****   ****                               ||    *        * 
                                          /  \
 |    tp   |                             |1/tp|
 
 periodical function: period tp	discrete spectrum lines, 
 				 distance = 1/tp
 				 envelope like for primitive period
 
 even function			real spectrum
 
 odd function			imag spectrum
 
 
 
 SOME IMPORTANT TIME-FREQ CONTEXT:
 ------------------------------------
 				NOTE: d = dirac impulse
 cos(2PI fo t)			1/2 * (d(f+fo) + d(f-fo))
 
 sin(2PI fo t)			j * 1/2 * (d(f+fo) - d(f-fo))
 
 1				d(f)
 
 d(t)				1
 
 d(t-to)				1 * exp(-j 2PI f to)
 
 s(t)    (switch function)		1/2 d(f) -j / (2PI f)
 
 				  -j
 sign(t)				------
 				 PI*f
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "README_FFT_Program" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! The FFT routine programmed in 'FFT' has been
 ! derived from the literature:
 ! Lawrence R.Rabiner, Bernard Gold, "Theory & Application of Digital Signal Processing",
 ! Prentice Hall International Inc., London 1975
 
 ! It transfers time signals beginning at t=0 to the freq. domain.
 
 
 ! ---------------------------------------------------------------
 ! After L.R.Rabiner et.al., it is the following Fortran program:
 ! ---------------------------------------------------------------
 
 
 ! N=2^M
 ! COMPLEX EH(N)
 ! CALL FFT(EH,M,N)
 ! ...
 
 
 ! SUBROUTINE FFT(A,M,N)
 ! COMPLEX A(N),U,W,T
 ! NV2=N/2
 ! NM1=N-1
 ! I1=1
 ! DO I=1,NM1
 ! 	IF (I.GE.I1) GOTO 5
 ! 	T=A(I1)
 ! 	A(I1)=A(I)
 ! 	A(I)=T
 ! 5	K=NV2
 ! 6	IF (K.GE.I1) GOTO 7
 ! 	I1=I1-K
 ! 	K=K/2
 ! 	GOTO 6
 ! 7	I1=I1+K
 ! END DO
 ! 
 ! PI=4.*ATAN(1.)
 ! DO L=1,M
 ! 	LE=2**L
 ! 	LE1=LE/2
 ! 	U=(1.,0.)
 ! 	W=CMPLX(COS(PI/LE1),SIN(PI/LE1))
 ! 	DO I1=1,LE1
 ! 		DO I=I1,N,LE
 ! 			IP=I+LE1
 ! 			T=A(IP)*U
 ! 			A(IP)=A(I)-T
 ! 			A(I)=A(I)+T
 ! 		END DO
 ! 		U=U*W
 ! 	END DO
 ! END DO
 ! RETURN
 ! END
 
 ! ==============================================
 ! Backtransformation:
 ! EH = CONJG(EH)
 ! CALL FFT(EH,M,N)
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE_FFT" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 ! ======================================================
 ! to convert from time domain to freq. domain  (FFT):
 ! ======================================================
 
 tmp_timedomain = REAL(my_time_signal)	! link to data
 M   = 6				! exp. of 2
 
 
 !===call central FFT program=============================================
 TimeStep = time[1] - time[0]
 tmp = tmp_timedomain*TimeStep		!combine with time stepping
 tmp = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/FFT/FFT", tmp_timedomain, M)
 !========================================================================
 
 
 RETURN tmp
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE_FFT_1" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 ! ======================================================
 ! to convert from freq. domain to time  domain  (FFT^-1):
 ! ======================================================
 
 tmp_freqdomain = REAL(my_freq_signal)		! link to data
 M   = 6					! exp. of 2
 
 
 !===call central FFT_1 program==============================================
 FreqStep = freq[1]-freq[0]
 tmp_freqdomain = tmp_freqdomain*FreqStep       	!combine with freq. stepping
 tmp = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/FFT/FFT_1", tmp_freqdomain, M)
 !===========================================================================
 
 
 RETURN tmp
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "calc_freq_from_time" "711.501"
{
View block_edit 0 "2394,29"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 ! This is an example program for your local ModelFile 
 ! to calculate the frequency points of the FFT-transformed time-signal
 ! e.g. for the x-Axis of the freq-domain plots
 
 
 M   = 6				! exp. of 2
 
 
 COMPLEX tmp[SIZEOF(time)]
 TimePeriod = (time[1] - time[0])*2^M
 FreqStep = 1//TimePeriod
 
 Npts = SIZEOF(tmp)
 FOR i=0 TO Npts-1
   tmp[i]=FreqStep*(i-Npts//2)
 NEXT i
 
 
 RETURN tmp
}
dataset
{
datasize COMMON 64 1 1
type COMMON
}
}
}
LINK XFORM "calc_time_from_freq" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 ! This is an example program for your local ModelFile 
 ! to calculate the frequency points of the FFT-transformed time-signal
 ! e.g. for the x-Axis of the time-domain plots
 
 
 M   = 6				! exp. of 2
 
 
 COMPLEX tmp[SIZEOF(freq)]
 Bandwidth = (freq[1] - freq[0])*2^M
 TimeStep = 1//Bandwidth
 
 Npts = SIZEOF(tmp)
 FOR i=0 TO Npts-1
   tmp[i]=TimeStep*i
 NEXT i
 
 
 RETURN tmp
}
dataset
{
datasize COMMON 64 1 1
type COMMON
}
}
}
LINK XFORM "___________________1" "711.501"
{
}
LINK XFORM "FFT" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  M
 
 !=== convert from time -> freq =============================
 
 GET_DATASET "data", timedata
 GET_INT     "Data Size Two's Exponent  M (2^M samples)", M
 
 
 
 !---------------------------------------------------
 freqdata = EVALUATE_TRANSFORM("Do_FFT", timedata, M)
 !---------------------------------------------------
 freqdata = EVALUATE_TRANSFORM("Flip_Index", freqdata)
 
 freqdata = CONJG(freqdata)
 freqdata = freqdata//2^VAL(M)
 
 
 !---execute 'aux' for data visualization in this very Setup (just in case the user does it)
 ICCAP_FUNC("aux", "Execute")
 
 
 
 RETURN freqdata
}
dataset
{
datasize COMMON 256 1 1
type COMMON
}
}
list PLOT "_FFT_RI_"
}
LINK XFORM "FFT_1" "711.501"
{
View block_edit 0 "0,52"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  M
 
 !=== convert from freq -> time =============================
 
 GET_DATASET "data", freqdata
 GET_INT     "Data Size Two's Exponent  M (2^M samples)", M
 
 
 freqdata = EVALUATE_TRANSFORM("Flip_Index", freqdata)
 !---------------------------------------------------
 timedata = EVALUATE_TRANSFORM("Do_FFT", freqdata, M)
 !---------------------------------------------------
 
 
 
 
 !---execute 'aux' for data visualization in this very Setup (just in case the user does it)
 ICCAP_FUNC("aux", "Execute")
 
 
 
 RETURN timedata
 
}
dataset
{
datasize COMMON 2048 1 1
type COMMON
}
}
list PLOT "_FFT_1_RI_"
}
LINK XFORM "___________________2" "711.501"
{
}
LINK XFORM "Do_FFT" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! ==============================================================
 !  >>>>>>>  NOTE  <<<<<<<
 !         ========
 ! THE FFT ONLY TRANSFORMS CORRECTLY IF THE TIME SIGNAL IS CAUSAL
 !  i.e. IF IT STARTS AT t=0 and goes up to t0.
 ! Otherwise, i.e. if the time signal is from -t0/2  .. 0  +t0/2,
 ! the FFT will treat it as if the part -t0/2 .. 0 had been
 ! appended *after* +t0/2.
 ! ==============================================================
 
 
 GET_DATASET "data", tmp
 GET_INT     "Data Size Two's Exponent  M (2^M samples)", M
 
 
 !=================below is the FFT program===================
 N   = 2^M
 !shifting the array to index 1...N
 COMPLEX tmp1[SIZEOF(tmp)+1]
 i = 1
 WHILE i < SIZEOF(tmp1)
   tmp1[i] = tmp[i-1]
   i = i + 1
 END WHILE
 
 
 NV2 = N//2
 NM1 = N-1
 I1  = 1
 FOR I=1 TO NM1
   IF I < I1 THEN
     TMP      = tmp1[I1]
     tmp1[I1] = tmp1[I]
     tmp1[I]  = TMP
   END IF
   K = NV2
   WHILE K < I1 
     I1 = I1 - K
     K = K / 2
   END WHILE
   I1 = I1+K
 NEXT I
 
 FOR L=1 TO M
   LE = 2^L
   LE1 = LE//2
   U = (1) + (j*0)
 !  W = (COS(PI//LE1))+(j*SIN(PI//LE1))
   W = EXP(j*PI//LE1)
   FOR I1=1 TO LE1
     FOR I=I1 TO N STEP LE
       IP = I + LE1
       TMP      = tmp1[IP]*U
       tmp1[IP] = tmp1[I] - TMP
       tmp1[I]  = tmp1[I] + TMP
     NEXT I
     U = U * W
   NEXT I1
 NEXT L
 
 
 !shifting the array with index 1..N
 !                  back to index 0...N-1
 FOR i=0 TO SIZEOF(tmp)-1
   tmp[i] = tmp1[i+1]
 NEXT i
 !===============above is the FFT program==============================
 
 
 
 RETURN tmp
}
dataset
{
datasize COMMON 2048 1 1
type COMMON
}
}
list PLOT "_Do_FFT_RI_"
}
LINK XFORM "Flip_Index" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program flips the freq or time data to get 
 ! - the conventional freq. spectrum with DC in the middle
 ! - for non-causal time signal, a time representation beginning with t=0
 ! In other words, the data array of size 100 with index
 !    0 ... 49 50 ... 99
 ! is re-ordered to index
 !   50 ... 99  0 ... 49
 
 
 GET_DATASET "Dataset", tmp
 
 
 !---flip index -Npts/2 ... Npts/2 to index 0 ... Npts
 Npts = SIZEOF(tmp)
 COMPLEX tmp1[Npts]
 FOR i=0 TO Npts-1
   IF i < Npts//2 THEN
 !print i,i+Npts//2
     tmp1[i]=tmp[i+Npts//2]
   ELSE
 !print i,i-Npts//2
     tmp1[i]=tmp[i-Npts//2]
   END IF
 NEXT i
 
 RETURN tmp1
}
dataset
{
datasize COMMON 2048 1 1
type COMMON
}
}
list PLOT "_Flip_Index_RI_"
}
LINK XFORM "aux" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! This Program provides the x-axis for visualization of the calculations
 ! Only used in the Plots of this very setup
 
 
 
 GLOBAL_VAR  M
 
 COMPLEX tmp.M[2^M]
 FOR i=0 TO SIZEOF(tmp)-1
   tmp[i]=i
 NEXT i
 
 
 RETURN tmp + j*1
}
dataset
{
datasize MEAS 2048 1 1
type MEAS
}
}
list PLOT "_Do_FFT_RI_"
list PLOT "_Flip_Index_RI_"
list PLOT "_FFT_RI_"
list PLOT "_FFT_1_RI_"
}
LINK PLOT "_MP_" "711.501"
{
View plot_window 0 "4,23,22754,14522"
View draw_ds 0 "B,0,0"
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "0"
element "Orientation" "H"
element "Plots Per Row" "0"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_FFT_RI_"
element "Plot 1" "_FFT_1_RI_"
element "Plot 2" "_Do_FFT_RI_"
element "Plot 3" "_Flip_Index_RI_"
}
HYPTABLE "Multi GUI Table"
{
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_Do_FFT_RI_" "711.501"
{
View plot_window 0 "4,23,15538,13643"
View draw_ds 0 "B,0,2736"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(aux)!!index"
element "# of Traces" "8"
element "Curve Data" "IMAG(aux)"
element "Header" "Do_FFT  Real & Imag"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Do_FFT)"
element "Y Data 1" "IMAG(Do_FFT)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "Do_FFT"
member XFORM "aux"
}
LINK PLOT "_Flip_Index_RI_" "711.501"
{
View plot_window 0 "4,23,15538,13643"
View draw_ds 0 "B,0,6684"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(aux)!!index"
element "# of Traces" "8"
element "Curve Data" "IMAG(aux)"
element "Header" "Flip_Index  Real & Imag"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Flip_Index)"
element "Y Data 1" "IMAG(Flip_Index)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "Flip_Index"
member XFORM "aux"
}
LINK PLOT "_FFT_RI_" "711.501"
{
View plot_window 0 "4,23,15538,13643"
View draw_ds 0 "B,0,10632"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(aux)!!index"
element "# of Traces" "8"
element "Curve Data" "IMAG(aux)"
element "Header" "FFT  Real & Imag"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(FFT)"
element "Y Data 1" "IMAG(FFT)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "FFT"
member XFORM "aux"
}
LINK PLOT "_FFT_1_RI_" "711.501"
{
View plot_window 0 "4,23,15538,13643"
View draw_ds 0 "B,0,14580"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(aux)!!index"
element "# of Traces" "8"
element "Curve Data" "IMAG(aux)"
element "Header" "FFT_1  Real & Imag"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(FFT_1)"
element "Y Data 1" "IMAG(FFT_1)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "FFT_1"
member XFORM "aux"
}
data "711.501"
{
}
}
}
LINK DUT "_____________________________________2" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "MDM_UTILITIES" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P100 P235 P349"
element 0 "Name" "DirName"
element 0 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/ScaledMdlg_Chalmers_2011-05"
element 0 "Comment" "common DirName for all MDM Utilities"
element 1 "Name" "MINLOG"
element 1 "Value" "1E-30"
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P15 P100 P100 P100 P100 P100 P100 P100"
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "MDM_VIEWER" "711.501"
{
View in_out 0 "0.63271955747518 2672 2000"
View plot 0 "1.55646169584 7027 5312"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 C27 P182 P166"
element 0 "Name" "MDM_FILE_PATH"
element 0 "Value" ""
element 1 "Name" "MDM_FILE_NAME"
element 1 "Value" ""
element 2 "Name" "MDM_EXPORT_XFORM_DATA"
element 2 "Value" "0"
element 3 "Name" "MINLOG"
element 3 "Value" "1E-20"
element 4 "Name" "PLOT_TRACE_LINE_WIDTH"
element 4 "Value" "0"
element 5 "Name" "ICCAP_VALUES_Present"
element 5 "Value" ""
element 6 "Name" "LSYNC_Sweeps_Present"
element 6 "Value" ""
element 7 "Name" "RI_GRAPH_SYMMETRY"
element 7 "Value" "FALSE"
element 8 "Name" "______________________1"
element 8 "Value" ""
element 9 "Name" "ErrMsg"
element 9 "Value" ""
element 10 "Name" "Suffix"
element 10 "Value" ".mdm"
element 11 "Name" "Wildcard"
element 11 "Value" ""
element 12 "Name" "Avail_Data_Files"
element 12 "Value" "ICCAP_ARRAY[0]"
element 13 "Name" "mdm_Files_sel"
element 13 "Value" "22"
element 14 "Name" "FileName"
element 14 "Value" ""
element 15 "Name" "DirFileName"
element 15 "Value" ""
element 16 "Name" "!DirName"
element 16 "Value" ""
element 16 "Comment" "DUT Variable !"
element 17 "Name" "______________________2"
element 17 "Value" ""
element 18 "Name" "InputNames"
element 18 "Value" "ICCAP_ARRAY[0]"
element 19 "Name" "Sweep1Name"
element 19 "Value" "vg"
element 20 "Name" "OutputNames"
element 20 "Value" "ICCAP_ARRAY[0]"
element 21 "Name" "PlotNames"
element 21 "Value" "ICCAP_ARRAY[0]"
element 22 "Name" "PlotNames_sel"
element 22 "Value" "0"
element 23 "Name" "ReqPlotNames"
element 23 "Value" "ICCAP_ARRAY[0]"
element 23 "Comment" "requested PlotNames"
element 24 "Name" "LineStyle[0]"
element 24 "Value" "Line & Symbols"
element 25 "Name" "LineStyle[1]"
element 25 "Value" "Line only"
element 26 "Name" "LineStyle[2]"
element 26 "Value" "Symbols only"
element 27 "Name" "LineStyle"
element 27 "Value" "ICCAP_ARRAY[3]"
element 28 "Name" "LineStyle_sel"
element 28 "Value" "0"
element 29 "Name" "LineColor[0]"
element 29 "Value" "apply default"
element 30 "Name" "LineColor[1]"
element 30 "Value" "2nd order sweep"
element 31 "Name" "LineColor[2]"
element 31 "Value" "highest order sweep"
element 32 "Name" "LineColor[3]"
element 32 "Value" "every curve"
element 33 "Name" "LineColor"
element 33 "Value" "ICCAP_ARRAY[4]"
element 34 "Name" "LineColor_sel"
element 34 "Value" "0"
element 35 "Name" "CurveColoring"
element 35 "Value" "Display all curves with the configured trace color"
element 36 "Name" "NrPts"
element 36 "Value" "201"
element 37 "Name" "NrSweeps"
element 37 "Value" "1"
element 38 "Name" "MoreThan1Sweep"
element 38 "Value" "0"
element 38 "Comment" "activates GUI buttons for Legend and trace color changes"
element 39 "Name" "AuxVar"
element 39 "Value" ""
element 40 "Name" "Index"
element 40 "Value" "ICCAP_ARRAY[0]"
element 41 "Name" "Text4GUI"
element 41 "Value" "! VERSION = 6.00"
element 42 "Name" "PlotMdmName"
element 42 "Value" "DirFileName: /cygdrive/d/d_SisConsult/30 ... -22/data/_N45PA_4.5X100_25C~Diode~Diode_Forward.mdm"
element 43 "Name" "RefPlotMdmName"
element 43 "Value" ""
element 44 "Name" "ShowLegend"
element 44 "Value" "0"
element 45 "Name" "mdm_Header"
element 45 "Value" "DirFileName:"
element 46 "Name" "GUI_xPos"
element 46 "Value" "33"
element 47 "Name" "GUI_yPos"
element 47 "Value" "33"
element 48 "Name" "___Vars_below_stem_from_mdm_file___"
element 48 "Value" "you_can_delete_them_from_time_to_time ;-)"
element 49 "Name" ""
element 49 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_mdm_Viewer"
element 0 "Value" "TL|HT=400:LX=%#18GUI_xPos:LY=%#18GUI_yPos|CA=#15PB_OK&#17Execute|#215TL_Selected_Dir:#221TL_Show_Mdm_Header_OK:#13SEP:#213TL_Avail_Mdms|0|0"
element 1 "Name" "TL_mdm_Viewer.TL_Avail_Mdms"
element 1 "Value" "TL|OR=VE|<none>|#222TL_Preview_RefreshList:#214LI_Avail_Files:#219TL_mdm_file_actions|1"
element 2 "Name" "TL_mdm_Viewer.TL_Selected_Dir.TL_upper.LA_Selected_Dir"
element 2 "Value" "LA|CA=#260Currently Selected Dir    (Unix style, case sentitive !)\072:TO=FW&TL|<none>|<none>|0"
element 3 "Name" "TL_mdm_Viewer.TL_Selected_Dir"
element 3 "Value" "TL|FV=T:OR=VE:TO=FH&dummy|<none>|#18TL_upper:#215ED_Selected_Dir:#211TL_Filename|1"
element 4 "Name" "TL_mdm_Viewer.TL_Selected_Dir.ED_Selected_Dir"
element 4 "Value" "ED|BG=C9:VA=%#17DirName:TO=FH&dummy|EP=#214GUI_Verify_Dir&#17Execute|<none>|0"
element 5 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.LI_Avail_Files"
element 5 "Value" "LI|CA=#216avail. mdm files:IT=%#216Avail_Data_Files:SX=%#213mdm_Files_sel:SY=SS|LS=#214Load_Data_File&#17Execute|<none>|0"
element 6 "Name" "TL_mdm_Viewer.TL_Show_Mdm_Header_OK"
element 6 "Value" "TL|FV=F:OR=HO:TO=FH&MH&LH|<none>|#216PB_Show_Next_Mdm:#231PB_Keep_Actual_mdm_As_Reference:#15PB_OK|1"
element 7 "Name" "TL_mdm_Viewer.TL_Show_Mdm_Header_OK.PB_Show_Next_Mdm"
element 7 "Value" "PB|CA=#214Show Next .mdm|AC=#216PB_Load_Next_Mdm&#17Execute|<none>|0"
element 8 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.TL_mdm_file_actions"
element 8 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#213PB_mdm_Rename:#213PB_mdm_Delete|1"
element 9 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.TL_mdm_file_actions.PB_mdm_Rename"
element 9 "Value" "PB|CA=#216Rename .mdm File|AC=#213PB_Mdm_Action&#214Execute,Rename|<none>|0"
element 10 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.TL_mdm_file_actions.PB_mdm_Delete"
element 10 "Value" "PB|CA=#216Delete .mdm File|AC=#213PB_Mdm_Action&#214Execute,Delete|<none>|0"
element 11 "Name" "TL_mdm_Viewer.TL_Show_Mdm_Header_OK.PB_OK"
element 11 "Value" "PB|CA=#210OK, Done !:TO=MW&MH&LW&LH&TR|AC=#15PB_OK&#17Execute|<none>|0"
element 12 "Name" "GUI_MP.GUI_MP_Top.TL_5.PB_Mdm_Preview"
element 12 "Value" "PB|CA=#228  ->  View .mdm Header  <-  :TO=FW&FH|AC=#221GUI_Mdm_Header_Viewer&#17Execute|<none>|0|2"
element 13 "Name" "GUI_MP.GUI_MP_Top"
element 13 "Value" "TL|OR=HO|<none>|#14TL_1:#16Sep__1:#14TL_2:#16Sep__2:#14TL_3:#14TL_4:#16Sep__3:#14TL_5:#16Sep__4|1|5"
element 14 "Name" "GUI_MP.GUI_MP_Top.Sep__4"
element 14 "Value" "TL|<none>|<none>|<none>|0"
element 15 "Name" "GUI_MP.GUI_MP_Top.Sep__3"
element 15 "Value" "SE|OR=VE:TO=FW&dummy|<none>|<none>|0"
element 16 "Name" "GUI_MP.GUI_MP_Top.Sep__1"
element 16 "Value" "SE|OR=VE:TO=FW&dummy|<none>|<none>|0"
element 17 "Name" "TL_mdm_Viewer.TL_Selected_Dir.TL_upper"
element 17 "Value" "TL|OR=HO|<none>|#215LA_Selected_Dir:#210PB_Sel_Dir|1"
element 18 "Name" "TL_mdm_Viewer.TL_Selected_Dir.TL_upper.PB_Sel_Dir"
element 18 "Value" "PB|CA=#210Change Dir:TO=FW&LW&TR|AC=#221PB_Change_Dir_Browser&#17Execute|<none>|0"
element 19 "Name" "TL_mdm_Viewer.SEP"
element 19 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 20 "Name" "TL_mdm_Viewer.TL_Show_Mdm_Header_OK.PB_Keep_Actual_mdm_As_Reference"
element 20 "Value" "PB|CA=#230Keep Current Plot As Reference|AC=#223PB_Current_As_Reference&#17Execute|<none>|0"
element 21 "Name" "GUI_ReferencePlot"
element 21 "Value" "TL|<none>|<none>|#16TL_Top:#215LA_mdm_FileName|0|2"
element 22 "Name" "GUI_ReferencePlot.TL_Top.LA_ReferencePlots"
element 22 "Value" "LA|CA=#259\075\075>>   REFERENCE  PLOTS  FOR  COMPARISON   <<\075\075:FG=C6|<none>|<none>|0"
element 23 "Name" "TL_Show_mdm_Header"
element 23 "Value" "TL|HT=600:OR=VE:WD=800|<none>|#19PB_OK_top:#214TL_DirFileName:#17ED_Text:#212PB_OK_bottom|1|3"
element 24 "Name" "TL_Show_mdm_Header.PB_OK_bottom"
element 24 "Value" "PB|CA=#12OK:TO=FW&FH&TR|AC=#218TL_Show_mdm_Header&#222Destroy GUI,mdm Header|<none>|0"
element 25 "Name" "TL_Show_mdm_Header.ED_Text"
element 25 "Value" "ED|EM=ML:ED=F:VA=%#18Text4GUI:FI=FF|<none>|<none>|0"
element 26 "Name" "GUI_ReferencePlot.LA_mdm_FileName"
element 26 "Value" "LA|CA=%#214RefPlotMdmName:FG=C6|<none>|<none>|0"
element 27 "Name" "TL_mdm_Viewer.TL_Selected_Dir.TL_Filename"
element 27 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#211ED_Wildcard:#19ED_Suffix:#18PB_Apply|1"
element 28 "Name" "TL_mdm_Viewer.TL_Selected_Dir.TL_Filename.ED_Wildcard"
element 28 "Value" "ED|CA=#217Filename Wildcard:CO=1:EM=SL:ED=T:VA=%#18Wildcard:TO=MH&dummy|EP=#221Show_Avail_Data_Files&#17Execute|<none>|1"
element 29 "Name" "TL_mdm_Viewer.TL_Selected_Dir.TL_Filename.ED_Suffix"
element 29 "Value" "ED|CA=#215Filename Suffix:CO=1:EM=SL:VA=%#16Suffix:TO=MW&MH|EP=#221Show_Avail_Data_Files&#17Execute|<none>|0"
element 30 "Name" "TL_mdm_Viewer.TL_Selected_Dir.TL_Filename.PB_Apply"
element 30 "Value" "PB|CA=#15Apply:TO=FW&FH|AC=#221Show_Avail_Data_Files&#17Execute|<none>|0"
element 31 "Name" "GUI_MP.GUI_MP_Top.TL_5"
element 31 "Value" "TL|OR=VE:TO=FW&FH|<none>|#223LA_ICCAP_VALUES_present:#214PB_Mdm_Preview:#223LA_LSYNC_sweeps_present:#221PB_show_LSYNC_stimuli|1|2"
element 32 "Name" "GUI_MP.GUI_MP_Top.TL_5.LA_ICCAP_VALUES_present"
element 32 "Value" "LA|CA=#274ICCAP_VALUES present in .mdm file !\012Hit 'View .mdm Header' for details.:FG=C6:MF=%ICCAP_VALUES_Present|<none>|<none>|0"
element 33 "Name" "GUI_MP.GUI_MP_Top.TL_5.LA_LSYNC_sweeps_present"
element 33 "Value" "LA|CA=#274LSYNC sweeps present in .mdm file !\012Hit 'View .mdm Header' for details.:FG=C6:MF=%LSYNC_Sweeps_Present|<none>|<none>|0"
element 34 "Name" "GUI_MP.GUI_MP_Top.TL_5.PB_show_LSYNC_stimuli"
element 34 "Value" "PB|CA=#218Show LSYNC Stimuli:MF=%LSYNC_Sweeps_Present|AC=#222GUI_Show_LSYNC_Stimuli&#17Execute|<none>|0"
element 35 "Name" "GUI_MP.GUI_MP_Top.TL_2"
element 35 "Value" "TL|OR=VE:TO=FH&MW|<none>|#210TL_DataPts:#211TL_NrSweeps|1"
element 36 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.TL_Preview_RefreshList.PB_Refresh_FileList"
element 36 "Value" "PB|CA=#222Refresh .mdm File List:TO=FW&FH&TR|AC=#221Show_Avail_Data_Files&#17Execute|<none>|0"
element 37 "Name" "GUI_MP.GUI_MP_Top.TL_4"
element 37 "Value" "TL|OR=VE:TO=FW&FH|<none>|#212DL_LineStyle:#212DL_LineColor|1"
element 38 "Name" "GUI_MP.GUI_MP_Top.TL_1"
element 38 "Value" "TL|OR=VE:TO=FW&dummy|<none>|#219CB_DisplaySweepInfo|1"
element 39 "Name" "GUI_MP.GUI_MP_Top.TL_1.CB_DisplaySweepInfo"
element 39 "Value" "CB|CA=#211Plot Legend:SF=%MoreThan1Sweep:TO=FH&dummy:TS=%ShowLegend|TC=#217GUI_PlotSweepInfo&#17Execute|<none>|0"
element 40 "Name" "GUI_MP.GUI_MP_Top.TL_2.TL_DataPts.LA_NrPts"
element 40 "Value" "LA|CA=#215Nr.DataPts.\072:TO=FH&TL|<none>|<none>|0"
element 41 "Name" "GUI_MP.GUI_MP_Top.TL_2.TL_DataPts"
element 41 "Value" "TL|OR=HO:TO=TL&dummy|<none>|#18LA_NrPts:#211ED_NrPtsVal|1"
element 42 "Name" "GUI_MP.GUI_MP_Top.TL_2.TL_DataPts.ED_NrPtsVal"
element 42 "Value" "ED|CO=7:ED=F:VA=%#15NrPts:TO=FH&dummy|<none>|<none>|0"
element 43 "Name" "GUI_MP.GUI_MP_Top.TL_4.DL_LineColor"
element 43 "Value" "DL|CA=#217Change Line Color:IT=%#19LineColor:SX=%#213LineColor_sel:SF=%MoreThan1Sweep:TO=FH&dummy|LS=#213GUI_LineColor&#17Execute:TC=#219GUI_PlotSymbolsOnly&#17Execute|<none>|0"
element 44 "Name" "GUI_MP.GUI_MP_Top.TL_4.DL_LineStyle"
element 44 "Value" "DL|CA=#210Line Style:IT=%#19LineStyle:SX=%#213LineStyle_sel:TO=FH&dummy|LS=#213GUI_LineStyle&#17Execute:TC=#219GUI_PlotSymbolsOnly&#17Execute|<none>|0"
element 45 "Name" "GUI_MP.GUI_MP_Top.TL_2.TL_NrSweeps.LA_NrSweeps"
element 45 "Value" "LA|CA=#214Nr. Sweeps\072:TO=FH&TL|<none>|<none>|0"
element 46 "Name" "GUI_MP.GUI_MP_Top.TL_2.TL_NrSweeps"
element 46 "Value" "TL|OR=HO:TO=TL&dummy|<none>|#211LA_NrSweeps:#211ED_NrSweeps|1"
element 47 "Name" "GUI_MP.GUI_MP_Top.TL_2.TL_NrSweeps.ED_NrSweeps"
element 47 "Value" "ED|CO=3:ED=F:VA=%#18NrSweeps:TO=FH&dummy|<none>|<none>|0"
element 48 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.TL_Preview_RefreshList"
element 48 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#219PB_Refresh_FileList:#214PB_Mdm_Preview:#15Space|1"
element 49 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.TL_Preview_RefreshList.Space"
element 49 "Value" "TL|<none>|AC=#217GUI_ViewMdmHeader&#17Execute|<none>|0"
element 50 "Name" "GUI_MP.GUI_MP_Top.TL_3"
element 50 "Value" "TL|OR=VE:TO=FH&MW|<none>|#217TL_Line_Thickness:#19TL_MinLog|1"
element 51 "Name" "GUI_MP.GUI_MP_Top.TL_3.TL_Line_Thickness.LA_LineThickness"
element 51 "Value" "LA|CA=#228Line Thickness\012[0..8]\072:TO=FH&TL|<none>|<none>|0"
element 52 "Name" "GUI_MP.GUI_MP_Top.TL_3.TL_Line_Thickness"
element 52 "Value" "TL|OR=HO:TO=TL&dummy|<none>|#216LA_LineThickness:#216SB_LineThickness|1"
element 53 "Name" "GUI_MP.GUI_MP_Top.TL_3.TL_Line_Thickness.SB_LineThickness"
element 53 "Value" "SB|CO=3:ED=F:MX=8:MN=0:SS=%#221PLOT_TRACE_LINE_WIDTH|VI=#14_MP_&#19Redisplay:VD=#14_MP_&#19Redisplay:VC=#14_MP_&#19Redisplay|<none>|0"
element 54 "Name" "GUI_MP.GUI_MP_Top.Sep__2"
element 54 "Value" "SE|OR=VE:TO=FW&dummy|<none>|<none>|0"
element 55 "Name" "GUI_MP.GUI_MP_Top.TL_3.TL_MinLog.LA_NrSweeps"
element 55 "Value" "LA|CA=#212Min.Log.\072:TO=FH&TL|<none>|<none>|0"
element 56 "Name" "GUI_MP.GUI_MP_Top.TL_3.TL_MinLog"
element 56 "Value" "TL|OR=HO:TO=TL&dummy|<none>|#211LA_NrSweeps:#19ED_MinLog|1"
element 57 "Name" "GUI_MP.GUI_MP_Top.TL_3.TL_MinLog.ED_MinLog"
element 57 "Value" "ED|CO=3:VA=%#16MINLOG:TO=FH&dummy|EP=#14_MP_&#16Replot|<none>|0"
element 58 "Name" "GUI_MP"
element 58 "Value" "TL|OR=VE|<none>|#210GUI_MP_Top:#213GUI_MP_Bottom|1|1"
element 59 "Name" "GUI_MP.GUI_MP_Bottom"
element 59 "Value" "TL|<none>|<none>|#215LA_mdm_FileName|1"
element 60 "Name" "GUI_MP.GUI_MP_Bottom.LA_mdm_FileName"
element 60 "Value" "LA|CA=%#211PlotMdmName:FG=C2|<none>|<none>|0"
element 61 "Name" "GUI_ReferencePlot.TL_Top"
element 61 "Value" "TL|OR=HO|<none>|#217LA_ReferencePlots:#225TL_Add_Remove_CurrentPlot|1"
element 62 "Name" "GUI_ReferencePlot.TL_Top.TL_Add_Remove_CurrentPlot.PB_Display_also_in_Current_Plot"
element 62 "Value" "PB|CA=#228Display also in Current Plot:TO=FW&FH|AC=#240../MDM_VIEWER/PB_Disp_RefPlot_in_Current&#211Execute,Add|<none>|0"
element 63 "Name" "GUI_ReferencePlot.TL_Top.TL_Add_Remove_CurrentPlot"
element 63 "Value" "TL|OR=VE:TO=FH&dummy|<none>|#231PB_Display_also_in_Current_Plot:#227PB_Remove_from_Current_Plot:#19PB_Delete|1"
element 64 "Name" "GUI_ReferencePlot.TL_Top.TL_Add_Remove_CurrentPlot.PB_Remove_from_Current_Plot"
element 64 "Value" "PB|CA=#224Remove from Current Plot:TO=FW&FH|AC=#240../MDM_VIEWER/PB_Disp_RefPlot_in_Current&#214Execute,Remove|<none>|0"
element 65 "Name" "GUI_ReferencePlot.TL_Top.TL_Add_Remove_CurrentPlot.PB_Delete"
element 65 "Value" "PB|CA=#226Delete this Reference Plot:TO=FW&FH|AC=#240../MDM_VIEWER/PB_Disp_RefPlot_in_Current&#214Execute,Delete|<none>|0"
element 66 "Name" "TL_mdm_Viewer.TL_Avail_Mdms.TL_Preview_RefreshList.PB_Mdm_Preview"
element 66 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH|AC=#221GUI_Mdm_Header_Viewer&#17Execute|<none>|0|2"
element 67 "Name" "TL_Show_mdm_Header.TL_DirFileName"
element 67 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#214LA_DirFileName:#220LA_DirFileNameString|1"
element 68 "Name" "TL_Show_mdm_Header.TL_DirFileName.LA_DirFileName"
element 68 "Value" "LA|CA=#215DirFileName\072:FG=C6:TO=FW&dummy|<none>|<none>|1"
element 69 "Name" "TL_Show_mdm_Header.TL_DirFileName.LA_DirFileNameString"
element 69 "Value" "ED|BG=C8:ED=F:VA=%#211DirFileName:FG=C6|<none>|<none>|0"
element 70 "Name" "TL_Show_mdm_Header.PB_OK_top"
element 70 "Value" "PB|CA=#12OK:TO=FW&FH&TR|AC=#218TL_Show_mdm_Header&#222Destroy GUI,mdm Header|<none>|0"
element 71 "Name" ""
element 71 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 ! MDM_VIEWER
 ! ==================
 ! - opens a .mdm file browser, 
 ! - lets the user select a file for inspection
 ! Then,
 ! - XY Plots are auto-created for all loaded Outputs, 
 !   with the 1st order sweep as the x-axis
 ! - Smith and Polar Plots are created for S-parameters
 
 
 ! - when a Plot can be re-used from a previous session, 
 !   it will not be re-created.
 !   This allows to re-use customized Plots (e.g. manually 
 !   adjusted lin/log scaling, autoscaling etc).
 
 
 
 
 
 ! Notes: 
 ! if Inputs with LSYNC sweep are present, the GUI will show it by
 ! GUI Item 
 !  'ICCAP_VALUES present in .mdm file !
 !   Hit 'View .mdm Header' for details.'
 ! If you then want a plot annotated by an Input of the LSYNC series,
 ! right-mouse click into this Plot and select 'Add Legend', 
 ! and then 'Edit Definition', and enter the name of this Input 
 ! into field 'Curve Data'
 
 
 
 
 !------------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! Just execute Transform 'START_MDM_VIEWER'.
 
 
 
 ! All other Transforms of this Setup are aux. Transforms,
 ! called by 'START_MDM_VIEWER' or by its GUI (Transforms with leading name 'GUI_' or 'PB_' (PushButton)
 
 
 ! If you want to use the MDM_VIEWER from your own Modelfile,
 ! add a  line
 ICCAP_FUNC("/UTILITIES/MDM_UTILITIES/MDM_VIEWER/START_MDM_VIEWER", "Execute")
 
 
 
 
 ! NOTE: Setup Variables below the separator Variable
 ! '____Vars_below_stem_from_mdm_file________________' 
 ! have been auto-created by IC-CAP during .mdm import
 ! (provided they were rpesent in the .mdm file as ICCAP_VALUES).
 ! They can be deleted from time to time by the user, 
 ! applying the 'Organize...' button.
 
 
 
 
 
 
 
 !------------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________0" "711.501"
{
}
LINK XFORM "START_MDM_VIEWER" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 !---initialize--------------------------------------------------
 Suffix          = ".mdm"
 Wildcard        = ""
 DataSymbolsOnly = 0
 NrPts=0
 LineStyle_sel=0
 LineColor_sel=0
 ShowLegend=0
 CurveColoring = "Display all curves with the configured trace color"
 
 
 !---show avail data files in the active data file directory------------------------
 mdm_Files_sel=-1
 ICCAP_FUNC("Show_Avail_Data_Files", "Execute")
 
 !---resetting the MultiPlot _MP_
 ICCAP_FUNC("_MP_", "STFV", "# of Plots",  "0")
 ICCAP_FUNC("_MP_", "STFV", "Plot 0",  "")
 
 
 !---opening the GUI
 ICCAP_FUNC("./TL_mdm_Viewer", "Display Modeless GUI", "mdm Viewer")
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________1" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "PB_Change_Dir_Browser" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR DirName             ! DUT Variable
 GLOBAL_VAR Suffix
 GLOBAL_VAR Wildcard
 
 GUIheader = "Select mdm directory (mdm files will be selected later)"
 SelPolicy = "DirOnly"	! Single, Multi, DirOnly
 
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(DirName), VAL$(Suffix), VAL$(Wildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)=="" THEN
   !---Get the selected directory back
   DirName=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
   !---convert DirName to unix-style
   DirName=SYS_PATH$(VAL$(DirName))
 ELSE
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 
 !---update list of currently avail. mdm file
 ICCAP_FUNC("Show_Avail_Data_Files", "Execute")
 
 
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Verify_Dir" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---This Program verifies if the manually entered directory is correct.
 ! If not, it calls 'PB_Change_Dir_Browser':
 
 
 GLOBAL_VAR DirName             ! DUT Variable
 
 
 IF VAL(SYSTEM("cd "&VAL$(SYS_PATH$(VAL$(DirName)))&" 2 > /dev/null"))<>0 THEN
   ICCAP_FUNC("PB_Change_Dir_Browser", "Execute")
   RETURN_VALUE 2
 END IF
 
 
 !---show files found in maunally entered dir
 ICCAP_FUNC("Show_Avail_Data_Files", "Execute")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Show_Avail_Data_Files" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! Initialize Variables
 NrPts=""
 FileName=""
 mdm_Files_sel=-1
 
 ICCAP_FUNC("_MP_", "Close")
 
 !---before performing the 'ls' command below, check first if directory 'DirName' still exists
 DirName_exists=SYSTEM("cd "&VAL$(SYS_PATH$(VAL$(DirName)))&" 2> /dev/null")		!suppress error msg
 IF DirName_exists<>0 THEN RETURN_VALUE 0
 
 
 !---show the avail.files with correct Suffix and Wildcard in directory of Variable 'DirName'
 !   execute the unix 'cd' command, followed by the 'ls'command (which returns the found filenames)
 ls_Files=SYSTEM$("cd "&VAL$(SYS_PATH$(VAL$(DirName))) &"
 ls *"&VAL$(Wildcard)&"*"&VAL$(Suffix)&" 2> /dev/null")	! avoid showing error messages in the Status window
 
 !---cut the big 'ls'-command string chain into its components
 dummy=CUTSTR(ls_Files, Avail_Data_Files)
 
 
 !---re-sort filenames case-insensitively
 IF SIZEOF(Avail_Data_Files)>0 THEN
   dummy=ARRAY_COPY(Avail_Data_Files, AuxVar)
   FOR i=0 TO SIZEOF(AuxVar)-1
     AuxVar[i]=LWC$(VAL$(AuxVar[i]))
   NEXT i
   dummy=ARRAY_SORT_STR(AuxVar, Index)
   dummy=ARRAY_REORDER(Avail_Data_Files, Index)
 END IF
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_Data_File" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---close the MP
 ICCAP_FUNC("_MP_", "Close")
 
 
 !---exit if no mdm file was selected
 IF mdm_Files_sel == -1 THEN 
   RETURN_VALUE 0
 END IF
 
 
 !---close the possibly open GUI of PLOT_SHOW_LSYNC_VALUES (LSYNCs)
 ICCAP_FUNC("/UTILITIES/PLOT_UTILITIES/PLOT_SHOW_LSYNC_VALUES/gui_Done", "Execute")
 
 
 !---delete SetupVariables created by the previous .mdm reading  (ICCAP_VALUES)
 ICCAP_FUNC("Delete_ICCAP_VALUE_Vars", "Execute")
 
 
 !---track case of last file in the list of the GUI being just deleted by the user
 IF mdm_Files_sel>SIZEOF(Avail_Data_Files)-1 THEN mdm_Files_sel=SIZEOF(Avail_Data_Files)-1
 FileName=Avail_Data_Files[mdm_Files_sel]
 DirFileName=SYS_PATH$(VAL$(DirName)&"/"&VAL$(FileName))
 
 
 !---load the file
 ICCAP_FUNC(".", "Import Create", VAL$(DirFileName))
 
 
 !---return if only CON Inputs present
 ICCAP_FIND_CHILDREN ".", "Input", InputNames
 IF  SIZEOF(DATASET("quiet "&VAL$(InputNames[0])))==1 THEN
   ICCAP_FUNC("Mdm_Header_Viewer", "Execute")
   GET_STRING "There are no sweeps included in the .mdm file, 
 	probably all Inputs are of Type 'CON'   [OK]", dummy
   NrPts=1
   RETURN_VALUE 3
 END IF
 
 
 !---identify DirFileName of  Plot
 PlotMdmName="DirFileName: "&VAL$(DirFileName)
 IF STRLEN(VAL$(PlotMdmName)) > 100 THEN
   PlotMdmName=VAL$(SUBSTR$(VAL$(PlotMdmName), 1, 40)) & " ... " & VAL$(SUBSTR$(VAL$(PlotMdmName), STRLEN(VAL$(PlotMdmName))-50))
 END IF
 
 
 !---switch on note about ICCAP_VALUES present in loaded .mdm file
 ICCAP_VALUES_Present = ""
 ICCAP_VALUES_Present = SYSTEM$("cat "&VAL$(DirFileName)&" | grep ICCAP_VALUES")
 IF VAL$(ICCAP_VALUES_Present)<>"" THEN ICCAP_VALUES_Present=1
 
 
 !---switch on note about LSYNC sweeps present in loaded .mdm file
 LSYNC_Sweeps_Present = ""
 LSYNC_Sweeps_Present = SYSTEM$("cat "&VAL$(DirFileName)&" | grep LSYNC")
 IF VAL$(LSYNC_Sweeps_Present)<>"" THEN LSYNC_Sweeps_Present=1
 
 
 !---de-activate GUI button 'Display Sweep Info' if only 1st order sweep is available
 MoreThan1Sweep=0
 NrSweeps=1
 WHILE USERC_num_of_points(NrSweeps, ".") <> -1
   NrSweeps = NrSweeps + 1
 END WHILE
 NrSweeps = NrSweeps - 1
 IF NrSweeps>1 THEN MoreThan1Sweep=1
 
 
 !---auto-create Plots for all loaded Outputs
 ICCAP_FUNC("Create_Plots", "Execute")
 
 
 
 !---re-display _MP_ with new/updated Plot contents
 ICCAP_FUNC("_MP_", "Display Plot")
 ICCAP_FUNC("_MP_", "Legend Off")
 ICCAP_FUNC("_MP_", "Title Off")
 ICCAP_FUNC("_MP_", "Area Tools On")
 
 
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PB_Load_Next_Mdm" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 mdm_Files_sel= mdm_Files_sel + 1
 IF mdm_Files_sel > SIZEOF(Avail_Data_Files)-1 THEN 
   mdm_Files_sel =-1
   GET_STRING "ERROR: no more plots to be shown !  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 ICCAP_FUNC("Load_Data_File", "Execute")
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Delete_ICCAP_VALUE_Vars" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This program deletes Setup Variables which have been auto-created
 ! by IC-CAP, if ICCAP_VALUES had been included in the loaded .mdm file
 
 
 !---find location of Variable '___Vars_below_stem_from_mdm_file___'
 i=0
 ErrMsg=""
 WHILE VAL$(ErrMsg)==""
   VarName =LOOKUP_TABLE_VAL(".", "Name["&VAL$(i)&"]", ErrMsg)
   EXIT IF VAL$(VarName)=="___Vars_below_stem_from_mdm_file___"
   i = i + 1
 END WHILE
 
 
 !---delete Variables below '___Vars_below_stem_from_mdm_file___'
 ErrMsg=""
 N = i + 1
 LOOP
   VarName =LOOKUP_TABLE_VAL(".", "Name["&VAL$(N)&"]", ErrMsg)
   !---exit if end of list is reached
   EXIT IF (VAL$(VarName)=="")
   !---maybe it's an ICCAP_ARRAY
   IF STRPOS(VAL$(VarName), "[") > 0 THEN 
     N = N + 1
   ELSE
     !---delete, it's no ICCAP_ARRAY
     ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
     N = i + 1
   END IF
 END LOOP
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PB_Current_As_Reference" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! This Program creates a temporary Setup 'tmp_aux', 
 ! and exports the current Inputs/Outputs to it. 
 ! Also exproted are the current Plots and the corresponding MultiPlot.
 ! It then links that MultiPlot to GUI 'GUI_ReferencePlot', 
 ! which is located in this Setup 'MDM_VIEWER'.
 
 
 GLOBAL_VAR  AuxVar
 GLOBAL_VAR  RefPlotMdmName
 GLOBAL_VAR  MDM_FILE_PATH
 GLOBAL_VAR  MDM_FILE_NAME
 
 
 !---check if required parallel Setup 'tmp_aux' already exists
 !   if not, create it
 ICCAP_FIND_CHILDREN "..", "Setup", AuxVar
 FOR i=0 TO SIZEOF(AuxVar)-1
   IF VAL$(AuxVar[i])=="tmp_aux" THEN ICCAP_FUNC("../tmp_aux", "Delete")
 NEXT i
 ICCAP_FUNC("..", "New Setup", "tmp_aux")   
 
 
 !---identify DirFileName of reference Plot
 RefPlotMdmName="DirFileName: "&VAL$(SYS_PATH$(VAL$(MDM_FILE_PATH)&"/"&VAL$(MDM_FILE_NAME)))
 IF STRLEN(VAL$(RefPlotMdmName)) > 100 THEN
   RefPlotMdmName=VAL$(SUBSTR$(VAL$(RefPlotMdmName), 1, 40)) & " ... " & VAL$(SUBSTR$(VAL$(RefPlotMdmName), STRLEN(VAL$(RefPlotMdmName))-50))
 END IF
 
 !---export local Inputs/Outputs to Setup 'tmp_aux'
 ICCAP_FUNC(".", "Export Data Measured", "tmp")     
 ICCAP_FUNC("../tmp_aux", "Import Create", "tmp")
 
 
 !---export local Plots to Setup 'tmp_aux'
 ICCAP_FIND_CHILDREN ".", "Plot", AuxVar
 FOR i=0 TO SIZEOF(AuxVar)-1
   ICCAP_FUNC(VAL$(AuxVar[i]), "Copy", "../tmp_aux/"&VAL$(AuxVar[i]))  ! modelA/dutA/setupA/plotA must exist before
 NEXT i
 ICCAP_FUNC("../tmp_aux/_MP_", "STFV", "GUI 1", "../MDM_VIEWER/GUI_ReferencePlot")
 
 
 !---set color on Ydata0 to blue
 FOR i=1 TO SIZEOF(AuxVar)-1  !skip 1st Plot (which is the MultiPlot _MP_)
   !---identify Plot Type
   PlotType = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Report Type", ErrMsg)
   ! NOTE: color index:  1=red, 2=yellow, 3=green, 4=light blue, 5=blue, 6=purple, 7=grey
   IF VAL$(PlotType)=="XY PLOT" THEN
     ICCAP_FUNC("../tmp_aux/"&VAL$(AuxVar[i])&"/PlotOptions", "SetTableFieldValue", "On White[Data 0]", "5")
     ICCAP_FUNC("../tmp_aux/"&VAL$(AuxVar[i]), "Replot")
   END IF
 NEXT i
 
 
 !---display MultiPlot of Setup 'tmp_aux'
 ICCAP_FUNC("../tmp_aux/_MP_", "Display Plot")
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PB_Disp_RefPlot_in_Current" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR AuxVar
 
 GET_STRING "Reference Data:  [Add], [Remove], [Delete]", Action
 
 
 ICCAP_FIND_CHILDREN ".", "Plot",      AuxVar
 
 IF Action=="Add" THEN
   FOR i=1 TO SIZEOF(AuxVar)-1	  !skip 1st Plot (which is the MultiPlot _MP_)
     !---identify Plot Type
     PlotType = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Report Type", ErrMsg)
     !---get YData0 entry, and set YData1 entry
     IF VAL$(PlotType) == "SMITH PLOT" THEN      ! S11 and S22 share the same Plot
       FieldEntry0 = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Smith Data 0", ErrMsg)
       FieldEntry1 = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Smith Data 1", ErrMsg)
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Smith Data 2", "../tmp_aux/"&VAL$(FieldEntry0))
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Smith Data 3", "../tmp_aux/"&VAL$(FieldEntry1))
     ELSE IF VAL$(PlotType)=="POLAR PLOT" THEN      ! S12 and S21 share the same Plot
       FieldEntry0 = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Polar Data 0", ErrMsg)
       FieldEntry1 = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Polar Data 1", ErrMsg)
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Polar Data 2", "../tmp_aux/"&VAL$(FieldEntry0))
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Polar Data 3", "../tmp_aux/"&VAL$(FieldEntry1))
     ELSEIF VAL$(PlotType)=="XY GRAPH" THEN
       FieldEntry = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Y Data 0", ErrMsg)
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Y Data 1", "../tmp_aux/"&VAL$(FieldEntry))
     END IF
   NEXT i
 END IF
 
 IF Action=="Remove" ORELSE Action=="Delete" THEN
   FOR i=1 TO SIZEOF(AuxVar)-1
     !---identify Plot Type
     PlotType = LOOKUP_TABLE_VAL(VAL$(AuxVar[i]), "Report Type", ErrMsg)
     !---clear YData1 entry
     IF VAL$(PlotType) == "SMITH PLOT" THEN      ! S11 and S22 share the same Plot
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Smith Data 2", "")
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Smith Data 3", "")
     ELSE IF VAL$(PlotType)=="POLAR PLOT" THEN      ! S12 and S21 share the same Plot
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Polar Data 2", "")
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Polar Data 3", "")
     ELSEIF VAL$(PlotType)=="XY GRAPH" THEN
       ICCAP_FUNC(VAL$(AuxVar[i]), "SetTableFieldValue", "Y Data 1", "")
     END IF
   NEXT i
 END IF
 
 ICCAP_FUNC("_MP_", "Redisplay")
 
 IF Action=="Delete" THEN
   ICCAP_FUNC("../tmp_aux", "Delete")
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________2" "711.501"
{
}
LINK XFORM "Create_Plots" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ReqPlotNames
 GLOBAL_VAR  InputNames
 GLOBAL_VAR  OutputNames
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  Sweep1Name
 GLOBAL_VAR  CurveColoring
 GLOBAL_VAR  NrPts
 
 ! NOTE: This Program tries to keep Plots of previously inspected .mdm files open,
 ! when they are again requested with the current .mdm file.
 ! Background: they might have been customized by the user ;-)
 
 
 
 !--- identify all Inputs and Outputs
 ICCAP_FIND_CHILDREN ".", "Input", InputNames
 ICCAP_FIND_CHILDREN ".", "Output", OutputNames
 
 
 !---calc. nr. of bias pts for GUI
 NrPts=SIZEOF(DATASET("quiet "&VAL$(InputNames[0])))
 
 
 !--- identify sweep1 Input
 dummy= USERC_sweep_name(1, ".", Sweep1Name)	!Sweep1Name has to be a (Setup)Variable
 
 !--- create Plots for all Outputs with not yet existing Plots
 ICCAP_FIND_CHILDREN ".", "Plot", PlotNames
 ReqPlotNames="ICCAP_ARRAY[0]"
 N=0	!nr. of requested Plots
 i=0
 WHILE i < SIZEOF(OutputNames)
   ReqPlotNames="ICCAP_ARRAY["&VAL$(N+1)&"]"
   OutputMode = LOOKUP_TABLE_VAL(VAL$(OutputNames[i]), "Mode")
   IF VAL$(OutputMode)<>"S" THEN
     ReqPlotNames[N]=VAL$(OutputNames[i])&"_vs_"&VAL$(Sweep1Name)
   ELSE
     ReqPlotNames[N]=VAL$(OutputNames[i])&"xx_vs_"&VAL$(Sweep1Name)
     N = N + 1
     ReqPlotNames="ICCAP_ARRAY["&VAL$(N+1)&"]"
     ReqPlotNames[N]=VAL$(OutputNames[i])&"xy_vs_"&VAL$(Sweep1Name)
   END IF
 
   !--- Check if same Plot already exists (from the previous session)
   !    In this case, keep the old Plot (might have been customized by the user ;-)
   CreatePlot=1
   iPlot=0
   WHILE iPlot < SIZEOF(PlotNames)
     IF VAL$(OutputMode)<>"S" THEN
       IF VAL$(ReqPlotNames[N])==VAL$(PlotNames[iPlot]) THEN CreatePlot=0
     ELSE
       IF VAL$(ReqPlotNames[N])==VAL$(PlotNames[iPlot])   THEN CreatePlot=0
       IF VAL$(ReqPlotNames[N-1])==VAL$(PlotNames[iPlot]) THEN CreatePlot=0
     END IF
     iPlot = iPlot + 1
   END WHILE
 
   !--- Create a new Plot
   IF CreatePlot==1 THEN 
     IF VAL$(OutputMode)=="S" THEN
       ICCAP_FUNC("Create_Spar_Plot", "Execute", VAL$(N), VAL$(Sweep1Name), VAL$(OutputNames[i]), VAL$(CurveColoring))
     ELSEIF VAL$(OutputMode)=="X" THEN
       ICCAP_FUNC("Create_RI_Plot", "Execute", VAL$(N), VAL$(Sweep1Name), VAL$(OutputNames[i]), VAL$(CurveColoring))
     ELSE
       ICCAP_FUNC("Create_XY_Plot", "Execute", VAL$(N), VAL$(Sweep1Name), VAL$(OutputNames[i]), VAL$(CurveColoring))
     END IF
   END IF
 
   N = N + 1
   i = i + 1
 END WHILE
 
 
 !--- delete surplus Plots from previous session
 ICCAP_FIND_CHILDREN ".", "Plot", PlotNames
 iPlotExist=0
 WHILE iPlotExist < SIZEOF(PlotNames)
   DeletePlot=1
   iPlotReq=0
   WHILE iPlotReq < SIZEOF(ReqPlotNames)
     IF VAL$(PlotNames[iPlotExist])==VAL$(ReqPlotNames[iPlotReq]) THEN DeletePlot=0
     iPlotReq = iPlotReq + 1
   END WHILE
   IF (DeletePlot==1) AND (VAL$(PlotNames[iPlotExist])<>"_MP_") THEN 
     IF Debug>0 THEN PRINT "deleting surplus Plot ";PlotNames[iPlotExist];", stemming from previous session"
     ICCAP_FUNC(VAL$(PlotNames[iPlotExist]), "Delete")
   END IF
   iPlotExist = iPlotExist + 1
 END WHILE
 
 
 !--- combine Plots into a MultiPlot
 ICCAP_FIND_CHILDREN ".", "Plot", PlotNames
 !   delete found _MP_ from found PlotNames
 FOR i=0 TO SIZEOF(PlotNames)-1
   IF VAL$(PlotNames[i])=="_MP_" THEN dummy=ARRAY_REMOVE_AT("PlotNames", i)
 NEXT i
 
 
 !--- enter # of Plots into _MP_
 ICCAP_FUNC("_MP_", "STFV", "# of Plots",  SIZEOF(PlotNames))
 
 
 !--- enter Plot children into _MP_
 i=0
 WHILE i < SIZEOF(PlotNames)
   ICCAP_FUNC("_MP_", "STFV", "Plot "&VAL$(i), VAL$(PlotNames[i]))
   i = i + 1
 END WHILE
 
 
 !--- initialize PlotNames_sel
 PlotNames_sel=0
 
 
 !--- update Plot styles
 ICCAP_FUNC("GUI_LineStyle", "Execute")
 ICCAP_FUNC("GUI_LineColor", "Execute")
 ICCAP_FUNC("GUI_PlotSweepInfo", "Execute")
 
 
 !--------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Create_XY_Plot" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ReqPlotNames
 
 
 GET_STRING "ReqPlotName Index", N
 GET_STRING "Sweep1Name",  Sweep1Name
 GET_STRING "OutputName",  OutputName
 GET_STRING "CurveColoring", CurveColoring
 
 ReqPlotName=VAL$(ReqPlotNames[VAL(N)])
 
 
 !---this Program creates an XY plot for ReqPlotName[N]
 
 
 !--- create XY Plot
 IF Debug>0 THEN PRINT "creating new Plot ";ReqPlotName
 ICCAP_FUNC(".", "New Plot", VAL$(ReqPlotName))
 ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "X Data", VAL$(Sweep1Name))
 ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Y Data 0", VAL$(OutputName)&".M")
 
 !---set Plot header
 ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Header", VAL$(ReqPlotName))
 
 !---set requested plot trace color changing
 ICCAP_FUNC(VAL$(ReqPlotName)&"/PlotOptions", "STFV", "Multicolor", VAL$(CurveColoring))
 
 
 
 
 
 
 !--------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Create_RI_Plot" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ReqPlotNames
 
 
 GET_STRING "ReqPlotName Index", N
 GET_STRING "Sweep1Name",  Sweep1Name
 GET_STRING "OutputName",  OutputName
 GET_STRING "CurveColoring", CurveColoring
 
 ReqPlotName=VAL$(ReqPlotNames[VAL(N)])
 
 
 !---this Program creates an RI plot for ReqPlotName[N]
 
 
 !--- create RI Plot
 IF Debug>0 THEN PRINT "creating new Plot ";ReqPlotName
 ICCAP_FUNC(".", "New Plot", VAL$(ReqPlotName))
 ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Report Type", "RI GRAPH")
 ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Sweep Data", VAL$(Sweep1Name))
 ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "RI Data 0", VAL$(OutputName)&".M")
 
 !---set Plot header
 ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Header", VAL$(ReqPlotName))
 
 !---set requested plot trace color changing
 ICCAP_FUNC(VAL$(ReqPlotName)&"/PlotOptions", "STFV", "Multicolor", VAL$(CurveColoring))
 
 
 
 
 
 
 !--------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Create_Spar_Plot" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ReqPlotNames
 
 
 GET_STRING "ReqPlotName Index", N
 GET_STRING "Sweep1Name",  Sweep1Name
 GET_STRING "OutputName",  OutputName
 GET_STRING "CurveColoring", CurveColoring
 
 
 ! this Program creates a Smith plot for ReqPlotName[N-1]
 !   and a Polar Plot for Index ReqPlotName[N]
 
 
 !---create Smith and Polar Plot
 iSpar=0
 WHILE iSpar<2
   ReqPlotName=VAL$(ReqPlotNames[VAL(N)-1])
   PlotType = "Smith"
   IF iSpar==1 THEN
     ReqPlotName=VAL$(ReqPlotNames[VAL(N)])
     PlotType = "Polar"
   END IF
 
   IF Debug>0 THEN PRINT "creating new Plot ";ReqPlotName
   ICCAP_FUNC(".", "New Plot", VAL$(ReqPlotName))
 
   ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Report Type", VAL$(PlotType))
   ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Sweep Data", VAL$(Sweep1Name))
   ICCAP_FUNC(VAL$(ReqPlotName), "STFV", VAL$(PlotType)&" Data 0", VAL$(OutputName)&".M.1"&VAL$(1+iSpar))
   ICCAP_FUNC(VAL$(ReqPlotName), "STFV", VAL$(PlotType)&" Data 1", VAL$(OutputName)&".M.2"&VAL$(2-iSpar))
 
   !---set Plot header
   ICCAP_FUNC(VAL$(ReqPlotName), "STFV", "Header", VAL$(ReqPlotName))
 
   !---set requested plot trace color changing
   ICCAP_FUNC(VAL$(ReqPlotName)&"/PlotOptions", "STFV", "Multicolor", VAL$(CurveColoring))
 
   iSpar = iSpar + 1
 END WHILE
 
 
 
 
 
 
 
 
 !--------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Mdm_Header_Viewer" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  mdm_Files_sel
 GLOBAL_VAR  Text4GUI
 GLOBAL_VAR  DirFileName
 
 
 IF mdm_Files_sel<0 THEN 
   GET_STRING "You need to select a file from 'avail.mdm files'  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 IF VAL$(DirFileName)=="" THEN RETURN_VALUE -1
 
 
 !--- show the mdm header in a GUI
 Text4GUI=SYSTEM$("head -100 "&VAL$(DirFileName))
 Text4GUI= VAL$(Text4GUI)&"
 ...
 ...
 ..."
 
 
 !--- opening the GUI
 ICCAP_FUNC("./TL_Show_mdm_Header", "Display Modeless GUI", "mdm Header")
 
 
 
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Show_LSYNC_Stimuli" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("/UTILITIES/PLOT_UTILITIES/PLOT_SHOW_LSYNC_VALUES/PLOT_SHOW_LSYNC_VALUES", "Execute", "/UTILITIES/MDM_UTILITIES/MDM_VIEWER")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_LineStyle" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  LineStyle_sel
 GLOBAL_VAR  PlotNames
 
 
 PlotStyle=""
 IF VAL(LineStyle_sel)==0 THEN PlotStyle = "Solid Line with Symbols"
 IF VAL(LineStyle_sel)==1 THEN PlotStyle = "Solid Line"
 IF VAL(LineStyle_sel)==2 THEN PlotStyle = "Symbols Only"
 
 
 FOR i=0 TO SIZEOF(PlotNames)-1
   ICCAP_FUNC(VAL$(PlotNames[i])&"/PlotOptions", "SetTableFieldValue", "Measured Trace", VAL$(PlotStyle))
   ICCAP_FUNC(VAL$(PlotNames[i]), "Replot")
 NEXT i
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_LineColor" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  LineColor_sel
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  CurveColoring
 GLOBAL_VAR  ShowLegend
 
 
 CurveColoring=""
 IF VAL(LineColor_sel)==0 THEN CurveColoring = "Display all curves with the configured trace color"
 IF VAL(LineColor_sel)==1 THEN CurveColoring = "Change color with each 2nd order curve"
 IF VAL(LineColor_sel)==2 THEN CurveColoring = "Change color with each highest order curve"
 IF VAL(LineColor_sel)==3 THEN CurveColoring = "Change color with every curve"
 
 
 FOR i=0 TO SIZEOF(PlotNames)-1
   ICCAP_FUNC(VAL$(PlotNames[i])&"/PlotOptions", "SetTableFieldValue", "Multicolor", VAL$(CurveColoring))
   ICCAP_FUNC(VAL$(PlotNames[i]), "Replot")
 NEXT i
 
 
 !---update GUI buttons
 IF VAL(LineColor_sel)==0 THEN ShowLegend=0
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PlotSweepInfo" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ShowLegend
 GLOBAL_VAR  LineColor_sel
 
 
 !---show Sweep Info (Plot Legend) or not
 IF VAL(ShowLegend)==0 THEN 
   ICCAP_FUNC("_MP_", "Legend Off")
 END IF
 
 IF VAL(ShowLegend)==1 THEN 
   ICCAP_FUNC("_MP_", "Legend On")
   !---update GUI buttons
   LineColor_sel=3
 END IF
 
 ICCAP_FUNC("_MP_", "Redisplay")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PB_Mdm_Action" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! this is answered by the calling GUI
 
 GET_STRING "requested action [Delete], [Rename]", action
 
 
 IF VAL$(action)=="Delete" THEN
   tmpDirFileName=VAL$(DirFileName)
   IF STRLEN(tmpDirFileName)>50 THEN
     tmpDirFileName="..."&VAL$(SUBSTR$(tmpDirFileName, VAL(STRLEN(tmpDirFileName)-50)))
   END IF
   GET_STRING "Do you really want to delete 
 	"&VAL$(tmpDirFileName)&" ?
 	  [OK],[Cancel]", dummy
   ICCAP_FUNC("_MP_", "Close")
   dummy=SYSTEM("rm "&VAL$(DirFileName))
 END IF
 
 
 
 IF VAL$(action)=="Rename" THEN
   GET_STRING "Change .mdm File Name     [OK], [Cancel]", VAL$(FileName), FileName
   dummy=SYSTEM("mv "&VAL$(SYS_PATH$(VAL$(DirFileName)))&" "&VAL$(SYS_PATH$(VAL$(DirName)&"/"&VAL$(FileName))))
 END IF
 
 
 
 ICCAP_FUNC("Show_Avail_Data_Files", "Execute")
 ICCAP_FUNC("Load_Data_File", "Execute")
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PB_OK" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---close Plot(s)
 ICCAP_FUNC(".", "Close All")
 
 
 !---destroy GUI
 ICCAP_FUNC("./TL_mdm_Viewer", "Destroy GUI", "mdm Viewer")
 
 
 !---delete possibly existing parallel Setup 'aux' (may have been created when user selected 'Keep Current As Reference')
 ICCAP_FIND_CHILDREN "..", "Setup", AuxVar
 FOR i=0 TO SIZEOF(AuxVar)-1
   IF VAL$(AuxVar[i])=="tmp_aux" THEN ICCAP_FUNC("../tmp_aux", "Delete")
 NEXT i
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________3" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 Avail_Data_Files   ="ICCAP_ARRAY[0]"
 
 
 
 !---delete all Inputs/Outputs
 ICCAP_FUNC(".", "Import Delete")
 ICCAP_FUNC(".", "New Input", "see_under_ExtractOptimize")
 ICCAP_FUNC("see_under_ExtractOptimize", "STFV", "Sweep Type", "CON")
 
 !---reset arrays
 DIMENSION_ARRAY(InputNames, 0)
 DIMENSION_ARRAY(OutputNames, 0)
 DIMENSION_ARRAY(Index, 0)
 DIMENSION_ARRAY(PlotNames, 0)
 DIMENSION_ARRAY(ReqPlotNames, 0)
 
 
 !---reset Variables
 AuxVar = ""
 MDM_FILE_PATH = ""
 MDM_FILE_NAME = ""
 DirFileName   = ""
 FileName      = ""
 RefPlotMdmName= ""
 DeviceName    = ""
 
 
 !---delete ICCAP_VALUES from loaded .mdm
 ICCAP_FUNC("Delete_ICCAP_VALUE_Vars", "Execute")
 
 
 !---delete all Plots except _MP_ and reset array
 !delete all Plots except _MP_ and reset array
 ICCAP_FIND_CHILDREN ".", "Plot", AuxVar
 i=0
 WHILE i < SIZEOF(AuxVar)
   IF VAL$(AuxVar[i])<>"_MP_" THEN ICCAP_FUNC(VAL$(AuxVar[i]), "Delete")
   i = i + 1
 END WHILE
 AuxVar = ""
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK PLOT "_MP_" "711.501"
{
View draw_ds 0 "B,-255,-1844"
View plot_window 0 "516,0,28773,24941"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "Yes" "N"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "9.000" "N"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "6.750" "N"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "2"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "0"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "id_vs_vg"
element "Plot 1" "ig_vs_vg"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./GUI_MP"
element "GUI 1 Location" "U"
}
PlotOptimizerOpt Enable 0
}
}
data "711.501"
{
TABLE "HP4142.4000.24" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Range" "0"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "Yes"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Module Control" ""
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "HP4145.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Init Command" ""
}
TABLE "AgilentE5270.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "No"
element 0 "Range Manager Mode" "1"
element 0 "Range Manager Setting" "90"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Disable Self-cal" "No"
element 0 "Output I/O Port (ERC Command)" ""
element 0 "Output I/O Port (ERM Command)" ""
element 0 "Format Parameter (FMT Command)" "4"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentPNA.4000.20" "711.501"
{
element 0 "Use User Sweep [Yes/No]" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Sweep Type[Step/Analog]" "S"
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port Src Power (dBm)" "-20.00 "
element 0 "Port 2 Src Power (dBm)" "-20.00 "
element 0 "Port Atten Auto [Y/N]" "No"
element 0 "Port Src Atten (dB)" " 0.000 "
element 0 "Port 2 Src Atten (dB)" " 0.000 "
element 0 "Power Slope (dB/GHz)" " 0.000 "
element 0 "Dwell Time (sec) [0=auto]" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor [1-1024]" "1"
element 0 "Ports Mapping" ""
element 0 "Cal Type [Hardware/None]" "H"
element 0 "Cal/State File Name [.csa|.cst only]" ""
element 0 "Use PNA Calibration Settings" "No"
element 0 "Use PNA Receiver Leveling" "No"
element 0 "Delay for timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentB2900.4000.23" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Customized Integ Time" " 10.00u"
element 0 "SMU Filters ON" "No"
element 0 "Sampling Mode" "No"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentB2900.7.23" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Customized Integ Time" " 10.00u"
element 0 "SMU Filters ON" "No"
element 0 "Sampling Mode" "No"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
}
}
LINK DAT "MDM_SPAR2PI_VIEWER" "711.501"
{
View in_out 0 "0.63271955747518 2000 2000"
View plot 0 "0.87947377746279 3329 3002"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P308 P254 C10"
element 0 "Name" "MDM_FILE_PATH"
element 0 "Value" "D:\d_SisConsult\30_TOOLS___\5_Mdlg\5_Xtors\5_III_V\5c_ASM-HEMT\___ICCAP\data\Son_Ya"
element 1 "Name" "MDM_FILE_NAME"
element 1 "Value" "_GaN_SN_6x50u~SPAR_MODELING~Spar_all_freq_biases.mdm"
element 2 "Name" "!DirName"
element 2 "Value" ""
element 2 "Comment" "DUT Variable !"
element 3 "Name" "DirFileName"
element 3 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/Son_Ya/_GaN_SN_6x50u~SPAR_MODELING~Spar_all_freq_biases.mdm"
element 4 "Name" "MDM_EXPORT_XFORM_DATA"
element 4 "Value" "0"
element 5 "Name" "ICCAP_DEFAULT_SETUP_PAGE"
element 5 "Value" "Extract / Optimize"
element 6 "Name" "____________________1"
element 6 "Value" ""
element 7 "Name" "ErrMsg"
element 7 "Value" "LOOKUP_TABLE_VAL: Unable to locate 'S_deemb'."
element 8 "Name" "InputNames[0]"
element 8 "Value" "vg"
element 9 "Name" "InputNames[1]"
element 9 "Value" "vd"
element 10 "Name" "InputNames[2]"
element 10 "Value" "freq"
element 11 "Name" "InputNames"
element 11 "Value" "ICCAP_ARRAY[3]"
element 12 "Name" "OutputNames[0]"
element 12 "Value" "ig"
element 13 "Name" "OutputNames[1]"
element 13 "Value" "id"
element 14 "Name" "OutputNames[2]"
element 14 "Value" "S_deemb"
element 15 "Name" "OutputNames"
element 15 "Value" "ICCAP_ARRAY[3]"
element 16 "Name" "Branch12"
element 16 "Value" "L"
element 17 "Name" "XtorType"
element 17 "Value" "HEMT"
element 18 "Name" "tmpVar"
element 18 "Value" ""
element 19 "Name" "Sweep2Name"
element 19 "Value" "vg"
element 20 "Name" "LegendOnOff"
element 20 "Value" "0"
element 21 "Name" "mdm_Header"
element 21 "Value" "! VERSION = 6.00"
element 22 "Name" "____________________2"
element 22 "Value" ""
element 23 "Name" "Variables_below_stem_from_the_mdm_file"
element 23 "Value" "you_can_delete_them_from_time_to_time"
element 24 "Name" ""
element 24 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_DC"
element 0 "Value" "TL|<none>|<none>|#210TL_Actions|0|0"
element 1 "Name" "TL_DC.TL_Actions.PB_CloseAll"
element 1 "Value" "PB|CA=#19Close All:TO=FW&FH&TT&TR|AC=#11.&#19Close All|<none>|0"
element 2 "Name" "TL_DC.TL_Actions"
element 2 "Value" "TL|OR=HO|<none>|#15Space:#214PB_Mdm_Preview:#19CB_Legend:#211PB_CloseAll|1"
element 3 "Name" "TL_DC.TL_Actions.Space"
element 3 "Value" "TL|<none>|<none>|<none>|0"
element 4 "Name" "TL_Spar"
element 4 "Value" "TL|<none>|<none>|#210TL_Actions|0|1"
element 5 "Name" "TL_Spar.TL_Actions.PB_CloseAll"
element 5 "Value" "PB|CA=#19Close All:TO=FW&FH&TT&TR|AC=#11.&#19Close All|<none>|0"
element 6 "Name" "TL_Spar.TL_Actions"
element 6 "Value" "TL|OR=HO|<none>|#15Space:#214PB_Mdm_Preview:#19CB_Legend:#211PB_CloseAll|1"
element 7 "Name" "TL_Spar.TL_Actions.CB_Legend"
element 7 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 8 "Name" "TL_Spar.TL_Actions.Space"
element 8 "Value" "TL|<none>|<none>|<none>|0"
element 9 "Name" "TL_PI_Schematic"
element 9 "Value" "TL|OR=VE|<none>|#211PB_CloseAll:#19CB_Legend:#214PB_Mdm_Preview:#13Sep:#212LA_Schematic|0|2"
element 10 "Name" "TL_PI_Schematic.LA_Schematic"
element 10 "Value" "LA|CA=#3204\012 port1    __    port2\012  o---o--\174__\174--o---o\012      \174  Z12   \174\012      -        -\012  Z10\174 \174      \174 \174Z20\012      -        -\012      \174        \174\012     ---      ---:FI=FF|<none>|<none>|0"
element 11 "Name" "TL_PI_Schematic.PB_CloseAll"
element 11 "Value" "PB|CA=#19Close All:TO=FW&FH&TR|AC=#11.&#19Close All|<none>|0"
element 12 "Name" "TL_PI_Schematic.Sep"
element 12 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 13 "Name" "TL_PI_Schematic_C"
element 13 "Value" "TL|OR=VE|<none>|#211PB_CloseAll:#19CB_Legend:#214PB_Mdm_Preview:#13Sep:#212LA_Schematic|0|3"
element 14 "Name" "TL_PI_Schematic_C.LA_Schematic"
element 14 "Value" "LA|CA=#3337\012 port1   __         port2\012  o---o-\174__\174---\174\174---o---o\012      \174  R12   C12  \174\012 C10 ---           --- C20\012     ---           ---\012      \174             \174\012      -             -\012 R10 \174 \174           \174 \174 R20\012      -             -\012      \174             \174\012     ---           ---:FI=FF|<none>|<none>|0"
element 15 "Name" "TL_PI_Schematic_C.PB_CloseAll"
element 15 "Value" "PB|CA=#19Close All:TO=FW&FH&TR|AC=#11.&#19Close All|<none>|0"
element 16 "Name" "TL_PI_Schematic_C.Sep"
element 16 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 17 "Name" "TL_PI_Schematic_L"
element 17 "Value" "TL|OR=VE|<none>|#211PB_CloseAll:#19CB_Legend:#214PB_Mdm_Preview:#13Sep:#212LA_Schematic|0|4"
element 18 "Name" "TL_PI_Schematic_L.LA_Schematic"
element 18 "Value" "LA|CA=#3348\012 port1   __          port2\012  o---o-\174__\174--/\134/\134---o---o\012      \174  R12   L12   \174\012 C10 ---            --- C20\012     ---            ---\012      \174              \174\012      -              -\012 R10 \174 \174            \174 \174 R20\012      -              -\012      \174              \174\012     ---            ---:FI=FF|<none>|<none>|0"
element 19 "Name" "TL_PI_Schematic_L.PB_CloseAll"
element 19 "Value" "PB|CA=#19Close All:TO=FW&FH&TR|AC=#11.&#19Close All|<none>|0"
element 20 "Name" "TL_PI_Schematic_L.Sep"
element 20 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 21 "Name" "TL_PI_Schematic_DiodeON"
element 21 "Value" "TL|OR=VE|<none>|#211PB_CloseAll:#19CB_Legend:#214PB_Mdm_Preview:#13Sep:#212LA_Schematic|0|5"
element 22 "Name" "TL_PI_Schematic_DiodeON.LA_Schematic"
element 22 "Value" "LA|CA=#3355\012           __        \012port1  ---\174__\174---  port2\012o---o-\174    R12   \174-o---o\012    \174  ----\174\174----  \174\012   ---     C12    ---C20\012C10---            ---\012    \174              \174\012    -              -\012R10\174 \174            \174 \174R20\012    -              -\012    \174              \174\012   ---            ---:FI=FF|<none>|<none>|0"
element 23 "Name" "TL_PI_Schematic_DiodeON.PB_CloseAll"
element 23 "Value" "PB|CA=#19Close All:TO=FW&FH&TR|AC=#11.&#19Close All|<none>|0"
element 24 "Name" "TL_PI_Schematic_DiodeON.Sep"
element 24 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 25 "Name" "TL_PI_Schematic_Xtor"
element 25 "Value" "TL|OR=VE|<none>|#210TL_Actions:#13Sep:#212LA_Schematic|0|6"
element 26 "Name" "TL_PI_Schematic_Xtor.LA_Schematic"
element 26 "Value" "LA|CA=#3297\012Transistor \012inner PI Schematic\012        ___\012P1 o-o-\174___\174-o----o-o P2\012     \174  Z12  \174    \174\012     -       -    -\012 Z10\174 \174    / \174 \134 \174 \174Z20\012     -     \134 v /  -\012     \174    Gm -    \174\012     \174       \174    \174\012    ---     ---  ---:FI=FF|<none>|<none>|0"
element 27 "Name" "TL_PI_Schematic_Xtor.TL_Actions.PB_CloseAll"
element 27 "Value" "PB|CA=#19Close All:TO=FW&FH&TR|AC=#11.&#19Close All|<none>|0"
element 28 "Name" "TL_PI_Schematic_Xtor.Sep"
element 28 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 29 "Name" "TL_PI_Schematic_Xtor.TL_Actions"
element 29 "Value" "TL|OR=HO|<none>|#15Space:#214PB_Mdm_Preview:#19CB_Legend:#211PB_CloseAll|1"
element 30 "Name" "TL_PI_Schematic_Xtor.TL_Actions.CB_Legend"
element 30 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 31 "Name" "TL_PI_Schematic_Xtor.TL_Actions.Space"
element 31 "Value" "TL|<none>|<none>|<none>|0"
element 32 "Name" "TL_PI_Schematic_Bipolar"
element 32 "Value" "TL|OR=HO|<none>|#212LA_Schematic:#13Sep:#210TL_Actions|0|7"
element 33 "Name" "TL_PI_Schematic_Bipolar.LA_Schematic"
element 33 "Value" "LA|CA=#3655                      ___  \075\075\075Bipolar PI Schematic (negleced RBB) \075\075\075\012Bi o-----o----o--\174\174--\174___\174--o---------------------------o------o--o C\012   \174     \174    \174  C12  R12   \174                           \174      \174      \012  vBiE   -   ---            -                           -      \174\012   \174    \174 \174  ---          /   \134                        \174 \174    ---\012   \174 R10 -    \174C10        \134 _ /vBiE*GM*exp(-j*2PI*TAU)  - R20 ---C20\012   v     \174    \174             \174                           \174      \174\012  ---   ---  ---           ---                         ---    ---:FI=FF|<none>|<none>|0"
element 34 "Name" "TL_PI_Schematic_Bipolar.TL_Actions.PB_CloseAll"
element 34 "Value" "PB|CA=#19Close All:TO=FW&FH&TT&TR|AC=#11.&#19Close All|<none>|0"
element 35 "Name" "TL_PI_Schematic_Bipolar.Sep"
element 35 "Value" "SE|OR=VE|<none>|<none>|0"
element 36 "Name" "TL_PI_Schematic_Bipolar.TL_Actions"
element 36 "Value" "TL|OR=VE|<none>|#211PB_CloseAll:#19CB_Legend:#214PB_Mdm_Preview:#15Space|1"
element 37 "Name" "TL_PI_Schematic_Bipolar.TL_Actions.CB_Legend"
element 37 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 38 "Name" "TL_PI_Schematic_Bipolar.TL_Actions.Space"
element 38 "Value" "TL|<none>|<none>|<none>|0"
element 39 "Name" "TL_PI_Schematic_MOS_HEMT"
element 39 "Value" "TL|OR=HO|<none>|#212LA_Schematic:#13Sep:#210TL_Actions|0|8"
element 40 "Name" "TL_PI_Schematic_MOS_HEMT.LA_Schematic"
element 40 "Value" "LA|CA=#3601               ___    \075\075\075MOS/HEMT quasistatic\075\075\075\075\075\075\075\075\075\075\075\075\075\012G o------o-\174\174-\174___\174-o---------------------------o----o-o D\012   \174     â´ C12 R12  \174                           \174    \174\012   \174 R10\174 \174         -                           \174    \174\012   \174     â¬        /   \134                         -   ---C20\012vGS\174 C10ââ§â       \134 _ / vGS*GM*exp(-j*2PI*TAU) \174 \174  ---\012   v     \174          \174                           \174R20 \174\012  ---   ---        ---                         ---  ---:FI=FF|<none>|<none>|0"
element 41 "Name" "TL_PI_Schematic_MOS_HEMT.Sep"
element 41 "Value" "SE|OR=VE|<none>|<none>|0"
element 42 "Name" "TL_PI_Schematic_MOS_HEMT.TL_Actions.PB_CloseAll"
element 42 "Value" "PB|CA=#19Close All:TO=FW&FH&TT&TR|AC=#11.&#19Close All|<none>|0"
element 43 "Name" "TL_PI_Schematic_MOS_HEMT.TL_Actions"
element 43 "Value" "TL|OR=VE|<none>|#211PB_CloseAll:#19CB_Legend:#214PB_Mdm_Preview:#15Space|1"
element 44 "Name" "TL_PI_Schematic_MOS_HEMT.TL_Actions.CB_Legend"
element 44 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 45 "Name" "TL_PI_Schematic_MOS_HEMT.TL_Actions.Space"
element 45 "Value" "TL|<none>|<none>|<none>|0"
element 46 "Name" "TL_DC.TL_Actions.CB_Legend"
element 46 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 47 "Name" "TL_PI_Schematic_C.CB_Legend"
element 47 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 48 "Name" "TL_PI_Schematic_L.CB_Legend"
element 48 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 49 "Name" "TL_PI_Schematic_DiodeON.CB_Legend"
element 49 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 50 "Name" "TL_PI_Schematic.CB_Legend"
element 50 "Value" "CB|CA=#211Plot Legend:TO=FW&FH&TR:TS=%LegendOnOff|TC=#210gui_Legend&#17Execute|<none>|0"
element 51 "Name" "TL_mdmFileHead"
element 51 "Value" "TS|HT=400:WD=600|<none>|#18LA_notes:#215ED_fileheadtail|0|9"
element 52 "Name" "TL_mdmFileHead.LA_notes"
element 52 "Value" "LA|CA=#225Head of the .mdm File\072:TO=FH&dummy|<none>|<none>|0"
element 53 "Name" "TL_mdmFileHead.ED_fileheadtail"
element 53 "Value" "ED|BG=C9:EM=ML:ED=F:VA=%#210mdm_Header:FI=FF|<none>|<none>|0"
element 54 "Name" "TL_DC.TL_Actions.PB_Mdm_Preview"
element 54 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 55 "Name" "TL_Spar.TL_Actions.PB_Mdm_Preview"
element 55 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 56 "Name" "TL_PI_Schematic.PB_Mdm_Preview"
element 56 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH&TR|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 57 "Name" "TL_PI_Schematic_C.PB_Mdm_Preview"
element 57 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH&TR|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 58 "Name" "TL_PI_Schematic_L.PB_Mdm_Preview"
element 58 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH&TR|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 59 "Name" "TL_PI_Schematic_DiodeON.PB_Mdm_Preview"
element 59 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 60 "Name" "TL_PI_Schematic_Xtor.TL_Actions.PB_Mdm_Preview"
element 60 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH&TR|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 61 "Name" "TL_PI_Schematic_Bipolar.TL_Actions.PB_Mdm_Preview"
element 61 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 62 "Name" "TL_PI_Schematic_MOS_HEMT.TL_Actions.PB_Mdm_Preview"
element 62 "Value" "PB|CA=#216View .mdm Header:TO=FW&FH&TR|AC=#217gui_ViewMdmHeader&#17Execute|<none>|0|2"
element 63 "Name" ""
element 63 "Value" ""
}
LINK SWEEP "vg" "711.501"
{
View draw_ds 0 "B,1055,-3624"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
element "Unit" "SMU1"
element "Compliance" " 40.00m"
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "# of Values" "10"
}
HYPTABLE "List Table"
{
element "Value 1" "-770.0m"
element "Value 2" "-647.0m"
element "Value 3" "-565.0m"
element "Value 4" "-442.0m"
element "Value 5" "-360.0m"
element "Value 6" "-237.0m"
element "Value 7" "-155.0m"
element "Value 8" "-73.00m"
element "Value 9" " 9.000m"
element "Value 10" " 50.00m"
}
}
list PLOT "DC_Bias_ig_vg"
list PLOT "DC_Bias_id_vg"
}
LINK SWEEP "vd" "711.501"
{
View draw_ds 0 "B,1918,-9221"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
element "Unit" "SMU2"
element "Compliance" " 160.0m"
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "6"
}
HYPTABLE "List Table"
{
element "Value 1" " 500.0m"
element "Value 2" " 1.500 "
element "Value 3" " 2.500 "
element "Value 4" " 3.000 "
element "Value 5" " 3.500 "
element "Value 6" " 5.000 "
}
}
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,-170,-6533"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "# of Values" "26"
}
HYPTABLE "List Table"
{
element "Value 1" " 500.0MEG"
element "Value 2" " 1.500G"
element "Value 3" " 2.500G"
element "Value 4" " 3.500G"
element "Value 5" " 4.500G"
element "Value 6" " 5.500G"
element "Value 7" " 6.500G"
element "Value 8" " 7.500G"
element "Value 9" " 8.500G"
element "Value 10" " 9.500G"
element "Value 11" " 10.50G"
element "Value 12" " 11.50G"
element "Value 13" " 12.50G"
element "Value 14" " 13.50G"
element "Value 15" " 14.50G"
element "Value 16" " 15.50G"
element "Value 17" " 16.50G"
element "Value 18" " 17.50G"
element "Value 19" " 18.50G"
element "Value 20" " 19.50G"
element "Value 21" " 20.50G"
element "Value 22" " 21.50G"
element "Value 23" " 22.50G"
element "Value 24" " 23.50G"
element "Value 25" " 24.50G"
element "Value 26" " 25.50G"
}
}
list XFORM "START_SPAR_VIEWER"
list XFORM "Identify_PassCompType"
list XFORM "PI_to_CLR"
list XFORM "PI_Components"
list PLOT "S11"
list PLOT "S12"
list PLOT "S21"
list PLOT "S22"
list PLOT "Z10"
list PLOT "Z12"
list PLOT "Z20"
list PLOT "C10_"
list PLOT "R10_"
list PLOT "L12_"
list PLOT "C12_"
list PLOT "R12_"
list PLOT "C20_"
list PLOT "R20_"
list PLOT "_Z10_"
list PLOT "_Z12_"
list PLOT "_GM_"
list PLOT "_Z20_"
list PLOT "_C10_"
list PLOT "_R10_"
list PLOT "_C12_"
list PLOT "_R12_"
list PLOT "_TAU_"
list PLOT "_GM_AC_"
list PLOT "_C20_"
list PLOT "_R20_"
}
LINK OUT "ig" "711.501"
{
View draw_ds 0 "B,6445,-9221"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" "SMU1"
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "GROUND"
}
dataset
{
datasize BOTH 1560 1 1
type MEAS
type SIMU
}
}
list PLOT "DC_Bias_ig_vg"
}
LINK OUT "id" "711.501"
{
View draw_ds 0 "B,8506,-9221"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" "SMU2"
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "GROUND"
}
dataset
{
datasize BOTH 1560 1 1
type MEAS
type SIMU
}
}
list PLOT "DC_Bias_id_vg"
}
LINK OUT "S" "711.501"
{
View draw_ds 0 "B,-170,488"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "S"
element "Unit" "NWA"
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "Port 1" "P1"
element "Port 2" "P2"
element "AC Ground" "GROUND"
}
dataset
{
datasize BOTH 1560 2 2
type MEAS
type SIMU
}
}
list XFORM "START_SPAR_VIEWER"
list XFORM "S_to_PI"
list XFORM "PI_to_CLR"
list XFORM "PI_Impedances"
list XFORM "PI_Components"
list PLOT "S11"
list PLOT "S12"
list PLOT "S21"
list PLOT "S22"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 ! This is a special version of the MDM_VIEWER for S-Parameter data
 ! ================================================================
 
 ! - opens a .mdm file browser, 
 ! - lets the user select a file for inspection
 ! Then,
 ! - Smith and Polar Plots are created for S-parameters
 ! - depending on the device type (transistor or other)
 ! - the impedance plots of a PI schematic are shown,
 ! - plus the plots of the individual components of the PI Schematic
 ! If a swept DC bias is present, it will be plotted too.
 
 
 !  HOW TO USE
 !  ==========
 !  Execute RUN_ALL
 !
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1560 1 1
type COMMON
}
}
}
LINK XFORM "START_SPAR_VIEWER" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  DirName             ! DUT Variable
 GLOBAL_VAR  DirFileName
 GLOBAL_VAR  MDM_FILE_PATH
 GLOBAL_VAR  MDM_FILE_NAME
 GLOBAL_VAR  XtorType
 
 
 ErrMsg = ""
 
 !---close all possibly displayed Plots
 ICCAP_FUNC(".", "Close All")
 
 
 !---import S-Parameter mdm data
 MDM_FILE_PATH = VAL$(DirName)
 ICCAP_FUNC(".", "Import Create")
 DirName = VAL$(MDM_FILE_PATH)
 DirFileName=SYS_PATH$(VAL$(DirName)&"/"&VAL$(MDM_FILE_NAME))
 
 
 !---delete auto-created Setup Variables due to ICCAP_VALUE in .mdm file
 ICCAP_FUNC("Clean_Up_Variables", "Execute")
 
 
 !---normalize Input/Output names
 ICCAP_FUNC("Verify_InputsOutputs", "Execute")
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING VAL$(ErrMsg) & "    [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---if available, display DC Bias Plots
 ICCAP_FUNC("Display_DC_Bias", "Execute")
 
 
 !---display S-Parameters
 ICCAP_FUNC("_MP_Spar_", "Display Plot")
 ICCAP_FUNC("_MP_Spar_", "Autoscale On")
 
 
 
 
 
 !===apply further inspections==================
 TransistorData = 0
 
 freqPts = USERC_num_of_points(1, ".")
 freqMax = freq[MIN(5, freqPts)]
 S21_R=0
 N=0
 FOR i=0 TO SIZEOF(freq)-1
   IF freq[i] <= freqMax THEN 
     S21_R = S21_R + REAL(S.M.21[i])
     N = N + 1
   END IF 
 NEXT i
 S21_R_Mean = S21_R//N
 IF S21_R_Mean < -0.01 THEN TransistorData = 1
 
 GET_INT "Please Verify Automatic Device Type Classification:
      [1]  Transistor
      [0]  Other Device", VAL(TransistorData), TransistorData
 IF VAL(TransistorData)<>0 ANDALSO VAL(TransistorData)<>1 THEN
   GET_STRING "ERROR: wrong Input !!!  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 
 IF VAL(TransistorData)==0 THEN
   !===for all devices except transistors========================
   !---convert to impedances of a PI schematic, and display the result
   ICCAP_FUNC("S_to_PI",     "Execute")
   ICCAP_FUNC("_MP_S2PI_",   "Display Plot")
   ICCAP_FUNC("_MP_S2PI_",   "Autoscale On")
   !---convert further to detailed PI schematic
   ICCAP_FUNC("Identify_PassCompType", "Execute")
   ICCAP_FUNC("PI_to_CLR",   "Execute")
   IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
   ICCAP_FUNC("_MP_PI2CLR_", "Display Plot")
   ICCAP_FUNC("_MP_PI2CLR_", "Autoscale On")
 ELSEIF VAL(TransistorData)==1 THEN
   !===for transistors========================
   GET_STRING "Enter Type of Transistor:
   Choices:   [BIP], [HBT], [MOS], [HEMT]", VAL$(XtorType), XtorType
   ICCAP_FUNC("PI_Components",          "Execute", S.M)
   ICCAP_FUNC("_MP_Xtor_Zxx_",          "Display Plot")
   ICCAP_FUNC("_MP_Xtor_Zxx_",          "Autoscale On")
   ICCAP_FUNC("_MP_Xtor_PiComponents_", "Display Plot")
   ICCAP_FUNC("_MP_Xtor_PiComponents_", "Autoscale On")
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member OUT "S"
member SWEEP "freq"
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "___aux_______________" "711.501"
{
}
LINK XFORM "Verify_InputsOutputs" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  InputNames
 GLOBAL_VAR  OutputNames
 
 
 
 ErrMsg = ""
 
 
 !---verify that Input with Mode=F is named 'freq'
 Input_OK=0
 ICCAP_FIND_CHILDREN ".", "Input", InputNames
 FOR i=0 TO SIZEOF(InputNames)-1
   Mode = LOOKUP_TABLE_VAL(VAL$(InputNames[i]), "Mode", ErrMsg)
   IF VAL$(Mode)=="F" THEN
     Input_OK=1
     ICCAP_FUNC(VAL$(InputNames[i]), "Rename", "freq")  
   END IF
 NEXT i
 IF VAL(Input_OK)==0 THEN
   ErrMsg="ERROR with Measurement Data:    no Input with Frequency available !!!"
   RETURN_VALUE -1
 END IF
 
 
 !---verify that only 1 Output of type 'S' exists
 ICCAP_FIND_CHILDREN ".", "Output", OutputNames
 N=0
 Spar_OutputNames=""
 FOR i=0 TO SIZEOF(OutputNames)-1
   Mode = LOOKUP_TABLE_VAL(VAL$(OutputNames[i]), "Mode", ErrMsg)
   IF VAL$(Mode)=="S" THEN 
     N = N + 1
     Spar_OutputNames = VAL$(Spar_OutputNames)&", "&VAL$(OutputNames[i])
   END IF
 NEXT i
 Spar_OutputNames = TRIM$(VAL$(Spar_OutputNames), ",")
 IF VAL(N)>1 THEN
   GET_STRING "ERROR with Measurement Data:    more than one Output with S-Parameters !
    From the ones shown below, keep only the one you want to inspect, and delete the other(s)", VAL$(Spar_OutputNames), Spar_OutputName_sel
   FOR i=0 TO SIZEOF(OutputNames)-1
     Mode = LOOKUP_TABLE_VAL(VAL$(OutputNames[i]), "Mode", ErrMsg)
     IF VAL$(Mode)=="S" THEN 
       IF VAL$(OutputNames[i]) <> VAL$(Spar_OutputName_sel) THEN ICCAP_FUNC(VAL$(OutputNames[i]), "Delete")
     END IF
   NEXT i
 END IF
 
 !---for standardization, name the Output with Mode=S to default 'S'
 ICCAP_FIND_CHILDREN ".", "Output", OutputNames
 Output_OK=0
 FOR i=0 TO SIZEOF(OutputNames)-1
   Mode = LOOKUP_TABLE_VAL(VAL$(OutputNames[i]), "Mode", ErrMsg)
   IF VAL$(Mode)=="S" THEN
     Output_OK=1
     ICCAP_FUNC(VAL$(OutputNames[i]), "Rename", "S")  
   END IF
 NEXT i
 IF VAL(Output_OK)==0 THEN
   ErrMsg="ERROR with Measurement Data:    no Output with S-Parameters available !!!"
   RETURN_VALUE -3
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Clean_Up_Variables" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 VarNameKeyword = "Variables_below_stem_from_the_mdm_file"
 Path2Model = WHOIS(".", "Parent Model")		!returns full path to ModelName
 N = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/CLEAN_UP/CleanUp_AllSetupVars", VAL$(VarNameKeyword), VAL$(Path2Model))
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "__passive_components_____" "711.501"
{
}
LINK XFORM "Identify_PassCompType" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Branch12
 
 
 !---this Program identifies the type of component representing Z12
 
 
 !---link to data
 Z12 = S_to_PI.12
 
 NrPts = FLOOR(SIZEOF(freq)//10)
 
 !---calc low freq. Z12
 COMPLEX tmp[NrPts]
 FOR i=0 TO SIZEOF(tmp)-1
   tmp[i]=Z12[i]
 NEXT i
 Z12_lowfreq = MEAN(tmp)
 
 !---calc mid freq. Z12
 COMPLEX tmp[NrPts]
 istart=FLOOR(SIZEOF(freq)//2)
 FOR i=0 TO SIZEOF(tmp)-1
   tmp[i]=Z12[istart - NrPts//2 + i]
 NEXT i
 Z12_midfreq = MEAN(tmp)
 
 !---calc high freq. Z12
 COMPLEX tmp[NrPts]
 imax=SIZEOF(freq)-1
 FOR i=0 TO SIZEOF(tmp)-1
   tmp[i]=Z12[imax-i]
 NEXT i
 Z12_highfreq = MEAN(tmp)
 
 
 
 IF IMAG(Z12_lowfreq)>0 THEN 
   !                        __
   !---check for  o--\/\/--|__|--o  : 
   Branch12="L"
   RETURN_VALUE 2
 ELSE
   IF ABS(IMAG(Z12_midfreq)) < 10*(REAL(Z12_lowfreq)-REAL(Z12_highfreq))//2 THEN
     !                 --||--
     !---check for  o-|  C12 |-o
     !                 -|__|-
     !                   R12
     Branch12="Diode ON"
     RETURN_VALUE 4
   ELSE
     !                      __
     !---check for  o--||--|__|--o  : 
     Branch12="C"
     RETURN_VALUE 3
   END IF
 END IF
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member XFORM "S_to_PI"
member SWEEP "freq"
}
LINK XFORM "S_to_PI" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 ! convert S-par into impedances of a PI schematic
 !
 ! port1    __      port2
 !  o---o--|__|--o---o
 !      |   Z12  |
 !      -        - 
 !  Z10| |      | |Z20
 !      -        -
 !      |        |
 !     ---      ---
 !
 ! ==> For details about the returned data set format, 
 !  see below, after the RETURN statement
 
 
 !------------------------------------------------------------------- 
 
 COMPLEX Z.M.22[SIZEOF(S)]
 
 IF MEAN(S.M.11)<>0 THEN 
   YM = TwoPort(S.M, "S", "Y")
   FOR i=0 TO SIZEOF(YM)-1
     YxyM = 0.5*(YM.12[i] + YM.21[i])
     IF YM.11[i]+YxyM <> 0 THEN Z.M.11[i] = (YM.11[i]+YxyM)^-1	!Z10.M
     IF YxyM <>0 THEN Z.M.12[i] = -(YxyM)^-1			!Z12.M
     IF YM.22[i]+YxyM <> 0 THEN Z.M.22[i] = (YM.22[i]+YxyM)^-1	!Z20.M
   NEXT i
 END IF
 
 
 RETURN Z
 
 ! Z.11  = Z10
 ! Z.12  = Z12
 ! Z.22  = Z20
 
 
 ! port1    __      port2
 !  o---o--|__|--o---o
 !      |   Z12  |
 !      -        - 
 !  Z10| |      | |Z20
 !      -        -
 !      |        |
 !     ---      ---
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize MEAS 405 2 2
type MEAS
}
}
list XFORM "Identify_PassCompType"
list XFORM "PI_to_CLR"
list PLOT "Z10"
list PLOT "Z12"
list PLOT "Z20"
member OUT "S"
}
LINK XFORM "PI_to_CLR" "711.501"
{
View block_edit 0 "32021,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  Branch12
 
 
 !---close Plot
 ICCAP_FUNC("_MP_PI2CLR_", "Close")
 
 
 !---ask user what to do
 ErrMsg = "User cancelled Program"  !handle case if user selects Cancel
 GET_STRING "Preparing Detailed Inspection of the PI Schematic Impedances:
 -------------------------------------------------------------
          _____  
  port1  |     |  port2
   o---o-| Z12 |-o---o
       | |_____| |
  C10 ---       --- C20
      ---       ---
       |         |
       -         -
  R10 | |       | | R20
       -         -
       |         |
      ---       ---
 ====================================================
 To Interpret Impedance Z12 (between Port1 and Port2)
 ==>  Verify the Auto-Detected Device Type:
 ====================================================
                           __R12  C12 
 [C]        for Z12:    o-|__|--||--o
 
                           __R12   L12 
 [L]        for Z12:    o-|__|--/\/\--o
 
                             --||--
 [Diode ON] for Z12:      o-|  C12 |-o
                             -|__|-
                               R12
 
 If you are not sure: 
 enter [L] for a conductive device between the ports,
 and   [C] else", VAL$(Branch12), Branch12
 
 ErrMsg = ""
 
 
 
 IF UPC$(VAL$(Branch12)) <> "L" ANDALSO UPC$(VAL$(Branch12)) <> "C" ANDALSO  UPC$(VAL$(Branch12)) <> "DIODE ON" THEN
   GET_STRING "ERROR: please answer with 'L' or 'C' or 'Diode ON'    [OK]", dummy
   COMPLEX tmp.B.22[SIZEOF(S)]
   RETURN tmp
 END IF
 
 !---update MultiPlot
 IF UPC$(VAL$(Branch12))=="L" THEN
   ICCAP_FUNC("_MP_PI2CLR_", "STFV", "Plot 1", "L12_")
   ICCAP_FUNC("_MP_PI2CLR_", "STFV", "GUI 1", "TL_PI_Schematic_L")
 ELSEIF UPC$(VAL$(Branch12))=="C" THEN
   ICCAP_FUNC("_MP_PI2CLR_", "STFV", "Plot 1", "C12_")
   ICCAP_FUNC("_MP_PI2CLR_", "STFV", "GUI 1", "TL_PI_Schematic_C")
 ELSEIF UPC$(VAL$(Branch12))=="DIODE ON" THEN
   ICCAP_FUNC("_MP_PI2CLR_", "STFV", "Plot 1", "C12_")
   ICCAP_FUNC("_MP_PI2CLR_", "STFV", "GUI 1", "TL_PI_Schematic_DiodeON")
 END IF
  
 !------------------------------------------------------------------- 
 
 COMPLEX Result_CLR.M.22[SIZEOF(S)]
 
 
 !---meas. data
 IF MEAN(S_to_PI.M.11)<>0 THEN 
   FOR i=0  TO SIZEOF(S_to_PI)-1
     C10M = 0
     IF IMAG(S_to_PI.M.11[i]) <> 0  THEN C10M = -(IMAG(S_to_PI.M.11[i])*2*PI*freq[i])^-1	!C10  port1 to GND
     R10M = REAL(S_to_PI.M.11[i])
     IF UPC$(VAL$(Branch12))<>"DIODE ON" THEN
       IF UPC$(VAL$(Branch12))=="L" THEN L12M = IMAG(S_to_PI.M.12[i])//(2*PI*freq[i])        !L12  port1 to port2
       C12M = 0
       IF UPC$(VAL$(Branch12))=="C" ANDALSO IMAG(S_to_PI.M.12[i])<>0 THEN C12M = -(IMAG(S_to_PI.M.12[i])*2*PI*freq[i])^-1     !C12  port1 to Port2
       R12M = REAL(S_to_PI.M.12[i])
     ELSE ! Diode ON
       Y12 = (S_to_PI.M.12[i])^-1
       C12M = REAL(IMAG(Y12) // (2PI*freq[i]))
       R12M = 0
       IF REAL(Y12) <> 0 THEN R12M = REAL(Y12)^-1
     END IF
     C20M = 0
     IF IMAG(S_to_PI.M.22[i]) <> 0  THEN C20M = -(IMAG(S_to_PI.M.22[i])*2*PI*freq[i])^-1	!C20  port1 to GND
     R20M = REAL(S_to_PI.M.22[i])
 
     !---fill array 'Result_CLR' with schematic component values
     Result_CLR.M.11[i] = REAL(R10M) + j*REAL(C10M)	!apply REAL() to cancel PEL calculation rounding errors
     IF UPC$(VAL$(Branch12))=="L"        THEN Result_CLR.M.12[i] = REAL(R12M) + j*REAL(L12M)
     IF UPC$(VAL$(Branch12))=="C"        THEN Result_CLR.M.12[i] = REAL(R12M) + j*REAL(C12M)
     IF UPC$(VAL$(Branch12))=="DIODE ON" THEN Result_CLR.M.12[i] = REAL(R12M) + j*REAL(C12M)
     Result_CLR.M.21[i] = 0				
     Result_CLR.M.22[i] = REAL(R20M) + j*REAL(C20M)
   NEXT i
 END IF
 
 
 
 RETURN Result_CLR
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !                                             Result_CLR.11 = R10 + j*C10
 ! IF VAL$(Branch12)=="L" THEN                 Result_CLR.12 = R12 + j*L12
 ! IF VAL$(Branch12)=="C" OR "Diode ON" THEN   Result_CLR.12 = R12 + j*C12
 !                                             Result_CLR.21 = 0				
 !                                             Result_CLR.22 = R20 + j*C20
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !
 !         _____  
 ! port1  |     |  port2
 !  o---o-| Z12 |-o---o
 !      | |_____| |
 ! C10 ---       --- C20
 !     ---       ---
 !      |         |
 !      -         -
 ! R10 | |       | | R20
 !      -         -
 !      |         |
 !     ---       ---
}
dataset
{
datasize MEAS 405 2 2
type MEAS
}
}
list PLOT "C10_"
list PLOT "R10_"
list PLOT "L12_"
list PLOT "C12_"
list PLOT "R12_"
list PLOT "C20_"
list PLOT "R20_"
member XFORM "S_to_PI"
member OUT "S"
member SWEEP "freq"
}
LINK XFORM "__transistors_______" "711.501"
{
}
LINK XFORM "PI_Impedances" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 
 ! This Program, called by 'PI_Components',
 ! acts like a data base to host the 
 ! transistor PI schematic impedances 
 ! Z10, Z12 and Z20.
 ! This enables the plotting of the impedances in RI-Plots.
 !                 ___
 ! P1 o-------o---|___|---o------o--o P2
 !            |    Z12    |       |
 !            -           -       -
 !       Z10 | |        / | \    | | Z20
 !            -         \ v /Gm   -
 !            |           -       |
 !            |           |       |
 !           ---         ---     ---
 
 !----------------------------------------------------------------
 
 GET_DATASET "PI Impedance Z10", Z10
 GET_DATASET "PI Impedance Z12", Z12
 GET_DATASET "GM", GM
 GET_DATASET "PI Impedance Z20", Z20
 
 
 !---return impedances
 COMPLEX PI_Imped.M.22[SIZEOF(S)]
 FOR i=0 TO SIZEOF(PI_Imped)-1
   PI_Imped.M.11[i] = Z10.M[i]
   PI_Imped.M.12[i] = Z12.M[i]
   PI_Imped.M.21[i] = GM.M[i]
   PI_Imped.M.22[i] = Z20.M[i]
 NEXT i
 
 RETURN PI_Imped
 !   PI_Imped.11 = Z10     Impedance Port1 -> Ground
 !   PI_Imped.12 = Z12     Impedance Port1 -> Port2
 !   PI_Imped.21 = Gm      complex Gm
 !   PI_Imped.22 = Z20     Impedance Port2 -> Ground
 
}
dataset
{
datasize MEAS 1560 2 2
type MEAS
}
}
list PLOT "_Z10_"
list PLOT "_Z12_"
list PLOT "_GM_"
list PLOT "_Z20_"
member OUT "S"
}
LINK XFORM "PI_Components" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  XtorType
 
 
 !---this is answered by the calling Transform
 GET_DATASET "S-Param", Spar
 
 Ypar = TWOPORT(Spar.M, "S", "Y")
 
 !---calculate the impedances and Gm
 ! ===inner PI schematic impedances===
 !                 ___
 ! P1 o-------o---|___|---o------o--o P2
 !            |    Z12    |       |
 !            -           -       -
 !       Z10 | |        / | \    | | Z20
 !            -         \ v /Gm   -
 !            |           -       |
 !            |           |       |
 !           ---         ---     ---
 
 Z_10 = (Ypar.11 + Ypar.12)^-1           !impedance Z10:  port1 -> GND
 Y_10 =  Ypar.11 + Ypar.12               !admittance Y10: port1 -> GND
 Z_12 = (-Ypar.12)^-1                    !impedance Z12:  port1 -> port2
 Gm_quasistat  = Ypar.21 - Ypar.12       !GM (real + j*imag)
 Y_20 = Ypar.22 + Ypar.12                !admittance Z20: port2 -> GND
 
 
 
 !--export PI Impedances and GM to Transform PI_Impedances for Plots
 ICCAP_FUNC("PI_Impedances", "Execute", Z_10, Z_12, Gm_quasistat, Y_20^-1)
 
 
 ! calculate the Cxx, Rxx, GM and TAU for the following inner transistor PI schematic
 ! 
 ! ===MOS/HEMT quasistatic==========================================
 !                   ___
 ! G o-------o--||--|___|--o---------------------------o------o--o D
 !    |      â´   C12  R12  |                           |      |
 !    |  R10| |            -                           |      |
 !    |      â¬           /   \                         -     ---C20
 ! vGS|  C10ââ§â          \ _ / vGS*GM*exp(-j*2PI*TAU) | |    ---
 !    v      |             |                           |R20   |
 !   ---    ---           ---                         ---    ---
 
 ! 
 ! ===PI schematic of Bipolar, simplified: negleced RBB & CBCexternal ===
 !                        ___ 
 !  Bi o-----o----o--||--|___|--o---------------------------o------o--o C
 !     |     |    |  C12  R12   |                           |      |      
 !     |     -   ---            -                           -      |
 ! vBiE|    | |  ---          /   \                        | |    ---
 !     | R10 -    |C10        \ _ /vBiE*GM*exp(-j*2PI*TAU)  - R20 ---C20
 !     v     |    |             |                           |      |
 !    ---   ---  ---           ---                         ---    ---
 
 IF UPC$(VAL$(XtorType))=="BIP" OR UPC$(VAL$(XtorType))=="HBT" THEN
   !---for Bipolar and HBT-------
   R10_ = (REAL(Y_10))^-1
   C10_ = IMAG(Y_10) // (2PI*freq)
 ELSE
   !---for MOS and HEMT----------
   R10_ = REAL(Z_10)
   C10_ = -(IMAG(Z_10))^-1 // (2PI*freq)
 END IF
 
 
 R12_ = REAL(Z_12)
 C12_ = -(IMAG(Z_12))^-1 // (2PI*freq)
 
 
 GM_  = MAG(Gm_quasistat)
 TAU_ = -PH(Gm_quasistat) // (2PI*freq)
 
 
 R20_ = REAL(REAL(Y_20))^-1		! we need to take the REAL(math conversion) because of rounding problems in PEL, which could add small IMAG parts, which affect the REAL part after e.g. calculating the inverse
 C20_ = IMAG(Y_20) // (2PI*freq)
 
 
 !---finally, return the data inner-PI schematic values, 'M' (Measured) and 'S' (Simulated),
 !   in a 2x2 array for Plot and PlotOptimizer
 COMPLEX tmp.B.22[SIZEOF(S)]
 FOR i =0 TO SIZEOF(tmp) - 1
   tmp.M.11[i] = REAL(R10_.M[i]) + j*REAL(C10_.M[i])
   tmp.M.12[i] = REAL(R12_.M[i]) + j*REAL(C12_.M[i])
   tmp.M.21[i] =  REAL(GM_.M[i]) + j*REAL(TAU_.M[i])
   tmp.M.22[i] = REAL(R20_.M[i]) + j*REAL(C20_.M[i])
 NEXT i
 
 !---update MultiPlot
 IF UPC$(VAL$(XtorType))=="BIP" OR UPC$(VAL$(XtorType))=="HBT" THEN
   ICCAP_FUNC("_MP_Xtor_PiComponents_", "STFV", "GUI 1", "TL_PI_Schematic_Bipolar")
 ELSE
   ICCAP_FUNC("_MP_Xtor_PiComponents_", "STFV", "GUI 1", "TL_PI_Schematic_MOS_HEMT")
 END IF
 
 
 RETURN tmp
 
 !      tmp.11 = R10 + j*C10
 !      tmp.12 = R12 + j*C12
 !      tmp.21 = GM  + j*TAU
 !      tmp.22 = R20 + j*C20
}
dataset
{
datasize BOTH 1560 2 2
type MEAS
type SIMU
}
}
list PLOT "_Z10_"
list PLOT "_Z12_"
list PLOT "_Z20_"
list PLOT "_C10_"
list PLOT "_R10_"
list PLOT "_C12_"
list PLOT "_R12_"
list PLOT "_TAU_"
list PLOT "_GM_AC_"
list PLOT "_C20_"
list PLOT "_R20_"
member OUT "S"
member SWEEP "freq"
}
LINK XFORM "gui_Legend" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  LegendOnOff
 GLOBAL_VAR  tmpVar
 
 
 IF VAL(LegendOnOff)==1 THEN 
   Action = "Legend On"
 ELSE
   Action = "Legend Off"
 END IF
 
 !---switch legend in MultiPlots
 ICCAP_FUNC("_MP_DC_Biases_",         VAL$(Action))
 ICCAP_FUNC("_MP_Spar_",              VAL$(Action))
 ICCAP_FUNC("_MP_S2PI_",              VAL$(Action))
 ICCAP_FUNC("_MP_PI2CLR_",            VAL$(Action))
 ICCAP_FUNC("_MP_Xtor_Zxx_",          VAL$(Action))
 ICCAP_FUNC("_MP_Xtor_PiComponents_", VAL$(Action))
 
 
 !---switch back to standard colors
 IF VAL(LegendOnOff)==0 THEN 
   ICCAP_FIND_CHILDREN ".", "Plot", tmpVar
   !---switch all plots back to default colors, except MultiPlots
   FOR i=0 TO SIZEOF(tmpVar)-1
     PlotType = LOOKUP_TABLE_VAL(VAL$(tmpVar[i]), "Report Type")
     IF VAL$(PlotType)<> "MULTIPLOT" THEN 
       ICCAP_FUNC(VAL$(tmpVar[i])&"/PlotOptions", "STFV", "Multicolor", "Display all curves with the configured trace color")
       ICCAP_FUNC(VAL$(tmpVar[i]), "Redisplay")
     END IF
   NEXT i
   !---redisplay MultiPlots
   FOR i=0 TO SIZEOF(tmpVar)-1
     PlotType = LOOKUP_TABLE_VAL(VAL$(tmpVar[i]), "Report Type")
     IF VAL$(PlotType)== "MULTIPLOT" THEN 
       ICCAP_FUNC(VAL$(tmpVar[i]), "Redisplay")
     END IF
   NEXT i
 END IF
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Display_DC_Bias" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  Sweep2Name
 GLOBAL_VAR  OutputNames
 
 
 !---delete old DC Bias Plots, except their MultiPlot
 ICCAP_FIND_CHILDREN ".", "Plot", tmpVar         !find all Plots
 FOR i=0 TO SIZEOF(tmpVar)-1
   IF VAL$(tmpVar[i])<>"_MP_DC_Biases_" THEN
     IF STRPOS(VAL$(tmpVar[i]), "DC_Bias") > 0 THEN ICCAP_FUNC(VAL$(tmpVar[i]), "Delete")
   END IF
 NEXT i
 tmpVar = ""
 
 
 !---identify sweep2 Input
 dummy= USERC_sweep_name(2, ".", Sweep2Name)	!Sweep2Name has to be a (Setup)Variable
 
 !---exit if no DC bias sweep exists
 IF VAL$(Sweep2Name)=="" THEN RETURN_VALUE 2
 
 
 
 !---create Plots for all DC Bias Current Outputs 
 N = 0
 FOR i=0 TO SIZEOF(OutputNames) -1
   Mode = LOOKUP_TABLE_VAL(VAL$(OutputNames[i]), "Mode", ErrMsg)
   IF VAL$(Mode)=="I" THEN 
     PlotName = "DC_Bias_"&VAL$(OutputNames[i])&"_"&VAL$(Sweep2Name)
     ICCAP_FUNC(".", "New Plot", VAL$(PlotName))
     ICCAP_FUNC(VAL$(PlotName), "STFV", "X Data",   VAL$(Sweep2Name))
     ICCAP_FUNC(VAL$(PlotName), "STFV", "Y Data 0", VAL$(OutputNames[i])&".M")
     ICCAP_FUNC(VAL$(PlotName), "STFV", "Header",   VAL$(OutputNames[i])&"_"&VAL$(Sweep2Name))
     N = N + 1
     !---add Plot to MultiPlot
     ICCAP_FUNC("_MP_DC_Biases_", "STFV", "# of Plots", N)
     ICCAP_FUNC("_MP_DC_Biases_", "STFV", "Plot "&VAL$(N-1), VAL$(PlotName))
   END IF
 NEXT i 
 
 
 !---display DC Bias MultiPlot
 IF N>0 THEN ICCAP_FUNC("_MP_DC_Biases_", "Display Plot")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_ViewMdmHeader" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR  DirFileName
 GLOBAL_VAR  mdm_Header
 
 
 IF VAL$(DirFileName)=="" THEN RETURN_VALUE -1
 
 mdm_Header = SYSTEM$("head -100 "&VAL$(DirFileName))
 
 ICCAP_FUNC("./TL_mdmFileHead", "Display Modeless GUI", "mdm File Header")
 
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK PLOT "_MP_Spar_" "711.501"
{
View plot_window 0 "26,184,36671,12524,{S11:AUTO|RI|RI: 900.0m, 100.0m, 200.0m,4,5,4,5&S12:AUTO|RI|RI: 105.0m,-55.00m, 35.00m,7,5,7,5&S21:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&S22:AUTO|RI|RI: 50.00m,-50.00m, 250.0m,5,5,5,5}"
View draw_ds 0 "B,0,171"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "4"
element "Header" "S-Parameter Inspection"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "S11"
element "Plot 1" "S12"
element "Plot 2" "S21"
element "Plot 3" "S22"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_Spar"
element "GUI 1 Location" "U"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S11" "711.501"
{
View draw_ds 0 "B,0,-59455"
View plot_window 0 "4,23,11997,8998"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S-Parameter  S11"
element "Footer" ""
element "Smith Data 0" "S.M.11"
element "Smith Data 1" ""
element "Smith Data 2" ""
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "S"
member SWEEP "freq"
}
LINK PLOT "S12" "711.501"
{
View draw_ds 0 "B,0,-56083"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S-Parameter  S12"
element "Footer" ""
element "Polar Data 0" "S.M.12"
element "Polar Data 1" ""
element "Polar Data 2" ""
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "S"
member SWEEP "freq"
}
LINK PLOT "S21" "711.501"
{
View draw_ds 0 "B,0,-52711"
View plot_window 0 "4,23,11997,8998,{AUTO|RI|RI:-25.00m,-5.000m, 15.00m,3,5,3,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S-Parameter  S21"
element "Footer" ""
element "Polar Data 0" "S.M.21"
element "Polar Data 1" ""
element "Polar Data 2" ""
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "S"
member SWEEP "freq"
}
LINK PLOT "S22" "711.501"
{
View draw_ds 0 "B,0,-49339"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S-Parameter  S22"
element "Footer" ""
element "Smith Data 0" "S.M.22"
element "Smith Data 1" ""
element "Smith Data 2" ""
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "S"
member SWEEP "freq"
}
LINK PLOT "_MP_S2PI_" "711.501"
{
View draw_ds 0 "B,0,-45967"
View plot_window 0 "142,301,39492,12453,{Z10:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&Z12:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&GM:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&Z20:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,0,0,0,0}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "3"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" "Impedances of PI Schematic"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "Z10"
element "Plot 1" "Z12"
element "Plot 2" "Z20"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_PI_Schematic"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "Z10" "711.501"
{
View draw_ds 0 "B,0,-43003"
View plot_window 0 "929,370,8998,8998,{AUTO|RI|RI: 0.000 , 0.000 , 100.0K,4,5,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z10"
element "Footer" ""
element "RI Data 0" "S_to_PI.M.11!!Z10.M"
element "RI Data 1" ""
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_PI"
member SWEEP "freq"
}
LINK PLOT "Z12" "711.501"
{
View draw_ds 0 "B,0,-39631"
View plot_window 0 "382,697,10629,8990,{MAN|XY| 700.0 , 820.0 ,6,4:-80.00 , 20.00 ,6,4: 0.000 , 1.000 ,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z12"
element "Footer" ""
element "RI Data 0" "S_to_PI.M.12!!Z12.M"
element "RI Data 1" ""
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_PI"
member SWEEP "freq"
}
LINK PLOT "Z20" "711.501"
{
View draw_ds 0 "B,0,-36259"
View plot_window 0 "716,313,9005,8995"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z20"
element "Footer" ""
element "RI Data 0" "S_to_PI.M.22!!Z20.M"
element "RI Data 1" ""
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S_to_PI"
member SWEEP "freq"
}
LINK PLOT "_MP_PI2CLR_" "711.501"
{
View draw_ds 0 "B,0,-32887"
View plot_window 0 "311,266,47284,22260,{C10_:AUTO|XY| 1.000G, 100.0G,2,9: 0.000 , 100.0f,2,9: 0.000 , 1.000 ,4,5&L12_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&C20_:AUTO|XY| 1.000G, 100.0G,2,9: 0.000 , 1.000p,3,9: 0.000 , 1.000 ,4,5&R10_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&R12_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&R20_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "6"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" "PI Schematic Components in Details"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "C10_"
element "Plot 1" "L12_"
element "Plot 2" "C20_"
element "Plot 3" "R10_"
element "Plot 4" "R12_"
element "Plot 5" "R20_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "TL_PI_Schematic_L"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "C10_" "711.501"
{
View plot_window 0 "37,293,9005,8995,{AUTO|XY| 0.00000 , 40.0000G,4,5: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,-29311"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.11)!!C10.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
member SWEEP "freq"
}
LINK PLOT "R10_" "711.501"
{
View plot_window 0 "415,468,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 600.000 ,6,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,-25123"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_to_CLR.M.11)!!R10.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
member SWEEP "freq"
}
LINK PLOT "L12_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 100.0MEG, 100.0G,3,9:-4.000n, 8.000n,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,-20935"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "L12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.12)!!L12.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
member SWEEP "freq"
}
LINK PLOT "C12_" "711.501"
{
View plot_window 0 "4,23,8998,8998,{AUTO|XY| 100.0MEG, 100.0G,3,9: 4.000n, 8.000n,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,-16747"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.12)!!C12.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
member SWEEP "freq"
}
LINK PLOT "R12_" "711.501"
{
View plot_window 0 "845,266,9005,8995,{AUTO|XY| 100.000MEG, 10.0000G,2,9: 793.000 , 797.000 ,4,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,-12559"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_to_CLR.M.12)!!R12.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
member SWEEP "freq"
}
LINK PLOT "C20_" "711.501"
{
View plot_window 0 "138,147,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 1.00000p,5,4: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,-8371"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_to_CLR.M.22)!!C20.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
member SWEEP "freq"
}
LINK PLOT "R20_" "711.501"
{
View plot_window 0 "728,323,9005,8995,{AUTO|XY| 100.000MEG, 100.000G,3,9: 0.00000 , 300.000 ,6,5: 0.00000 , 1.00000 ,4,5}"
View draw_ds 0 "B,0,-4183"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_to_CLR.M.22)!!R20.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_to_CLR"
member SWEEP "freq"
}
LINK PLOT "_MP_Xtor_Zxx_" "711.501"
{
View plot_window 0 "278,260,32299,10866,{_Z10_:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&_Z12_:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&_Z20_:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5}"
View draw_ds 0 "B,6,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "3"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "4"
element "Header" "Transistor PI Impedances"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_Z10_"
element "Plot 1" "_Z12_"
element "Plot 2" "_Z20_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_PI_Schematic_Xtor"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_Z10_" "711.501"
{
View plot_window 0 "4,23,8991,8996,{AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC}"
View draw_ds 0 "B,0,2969"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z10"
element "Footer" ""
element "RI Data 0" "PI_Impedances.M.11"
element "RI Data 1" ""
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_Components"
member XFORM "PI_Impedances"
member SWEEP "freq"
}
LINK PLOT "_Z12_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC}"
View draw_ds 0 "B,0,6341"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z12"
element "Footer" ""
element "RI Data 0" "PI_Impedances.M.12"
element "RI Data 1" ""
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_Components"
member XFORM "PI_Impedances"
member SWEEP "freq"
}
LINK PLOT "_GM_" "711.501"
{
View draw_ds 0 "B,0,61709"
View plot_window 0 "716,313,8991,8996"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "GM"
element "Footer" ""
element "RI Data 0" "PI_Impedances.M.21!!GM"
element "RI Data 1" ""
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_Impedances"
member SWEEP "freq"
}
LINK PLOT "_Z20_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 0.000 , 140.0 ,7,4:-100.0 , 150.0 ,7,5:AUTOMATIC}"
View draw_ds 0 "B,0,9713"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z20"
element "Footer" ""
element "RI Data 0" "PI_Impedances.M.22"
element "RI Data 1" ""
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PI_Components"
member XFORM "PI_Impedances"
member SWEEP "freq"
}
LINK PLOT "_MP_Xtor_PiComponents_" "711.501"
{
View plot_window 0 "__iccapDataBlock"
TABLE "ICVIEWDATA"
{
34,82,39880,24483,{_C10_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_R10_:AUTO|XY| 75.88MEG, 25.00G,5,5: 42.14 , 120.0G,6,4: 0.000 , 1.000 ,4,5&_C12_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_R12_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_GM_AC_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_TAU_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_C20_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_R20_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOM
ATIC}
__iccapDataBlockEnd
}
View draw_ds 0 "B,0,13085"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "8"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "4"
element "Header" "Transistor PI Schematic Components in Details"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_C10_"
element "Plot 1" "_R10_"
element "Plot 2" "_C12_"
element "Plot 3" "_R12_"
element "Plot 4" "_GM_AC_"
element "Plot 5" "_TAU_"
element "Plot 6" "_C20_"
element "Plot 7" "_R20_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "TL_PI_Schematic_MOS_HEMT"
element "GUI 1 Location" "U"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_C10_" "711.501"
{
View plot_window 0 "4,23,10135,10118"
View draw_ds 0 "B,0,17069"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.11)!!C10.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_R10_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_R10_:MAN|XY| 75.88MEG, 25.00G,5,5: 42.14 , 120.0G,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,21257"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.11)!!R10.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_C12_" "711.501"
{
View plot_window 0 "4,23,10135,10118"
View draw_ds 0 "B,0,25445"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.12)!!C12.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_R12_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_R12_:AUTO|XY| 1.000G, 5.000G,4,5: 7.338m, 200.0 ,4,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,29633"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.12)!!R12.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_TAU_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_TAU_:AUTO|XY| 82.23MEG, 5.000G,5,5: 0.000 , 10.00p,5,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,33821"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "TAU"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.21)!!TAU.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_GM_AC_" "711.501"
{
View plot_window 0 "4,23,9005,8990"
View draw_ds 0 "B,0,38009"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "GM"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.21)!!GM_AC.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_C20_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_C20_:AUTO|XY| 92.27MEG, 500.0MEG,5,5: 2.950a, 800.0f,5,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,42197"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(PI_Components.M.22)!!C20.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
PlotError IsErrorRelative 0 
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_R20_" "711.501"
{
View plot_window 0 "4,23,9005,8990,{_R20_:AUTO|XY| 1.000 , 39.81MEG,4,5: 53.90 , 8.000K,6,4: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,46385"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PI_Components.M.22)!!R20.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 1
}
member XFORM "PI_Components"
member SWEEP "freq"
}
LINK PLOT "_MP_DC_Biases_" "711.501"
{
View draw_ds 0 "B,0,50573"
View plot_window 0 "4,23,24964,13194"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "A"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "2"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "0"
element "Header" "DC Biasings"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "DC_Bias_ig_vg"
element "Plot 1" "DC_Bias_id_vg"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_DC"
element "GUI 1 Location" "U"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "DC_Bias_ig_vg" "711.501"
{
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "vg"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "ig_vg"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "ig.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "ig"
member SWEEP "vg"
}
LINK PLOT "DC_Bias_id_vg" "711.501"
{
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "vg"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "id_vg"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "id.M"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "id"
member SWEEP "vg"
}
data "711.501"
{
TABLE "AgilentE5270.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "No"
element 0 "Range Manager Mode" "1"
element 0 "Range Manager Setting" "90"
element 0 "Enable HRSMU1 Range Manager" "No"
element 0 "HRSMU1 A/D converter" "R"
element 0 "HRSMU1 In/Out Range" "0/11"
element 0 "Enable MPSMU2 Range Manager" "No"
element 0 "MPSMU2 A/D converter" "R"
element 0 "MPSMU2 In/Out Range" "0/11"
element 0 "Enable MPSMU3 Range Manager" "No"
element 0 "MPSMU3 A/D converter" "R"
element 0 "MPSMU3 In/Out Range" "0/11"
element 0 "Enable MPSMU4 Range Manager" "No"
element 0 "MPSMU4 A/D converter" "R"
element 0 "MPSMU4 In/Out Range" "0/11"
element 0 "Enable MPSMU5 Range Manager" "No"
element 0 "MPSMU5 A/D converter" "R"
element 0 "MPSMU5 In/Out Range" "0/11"
element 0 "Enable MPSMU6 Range Manager" "No"
element 0 "MPSMU6 A/D converter" "R"
element 0 "MPSMU6 In/Out Range" "0/11"
element 0 "Enable MPSMU7 Range Manager" "No"
element 0 "MPSMU7 A/D converter" "R"
element 0 "MPSMU7 In/Out Range" "0/11"
element 0 "Enable MPSMU8 Range Manager" "No"
element 0 "MPSMU8 A/D converter" "R"
element 0 "MPSMU8 In/Out Range" "0/11"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Disable Self-cal" "No"
element 0 "Output I/O Port (ERC Command)" ""
element 0 "Output I/O Port (ERM Command)" ""
element 0 "Format Parameter (FMT Command)" "4"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentPNA.4000.20" "711.501"
{
View par_var_table 0 "V530 C36 C17"
element 0 "Use User Sweep [Yes/No]" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Sweep Type[Step/Analog]" "S"
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port Src Power (dBm)" "-20.00 "
element 0 "Port 2 Src Power (dBm)" "-20.00 "
element 0 "Port Atten Auto [Y/N]" "No"
element 0 "Port Src Atten (dB)" " 0.000 "
element 0 "Port 2 Src Atten (dB)" " 0.000 "
element 0 "Power Slope (dB/GHz)" " 0.000 "
element 0 "Dwell Time (sec) [0=auto]" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor [1-1024]" "1"
element 0 "Ports Mapping" ""
element 0 "Cal Type [Hardware/None]" "H"
element 0 "Cal/State File Name [.csa|.cst only]" "myCalState.cst"
element 0 "Use PNA Calibration Settings" "Yes"
element 0 "Use PNA Receiver Leveling" "No"
element 0 "Delay for timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
TABLE "HP4142.4000.24" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Range" "0"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "Yes"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Module Control" ""
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "HP4145.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Init Command" ""
}
}
}
LINK DAT "COMBINE_MDMS" "711.501"
{
View in_out 0 "0.62950452484601 1842 2166"
View plot 0 "2.0379944976757 8633 6901"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 C23 P301 C10"
element 0 "Name" "MDM_FILE_PATH"
element 0 "Value" "D:\d_SisConsult\30_TOOLS___\5_Mdlg\5_Xtors\5_III_V\5c_ASM-HEMT\___ICCAP\data\San_An\2019-01-22\data"
element 1 "Name" "MDM_FILE_NAME"
element 1 "Value" "_Diode_Rev_All_TEMP_Combined.mdm"
element 2 "Name" "MDM_VALUES_LIST"
element 2 "Value" ""
element 3 "Name" "MDM_EXPORT_XFORM_DATA"
element 3 "Value" "0"
element 4 "Name" "__________________1"
element 4 "Value" "Variables"
element 5 "Name" "txt_HELP"
element 5 "Value" "The combined .mdm file has been saved into the user-defined disk location."
element 6 "Name" "mdm_filenames"
element 6 "Value" "ICCAP_ARRAY[0]"
element 7 "Name" "addtl_scaling"
element 7 "Value" "ICCAP_ARRAY[0]"
element 8 "Name" "__________________2"
element 8 "Value" "Variables_below_as_docu_for_debugging_purpose"
element 9 "Name" "!DirName"
element 9 "Value" ""
element 9 "Comment" "a DUT Variable !"
element 10 "Name" "mdm_dir"
element 10 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/San_An/2019-01-22/data"
element 11 "Name" "target_dir"
element 11 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/San_An/2019-01-22/data"
element 12 "Name" "combinedmdm"
element 12 "Value" "_Diode_Rev_All_TEMP_Combined.mdm"
element 13 "Name" "wildcard"
element 13 "Value" ""
element 14 "Name" "nr_mdms"
element 14 "Value" "3"
element 15 "Name" "addtl_scaling_param"
element 15 "Value" ""
element 16 "Name" "user_sweep_present_in_mdms"
element 16 "Value" "0"
element 17 "Name" "user_sweep_not_present_in_mdms"
element 17 "Value" "1"
element 18 "Name" "__________________3"
element 18 "Value" "Variables_for_COMBINE_MDMS_GUI"
element 19 "Name" "filenames"
element 19 "Value" "ICCAP_ARRAY[0]"
element 20 "Name" "SortSelection[0]"
element 20 "Value" "2"
element 21 "Name" "SortSelection"
element 21 "Value" "ICCAP_ARRAY[1]"
element 22 "Name" "param_values"
element 22 "Value" "ICCAP_ARRAY[0]"
element 23 "Name" "filesselected"
element 23 "Value" "ICCAP_ARRAY[0]"
element 24 "Name" "mdm4preview"
element 24 "Value" "1"
element 25 "Name" "inputnames"
element 25 "Value" "ICCAP_ARRAY[0]"
element 26 "Name" "inputnames_sel[0]"
element 26 "Value" "4"
element 27 "Name" "inputnames_sel[1]"
element 27 "Value" "5"
element 28 "Name" "inputnames_sel"
element 28 "Value" "ICCAP_ARRAY[2]"
element 29 "Name" "outputnames"
element 29 "Value" "ICCAP_ARRAY[0]"
element 30 "Name" "mdm_Header"
element 30 "Value" "! VERSION = 6.00"
element 31 "Name" "__________________4"
element 31 "Value" ""
element 32 "Name" "___Vars_below_stem_from_mdm_file___"
element 32 "Value" "you_can_delete_them_from_time_to_time ;-)"
element 33 "Name" ""
element 33 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "Combine"
element 0 "Value" "TS|HT=700:OR=VE|CA=#16btExit&#17Execute|#211tbSourceDir:#210tbButtons1:#219tbl_filename_filter:#210tbButtons2:#18FileList|1|2"
element 1 "Name" "Combine.tbButtons1"
element 1 "Value" "TL|CS=10:OR=HO:TO=FH&MH|<none>|#211tbTargetDir:#214tbCombinedName|0"
element 2 "Name" "Combine.tbButtons1.tbTargetDir.edTargetDir"
element 2 "Value" "ED|SC=2:VA=%#210target_dir|<none>|<none>|0"
element 3 "Name" "Combine.tbButtons1.tbTargetDir"
element 3 "Value" "TL|CA=#233Target directory for combined mdm:NC=2:OR=HO|<none>|#216btTarget_equ_src:#211btTargetDir:#211edTargetDir|1"
element 4 "Name" "Combine.tbButtons1.tbTargetDir.btTargetDir"
element 4 "Value" "PB|CA=#217Select target dir|AC=#212guiChangeDir&#219Execute,ChDirTarget|<none>|0"
element 5 "Name" "Combine.tbButtons2"
element 5 "Value" "TL|FV=T:TO=FH&dummy|<none>|#227tbName_of_new_scaling_param:#221tbPresent_and_Preview:#18tbSelect|1"
element 6 "Name" "Combine.tbButtons2.tbSelect.btAll"
element 6 "Value" "PB|CA=#210Select All:SF=T:TO=FH&MH|AC=#211btSelectAll&#17Execute|<none>|0"
element 7 "Name" "Combine.tbButtons2.tbPresent_and_Preview.cbPresent"
element 7 "Value" "CB|TO=FW&MW:TS=%user_sweep_present_in_mdms|TC=#215chkParamPresent&#17Execute|<none>|0"
element 8 "Name" "Combine.tbButtons2.tbName_of_new_scaling_param.edScalingPar"
element 8 "Value" "ED|CA=#274Name of the (new) scaling parameter (new Input) for the combined mdm file.:EM=SL:ED=T:VA=%#219addtl_scaling_param:TO=FH&dummy|<none>|<none>|0"
element 9 "Name" "Combine.tbButtons1.tbTargetDir.btTarget_equ_src"
element 9 "Value" "PB|CA=#218Same as source dir|AC=#212guiChangeDir&#223Execute,TargetEquSource|<none>|0"
element 10 "Name" "Combine.tbButtons1.tbCombinedName"
element 10 "Value" "TL|CA=#225File name of combined mdm:FV=T|<none>|#210edFilename:#15Space|1"
element 11 "Name" "Combine.tbButtons1.tbCombinedName.edFilename"
element 11 "Value" "ED|VA=%#211combinedmdm:TO=FH&TB|<none>|<none>|0"
element 12 "Name" "Combine.tbButtons2.tbPresent_and_Preview"
element 12 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#19cbPresent:#19lbPresent|1"
element 13 "Name" "Combine.tbButtons2.tbPresent_and_Preview.lbPresent"
element 13 "Value" "LA|CA=#297The scaling parameter is already present\012(as Input of Type 'CON') in the individual mdm files.:TO=FH&dummy|<none>|<none>|0"
element 14 "Name" "Combine.tbButtons2.tbSelect"
element 14 "Value" "TL|NC=2:OR=VE:TO=FH&dummy|<none>|#15btAll:#16btNone:#19btCombine:#16btExit|1"
element 15 "Name" "Combine.tbButtons2.tbSelect.btNone"
element 15 "Value" "PB|CA=#211Select None:SF=T:TO=FH&MH|AC=#212btSelectNone&#17Execute|<none>|0"
element 16 "Name" "Combine.tbl_filename_filter"
element 16 "Value" "TL|FV=F:OR=HO:TO=FH&MH&LH|<none>|#13tbl|0"
element 17 "Name" "Combine.tbl_filename_filter.tbl.lbl_wildcard"
element 17 "Value" "LA|CA=#221Filename Wildcard   *:TO=FW&MW&LW|<none>|<none>|0"
element 18 "Name" "Combine.tbl_filename_filter.tbl"
element 18 "Value" "TL|OR=HO:TO=FW&MW&LW&TL|<none>|#212lbl_wildcard:#18Wildcard:#17lbl_mdm:#17btApply|1"
element 19 "Name" "Combine.tbl_filename_filter.tbl.Wildcard"
element 19 "Value" "ED|EM=SL:ED=T:VA=%#18wildcard:TO=LW&LH&TL|EP=#212edFileFilter&#17Execute|<none>|1"
element 20 "Name" "Combine.tbl_filename_filter.tbl.lbl_mdm"
element 20 "Value" "LA|CA=#14.mdm:TO=LW&LH&TL|<none>|<none>|0"
element 21 "Name" "Combine.tbButtons2.tbSelect.btCombine"
element 21 "Value" "PB|CA=#17Combine:SF=%nr_mdms:TO=FH&MH|AC=#19btCombine&#17Execute|<none>|0"
element 22 "Name" "Combine.tbButtons2.tbSelect.btExit"
element 22 "Value" "PB|CA=#14Exit:TO=FH&dummy|AC=#16btExit&#17Execute|<none>|0"
element 23 "Name" "TL_mdmFileHead"
element 23 "Value" "TS|HT=400:WD=600|<none>|#18LA_notes:#215ED_fileheadtail|0|1"
element 24 "Name" "TL_mdmFileHead.LA_notes"
element 24 "Value" "LA|CA=#225Head of the .mdm File\072:TO=FH&dummy|<none>|<none>|0"
element 25 "Name" "TL_mdmFileHead.ED_fileheadtail"
element 25 "Value" "ED|BG=C9:EM=ML:ED=F:VA=%#210mdm_Header:FI=FF|<none>|<none>|0"
element 26 "Name" "Combine.tbButtons2.tbName_of_new_scaling_param"
element 26 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#212edScalingPar:#15space:#217LI_preview_header|1"
element 27 "Name" "Combine.tbButtons2.tbName_of_new_scaling_param.LI_preview_header"
element 27 "Value" "DL|CA=#219Preview .mdm Header:IT=%#19filenames:SX=%#211mdm4preview:TO=FW&dummy|LS=#216previewMdmHeader&#17Execute|<none>|0"
element 28 "Name" "Combine.tbButtons2.tbName_of_new_scaling_param.space"
element 28 "Value" "TL|<none>|<none>|<none>|0"
element 29 "Name" "Combine.tbButtons1.tbCombinedName.Space"
element 29 "Value" "TL|<none>|<none>|<none>|0"
element 30 "Name" "Combine.tbSourceDir.edSourceDir"
element 30 "Value" "ED|VA=%#17mdm_dir|<none>|<none>|0"
element 31 "Name" "Combine.tbSourceDir"
element 31 "Value" "TL|CA=#229Source directory of mdm files:OR=HO:TO=FH&dummy|<none>|#211edSourceDir:#214btSelectSource|1"
element 32 "Name" "Combine.tbSourceDir.btSelectSource"
element 32 "Value" "PB|CA=#210Change Dir:TO=FW&FH|AC=#212guiChangeDir&#219Execute,ChDirSource|<none>|0"
element 33 "Name" "Combine.tbl_filename_filter.tbl.btApply"
element 33 "Value" "PB|CA=#15Apply|AC=#212edFileFilter&#17Execute|<none>|0"
element 34 "Name" "GUI_Notes"
element 34 "Value" "TL|<none>|<none>|#18LA_Notes|1|0"
element 35 "Name" "GUI_Notes.LA_Notes"
element 35 "Value" "LA|CA=%#18txt_HELP:FG=C6|<none>|<none>|0"
element 36 "Name" "GUI_SortFilenames"
element 36 "Value" "TL|OR=HO|<none>|#17TL_LIST:#15TL_OK|1|3"
element 37 "Name" "GUI_SortFilenames.TL_LIST"
element 37 "Value" "TL|CA=#249Organize Sequence of File Names for Combined File:FV=T|<none>|#226TL_FileNames_AddtlScalings:#19TL_updown|1"
element 38 "Name" "GUI_SortFilenames.TL_LIST.TL_FileNames_AddtlScalings.FilenameList"
element 38 "Value" "LI|CA=#210File Names:IT=%#213mdm_filenames:SI=%#213SortSelection:SY=ES|<none>|<none>|0"
element 39 "Name" "GUI_SortFilenames.TL_LIST.TL_updown"
element 39 "Value" "TL|OR=HO:TO=FH&MW&MH|<none>|#17move_up:#19move_down|0"
element 40 "Name" "GUI_SortFilenames.TL_LIST.TL_updown.move_up"
element 40 "Value" "PB|CA=#15/\134:TO=FW&FH|AC=#212bt_SortFiles&#214Execute,MoveUp|<none>|0"
element 41 "Name" "GUI_SortFilenames.TL_LIST.TL_updown.move_down"
element 41 "Value" "PB|CA=#15\134/:TO=FW&FH|AC=#212bt_SortFiles&#216Execute,MoveDown|<none>|0"
element 42 "Name" "GUI_SortFilenames.TL_OK"
element 42 "Value" "TL|TO=FW&dummy|<none>|#15PB_OK|1"
element 43 "Name" "GUI_SortFilenames.TL_OK.PB_OK"
element 43 "Value" "PB|CA=#12OK:TO=FW&FH&TT|AC=#219./GUI_SortFilenames&#236Destroy Gui,OrganizeFileNameSequence|<none>|0"
element 44 "Name" "GUI_SortFilenames.TL_LIST.TL_FileNames_AddtlScalings"
element 44 "Value" "TL|OR=HO|<none>|#212FilenameList:#216AddtlScalingVals|1"
element 45 "Name" "GUI_SortFilenames.TL_LIST.TL_FileNames_AddtlScalings.AddtlScalingVals"
element 45 "Value" "LI|CA=#214Scaling Values:IT=%#213addtl_scaling:SI=%#213SortSelection:SY=ES|<none>|<none>|0"
element 46 "Name" "Combine.FileList"
element 46 "Value" "TL|CA=#3119select the .mdm files, and if the new scaling param. was not present in the .mdm files, enter the scaling param. values:NC=2|<none>|#19FileList0:#19FileList1:#19FileList2:#19FileList3:#19FileList4:#19FileList5:#210ParamList0:#210ParamList1:#210ParamList2:#210ParamList3:#210ParamList4:#210ParamList5|0"
element 47 "Name" "Combine.FileList.FileList0"
element 47 "Value" "CB|CA=#237SA_4X100_N55C~Diode~Diode_Forward.mdm:TS=%filesselected[0]|TC=#19chkNrMDMs&#17Execute|<none>|0"
element 48 "Name" "Combine.FileList.FileList1"
element 48 "Value" "CB|CA=#237SA_4X100_N55C~Diode~Diode_Reverse.mdm:TS=%filesselected[1]|TC=#19chkNrMDMs&#17Execute|<none>|0"
element 49 "Name" "Combine.FileList.FileList2"
element 49 "Value" "CB|CA=#242_N45PA_4.5X100_25C~Diode~Diode_Forward.mdm:TS=%filesselected[2]|TC=#19chkNrMDMs&#17Execute|<none>|0"
element 50 "Name" "Combine.FileList.FileList3"
element 50 "Value" "CB|CA=#242_N45PA_4.5X100_25C~Diode~Diode_Reverse.mdm:TS=%filesselected[3]|TC=#19chkNrMDMs&#17Execute|<none>|0"
element 51 "Name" "Combine.FileList.FileList4"
element 51 "Value" "CB|CA=#241_N45PA_4X100_125C~Diode~Diode_Forward.mdm:TS=%filesselected[4]|TC=#19chkNrMDMs&#17Execute|<none>|0"
element 52 "Name" "Combine.FileList.FileList5"
element 52 "Value" "CB|CA=#241_N45PA_4X100_125C~Diode~Diode_Reverse.mdm:TS=%filesselected[5]|TC=#19chkNrMDMs&#17Execute|<none>|0"
element 53 "Name" "Combine.FileList.ParamList0"
element 53 "Value" "ED|VA=%#215param_values[0]:SF=%user_sweep_not_present_in_mdms|<none>|<none>|0"
element 54 "Name" "Combine.FileList.ParamList1"
element 54 "Value" "ED|VA=%#215param_values[1]:SF=%user_sweep_not_present_in_mdms|<none>|<none>|0"
element 55 "Name" "Combine.FileList.ParamList2"
element 55 "Value" "ED|VA=%#215param_values[2]:SF=%user_sweep_not_present_in_mdms|<none>|<none>|0"
element 56 "Name" "Combine.FileList.ParamList3"
element 56 "Value" "ED|VA=%#215param_values[3]:SF=%user_sweep_not_present_in_mdms|<none>|<none>|0"
element 57 "Name" "Combine.FileList.ParamList4"
element 57 "Value" "ED|VA=%#215param_values[4]:SF=%user_sweep_not_present_in_mdms|<none>|<none>|0"
element 58 "Name" "Combine.FileList.ParamList5"
element 58 "Value" "ED|VA=%#215param_values[5]:SF=%user_sweep_not_present_in_mdms|<none>|<none>|0"
element 59 "Name" ""
element 59 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 ! This Setup is about combining 2 or more mdm files 
 ! into a single one.
 
 ! Different to the other Setup 'COMBINE_MDMS_incl_ICCAP_VALUE',
 ! -------------------------------------------------------------
 !- The combining factor can be already part 
 !   of the individual mdm files 
 !   (as type CON sweep e.g. TEMP etc.),
 !   In this case, the CON sweep will be replaced by a 
 !   LIST user sweep.
 !
 !- The combining factor will be entered manually by the
 !  user into the GUI, and then added to the combined 
 !   mdm file again as a LIST user sweep .
 !
 !-> If the combining factor is present as ICCAP_VALUE in the .mdm file,
 !  use rather 'COMBINE_MDMS_incl_ICCAP_VALUE'.
 !---------------------------------------------------------------------------------------
 
 ! NOTE: the Programs in this Setup allow combining of a single combining factor.
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! Just execute COMBINE_MDMS (this is the MAIN Transform in this Setup)
 
 ! It will combine user-selected mdm files into a single 
 ! mdm file.
 
 ! How it works:
 ! -------------
 ! a new .mdm file (typ. called combined.mdm) will be
 ! created, and a USER_SWEEP will be added,
 ! representing the combining factor. This is done by
 ! applying the ICDB_xxx() PEL function in 'btCombine'.
 ! 'btCombine' loads the mdm files individually 
 ! into this Setup and exports them into combined.mdm. 
 
 ! The user specifies what sweep (USER_INPUT) will be 
 ! added to the combined mdm file. 
 ! This new USER_INPUT will be of type LIST.
 ! If this new sweep was already present in the 
 ! individual mdm files as a sweep of type CON, 
 ! it will be replaced by a sweep of type LIST.
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "COMBINE_MDMS" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 addtl_scaling_param="-> ENTER HERE <-"
 
 !---preset variables
 wildcard = ""
 user_sweep_present_in_mdms = 0
 SortSelection=""
 
 
 !---initialize directories
 mdm_dir    = VAL$(DirName)
 target_dir = "-> PLEASE SELECT <-"
 
 GET_STRING "-> If the combining factor is present as ICCAP_VALUE *inside* the .mdm file,
 	use rather 'UTILITIES/MDM_UTILITIES/COMBINE_MDMS_incl_ICCAP_VALUE'", dummy
 
 
 
 ICCAP_FUNC("./Combine.FileList", "Delete")
 ICCAP_FUNC("./Combine", "Add GUI", "FileList", "TL")
 ICCAP_FUNC("./Combine.FileList", "Set GUI Options", "CA=Available .mdm files","")
 
 
 !---Verify if the current directory exists
 !   If yes, identify .mdm file names
 !   If not, then default to current home directory
 dir_fail=SYSTEM("cd "&VAL$(mdm_dir)&" 2> /dev/null")
 IF (dir_fail<>0) THEN 
   PRINT "Directory '";mdm_dir;"' not found !"
   DirName = SYSTEM$("pwd")
   mdm_dir = DirName
   PRINT "~> Changing directory to current default directory instead"
 ELSE
   ICCAP_FUNC("rebuildFileList", "Execute")
 END IF
 
 
 ICCAP_FUNC("./Combine", "Display Modeless GUI", "Combine MDM files")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "guiChangeDir" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ErrMsg=""
 
 !---This is answered by the calling GUI
 GET_STRING "What to do:  [ChDirSource], [ChDirTarget], [TargetEquSource]", What2Do
 
 
 !---dependent on the answer, link to the previously selected dir
 IF VAL$(What2Do)=="ChDirSource" THEN
   DirName=SYS_PATH$(VAL$(DirName))
   GUIheader = "Select mdm directory of .mdm files to be combined"
 ELSE IF VAL$(What2Do)=="ChDirTarget" THEN
   DirName=SYS_PATH$(VAL$(target_dir))
   GUIheader = "Select mdm directory of combined .mdm file"
 ELSE IF VAL$(What2Do)=="TargetEquSource" THEN
   target_dir=SYS_PATH$(VAL$(mdm_dir))
   RETURN_VALUE 2
 END IF
 
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Suffix=".mdm"
 SelPolicy = "DirOnly"	! Single, Multi, DirOnly
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(DirName), VAL$(Suffix), VAL$(wildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)=="" THEN
   !---Get the selected directory back
   DirName=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
 ELSE
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy	!an error has occurred
   RETURN_VALUE 0
 END IF
 
 
 
 !---link the dir to the requested variable
 IF VAL$(What2Do)=="ChDirSource" THEN
   mdm_dir=SYS_PATH$(VAL$(DirName))
   ICCAP_FUNC("rebuildFileList", "Execute")
   RETURN_VALUE 3
 ELSE IF VAL$(What2Do)=="ChDirTarget" THEN
   target_dir=SYS_PATH$(VAL$(DirName))
   RETURN_VALUE 4
 END IF
 
 
 
 RETURN_VALUE 0
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_SortFiles" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  mdm_filenames
 GLOBAL_VAR  addtl_scaling
 GLOBAL_VAR  SortSelection
 
 
 
 GET_STRING "What to do ?  [MoveUp], [MoveDown]", Action
 
 
 
 !--------------------------------------------------------------
 IF Action == "MoveUp" THEN
   !check if nothing was selected
   IF SortSelection==-1 THEN RETURN_VALUE 0
   !check if top most item was selected
   IF SortSelection[0]==0  THEN RETURN_VALUE 0	
 
   FOR i=0 TO SIZEOF(SortSelection)-1
     tmp=VAL$(mdm_filenames[SortSelection[i]])
     dummy=ARRAY_REMOVE_AT(mdm_filenames, SortSelection[i])
     dummy=ARRAY_INSERT_AT(mdm_filenames, tmp, SortSelection[i]-1)
 
     tmp=VAL$(addtl_scaling[SortSelection[i]])
     dummy=ARRAY_REMOVE_AT(addtl_scaling, SortSelection[i])
     dummy=ARRAY_INSERT_AT(addtl_scaling, tmp, SortSelection[i]-1)
   NEXT i
   !move selection also upwards, maybe user wants to move the item even higher
   FOR i=0 TO SIZEOF(SortSelection)-1
      SortSelection[i] = MAX(0, SortSelection[i] - 1)	
   NEXT i
 END IF
 
 
 !--------------------------------------------------------------
 IF Action == "MoveDown" THEN
   !check if nothing was selected
   IF SortSelection==-1 THEN RETURN_VALUE 0
   !check if last item was selected
   IF SortSelection[SIZEOF(SortSelection)-1]==SIZEOF(mdm_filenames)-1  THEN RETURN_VALUE 0	
 
   FOR i=SIZEOF(SortSelection)-1 TO 0 STEP -1
     tmp=VAL$(mdm_filenames[SortSelection[i]])
     dummy=ARRAY_REMOVE_AT(mdm_filenames, SortSelection[i])
     dummy=ARRAY_INSERT_AT(mdm_filenames, tmp, SortSelection[i]+1)
 
     tmp=VAL$(addtl_scaling[SortSelection[i]])
     dummy=ARRAY_REMOVE_AT(addtl_scaling, SortSelection[i])
     dummy=ARRAY_INSERT_AT(addtl_scaling, tmp, SortSelection[i]+1)
   NEXT i
   !move selection also downwards, maybe user wants to move the item even lower
   FOR i=0 TO SIZEOF(SortSelection)-1
     SortSelection[i] = SortSelection[i] + 1		
   NEXT i
 END IF
 
 
 !--------------------------------------------------------------
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "btCombine" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---first some pre-checks
 IF VAL$(target_dir)=="-> PLEASE SELECT <-" THEN
   GET_STRING "ERROR: Seems you forgot to define the Target Directory of the Combined .mdm File !! [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 IF VAL$(addtl_scaling_param) == "-> ENTER HERE <-" THEN
   GET_STRING "ERROR: Seems you forgot to enter the new, addt'l parameter sweep
      (Field 'Name of the new scaling parameter (new Input) for the combined mdm file.'  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~link to data~~~~~~~~~~~~~~~~~~~~~~~~
 mdm_filenames="ICCAP_ARRAY[0]"
 addtl_scaling="ICCAP_ARRAY[0]"
 i=0
 nr_mdms=0
 WHILE i<SIZEOF(filesselected)
   IF val$(filesselected[i])=="1" THEN 
     nr_mdms=nr_mdms+1
     mdm_filenames="ICCAP_ARRAY["&val$(nr_mdms)&"]"
     addtl_scaling="ICCAP_ARRAY["&val$(nr_mdms)&"]"
 
     mdm_filenames[nr_mdms-1]=filenames[i]
     addtl_scaling[nr_mdms-1]=param_values[i]
 
   END IF
   i=i+1
 END WHILE
 
 
 ICCAP_FUNC("chkNrMDMs", "Execute")
 
 
 !---let user arrange the sequence of files
 ICCAP_FUNC("./GUI_SortFilenames", "Display Modal Gui", "OrganizeFileNameSequence")
 
 
 !---some more preparation
 i=0
 WHILE i < SIZEOF(mdm_filenames)
   IF VAL$(user_sweep_present_in_mdms)=="1" THEN 
     !Delete at least one Input to ensure accurate ImportCreate also for the case of only CON sweeps in the .mdm file (bug in 2004A and 2006A)
     inputnames=""
     ICCAP_FIND_CHILDREN ".","Input",inputnames
     IF VAL$(inputnames)<>"" THEN ICCAP_FUNC(VAL$(inputnames[0]),"Delete")
 
     ICCAP_FUNC(".","Import Create Header Only",VAL$(mdm_dir)&"/"&VAL$(mdm_filenames[i]))
     tmp=dataset("quiet "&VAL$(addtl_scaling_param))
     addtl_scaling[i]=tmp[0] 
   END IF
 
   IF val$(addtl_scaling[i])=="" THEN addtl_scaling[i]="0"
   i = i + 1
 END WHILE
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~begin of .mdm combining~~~~~~~~~~~~~~~~~~~~~~~~
 mdm_dirfile=VAL$(target_dir)&"/"&VAL$(combinedmdm)!&".mdm"
 dummy=SYSTEM("rm -f "&VAL$(mdm_dirfile)&"  2> /dev/null")
 PRINT "writing to data base file ";mdm_dirfile
 !---open data base file------------------------------------------------------
 dummy=ICDB_OPEN(VAL$(mdm_dirfile))
 
 !---add comment about the file combination info------------------------------
 dummy = ICDB_ADD_COMMENT("combined file by "&VAL$(SYSTEM$("whoami"))&" on "&VAL$(SYSTEM$("date")))
 
 !---Register a LIST user sweep-----------------------------------------------
 !          ICDB_REGISTER_LIST_SWEEP(sweep_order, "Sweep_Name", data_array)
 nr_entries=ICDB_REGISTER_LIST_SWEEP(1, VAL$(addtl_scaling_param), addtl_scaling)
 
 i=0
 WHILE i < SIZEOF(mdm_filenames)
    !---delete SetupVariables created by the previous .mdm reading  (ICCAP_VALUES)
    ICCAP_FUNC("Delete_ICCAP_VALUE_Vars", "Execute")
 
   !Delete at least one Input to ensure accurate ImportCreate also for the case of only CON sweeps in the .mdm file (bug in 2004A and 2006A)
   inputnames=""
   ICCAP_FIND_CHILDREN ".", "Input", inputnames
   IF VAL$(inputnames)<>"" THEN ICCAP_FUNC(VAL$(inputnames[0]), "Delete")
 
   !ImportCreate of mdm file[i] 
   PRINT "Importing "&VAL$(mdm_filenames[i])
   ICCAP_FUNC(".", "Import Create", VAL$(mdm_dir)&"/"&VAL$(mdm_filenames[i]))
 
   !check if new USER_SWEEP is already present in indiv.mdm files
   IF VAL$(user_sweep_present_in_mdms)=="1" THEN ICCAP_FUNC(VAL$(addtl_scaling_param), "Delete")
 
   !verify if currently loaded .mdm has the same size like the previous one (only in this case, we can combine them !!)
   ICCAP_FIND_CHILDREN ".", "Input", inputnames
   tmp=DATASET("quiet "&VAL$(inputnames[0]))
   IF i==0 THEN Last_mdm_DataSize=SIZEOF(tmp)
   IF i>0 THEN 
     Current_mdm_DataSize=SIZEOF(tmp)
     IF VAL(Last_mdm_DataSize)<>VAL(Current_mdm_DataSize) THEN
       GET_STRING "ERROR: the selected .mdm files seem to have different sweep conditions !! 
         The detected difference is between mdm files 
 	-> "&VAL$(mdm_filenames[i-1])&"
           and
 	-> "&VAL$(mdm_filenames[i])&"
             ==> The combining is stopped, the combined .mdm file is most probably corrupted (pls. delete it)   [OK]", dummy
       RETURN_VALUE 0
     END IF
   Last_mdm_DataSize=Current_mdm_DataSize
   END IF
 
 
   !---export the data into the open data base file--------------------------
   dummy = ICDB_EXPORT_DATA(".", "M") 
 
   i=i+1
 END WHILE
 
 !---close the combined .mdm data base file----------------------------------
 dummy = ICDB_CLOSE()
 PRINT ".mdm combining finished!"
 
 
 
 
 !---delete all Inputs/Outputs
 ICCAP_FUNC(".", "Import Delete")
 !---import the new .mdm file
 ICCAP_FUNC(".", "Import Create", VAL$(mdm_dirfile))
 
 !---show notes
 txt_HELP = "The combined .mdm file has been saved into the user-defined disk location.
   -----------------------------------------------------------------------------------------------
   Additionally, it has been loaded back into the Inputs/Outputs of this UTILITIES Setup 'COMBINE_MDMS_incl_ICCAP_VALUE'.
   This means that
  ==>  You can verify the settings in the Input Entry Fields, 
       i.e. especially 'Mode' and 'Node' of the new Input(s) (the combining ones),
       e.g. to make sure the new combined .mdm file can also be simulated
 
  ==>  If you want to include all or parts of the ICCAP_VALUES of the .mdm file,
       enter their names to SetupVariable MDM_VALUES_LIST   (as a comma-separated list, without spaces)
 
  ==>  Hit 'Export' *manually*
 
  ==>  And finally, close all GUIs
       ====================================="
 ICCAP_FUNC("./GUI_Notes", "Display Modeless GUI", "Manually adjust Inputs/Outputs of combined .mdm and re-save it")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "btSelectAll" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 i=SIZEOF(filesselected)-1
 WHILE i>-1
   filesselected[i]=1
   i=i-1
 END WHILE
 
 ICCAP_FUNC("chkNrMDMs", "Execute")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "btSelectNone" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 i=SIZEOF(filesselected)-1
 WHILE i>-1
   filesselected[i]=0
   i=i-1
 END WHILE
 
 ICCAP_FUNC("chkNrMDMs", "Execute")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "rebuildFileList" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("./Combine", "Destroy GUI", "Combine MDM files")
 
 ICCAP_FUNC("findFiles", "Execute")
 
 IF Debug==1 THEN PRINT "delete old GUI and prepare new one..."
 
 ICCAP_FUNC("./Combine.FileList", "Delete")
 ICCAP_FUNC("./Combine", "Add GUI", "FileList", "TL")
 ICCAP_FUNC("./Combine.FileList", "Set GUI Options", "CA=select the .mdm files, and if the new scaling param. was not present in the .mdm files, enter the scaling param. values", "NC=2","")
 
 index=0
 WHILE index<SIZEOF(filenames)
   IF Debug==1 THEN PRINT "adding a GUI item for .mdm file name nr.";index
 
   ICCAP_FUNC("./Combine.FileList","Add GUI","FileList"&val$(index),"CB")
 
   ICCAP_FUNC("./Combine.FileList.FileList"&val$(index),"Set GUI Options","CA="&val$(filenames[index]),"")
   ICCAP_FUNC("./Combine.FileList.FileList"&val$(index),"Set GUI Options","TS=%filesselected["&val$(index)&"]","")
   ICCAP_FUNC("./Combine.FileList.FileList"&val$(index),"Set GUI Callback","TC","chkNrMDMs", "Execute")
 
   index=index+1
 END WHILE
 
 
 index=0
 WHILE index<SIZEOF(filenames)
   IF Debug==1 THEN PRINT "adding a GUI item for param value of file nr.";index
 
   ICCAP_FUNC("./Combine.FileList","Add GUI","ParamList"&val$(index),"ED")
 
   ICCAP_FUNC("./Combine.FileList.ParamList"&val$(index),"Set GUI Options","SF=%user_sweep_not_present_in_mdms","")
   ICCAP_FUNC("./Combine.FileList.ParamList"&val$(index),"Set GUI Options","VA=%param_values["&val$(index)&"]","")
 
   index=index+1
 END WHILE
 
 
 
 ICCAP_FUNC("chkNrMDMs", "Execute")
 ICCAP_FUNC("chkParamPresent", "Execute")
 
 ICCAP_FUNC("./Combine","Display Modeless GUI","Combine MDM files")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "findFiles" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---set up unix command
 command="cd "&VAL$(mdm_dir)&"
 ls *"&VAL$(wildcard)&".mdm  2> /dev/null"    !  NOTE:  2> /dev/null   avoids an error message in the IC-CAP Status window
 
 !---execute the SYSTEM call  (NOTE: filenames with a leading '-' will confuse the unix command !!!  -> Change the filename)
 stringchain$=SYSTEM$(command)
 
 
 
 filenames="ICCAP_ARRAY[0]"
 filesselected="ICCAP_ARRAY[0]"    
 param_values="ICCAP_ARRAY[0]"
 
 IF stringchain$<>"" THEN
   ICCAP_FUNC("./Combine.tbButtons2.tbSelect.btAll",  "Set GUI Options", "SF=T","")
   ICCAP_FUNC("./Combine.tbButtons2.tbSelect.btNone", "Set GUI Options", "SF=T","")
 
   index=0
   stringpos=1
 
   WHILE stringpos>0
     stringpos=STRPOS(VAL$(stringchain$), CHR$(10))
     IF stringpos>0 THEN  
       stringlen=STRLEN(VAL$(stringchain$))
       substring$=SUBSTR$(VAL$(stringchain$), 1, stringpos-1)
       index=index+1
       
       filenames="ICCAP_ARRAY["&val$(index)&"]"
       filesselected="ICCAP_ARRAY["&val$(index)&"]"    
       param_values="ICCAP_ARRAY["&val$(index)&"]"
       
       filenames[index-1]=substring$
       filesselected[index-1]="1"
       param_values[index-1]=""
       stringchain$=SUBSTR$(VAL$(stringchain$), stringpos+1, stringlen)
     END IF
   END WHILE
 
   IF strlen(stringchain$)>0 THEN
       filenames="ICCAP_ARRAY["&val$(index+1)&"]"
       filesselected="ICCAP_ARRAY["&val$(index+1)&"]"    
       param_values="ICCAP_ARRAY["&val$(index+1)&"]"
 
       filenames[index]=stringchain$
       filesselected[index]="1"
       param_values[index]=""
   END IF
 
 
 ELSE
   ICCAP_FUNC("./Combine.tbButtons2.tbSelect.btAll",  "Set GUI Options" ,"SF=F","")
   ICCAP_FUNC("./Combine.tbButtons2.tbSelect.btNone", "Set GUI Options", "SF=F","")
 END IF
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "btExit" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("./Combine", "Destroy GUI", "Combine MDM files")
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 GET_STRING "Done !    [OK]", dummy
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "chkNrMDMs" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 nr_mdms=0
 i=0
 
 WHILE i<SIZEOF(filesselected)
   IF val$(filesselected[i])=="1" THEN nr_mdms=nr_mdms+1
   i=i+1
 END WHILE
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "chkParamPresent" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 IF val$(user_sweep_present_in_mdms)=="1" THEN 
   user_sweep_not_present_in_mdms="0"
 ELSE
   user_sweep_not_present_in_mdms="1"
 END IF
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "edFileFilter" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("findFiles", "Execute")
 ICCAP_FUNC("rebuildFileList", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "previewMdmHeader" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 mdm_Header = SYSTEM$("head -100 "&VAL$(mdm_dir)&"/"&VAL$(filenames[mdm4preview]))
 
 ICCAP_FUNC("./TL_mdmFileHead", "Display Modeless GUI", "mdm File Header")
 
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Delete_ICCAP_VALUE_Vars" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !---find location of Variable '___Vars_below_stem_from_mdm_file___'
 i=0
 ErrMsg=""
 WHILE VAL$(ErrMsg)==""
   VarName =LOOKUP_TABLE_VAL(".", "Name["&VAL$(i)&"]", ErrMsg)
   EXIT IF VAL$(VarName)=="___Vars_below_stem_from_mdm_file___"
   i = i + 1
 END WHILE
 
 
 !---delete Variables below '___Vars_below_stem_from_mdm_file___'
 i = i + 1
 LOOP
   VarName =LOOKUP_TABLE_VAL(".", "Name["&VAL$(i)&"]")
   EXIT IF (VAL$(VarName)=="")
   !---delete
   ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
 END LOOP
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---clean up Inputs/Outputs
 ICCAP_FUNC(".","Import Delete")
 
 
 !---add Input 'See_under_ExtractOptimize'
 ICCAP_FUNC(".","New Input","See_under_ExtractOptimize") 
 ICCAP_FUNC("See_under_ExtractOptimize","SetTableFieldValue","Sweep Type","CON")
 
 
 
 
 !---close all ICCAP_ARRAYs so that the Setup Variable List becomes 'readable-by-a-human' again
 mdm_filenames = "ICCAP_ARRAY[0]"
 addtl_scaling = "ICCAP_ARRAY[0]"
 filenames     = "ICCAP_ARRAY[0]"
 param_values  = "ICCAP_ARRAY[0]"
 filesselected = "ICCAP_ARRAY[0]"
 inputnames    = "ICCAP_ARRAY[0]"
 outputnames   = "ICCAP_ARRAY[0]"
 
 addtl_scaling_param = ""
 wildcard = ""
 
 
 !---delete ICCAP_VALUES from loaded .mdm
 ICCAP_FUNC("Delete_ICCAP_VALUE_Vars", "Execute")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
TABLE "HP4145.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Init Command" ""
}
TABLE "AgilentE5270.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "No"
element 0 "Range Manager Mode" "1"
element 0 "Range Manager Setting" "90"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Disable Self-cal" "No"
element 0 "Output I/O Port (ERC Command)" ""
element 0 "Output I/O Port (ERM Command)" ""
element 0 "Format Parameter (FMT Command)" "4"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentPNA.4000.20" "711.501"
{
element 0 "Use User Sweep [Yes/No]" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Sweep Type[Step/Analog]" "S"
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port Src Power (dBm)" "-20.00 "
element 0 "Port 2 Src Power (dBm)" "-20.00 "
element 0 "Port Atten Auto [Y/N]" "No"
element 0 "Port Src Atten (dB)" " 0.000 "
element 0 "Port 2 Src Atten (dB)" " 0.000 "
element 0 "Power Slope (dB/GHz)" " 0.000 "
element 0 "Dwell Time (sec) [0=auto]" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor [1-1024]" "1"
element 0 "Ports Mapping" ""
element 0 "Cal Type [Hardware/None]" "H"
element 0 "Cal/State File Name [.csa|.cst only]" ""
element 0 "Use PNA Calibration Settings" "No"
element 0 "Use PNA Receiver Leveling" "No"
element 0 "Delay for timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
}
}
LINK DAT "COMBINE_MDMS_incl_ICCAP_VALUE" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "3.499010451026 15798 11593"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 C29 P301 C10"
element 0 "Name" "TmpVar"
element 0 "Value" "testVar"
element 1 "Name" "ErrMsg"
element 1 "Value" ""
element 2 "Name" "__________________1"
element 2 "Value" ""
element 3 "Name" "MDM_FILE_PATH"
element 3 "Value" "D:\d_SisConsult\22_Projects___\Keysight\EEsof\ICCAP"
element 4 "Name" "MDM_FILE_NAME"
element 4 "Value" "_Combined.mdm"
element 5 "Name" "MDM_EXPORT_XFORM_DATA"
element 5 "Value" "0"
element 6 "Name" "MDM_EXPORT_COMMENT"
element 6 "Value" ""
element 7 "Name" "MdmLocation"
element 7 "Value" "Common Dir"
element 8 "Name" "__________________2"
element 8 "Value" ""
element 9 "Name" "!DirName"
element 9 "Value" "a DUT Variable !"
element 10 "Name" "MdmDir"
element 10 "Value" "/cygdrive/d/d_SisConsult/22_Projects___/Keysight/EEsof/ICCAP"
element 11 "Name" "TargetDir"
element 11 "Value" "/cygdrive/d/d_SisConsult/22_Projects___/Keysight/EEsof/ICCAP"
element 12 "Name" "TargetDirIsSourceDir"
element 12 "Value" "1"
element 13 "Name" "CombinedMdm"
element 13 "Value" "_Combined"
element 14 "Name" "Wildcard"
element 14 "Value" ""
element 15 "Name" "__________________3"
element 15 "Value" ""
element 16 "Name" "FileNames"
element 16 "Value" "ICCAP_ARRAY[0]"
element 17 "Name" "FilesSelected"
element 17 "Value" "ICCAP_ARRAY[0]"
element 18 "Name" "SortSelection[0]"
element 18 "Value" "2"
element 19 "Name" "SortSelection"
element 19 "Value" "ICCAP_ARRAY[1]"
element 20 "Name" "FileNameSel4Preview"
element 20 "Value" "8"
element 21 "Name" "NrScalingParams"
element 21 "Value" "0"
element 22 "Name" "NamesScalingParams"
element 22 "Value" "ICCAP_ARRAY[0]"
element 23 "Name" "InstParams4CombinedMdm"
element 23 "Value" "ICCAP_ARRAY[0]"
element 24 "Name" "InstParams4CombinedMdmSel"
element 24 "Value" "ICCAP_ARRAY[0]"
element 25 "Name" "NrSelFiles"
element 25 "Value" "5"
element 26 "Name" "tmpVar"
element 26 "Value" ""
element 27 "Name" "mdm_Header"
element 27 "Value" "! VERSION = 6.00"
element 28 "Name" "__________________4"
element 28 "Value" ""
element 29 "Name" "InputNames"
element 29 "Value" "ICCAP_ARRAY[0]"
element 30 "Name" "OutputNames"
element 30 "Value" "ICCAP_ARRAY[0]"
element 31 "Name" "__________________5"
element 31 "Value" ""
element 32 "Name" "txt_HELP"
element 32 "Value" "The combined .mdm file has been saved into the user-defined disk location."
element 33 "Name" "__________________6"
element 33 "Value" ""
element 34 "Name" "___Vars_below_stem_from_mdm_file___"
element 34 "Value" "you_can_delete_them_from_time_to_time ;-)"
element 35 "Name" ""
element 35 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "GUI_SelFiles"
element 0 "Value" "TL|HT=550:OR=VE|CA=#16PbExit&#17Execute|#211tbSourceDir:#210tbButtons1:#210tbButtons2:#215LI_DirFileNames|1|2"
element 1 "Name" "GUI_SelFiles.tbButtons1"
element 1 "Value" "TL|OR=HO:TO=FH&MH|<none>|#220tbFileFilterWildcard:#13Sep:#211tbTargetDir:#214tbCombinedName|1"
element 2 "Name" "GUI_SelFiles.tbButtons1.tbTargetDir.edTargetDir"
element 2 "Value" "ED|SC=2:VA=%#19TargetDir|<none>|<none>|0"
element 3 "Name" "GUI_SelFiles.tbButtons1.tbTargetDir"
element 3 "Value" "TL|CA=#233Target directory for combined mdm:NC=2:OR=HO:TO=FH&dummy|<none>|#216cbTarget_equ_src:#211btTargetDir:#211edTargetDir|1"
element 4 "Name" "GUI_SelFiles.tbButtons1.tbTargetDir.btTargetDir"
element 4 "Value" "PB|CA=#217Select target dir:TO=MH&dummy|AC=#18GuiChDir&#219Execute,ChDirTarget|<none>|0"
element 5 "Name" "GUI_SelFiles.tbButtons2"
element 5 "Value" "TL|FV=T:TO=FH&dummy|<none>|#18tbSelect|1"
element 6 "Name" "GUI_SelFiles.tbButtons2.tbSelect.TL_Actions.TL_Selection.btAll"
element 6 "Value" "PB|CA=#210Select All:SF=T:TO=FH&dummy|AC=#215PbSelectNoneAll&#217Execute,SelectAll|<none>|0"
element 7 "Name" "GUI_SelFiles.tbButtons1.tbTargetDir.cbTarget_equ_src"
element 7 "Value" "CB|CA=#218Same As Source Dir:TO=FH&dummy:TS=%TargetDirIsSourceDir|AC=#18GuiChDir&#223Execute,TargetEquSource|<none>|0"
element 8 "Name" "GUI_SelFiles.tbButtons1.tbCombinedName"
element 8 "Value" "TL|<none>|<none>|#219Ed_FileNameCombined:#213LA_NrSelFiles|1"
element 9 "Name" "GUI_SelFiles.tbButtons1.tbCombinedName.Ed_FileNameCombined"
element 9 "Value" "ED|CA=#225File Name of Combined mdm:VA=%#211CombinedMdm:TO=FH&TB|<none>|<none>|0"
element 10 "Name" "GUI_SelFiles.tbButtons2.tbSelect"
element 10 "Value" "TL|OR=HO|<none>|#210TL_Actions:#210LA_preview:#217LI_preview_header:#19PbCombine:#16PbExit|1"
element 11 "Name" "GUI_SelFiles.tbButtons2.tbSelect.PbCombine"
element 11 "Value" "PB|CA=#17Combine:TO=FW&FH|AC=#19PbCombine&#17Execute|<none>|0"
element 12 "Name" "GUI_SelFiles.tbButtons2.tbSelect.PbExit"
element 12 "Value" "PB|CA=#210OK, Done !:TO=FW&FH|AC=#16PbExit&#17Execute|<none>|0"
element 13 "Name" "GUI_SelFiles.tbButtons1.tbFileFilterWildcard.tbl"
element 13 "Value" "TL|CA=#217Filename Wildcard:OR=HO:TO=FW&MW&LW&TL|<none>|#15lbl_*:#18Wildcard:#17lbl_mdm|1"
element 14 "Name" "GUI_SelFiles.tbButtons1.tbFileFilterWildcard.tbl.Wildcard"
element 14 "Value" "ED|EM=SL:ED=T:VA=%#18Wildcard:TO=LW&LH&TL|EP=#215RebuildFileList&#17Execute|<none>|1"
element 15 "Name" "GUI_SelFiles.tbButtons1.tbFileFilterWildcard.tbl.lbl_*"
element 15 "Value" "LA|CA=#11*:TO=LW&LH&TL|<none>|<none>|0"
element 16 "Name" "GUI_SelFiles.tbButtons1.Sep"
element 16 "Value" "SE|OR=VE|<none>|<none>|0"
element 17 "Name" "GUI_InstParams"
element 17 "Value" "TL|HT=700|CA=#222PbOkIdentifyInstParams&#210Execute,OK|#16TL_Top:#212TL_Cancel_OK:#14SEP1:#218TL_View_mdm_Header:#14SEP2:#225LI_InstParams4CombinedMdm|0|1"
element 18 "Name" "GUI_InstParams.LI_InstParams4CombinedMdm"
element 18 "Value" "LI|CA=#241Avail. ICCAP_VALUE Variables in .mdm File:IT=%#222InstParams4CombinedMdm:SI=%#225InstParams4CombinedMdmSel:SY=ES|<none>|<none>|0"
element 19 "Name" "GUI_InstParams.TL_Top.LA_Hint"
element 19 "Value" "LA|CA=#3317In the .mdm files, the following\012ICCAP_VALUES are present.\012Note\072 They were identified in the\0121st selected .mdm file,\012and it is assumed they are present\012in all selected .md files (!).\012Select, which of them shall be added \012as a  LIST \046 LSYNC (\046 TLSYNC) sweep \012to the combined .mdm File.:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 20 "Name" "GUI_InstParams.TL_Top"
element 20 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#17LA_Hint:#19PB_Cancel:#15PB_OK|1"
element 21 "Name" "GUI_InstParams.SEP1"
element 21 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 22 "Name" "GUI_SelFiles.tbButtons1.tbFileFilterWildcard"
element 22 "Value" "TL|OR=VE|<none>|#13tbl:#17btApply|1"
element 23 "Name" "GUI_SelFiles.tbButtons1.tbFileFilterWildcard.btApply"
element 23 "Value" "PB|CA=#15Apply:TO=FW&FH|AC=#215RebuildFileList&#17Execute|<none>|0"
element 24 "Name" "GUI_SelFiles.tbButtons1.tbCombinedName.LA_NrSelFiles"
element 24 "Value" "ED|CA=#218Nr. Selected Files:CO=3:ED=F:VA=%#210NrSelFiles:TO=FW&dummy|<none>|<none>|0"
element 25 "Name" "GUI_SelFiles.tbButtons1.tbFileFilterWildcard.tbl.lbl_mdm"
element 25 "Value" "LA|CA=#14.mdm:TO=LW&LH&TL|<none>|<none>|0"
element 26 "Name" "GUI_InstParams.TL_Cancel_OK"
element 26 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#17LA_Hint|1"
element 27 "Name" "GUI_InstParams.TL_Cancel_OK.LA_Hint"
element 27 "Value" "LA|CA=#3116NOTE\072 \012The ICCAP_VALUES may hold numbers or a *single* string,\012however, *NO* string chains (e.g. 'abc def'):FG=C6:TO=FH&dummy|<none>|<none>|0"
element 28 "Name" "GUI_SelFiles.tbButtons2.tbSelect.LI_preview_header"
element 28 "Value" "DL|IT=%#19FileNames:SX=%#219FileNameSel4Preview:TO=FH&dummy|LS=#219GuiPreviewMdmHeader&#17Execute|<none>|0"
element 29 "Name" "GUI_SelFiles.tbButtons2.tbSelect.LA_preview"
element 29 "Value" "LA|CA=#224     View .mdm Header ->:TO=FW&FH|<none>|<none>|0"
element 30 "Name" "GUI_Help"
element 30 "Value" "TL|<none>|<none>|#210LA_txtHelp|0|0"
element 31 "Name" "GUI_Help.LA_txtHelp"
element 31 "Value" "LA|CA=%#18txt_HELP:FG=C6|<none>|<none>|0"
element 32 "Name" "GUI_InstParams.TL_Top.PB_Cancel"
element 32 "Value" "PB|CA=#16Cancel:TO=FW&FH&TR|AC=#222PbOkIdentifyInstParams&#214Execute,Cancel|<none>|0"
element 33 "Name" "GUI_InstParams.TL_Top.PB_OK"
element 33 "Value" "PB|CA=#12OK:TO=FW&FH&TR|AC=#222PbOkIdentifyInstParams&#210Execute,OK|<none>|0"
element 34 "Name" "GUI_InstParams.TL_View_mdm_Header.LA_preview"
element 34 "Value" "LA|CA=#224     View .mdm Header ->:TO=FW&dummy|<none>|<none>|0"
element 35 "Name" "GUI_InstParams.TL_View_mdm_Header"
element 35 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#210LA_preview:#217LI_preview_header|1"
element 36 "Name" "GUI_InstParams.TL_View_mdm_Header.LI_preview_header"
element 36 "Value" "DL|IT=%#19FileNames:SX=%#219FileNameSel4Preview:TO=FW&dummy|LS=#219GuiPreviewMdmHeader&#17Execute|<none>|0"
element 37 "Name" "GUI_InstParams.SEP2"
element 37 "Value" "SE|OR=HO:TO=FH&dummy|<none>|<none>|0"
element 38 "Name" "TL_mdmFileHead"
element 38 "Value" "TS|HT=400:WD=600|<none>|#18LA_notes:#215ED_fileheadtail|0|3"
element 39 "Name" "TL_mdmFileHead.LA_notes"
element 39 "Value" "LA|CA=#225Head of the .mdm File\072:TO=FH&dummy|<none>|<none>|0"
element 40 "Name" "TL_mdmFileHead.ED_fileheadtail"
element 40 "Value" "ED|BG=C9:EM=ML:ED=F:VA=%#210mdm_Header:FI=FF|<none>|<none>|0"
element 41 "Name" "GUI_SelFiles.tbSourceDir.edSourceDir"
element 41 "Value" "ED|VA=%#16MdmDir|<none>|<none>|0"
element 42 "Name" "GUI_SelFiles.tbSourceDir"
element 42 "Value" "TL|CA=#229Source directory of mdm files:OR=HO:TO=FH&dummy|<none>|#211edSourceDir:#214btSelectSource|1"
element 43 "Name" "GUI_SelFiles.tbSourceDir.btSelectSource"
element 43 "Value" "PB|CA=#210Change Dir:TO=FW&FH|AC=#18GuiChDir&#219Execute,ChDirSource|<none>|0"
element 44 "Name" "GUI_SelFiles.LI_DirFileNames"
element 44 "Value" "LI|IT=%#19FileNames:SI=%#213FilesSelected:SY=ES|LS=#216GuiCountSelFiles&#17Execute|<none>|0"
element 45 "Name" "GUI_SortFilenames"
element 45 "Value" "TL|OR=HO|<none>|#17TL_LIST:#15TL_OK|1|4"
element 46 "Name" "GUI_SortFilenames.TL_LIST"
element 46 "Value" "TL|CA=#249Organize Sequence of File Names for Combined File:FV=T|<none>|#226TL_FileNames_AddtlScalings:#19TL_updown|1"
element 47 "Name" "GUI_SortFilenames.TL_LIST.TL_FileNames_AddtlScalings.FilenameList"
element 47 "Value" "LI|CA=#210File Names:IT=%#19FileNames:SI=%#213SortSelection:SY=ES|<none>|<none>|0"
element 48 "Name" "GUI_SortFilenames.TL_LIST.TL_updown"
element 48 "Value" "TL|OR=HO:TO=FH&MW&MH|<none>|#17move_up:#19move_down|1"
element 49 "Name" "GUI_SortFilenames.TL_LIST.TL_updown.move_up"
element 49 "Value" "PB|CA=#15/\134:TO=FW&FH|AC=#211PbSortFiles&#214Execute,MoveUp|<none>|0"
element 50 "Name" "GUI_SortFilenames.TL_LIST.TL_updown.move_down"
element 50 "Value" "PB|CA=#15\134/:TO=FW&FH|AC=#211PbSortFiles&#216Execute,MoveDown|<none>|0"
element 51 "Name" "GUI_SortFilenames.TL_OK"
element 51 "Value" "TL|TO=FW&dummy|<none>|#15PB_OK|1"
element 52 "Name" "GUI_SortFilenames.TL_OK.PB_OK"
element 52 "Value" "PB|CA=#12OK:TO=FW&FH&TT|AC=#219./GUI_SortFilenames&#236Destroy Gui,OrganizeFileNameSequence|<none>|0"
element 53 "Name" "GUI_SortFilenames.TL_LIST.TL_FileNames_AddtlScalings"
element 53 "Value" "TL|OR=HO|<none>|#212FilenameList|1"
element 54 "Name" "GUI_SelFiles.tbButtons2.tbSelect.TL_Actions"
element 54 "Value" "TL|OR=VE:TO=FH&dummy|<none>|#212TL_SortFiles:#212TL_Selection|1"
element 55 "Name" "GUI_SelFiles.tbButtons2.tbSelect.TL_Actions.TL_SortFiles.btFileSequence"
element 55 "Value" "PB|CA=#222Organize File Sequence:TO=FH&dummy|AC=#219./GUI_SortFilenames&#245Display Modeless GUI,OrganizeFileNameSequence|<none>|0"
element 56 "Name" "GUI_SelFiles.tbButtons2.tbSelect.TL_Actions.TL_Selection"
element 56 "Value" "TL|OR=HO|<none>|#15btAll:#16btNone|1"
element 57 "Name" "GUI_SelFiles.tbButtons2.tbSelect.TL_Actions.TL_Selection.btNone"
element 57 "Value" "PB|CA=#211Select None:SF=T:TO=FH&dummy|AC=#215PbSelectNoneAll&#218Execute,SelectNone|<none>|0"
element 58 "Name" "GUI_SelFiles.tbButtons2.tbSelect.TL_Actions.TL_SortFiles"
element 58 "Value" "TL|<none>|<none>|#214btFileSequence|1"
element 59 "Name" ""
element 59 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 ! This Setup is about combining 2 or more mdm files 
 ! into a single one.
 
 ! DIFFERENT TO COMBINE_MDMS,
 ! this utility offers to combine .mdm files
 ! with *non-rectangular* scaling parameters.
 ! EXAMPLE:
 ! - rectangular parameter scaling:
 !   W|
 !    |x  x  x  x
 !    |x  x  x  x
 !    |x  x  x  x
 !    +----------L
 !
 !
 ! - nonrectangular parameter scaling:
 !   W|
 !    |x     x  x
 !    |x  x      
 !    |      x  x
 !    +----------L
 !
 ! Combining of .mdm files means adding an additional
 ! sweep (PARAMETER SWEEP) to the combined .mdm file, 
 ! around the existing sweeps of the individual 
 ! .mdm files.
 
 ! The scaling parameters have to be present in the 
 ! .mdm files as ICCAP_VALUES.
 ! The first ICCAP_VALUE will be represented as a LIST
 ! sweep around the ICCAP_INPUTS in the .mdm files.
 ! All other ICCAP_VALUES will be added as LSYNC,
 ! referring to the LIST described above.
 ! For this task, the PEL commands ICDB_REGISTER_LIST_SWEEP()
 ! and several ICDB_REGISTER_LSYNC_SWEEP() are applied in 'PbCombine'.
 !
 !---------------------------------------------------------------------------------------
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 txt_HELP = "HOW2USE:
 ==============================
 For combining several .mdm files with the Transform
 COMBINE_MDMS, *the .mdm files have to include ICCAP_VALUES*.
 
 Those ICCAP_VALUES will serve as the overlaying
 sweep in the combined .mdm file.
 
 When there are *no ICCAP_VALUES present* in the .mdm files,
 but rather the filename itself holds the additional to-be-included-sweep,
 or when the to-be-included sweep is already an Input of type CON
 in the to-be-combined .mdm files, 
 apply rather the Macro of Setup 'COMBINE_MDMS'."
 
 
 ICCAP_FUNC("./GUI_Help", "Display Modeless GUI", "HELP")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "COMBINE_MDMS" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 !-----------------------------------------------------------------------
 ! The scaling info has to be present in the .mdm files as ICCAP_VALUES.
 !-----------------------------------------------------------------------
 
 GLOBAL_VAR  DirName             ! DUT Variable
 GLOBAL_VAR  MdmDir
 GLOBAL_VAR  TargetDir
 GLOBAL_VAR  Wildcard
 GLOBAL_VAR  MdmLocation
 GLOBAL_VAR  TargetDirIsSourceDir
 
 
 !---initialize directories
 MdmDir    = VAL$(DirName)
 TargetDir = "-> PLEASE SELECT <-"
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 Wildcard = "*"
 
 MdmLocation = "Common Dir"
 !GET_STRING "Define, how the .mdm files are organized:
 !  -> Enter
 !     [Common Dir]    to combine .mdm files all located in a common, single directory
 !     [Root Dir]      to combine .mdm files located in a directory hierarchy (e.g. WaferPro)", VAL$(MdmLocation), MdmLocation
  
 
 IF (VAL$(MdmLocation)<> "Common Dir") AND (VAL$(MdmLocation)<> "Root Dir") THEN
   GET_STRING "ERROR: you entered a wrong keyword ! [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---Verify if the current directory exists
 !   If yes, identify .mdm file names
 !   If not, then default to current home directory
 DirFail=SYSTEM("cd "&VAL$(MdmDir)&" 2> /dev/null")
 IF (DirFail<>0) THEN 
   PRINT "Directory '";MdmDir;"' not found !"
   DirName = SYSTEM$("pwd")
   MdmDir  = VAL$(DirName)
   PRINT "~> Changing directory to current default directory instead"
 ELSE
   ICCAP_FUNC("RebuildFileList", "Execute")
 END IF
 
 
 !---preset: dir. of combined file
 ICCAP_FUNC("GuiChDir", "Execute", "TargetEquSource")
 TargetDirIsSourceDir=1
 
 
 !---display GUI
 ICCAP_FUNC("./GUI_SelFiles", "Display Modeless GUI", "Combine MDM files")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "GuiChDir" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ErrMsg=""
 
 !---This is answered by the calling GUI
 GET_STRING "What to do:  [ChDirSource], [ChDirTarget], [TargetEquSource]", What2Do
 
 
 !---dependent on the answer, link to the previously selected dir
 IF VAL$(What2Do)=="ChDirSource" THEN
   DirNameAct=SYS_PATH$(VAL$(DirName))
   GUIheader = "Select mdm directory of .mdm files to be combined"
 ELSE IF VAL$(What2Do)=="ChDirTarget" THEN
   TargetDirIsSourceDir=0
   DirNameAct=SYS_PATH$(VAL$(TargetDir))
   GUIheader = "Select mdm directory of combined .mdm file"
 ELSE IF VAL$(What2Do)=="TargetEquSource" THEN
   TargetDir=SYS_PATH$(VAL$(MdmDir))
   RETURN_VALUE 2
 END IF
 
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Suffix=".mdm"
 SelPolicy = "DirOnly"	! Single, Multi, DirOnly
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(DirNameAct), VAL$(Suffix), VAL$(Wildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)=="" THEN
   !---Get the selected directory back
   DirNameSel=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
 ELSE
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy	!an error has occurred
   RETURN_VALUE 0
 END IF
 
 
 
 !---link the dir to the requested variable
 IF VAL$(What2Do)=="ChDirSource" THEN
   MdmDir  = SYS_PATH$(VAL$(DirNameSel))
   DirName = VAL$(MdmDir)
   IF VAL(TargetDirIsSourceDir) ==1 THEN TargetDir=VAL$(MdmDir)
   ICCAP_FUNC("RebuildFileList", "Execute")
   RETURN_VALUE 3
 ELSE IF (VAL$(What2Do)=="ChDirTarget") THEN
   TargetDir = SYS_PATH$(VAL$(DirNameSel))
   RETURN_VALUE 4
 END IF
 
 
 
 RETURN_VALUE 0
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PbSelectNoneAll" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  FileNames
 GLOBAL_VAR  FilesSelected
 
 
 
 
 GET_STRING "What to do: [SelectAll], [SelectNone]", What2Do
 
 IF VAL$(What2Do)=="SelectNone" THEN 
   DIMENSION_ARRAY(FilesSelected, 0)
 ELSE
   DIMENSION_ARRAY(FilesSelected, SIZEOF(FileNames))
   FOR i=0 TO SIZEOF(FilesSelected)-1
     FilesSelected[i]=i
   NEXT i
 END IF
 
 
 ICCAP_FUNC("GuiCountSelFiles", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "RebuildFileList" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  MdmLocation
 GLOBAL_VAR  NrSelFiles
 
 
 NrSelFiles = 0
 
 ICCAP_FUNC("./GUI_SelFiles", "Destroy GUI", "Combine MDM files")
 
 
 
 IF VAL$(MdmLocation)== "Common Dir" THEN 
   ICCAP_FUNC("FindFilesCommonDir", "Execute")
 ELSE IF VAL$(MdmLocation)== "Root Dir"   THEN 
   ICCAP_FUNC("FindFilesFromDirs",  "Execute")
 ELSE
   GET_STRING "ERROR: you entered a wrong keyword ! [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 
 ICCAP_FUNC("./GUI_SelFiles", "Display Modeless GUI", "Combine MDM files")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "FindFilesCommonDir" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 UnixCmd = "cd "&SYS_PATH$(VAL$(MdmDir))&" 2> /dev/null
 ls *"&VAL$(Wildcard)&".mdm 2> /dev/null"  		! NOTE:  2> /dev/null   avoids an error message in the IC-CAP Status window
 StringChain = SYSTEM$(UnixCmd)
 
 FileNames="ICCAP_ARRAY[0]"
 FilesSelected="ICCAP_ARRAY[0]"    
 
 IF StringChain<>"" THEN
   ICCAP_FUNC("./GUI_SelFiles.tbButtons2.tbSelect.TL_Actions.TL_Selection.btAll","Set GUI Options","SF=T","")
   ICCAP_FUNC("./GUI_SelFiles.tbButtons2.tbSelect.TL_Actions.TL_Selection.btNone","Set GUI Options","SF=T","")
 
   Index=0
   StringPos=1
 
   WHILE StringPos>0
     StringPos=STRPOS(VAL$(StringChain),CHR$(10))
     IF StringPos>0 THEN  
       StringLen=STRLEN(VAL$(StringChain))
       SubString=SUBSTR$(VAL$(StringChain),1,StringPos-1)
       Index=Index+1
 
       FileNames="ICCAP_ARRAY["&VAL$(Index)&"]"
       FileNames[Index-1]=SubString
       StringChain=SUBSTR$(VAL$(StringChain),StringPos+1,StringLen)
     END IF
   END WHILE
 
   IF STRLEN(StringChain)>0 THEN
     FileNames="ICCAP_ARRAY["&VAL$(Index+1)&"]"
     FileNames[Index]=StringChain
   END IF
 ELSE
   ICCAP_FUNC("./GUI_SelFiles.tbButtons2.tbSelect.btAll", "Set GUI Options","SF=F","")
   ICCAP_FUNC("./GUI_SelFiles.tbButtons2.tbSelect.btNone","Set GUI Options","SF=F","")
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "FindFilesFromDirs" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  MdmDir
 GLOBAL_VAR  FileNames
 GLOBAL_VAR  Wildcard
 GLOBAL_VAR  tmpVar
 
 
 mdmRootDirName = SYS_PATH$(VAL$(MdmDir))
 
 Wildcard=TRIM$(VAL$(Wildcard), "*")
 IF STRPOS(VAL$(Wildcard), "*") > 0 THEN 
   dummy = CUTSTR(VAL$(Wildcard), tmpVar, "*")
 ELSE
   IF VAL$(Wildcard)<>"" THEN
     DIMENSION_ARRAY(tmpVar, 1)
     tmpVar[0]=VAL$(Wildcard)
   ELSE
     DIMENSION_ARRAY(tmpVar, 0)
   END IF
 END IF
 
 
 !---find all files in dir. hierarchy
 !UnixCmd = "ls -R "&VAL$(mdmRootDirName)
 UnixCmd = "find "&VAL$(mdmRootDirName)
 FOR i=0 TO SIZEOF(tmpVar)-1
   UnixCmd = VAL$(UnixCmd)&" | grep "&VAL$(tmpVar[i])
 NEXT i
 !PRINT  UnixCmd
 allDirFileNames = SYSTEM$(VAL$(UnixCmd))
 
 
 
 !---export to array FileNames being shown in GUI
 dummy = CUTSTR(VAL$(allDirFileNames), FileNames)
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GuiPreviewMdmHeader" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 IF VAL$(MdmLocation)=="Common Dir" THEN mdm_Header = SYSTEM$("head -100 "&VAL$(MdmDir)&"/"&VAL$(FileNames[FileNameSel4Preview]))
 IF VAL$(MdmLocation)=="Root Dir"   THEN mdm_Header = SYSTEM$("head -100 "&VAL$(FileNames[FileNameSel4Preview]))
 
 
 
 ICCAP_FUNC("./TL_mdmFileHead", "Display Modeless GUI", "mdm File Header")
 
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "PbSortFiles" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  FileNames
 GLOBAL_VAR  SortSelection
 GLOBAL_VAR  FilesSelected
 
 
 GET_STRING "What to do ?  [MoveUp], [MoveDown]", Action
 
 
 !---clear mdm file selection
 FilesSelected=""
 
 
 !--------------------------------------------------------------
 IF Action == "MoveUp" THEN
   !check if nothing was selected
   IF SortSelection==-1 THEN RETURN_VALUE 0
   !check if top most item was selected
   IF SortSelection[0]==0  THEN RETURN_VALUE 0	
 
   FOR i=0 TO SIZEOF(SortSelection)-1
     tmp=VAL$(FileNames[SortSelection[i]])
     dummy=ARRAY_REMOVE_AT(FileNames, SortSelection[i])
     dummy=ARRAY_INSERT_AT(FileNames, tmp, SortSelection[i]-1)
   NEXT i
   !move selection also upwards, maybe user wants to move the item even higher
   FOR i=0 TO SIZEOF(SortSelection)-1
      SortSelection[i] = MAX(0, SortSelection[i] - 1)	
   NEXT i
 END IF
 
 
 !--------------------------------------------------------------
 IF Action == "MoveDown" THEN
   !check if nothing was selected
   IF SortSelection==-1 THEN RETURN_VALUE 0
   !check if last item was selected
   IF SortSelection[SIZEOF(SortSelection)-1]==SIZEOF(FileNames)-1  THEN RETURN_VALUE 0	
 
   FOR i=SIZEOF(SortSelection)-1 TO 0 STEP -1
     tmp=VAL$(FileNames[SortSelection[i]])
     dummy=ARRAY_REMOVE_AT(FileNames, SortSelection[i])
     dummy=ARRAY_INSERT_AT(FileNames, tmp, SortSelection[i]+1)
   NEXT i
   !move selection also downwards, maybe user wants to move the item even lower
   FOR i=0 TO SIZEOF(SortSelection)-1
     SortSelection[i] = SortSelection[i] + 1		
   NEXT i
 END IF
 
 
 !--------------------------------------------------------------
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PbCombine" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---first some pre-checks
 IF VAL$(TargetDir)=="-> PLEASE SELECT <-" THEN
   GET_STRING "ERROR: Seems you forgot to define the Target Directory of the Combined .mdm File !! [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 IF SIZEOF(FilesSelected)<2 THEN
   GET_STRING "ERROR: select at least 2 files to combine  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---let user select the Inst.Param. to be added to the big .mdm
 ICCAP_FUNC("IdentifyInstParams", "Execute")
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 
 IF VAL(Debug)==1 THEN PRINT "==> initializing ... "
 NamesScalingParams=""
 NamesScalingParams="ICCAP_ARRAY["&VAL$(SIZEOF(InstParams4CombinedMdmSel))&"]"
 i=0
 WHILE i < SIZEOF(NamesScalingParams)
   NamesScalingParams[i]=InstParams4CombinedMdm[InstParams4CombinedMdmSel[i]]
   i = i + 1
 END WHILE
 NrScalingParams=SIZEOF(NamesScalingParams)
 
 
 !---create arrays for selected Inst.Params and fill them
 ICCAP_FUNC("FillParamArrays", "Execute")
 
 
 !### WE ARE READY FOR COMBINING ###
 !   ----------------------------
 
 IF VAL(Debug)==1 THEN PRINT "==> combining ..."
 !---document the file creation conditions
 MDM_EXPORT_COMMENT="file created by "&VAL$(SYSTEM$("whoami"))&" on "&VAL$(SYSTEM$("date"))
 
 
 !---initialize the big mdm file
 !   -> opening data base file, adding comment line and registering USER_SWEEP"
 MdmDirfile=VAL$(TargetDir)&"/"&VAL$(CombinedMdm)!&".mdm"
 dummy=SYSTEM("rm -f "&VAL$(MdmDirfile))
 !---create and open the combined .mdm file--------------------------------------------
 dummy=ICDB_OPEN(VAL$(MdmDirfile))
 
 
 !---register the Instance Parameters (LIST for first one, then LSYNCs or TLSYNCs)-----
 i=0
 WHILE i < SIZEOF(NamesScalingParams)
   !  exchange MAIN.L -> MAIN_L  (IC-CAP Inputs cannot be named with '.', therefore we exchange to '_'
   TmpVar=VAL$(NamesScalingParams[i])
   ICCAP_FUNC("ExchChars", "Execute", VAL$(TmpVar)&"_swp")
 
   IF i==0 THEN
     MasterSweep=VAL$(TmpVar)
     ! check array for holding numbers or strings
     ICCAP_FUNC("CheckArrayNrString", "Execute", "Col0")
     IF CheckArrayNrString[0]==0 THEN	!it's a number
       !                              UserSweepOrder, SweepName, ICCAP_ARRAY
       dummy=ICDB_REGISTER_LIST_SWEEP(1, VAL$(MasterSweep), "Col0")
     ELSE IF CheckArrayNrString[0]==1 THEN	!it's a string
       dummy=ICDB_REGISTER_TEXT_LIST_SWEEP(1, VAL$(MasterSweep), "Col0")
     ELSE IF CheckArrayNrString[0]==-1 THEN	!it's a string chain
       GET_STRING "ERROR: selected ICCAP_VALUEs contain a string chain including blancs, e.g. 'abc def' !!!  
 	This is currently not supported for Inputs of Type TLIST and TLSYNC   [OK]", dummy
       RETURN_VALUE 2
     END IF
 
   ELSE
     ! check array for holding numbers or strings
     ICCAP_FUNC("CheckArrayNrString", "Execute", "Col"&VAL$(i))
     IF CheckArrayNrString[0]==0 THEN	!it's a number
       dummy=ICDB_REGISTER_LSYNC_SWEEP(VAL$(TmpVar), VAL$(MasterSweep), "Col"&VAL$(i))
     ELSE IF CheckArrayNrString[0]==1 THEN	!it's a string
       dummy=ICDB_REGISTER_TEXT_LSYNC_SWEEP(VAL$(TmpVar), VAL$(MasterSweep), "Col"&VAL$(i))
     ELSE IF CheckArrayNrString[0]==-1 THEN	!it's a string chain
       GET_STRING "ERROR: selected ICCAP_VALUEs contain a string chain including blancs, e.g. 'abc def' !!!  
 	This is currently not supported for Inputs of Type TLIST and TLSYNC   [OK]", dummy
       RETURN_VALUE 2
     END IF
   END IF
   i = i + 1
 END WHILE
 
 !---add all mdm files to the big one--------------------------------------------------
 ifiles=0
 WHILE ifiles<SIZEOF(FilesSelected)
   IF VAL(Debug)==1 THEN PRINT "-> ImportCreate of file ";FileNames[FilesSelected[ifiles]]
 
   !---Delete at least one Input to ensure accurate ImportCreate also for the case of only CON sweeps in the .mdm file (bug in 2004A and 2006A)
   InputNames=""
   ICCAP_FIND_CHILDREN ".", "Input", InputNames
   IF VAL$(InputNames)<>"" THEN ICCAP_FUNC(VAL$(InputNames[0]), "Delete")
 
   IF VAL$(MdmLocation)=="Common Dir" THEN mdmDirFileName = VAL$(MdmDir)&"/"&VAL$(FileNames[FilesSelected[ifiles]])
   IF VAL$(MdmLocation)=="Root Dir"   THEN mdmDirFileName = VAL$(FileNames[FilesSelected[ifiles]])
 
   ICCAP_FUNC(".", "Import Create", VAL$(mdmDirFileName))
 
   !---verify if currently loaded .mdm has the same size like the previous one (only in this case, we can combine them !!)
   ICCAP_FIND_CHILDREN ".", "Input", InputNames
   tmp=DATASET("quiet "&VAL$(InputNames[0]))
   IF ifiles==0 THEN Last_mdm_DataSize=SIZEOF(tmp)
   IF ifiles>0 THEN 
     Current_mdm_DataSize=SIZEOF(tmp)
     IF VAL(Last_mdm_DataSize)<>VAL(Current_mdm_DataSize) THEN
       GET_STRING "ERROR: the selected .mdm files seem to have different sweep conditions !! 
         The detected difference is between mdm files 
 	-> "&VAL$(FileNames[ifiles-1])&"
            and
 	-> "&VAL$(FileNames[ifiles])&"
             ==> The combining is stopped, the combined .mdm file is most probably corrupted (pls. delete it)   [OK]", dummy
       RETURN_VALUE 0
     END IF
   Last_mdm_DataSize=Current_mdm_DataSize
   END IF
 
   !---add currently loaded .mdm to big one-----------------------------------------
   IF VAL(Debug)==1 THEN PRINT "-> adding single .mdm to big .mdm "
   dummy = ICDB_EXPORT_DATA(".", "M") 
 
   ifiles = ifiles + 1
 END WHILE
 
 
 
 !---close the big mdm file-----------------------------------------------------------
 dummy = ICDB_CLOSE()
 
 !=======
 
 !---after the combining, we need to enter the Param.Names into the Inputs of type LSYNC (and its Master Input)
 !ImportCreate .mdm
 ICCAP_FUNC(".", "Import Create", VAL$(TargetDir)&"/"&VAL$(CombinedMdm))
 
 FOR i=0 TO SIZEOF(InstParams4CombinedMdmSel)-1
   !  exchange '.' with  '_' in InputName
   ParamName = VAL$(VAL$(InstParams4CombinedMdm[InstParams4CombinedMdmSel[i]]))
   TmpVar=VAL$(ParamName)
   ICCAP_FUNC("ExchChars", "Execute", VAL$(TmpVar))
   LSYNCInputName = VAL$(TmpVar)
   !  enter the Param.Name into current Input
   ICCAP_FUNC(VAL$(LSYNCInputName)&"_swp", "SetTableFieldValue", "Param Name", VAL$(ParamName))
 NEXT i
 
 !Export .mdm
 ICCAP_FUNC(".", "Export Data Measured", VAL$(TargetDir)&"/"&VAL$(CombinedMdm))
 
 
 
 
 !---re-import the new .mdm file
 ICCAP_FUNC(".", "Import Delete")	!---delete all Inputs/Outputs
 ICCAP_FUNC(".", "Import Create", VAL$(MdmDirfile))
 
 
 !---show notes
 txt_HELP = "The combined .mdm file has been saved into the user-defined disk location.
   -----------------------------------------------------------------------------------------------
   Additionally, it has been loaded back into the Inputs/Outputs of this UTILITIES Setup 'COMBINE_MDMS_incl_ICCAP_VALUE'.
   This means that
  ==>  You can verify the settings in the Input Entry Fields, 
       i.e. especially 'Mode' and 'Node' of the new Input(s) (the combining ones),
       e.g. to make sure the new combined .mdm file can also be simulated
  ==>  DO NOT RE-ORDER THE SWEEPS !  (Apply rather 'ANALYZE_AND_CUT_MDM' afterwards!!)
  ==>  Then, *manually* hit 'Export'
  ==>  and then, close the GUI"
 ICCAP_FUNC("./GUI_Help", "Display Modeless GUI", "Manually adjust Inputs/Outputs of combined .mdm and re-save it")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member XFORM "CheckArrayNrString"
}
LINK XFORM "IdentifyInstParams" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ErrMsg=""
 
 !---read ICCAP_VALUES from first selected .mdm file in order 
 !   to offer selection of the instance (scaling) parameters to be included in the mdm
 IF VAL$(MdmLocation)=="Common Dir" THEN DirFileName = VAL$(MdmDir)&"/"&VAL$(FileNames[FilesSelected[0]])
 IF VAL$(MdmLocation)=="Root Dir"   THEN DirFileName = VAL$(FileNames[FilesSelected[0]])
 
 
 SearchString="ICCAP_VALUES"
 !---check if SearchString is included at all
 IF SYSTEM$("cat "&VAL$(DirFileName)&" | grep "&VAL$(SearchString))=="" THEN 
   ErrMsg="ERROR: "&VAL$(SearchString)&" cannot be found in 
 	"&VAL$(DirFileName)&"
 	Apply rather the Macros of 'COMBINE_MDMS'"
   GET_STRING VAL$(ErrMsg), dummy
   RETURN_VALUE 0
 END IF
 
 
 !---open file and goto first ICCAP_VALUE
 r_stream = USERC_open(VAL$(DirFileName), "r")
 tmpVar=""
 WHILE VAL$(tmpVar)<>VAL$(SearchString)
   dummy = USERC_readstr(r_stream, 0, "%s", tmpVar)
 END WHILE
 
 !---read all ICCAP_VALUEs and export them to array 'InstParams4CombinedMdm'
 InstParams4CombinedMdm=""
 InstParams4CombinedMdmSel=""
 SearchString="END_HEADER"
 WHILE VAL$(tmpVar)<>VAL$(SearchString)
   !                                   %s%*[^\n] : read first string and skip the rest of the line
   dummy = USERC_readstr(r_stream, 0, "%s%*[^\n]", tmpVar)
   IF VAL$(tmpVar)<>VAL$(SearchString) THEN 	!don't act when SearchString is reached
     ICCAP_FUNC("Add2Array", "Execute", "InstParams4CombinedMdm", VAL$(tmpVar))
   END IF
 END WHILE
 
 dummy = USERC_close(r_stream)
 
 
 ICCAP_FUNC("./GUI_InstParams", "Display Modal GUI", "Select Parameters")
 
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PbOkIdentifyInstParams" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GET_STRING "[OK] or [Cancel]", answer
 
 ErrMsg=""
 IF VAL$(answer)=="Cancel" THEN
   ICCAP_FUNC("./GUI_InstParams", "Destroy GUI", "Select Parameters")
   ErrMsg="Param Selection Cancelled"
   RETURN_VALUE 0
 END IF
 
 
 IF SIZEOF(InstParams4CombinedMdmSel)==0 THEN
   GET_STRING "ERROR: at least one parameter has to be selected !!!", dummy
   RETURN
 END IF
 
 
 
 
 ICCAP_FUNC("./GUI_InstParams", "Destroy GUI", "Select Parameters")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Add2Array" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! this Program adds a value to an array
 
 
 GET_STRING "ArrayName", "myArray", ArrayName
 GET_STRING "DataVal", "123", DataVal
 
 
 IF VAL(Debug)==1 THEN PRINT " > adding '"; DataVal; "' to ICCAP_ARRAY "; ArrayName
 
 !check if array exists - if not, create the Variable
 ErrMsg=""
 VarValue=LOOKUP_VAR(VAL$(ArrayName), ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN ICCAP_FUNC(".", "CreateVariableTableVariable", VAL$(ArrayName))
 
 
 
 
 ! read the ICCAP_ARRAY size
 ArraySize=VAL(LOOKUP_VAR(VAL$(ArrayName)))
 
 ! calc current Size of Array and export value
 ICCAP_FUNC(".", "Set Variable Table Value", ArrayName, "ICCAP_ARRAY["&VAL$(ArraySize+1)&"]")
 ICCAP_FUNC(".", "Set Variable Table Value", ArrayName & "[" & VAL$(ArraySize) & "]", VAL$(DataVal))
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "FillParamArrays" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 iImportedFile=0
 iFiles=0
 WHILE iFiles<SIZEOF(FilesSelected)
 
   !First delete existing ParamNames in SetupVariables
   i=0
   WHILE i < SIZEOF(NamesScalingParams)
     VarName=VAL$(NamesScalingParams[i])
     ErrMsg=""
     dummy=LOOKUP_VAR(VAL$(VarName), ErrMsg)
     IF VAL$(ErrMsg)=="" THEN 
       ! Delete SetupVariable 'VarName'
       ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
     END IF
     i = i + 1
   END WHILE
 
 
   ! Get Instance Param.Value(s) from FileNames[FilesSelected[iFiles]]
   ! Delete at least one Input to ensure accurate ImportCreate also for the case of only CON sweeps in the .mdm file (bug in 2004A and 2006A)
   InputNames=""
   ICCAP_FIND_CHILDREN "." ,"Input", InputNames
   IF VAL$(InputNames)<>"" THEN ICCAP_FUNC(VAL$(InputNames[0]),"Delete")
 
   !---ImportCreate current mdm file[ifile].
   !   Then included ICCAP_VALUES will be auto-created as SetupVariables by IC-CAP
   !   so that we can access them and add them into the Col[x] arrays
   IF VAL$(MdmLocation)=="Common Dir" THEN DirFileName = VAL$(MdmDir)&"/"&VAL$(FileNames[FilesSelected[iFiles]])
   IF VAL$(MdmLocation)=="Root Dir"   THEN DirFileName = VAL$(FileNames[FilesSelected[iFiles]])
   ICCAP_FUNC(".", "Import Create", VAL$(DirFileName))
 
 
   !---update InstParam arrays
   iparam=0
   WHILE iparam< SIZEOF(NamesScalingParams)
     VarName="Col"&VAL$(iparam)
 
     IF iImportedFile==0 THEN    
       !check if array is already present in this Setup. 
       !(Happens when a 2nd combination is executed from the GUI)
       !If yes, reset it.
       ErrMsg=""
       dummy=LOOKUP_VAR(VAL$(VarName), ErrMsg)
       IF VAL$(ErrMsg)=="" THEN ICCAP_FUNC(".", "SetVariableTableValue", VAL$(VarName), "ICCAP_ARRAY[0]")
     END IF
 
     !  add to arrays
     ErrMsg=""
     VarVal=LOOKUP_VAR(VAL$(NamesScalingParams[iparam]), ErrMsg)
     IF VAL$(ErrMsg)=="" THEN
       !  Variable was ImportCreated (present as ICCAP_VALUE in the .mdm file)
       ICCAP_FUNC("Add2Array", "Execute", VAL$(VarName), VAL$(VarVal))
     ELSE
       GET_STRING "Requested Variable "&VAL$(NamesScalingParams[iparam])&"
 		was not present in .mdm file "&VAL$(FileNames[FilesSelected[iFiles]])&", 
 		therefore entering a 'detect-it-later-in-the-table' value", "1E37", answer
       ICCAP_FUNC("Add2Array", "Execute", VAL$(VarName), VAL$(answer))
     END IF
     iparam = iparam + 1
   END WHILE
   iImportedFile = iImportedFile + 1
 
   iFiles = iFiles + 1
 END WHILE
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "ExchChars" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! exchange  "." in the string to "_"
 ! example:
 !TmpVar="MAIN.L" -> "MAIN_L"
 
 
 GET_STRING "enter a string", TmpVar
 BadChar  = "."
 GoodChar = "_"
 
 ! find out how many chars are included in the bad characters string
 stringlenbad=STRLEN(VAL$(BadChar))
 
 ! do the char. exchange
 stringpos=1
 WHILE stringpos>0
   stringpos=STRPOS(VAL$(TmpVar),VAL$(BadChar))
   IF stringpos>0 THEN  
     stringlen=STRLEN(VAL$(TmpVar))
     IF stringlen>1 THEN
       IF stringpos>1 THEN
         TmpVar=SUBSTR$(VAL$(TmpVar),1,stringpos-1)&VAL$(GoodChar)&SUBSTR$(VAL$(TmpVar),stringpos+stringlenbad,stringlen)
       ELSE
         !the bad char is already the first char
         TmpVar=VAL$(GoodChar)&SUBSTR$(VAL$(TmpVar),stringpos+stringlenbad,stringlen)
       END IF
     ELSE	
       !string consisted only of the BadChar
       TmpVar=""
     END IF
   END IF
 END WHILE
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "CheckArrayNrString" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GET_STRING "enter an array to be checked 
 	for contents of number, string or string chain", actArrayName
 
 
 !---results of checking:
 ! ContainsString =  0:  it's a number
 ! ContainsString =  1:  it's a string
 ! ContainsString = -1:  it's a string chain
 
 
 
 ContainsString=0
 
 ArraySize = VAL(LOOKUP_VAR(VAL$(actArrayName)))
 i=0
 WHILE i < ArraySize
   x=LOOKUP_VAR(VAL$(actArrayName)&"["&VAL$(i)&"]", ErrStr)
 
   x1=VAL(VAL$(x))
   x2=STRPOS(VAL$(x), "0.0")
   x3=STRPOS(VAL$(x), "-0")
 
   !    check for numbers except 0
   !    |        check for number 0 in format '0'
   !    |               |               check for number 0 in format '0.00e0'
   !    |               |                  |         check for -0
   !    v               v                  v          v         check if , is present
   IF ((x1<>0) OR (VAL$(x)==VAL$(x1)) OR (x2>0) OR (x3>0)) AND (STRPOS(VAL$(x), ",")==0) THEN
     
     !===it's a number !!!
   ELSE
     !===it's a string or a string chain !!!
     ContainsString=1
     IF STRPOS(VAL$(x), " ")>0 THEN
       !===it's a string chain !!!
       ContainsString=-1
     END IF
     i = ArraySize
   END IF  
   
   i = i + 1
 END WHILE
 
 IF VAL(Debug)==1 THEN
   IF ContainsString==0  THEN PRINT "  > it's a number !"
   IF ContainsString==1  THEN PRINT "  > it's a string !"
   IF ContainsString==-1 THEN PRINT "  > it's a string chain !"
 END IF
 
 RETURN_VALUE ContainsString
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list XFORM "PbCombine"
}
LINK XFORM "GuiCountSelFiles" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  NrSelFiles
 GLOBAL_VAR  FilesSelected
 
 
 NrSelFiles = SIZEOF(FilesSelected)
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________3" "711.501"
{
}
LINK XFORM "PbExit" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("./GUI_SelFiles", "Destroy GUI", "Combine MDM files")
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !---close all ICCAP_ARRAYs so that the Setup Variable List becomes 'readable-by-a-human' again
 FileNames     = "ICCAP_ARRAY[0]"
 FilesSelected = "ICCAP_ARRAY[0]"
 
 NamesScalingParams="ICCAP_ARRAY[0]"
 InstParams4CombinedMdmSel="ICCAP_ARRAY[0]"
 
 NrScalingParams = 0
 tmpVar = ""
 Wildcard = ""
 
 CombinedMdm = "_Combined"
 
 
 !---some more complex clean-up stuff ...
 !   --------------------------------
 
 !---delete the auto-added SetupVariables, 
 !   which represent the Instance Parameters of the .mdm files
 i=0
 WHILE i < SIZEOF(InstParams4CombinedMdm)
   ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(InstParams4CombinedMdm[i])&"]", "") 
   i = i + 1
 END WHILE
 InstParams4CombinedMdm="ICCAP_ARRAY[0]"
 
 
 !---delete all Colx arrays (were used to keep the Instance Parameters of the added MASTER and the LSYNC sweeps
 ErrMsg=""
 i=0
 WHILE VAL$(ErrMsg)==""
   VarName="Col"&VAL$(i)
   dummy=LOOKUP_VAR(VAL$(VarName), ErrMsg)
   IF VAL$(ErrMsg)=="" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
     i = i + 1
   END IF
 END WHILE
 
 !---reset Variables
 ErrMsg=""
 MDM_EXPORT_COMMENT = ""
 
 
 !---clean up Inputs/Outputs
 ICCAP_FUNC(".", "Import Delete")
 InputNames  = "ICCAP_ARRAY[0]"
 OutputNames = "ICCAP_ARRAY[0]"
 
 
 !add Input 'See_under_ExtractOptimize'
 ICCAP_FUNC(".", "New Input" ,"See_under_ExtractOptimize") 
 ICCAP_FUNC("See_under_ExtractOptimize", "SetTableFieldValue", "Sweep Type", "CON")
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
TABLE "HP4145.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Init Command" ""
}
}
}
LINK DAT "ANALYZE_AND_CUT_MDM_FILES" "711.501"
{
View in_out 0 "0.63278323377544 2672 2000"
View plot 0 "1.9624822820695 4801 6698"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P196 P177 C10"
element 0 "Name" "!DirName"
element 0 "Value" ""
element 0 "Comment" "a DUT Variable !"
element 1 "Name" "DirFileName"
element 1 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/ScaledMdlg_Chalmers_2011-05/GaN_Triquint_40Chip2~DC~combined.mdm"
element 2 "Name" "NrSweepIndices"
element 2 "Value" "483"
element 3 "Name" "HB_present"
element 3 "Value" "0"
element 4 "Name" "SEG_present"
element 4 "Value" "0"
element 5 "Name" "SHOW_INPUT_OUTPUT_FINDER"
element 5 "Value" "yes"
element 6 "Name" "MAX_SETUP_POINTS"
element 6 "Value" "1000000"
element 7 "Name" "MDM_FILE_PATH"
element 7 "Value" "D:\d_SisConsult\30_TOOLS___\5_Mdlg\5_Xtors\5_III_V\5c_ASM-HEMT\___ICCAP\data\ScaledMdlg_Chalmers_2011-05"
element 8 "Name" "MDM_FILE_NAME"
element 8 "Value" "GaN_Triquint_40Chip2~DC~combined.mdm"
element 9 "Name" "MDM_EXPORT_XFORM_DATA"
element 9 "Value" "0"
element 10 "Name" "MDM_VALUES_LIST"
element 10 "Value" ""
element 11 "Name" "RETAIN_DATA"
element 11 "Value" "yes"
element 11 "Comment" "don't clear meas. data if not absolutely required"
element 12 "Name" "PLOT_TRACE_LINE_WIDTH"
element 12 "Value" "0"
element 13 "Name" "GWINDX"
element 13 "Value" "16000"
element 14 "Name" "GWINDY"
element 14 "Value" "16000"
element 15 "Name" "FIX_PLOT_SIZE"
element 15 "Value" "Yes"
element 16 "Name" "XFORM_LIST_COLS"
element 16 "Value" "22"
element 17 "Name" "__________________1"
element 17 "Value" ""
element 18 "Name" "txt_HELP"
element 18 "Value" "importing data ..."
element 19 "Name" "ErrMsg"
element 19 "Value" ""
element 20 "Name" "__________________2"
element 20 "Value" ""
element 21 "Name" "PlotMdmName"
element 21 "Value" "mdm DirFileName: /cygdrive/d/d_SisConsul ... almers_2011-05/GaN_Triquint_40Chip2~DC~combined.mdm"
element 22 "Name" "AllSweepNames"
element 22 "Value" "ICCAP_ARRAY[0]"
element 23 "Name" "AllSweepNames_sel"
element 23 "Value" "1"
element 24 "Name" "AllSweepIndex"
element 24 "Value" "ICCAP_ARRAY[0]"
element 25 "Name" "SweepNames"
element 25 "Value" "ICCAP_ARRAY[0]"
element 26 "Name" "MasterSweepName"
element 26 "Value" "NFING_swp"
element 27 "Name" "InputNames"
element 27 "Value" "ICCAP_ARRAY[0]"
element 28 "Name" "xAxisNames"
element 28 "Value" "ICCAP_ARRAY[0]"
element 29 "Name" "xAxisNames_sel"
element 29 "Value" "-1"
element 30 "Name" "OutputNames"
element 30 "Value" "ICCAP_ARRAY[0]"
element 31 "Name" "yAxisNames"
element 31 "Value" "ICCAP_ARRAY[0]"
element 32 "Name" "yAxisNames_sel"
element 32 "Value" "-1"
element 33 "Name" "PlotTypes"
element 33 "Value" "ICCAP_ARRAY[0]"
element 34 "Name" "PlotTypes_sel"
element 34 "Value" "0"
element 35 "Name" "PlotXaxisLabel"
element 35 "Value" "Plot X-Axis:"
element 36 "Name" "PlotYaxisLabel"
element 36 "Value" "Plot Y-Axis:"
element 37 "Name" "PlotNames"
element 37 "Value" "ICCAP_ARRAY[0]"
element 38 "Name" "PlotNames_sel"
element 38 "Value" "0"
element 39 "Name" "LineStyle[0]"
element 39 "Value" "Line & Symbols"
element 40 "Name" "LineStyle[1]"
element 40 "Value" "Line only"
element 41 "Name" "LineStyle[2]"
element 41 "Value" "Symbols only"
element 42 "Name" "LineStyle"
element 42 "Value" "ICCAP_ARRAY[3]"
element 43 "Name" "LineStyle_sel"
element 43 "Value" "0"
element 44 "Name" "LineColor[0]"
element 44 "Value" "apply default"
element 45 "Name" "LineColor[1]"
element 45 "Value" "2nd order sweep"
element 46 "Name" "LineColor[2]"
element 46 "Value" "highest order sweep"
element 47 "Name" "LineColor[3]"
element 47 "Value" "every curve"
element 48 "Name" "LineColor"
element 48 "Value" "ICCAP_ARRAY[4]"
element 49 "Name" "LineColor_sel"
element 49 "Value" "0"
element 50 "Name" "ShowAreaTools"
element 50 "Value" "1"
element 51 "Name" "__________________3"
element 51 "Value" ""
element 52 "Name" "LsyncPresent"
element 52 "Value" "1"
element 53 "Name" "PlotAvailable"
element 53 "Value" "0"
element 54 "Name" "Plots2MP"
element 54 "Value" "1"
element 55 "Name" "ColNames"
element 55 "Value" "ICCAP_ARRAY[0]"
element 56 "Name" "ColSize"
element 56 "Value" "5"
element 57 "Name" "Index"
element 57 "Value" "ICCAP_ARRAY[0]"
element 58 "Name" "Index_sel"
element 58 "Value" "ICCAP_ARRAY[0]"
element 59 "Name" "TmpVar"
element 59 "Value" ""
element 60 "Name" "GUI_xPos"
element 60 "Value" "665"
element 61 "Name" "GUI_yPos"
element 61 "Value" "160"
element 62 "Name" "__________________4"
element 62 "Value" ""
element 63 "Name" "___Vars_below_stem_from_mdm_file___"
element 63 "Value" "you_can_delete_them_from_time_to_time ;-)"
element 64 "Name" ""
element 64 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "GUI_Sel_Data"
element 0 "Value" "TL|CA=#276Select From Shown All Available Biases/Devices In Currently Loaded .mdm File:OR=HO:WD=800:LX=%#18GUI_xPos:LY=%#18GUI_yPos|CA=#16gui_OK&#17Execute|#220TL_SweepValuesParent:#214TL_PushButtons|1|1"
element 1 "Name" "GUI_Sel_Data.TL_SweepValuesParent"
element 1 "Value" "TL|<none>|<none>|#214TL_mdmFilename:#214TL_SweepValues|1"
element 2 "Name" "GUI_Sel_Data.TL_PushButtons"
element 2 "Value" "TL|OR=VE:TO=FW&dummy|<none>|#15TL_OK:#218PB_Show_mdm_Header:#219PB_UndoLsyncSorting:#14Sep1:#215PB_Load_another:#14Sep2:#218PB_Apply_Selection:#14Sep3:#14Sep4:#213TL_Plot_Setup:#211PB_DelPlots:#15Sep11:#211PB_Save_mdm:#15Sep12:#15Space|1"
element 3 "Name" "GUI_Sel_Data.TL_PushButtons.Space"
element 3 "Value" "TL|<none>|AC=#214gui_Export_mdm&#17Execute|<none>|0"
element 4 "Name" "GUI_Sel_Data.TL_PushButtons.PB_Show_mdm_Header"
element 4 "Value" "PB|CA=#221Show .mdm File Header:TO=FH&dummy|AC=#219gui_View_mdm_Header&#17Execute|<none>|0"
element 5 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup"
element 5 "Value" "TL|CA=#235For Currently Loaded Biases/Devices:OR=VE|<none>|#217TL_NrSweepIndices:#212DC_PlotTypes:#211TL_PlotAxes:#213TL_PlotStyles:#212TL_ShowPlots:#215PB_IdentifyData|1"
element 6 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.DC_PlotTypes"
element 6 "Value" "DC|CA=#216Select Plot Type:IT=%#19PlotTypes:SX=%#213PlotTypes_sel:TO=FH&dummy:VO=6|LS=#213Plot_Type_Sel&#17Execute|<none>|0"
element 7 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_PlotAxes.xAxisSelection"
element 7 "Value" "DC|CA=%#214PlotXaxisLabel:IT=%#210xAxisNames:SX=%#214xAxisNames_sel:TO=FH&dummy:VO=6|AC=#18gui_exit&#17Execute|<none>|0"
element 8 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_ShowPlots.PB_ShowPlot"
element 8 "Value" "PB|CA=#228\075\075> ShowPlot <\075\075:TO=FH&dummy|AC=#213gui_Show_Plot&#17Execute|<none>|0"
element 9 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.PB_IdentifyData"
element 9 "Value" "PB|CA=#226Show LSYNC Data Point Info:MF=%LsyncPresent:TO=FH&dummy|AC=#216gui_IdentifyData&#17Execute:EP=#216PlotInd2LsyncInd&#17Execute|<none>|0"
element 10 "Name" "GUI_Sel_Data.TL_PushButtons.Sep1"
element 10 "Value" "LA|TO=FH&dummy|<none>|<none>|0"
element 11 "Name" "GUI_Notes"
element 11 "Value" "TL|<none>|<none>|#16LA_txt|1|3"
element 12 "Name" "GUI_Notes.LA_txt"
element 12 "Value" "LA|CA=#218importing data ...:FI=FF:FG=C6|<none>|<none>|0"
element 13 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_NrSweepIndices.LA_NrSweepIndices"
element 13 "Value" "LA|CA=#226Info\072 Nr.sel.Sweep Pts.:TO=FH&MW|<none>|<none>|0"
element 14 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_NrSweepIndices"
element 14 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#217LA_NrSweepIndices:#217ED_NrSweepIndices:#213LA_HB_present:#214LA_SEG_present:#15space|1"
element 15 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_NrSweepIndices.ED_NrSweepIndices"
element 15 "Value" "ED|CO=10:ED=F:VA=%#214NrSweepIndices:TO=FW&FH|<none>|<none>|0"
element 16 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_NrSweepIndices.space"
element 16 "Value" "TL|<none>|<none>|<none>|0"
element 17 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_NrSweepIndices.LA_HB_present"
element 17 "Value" "LA|CA=#18incl. HB:MF=%HB_present|<none>|<none>|0"
element 18 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_mdmFilename"
element 18 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#215LA_mdm_FileName:#15Space:#214LA_SEG_Present:#213LA_HB_Present|1"
element 19 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_mdmFilename.Space"
element 19 "Value" "TL|<none>|<none>|<none>|0"
element 20 "Name" "GUI_ViewMdmHeader"
element 20 "Value" "TL|HT=600:OR=VE:WD=800|<none>|#19ED_Header:#15PB_OK|0|2"
element 21 "Name" "GUI_ViewMdmHeader.PB_OK"
element 21 "Value" "PB|CA=#12OK:TO=FW&FH&TR|AC=#217GUI_ViewMdmHeader&#222Destroy GUI,mdm Header|<none>|0"
element 22 "Name" "GUI_ViewMdmHeader.ED_Header"
element 22 "Value" "ED|EM=ML:ED=F:VA=%#16TmpVar|<none>|<none>|0"
element 23 "Name" "GUI_Sel_Data.TL_PushButtons.Sep2"
element 23 "Value" "LA|CA=#227^^^^^^^^^^^^^^^^^^^^^^^^^^^:TO=FH&dummy|<none>|<none>|1"
element 24 "Name" "GUI_Sel_Data.TL_PushButtons.PB_Apply_Selection"
element 24 "Value" "PB|CA=#247\075\075> Re-Load Sel. Biases/Devices <\075\075:TO=FH&dummy|AC=#227gui_Apply_Stimuli_Selection&#17Execute|<none>|0"
element 25 "Name" "GUI_Sel_Data.TL_PushButtons.Sep3"
element 25 "Value" "LA|CA=#227^^^^^^^^^^^^^^^^^^^^^^^^^^^:TO=FH&dummy|<none>|<none>|0"
element 26 "Name" "GUI_Sel_Data.TL_PushButtons.PB_UndoLsyncSorting"
element 26 "Value" "PB|CA=#230Undo Sorting (of LSYNC Inputs):MF=%LsyncPresent:TO=FH&dummy|AC=#218gui_Undo_Sort_Data&#17Execute|<none>|0"
element 27 "Name" "GUI_Sel_Data.TL_PushButtons.PB_Save_mdm"
element 27 "Value" "PB|CA=#248\075\075> Save Loaded To New .mdm File <\075\075:TO=FH&dummy|AC=#222gui_Prepare_Export_mdm&#17Execute|<none>|0"
element 28 "Name" "GUI_Sel_Data.TL_PushButtons.Sep4"
element 28 "Value" "LA|TO=FH&dummy|<none>|<none>|0"
element 29 "Name" "GUI_SweepOrders"
element 29 "Value" "TL|OR=HO|CA=#214gui_Export_mdm&#17Execute|#219TL_SweepIndex_Order:#15TL_OK|0|0"
element 30 "Name" "GUI_SweepOrders.TL_SweepIndex_Order.TL_Index.LI_SweepOrderSequence"
element 30 "Value" "LI|CA=#214Sweep\012Index:IT=%#213AllSweepIndex:TO=FH&LH|<none>|<none>|1"
element 31 "Name" "GUI_SweepOrders.TL_SweepIndex_Order.TL_Index"
element 31 "Value" "TL|TO=MW&dummy|<none>|#221LI_SweepOrderSequence:#13sep|0"
element 32 "Name" "GUI_SweepOrders.TL_SweepIndex_Order.TL_Index.sep"
element 32 "Value" "LA|<none>|<none>|<none>|0"
element 33 "Name" "GUI_SweepOrders.TL_OK.PB_OK"
element 33 "Value" "PB|CA=#12OK:TO=FW&FH|AC=#214gui_Export_mdm&#17Execute|<none>|0"
element 34 "Name" "GUI_SweepOrders.TL_OK"
element 34 "Value" "TL|OR=VE|<none>|#15PB_OK:#15Space|1"
element 35 "Name" "GUI_SweepOrders.TL_OK.Space"
element 35 "Value" "TL|<none>|<none>|<none>|0"
element 36 "Name" "GUI_SweepOrders.TL_SweepIndex_Order"
element 36 "Value" "TL|CA=#218Check Sweep Orders:OR=HO|<none>|#18TL_Index:#216TL_SelSweepOrder|0"
element 37 "Name" "GUI_SweepOrders.TL_SweepIndex_Order.TL_SelSweepOrder"
element 37 "Value" "TL|OR=VE:TO=MW&dummy|<none>|#213LI_SweepOrder:#19PB_MoveUp|1"
element 38 "Name" "GUI_SweepOrders.TL_SweepIndex_Order.TL_SelSweepOrder.PB_MoveUp"
element 38 "Value" "PB|CA=#17Move Up:TO=MH&LH|AC=#215gui_OrderSweeps&#17Execute|<none>|0"
element 39 "Name" "GUI_SweepOrders.TL_SweepIndex_Order.TL_SelSweepOrder.LI_SweepOrder"
element 39 "Value" "LI|CA=#213Sweep\012Name:IT=%#213AllSweepNames:SX=%#217AllSweepNames_sel:SY=SS:SF=T|<none>|<none>|0"
element 40 "Name" "GUI_Sel_Data.TL_PushButtons.TL_OK"
element 40 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#15Space:#15PB_OK|1"
element 41 "Name" "GUI_Sel_Data.TL_PushButtons.TL_OK.Space"
element 41 "Value" "TL|<none>|<none>|<none>|0"
element 42 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_NrSweepIndices.LA_SEG_present"
element 42 "Value" "LA|CA=#19incl. SEG:MF=%SEG_present|<none>|<none>|0"
element 43 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_PlotStyles.DL_LineStyle"
element 43 "Value" "DL|CA=#210Line Style:IT=%#19LineStyle:SX=%#213LineStyle_sel:TO=FH&dummy:VO=6|TC=#219GUI_PlotSymbolsOnly&#17Execute|<none>|0"
element 44 "Name" "GUI_Sel_Data.TL_PushButtons.PB_DelPlots"
element 44 "Value" "PB|CA=#216Delete all Plots:TO=FH&dummy|AC=#216gui_Delete_Plots&#17Execute|<none>|0"
element 45 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_PlotAxes"
element 45 "Value" "TL|OR=HO|<none>|#214xAxisSelection:#214yAxisSelection|1"
element 46 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_PlotAxes.yAxisSelection"
element 46 "Value" "DC|CA=%#214PlotYaxisLabel:IT=%#210yAxisNames:SX=%#214yAxisNames_sel:TO=FH&dummy:VO=6|AC=#18gui_exit&#17Execute|<none>|0"
element 47 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_PlotStyles"
element 47 "Value" "TL|OR=HO|<none>|#212DL_LineStyle:#212DL_LineColor:#212ED_LineWidth|1"
element 48 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_PlotStyles.DL_LineColor"
element 48 "Value" "DL|CA=#210Line Color:IT=%#19LineColor:SX=%#213LineColor_sel:TO=FH&dummy:VO=6|TC=#219GUI_PlotSymbolsOnly&#17Execute|<none>|0"
element 49 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_ShowPlots"
element 49 "Value" "TL|OR=HO:TO=FW&FH|<none>|#211PB_ShowPlot:#214TL_PlotFeature|1"
element 50 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_ShowPlots.TL_PlotFeature.CB_Plots2MP"
element 50 "Value" "CB|CA=#19MultiPlot:TO=FW&FH:TS=%Plots2MP|<none>|<none>|0|4"
element 51 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_PlotStyles.ED_LineWidth"
element 51 "Value" "SB|CA=#210Line Width:CO=6:MX=9:MN=0:TO=FW&FH:SS=%#221PLOT_TRACE_LINE_WIDTH|<none>|<none>|0"
element 52 "Name" "GUI_Sel_Data.TL_PushButtons.Sep11"
element 52 "Value" "LA|CA=#227^^^^^^^^^^^^^^^^^^^^^^^^^^^:TO=FH&dummy|<none>|<none>|1"
element 53 "Name" "GUI_Sel_Data.TL_PushButtons.Sep12"
element 53 "Value" "LA|CA=#227^^^^^^^^^^^^^^^^^^^^^^^^^^^:TO=FH&dummy|<none>|<none>|1"
element 54 "Name" "GUI_Sel_Data.TL_PushButtons.TL_OK.PB_OK"
element 54 "Value" "PB|CA=#19OK, Done!:TO=FW&FH|AC=#16gui_OK&#17Execute|<none>|0"
element 55 "Name" "GUI_Sel_Data.TL_PushButtons.PB_Load_another"
element 55 "Value" "PB|CA=#217Load another .mdm:TO=FH&dummy|AC=#220gui_Load_Another_mdm&#17Execute|<none>|0"
element 56 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_mdmFilename.LA_SEG_Present"
element 56 "Value" "LA|BG=C3:CA=#263Sweep Type SEG is currently not supported\072  i.e. not shown !:MF=%SEG_present:TO=FW&FH|<none>|<none>|0"
element 57 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_mdmFilename.LA_HB_Present"
element 57 "Value" "LA|BG=C3:CA=#262Sweep Type HB is currently not supported\072  i.e. not shown !:MF=%HB_present:TO=FW&FH|<none>|<none>|0"
element 58 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_ShowPlots.TL_PlotFeature"
element 58 "Value" "TL|OR=VE|<none>|#211CB_Plots2MP:#217CB_PlotsAreaTools|1|4"
element 59 "Name" "GUI_Sel_Data.TL_PushButtons.TL_Plot_Setup.TL_ShowPlots.TL_PlotFeature.CB_PlotsAreaTools"
element 59 "Value" "CB|CA=#19AreaTools:SF=%PlotAvailable:TO=FW&FH:TS=%ShowAreaTools|TC=#218gui_AreaToolsOnOff&#17Execute|<none>|0|4"
element 60 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_mdmFilename.LA_mdm_FileName"
element 60 "Value" "LA|CA=%#211PlotMdmName:FG=C6|<none>|<none>|0"
element 61 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues"
element 61 "Value" "TS|OR=HO|<none>|#19LI_Sweep0:#19LI_Sweep1:#17TL_Col0:#17TL_Col1|0"
element 62 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.LI_Sweep0"
element 62 "Value" "LI|CA=#12vd:IT=%#212Sweep1Values:SI=%#216Sweep1Values_sel:SY=ES:VI=20|LS=#218get_NrSweepIndices&#17Execute|<none>|0"
element 63 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.LI_Sweep1"
element 63 "Value" "LI|CA=#12vg:IT=%#212Sweep2Values:SI=%#216Sweep2Values_sel:SY=ES:VI=20|LS=#218get_NrSweepIndices&#17Execute|<none>|0"
element 64 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col0"
element 64 "Value" "TL|CA=#19 MASTER  :OR=VE|<none>|#210LA_ColName:#210PB_sort_up:#212PB_sort_down:#210PB_move_up:#212PB_move_down:#212LI_Instances|0"
element 65 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col0.LA_ColName"
element 65 "Value" "LA|CA=#19NFING_swp:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 66 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col0.PB_sort_up"
element 66 "Value" "PB|CA=#214Sort All /\134:TO=FH&dummy|AC=#213gui_Sort_Data&#211Execute,0,u|<none>|0"
element 67 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col0.PB_sort_down"
element 67 "Value" "PB|CA=#214Sort All \134/:TO=FH&dummy|AC=#213gui_Sort_Data&#211Execute,0,d|<none>|0"
element 68 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col0.PB_move_up"
element 68 "Value" "PB|CA=#17Move Up:TO=FH&dummy|AC=#213gui_Move_Data&#19Execute,u|<none>|0"
element 69 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col0.PB_move_down"
element 69 "Value" "PB|CA=#19Move Down:TO=FH&dummy|AC=#213gui_Move_Data&#19Execute,d|<none>|0"
element 70 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col0.LI_Instances"
element 70 "Value" "LI|IT=%#14Col0:SI=%#19Index_sel:SY=ES:VI=5|LS=#218get_NrSweepIndices&#17Execute|<none>|0"
element 71 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col1"
element 71 "Value" "TL|CA=#18LSYNC #1:OR=VE|<none>|#210LA_ColName:#210PB_sort_up:#212PB_sort_down:#210PB_move_up:#212PB_move_down:#212LI_Instances|0"
element 72 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col1.LA_ColName"
element 72 "Value" "LA|CA=#19WFING_swp:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 73 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col1.PB_sort_up"
element 73 "Value" "PB|CA=#214Sort All /\134:TO=FH&dummy|AC=#213gui_Sort_Data&#211Execute,1,u|<none>|0"
element 74 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col1.PB_sort_down"
element 74 "Value" "PB|CA=#214Sort All \134/:TO=FH&dummy|AC=#213gui_Sort_Data&#211Execute,1,d|<none>|0"
element 75 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col1.PB_move_up"
element 75 "Value" "PB|CA=#17Move Up:TO=FH&dummy|AC=#213gui_Move_Data&#19Execute,u|<none>|0"
element 76 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col1.PB_move_down"
element 76 "Value" "PB|CA=#19Move Down:TO=FH&dummy|AC=#213gui_Move_Data&#19Execute,d|<none>|0"
element 77 "Name" "GUI_Sel_Data.TL_SweepValuesParent.TL_SweepValues.TL_Col1.LI_Instances"
element 77 "Value" "LI|IT=%#14Col1:SI=%#19Index_sel:SY=ES:VI=5|LS=#218get_NrSweepIndices&#17Execute|<none>|0"
element 78 "Name" ""
element 78 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 ! The Programs in this Setup assist with inspecting 
 ! and cutting an existing .mdm file into pieces.
 
 ! ==> Hit 'START_ANALYZER' to start <==
  
 ! A user-selected .mdm file will be loaded 
 ! and all its Inputs (bias/device info) will be stored in 
 ! SetupVariables and be displayed in the user interface (GUI).
 !  Note: These stimuli values will stay there as SetupVariables, 
 !        independent of what subset of stimuli is currently loaded.
 !  -> the user can now analyze the data in free configurable Plots
 !  -> the Program displays S12 and S21 when a Polar Diagram is selected, 
 !      S11 and S22 when a Smith Chart is selected
 !  -> when displaying multi-dimensional data (e.g. Spars) using an XY Plot,
 !      the Program takes the first index, e.g. S.11
 !  ___________________________________________________________________________
 !
 ! IMPORTANT HINT: For big mdm files  (more than ~10.000 data points),
 !  and when you want to select subsets of data (to get a smaller mdm file),
 !  unselect first all stimuli, and then select the requested data points.
 !  This avoids slow GUI performance !
 !  ___________________________________________________________________________
 !
 !  When the user has selected a subset of stimulus values,
 !  and then hits the button 
 !        '==> Re-Load Selected Biases/Devices <=='
 !  the data for this subset of stimuli is then loaded from the original .mdm file 
 !  into this session.
 !  -> to save the user-selected biases/devices 
 !     (i.e. a subset of the originally available .mdm file contents)
 !     into a new .mdm file, hit the button 
 !     '==> Save Re-Loaded To New .mdm File <=='!
 !  ____________________________________________________________________________
 !
 !  ## if LSYNC sweeps are present, 
 !    -> their index order can be re-organized 
 !         by the buttons 'Move Up' and 'Move Down'.
 !    -> they can also be sorted.
 !         Hit the buttons 'Sort All /\' and 'Sort All \/'.
 ! Note: When you have re-sorted the stimuli (buttons 'Move Up' and 'Move Down'),
 !    you need to re-load the meas. data from the .mdm file:
 !    ### Hit the button   '==> Re-Load Selected Biases/Devices <=='
 !  ____________________________________________________________________________
 !
 !
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 !##################################################
 ! HOW TO USE
 ! ==============
 ! Just execute 'START_ANALYZER'.
 !##################################################
 
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "START_MDM_ANALYZER" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  DirFileName
 GLOBAL_VAR  PlotMdmName
 GLOBAL_VAR  Index_sel
 GLOBAL_VAR  LineStyle_sel
 GLOBAL_VAR  LineColor_sel
 GLOBAL_VAR  ShowAreaTools
 GLOBAL_VAR  PLOT_TRACE_LINE_WIDTH
 GLOBAL_VAR  Plots2MP
 GLOBAL_VAR  MDM_VALUES_LIST
 GLOBAL_VAR  PlotAvailable
 
 !---------------------------
 
 
 Plots2MP = 1
 PlotAvailable = 0		!control variable for GUI
 PLOT_TRACE_LINE_WIDTH = 0     !thin curve traces
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 ErrMsg    = ""
 Index_sel = "ICCAP_ARRAY[0]"
 ShowAreaTools = 1
 LineStyle_sel = 0
 LineColor_sel = 0
 MDM_VALUES_LIST = ""
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 !---first, delete a possibly existing GUI and Plots
 ICCAP_FUNC("./GUI_Sel_Data", "Destroy GUI", "Select Stimuli")
 ICCAP_FUNC("gui_Delete_Plots", "Execute")		!delete all Plots (when START_MDM_ANALYZER was called from the GUI)
 
 
 !---open mdm file browser (will return DirName and DirFileName)
 ICCAP_FUNC("Browse_mdm_File", "Execute")
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---prep DirFileName for  Plot
 PlotMdmName="mdm DirFileName: "&VAL$(DirFileName)
 IF STRLEN(VAL$(PlotMdmName)) > 100 THEN
   PlotMdmName=VAL$(SUBSTR$(VAL$(PlotMdmName), 1, 40)) & " ... " & VAL$(SUBSTR$(VAL$(PlotMdmName), STRLEN(VAL$(PlotMdmName))-50))
 END IF
 
 
 !---import data
 ICCAP_FUNC("./GUI_Notes", "Display Modeless GUI", "Notes")	! show something in case the data loading and analysis takes a while
 ICCAP_FUNC(".", "Import Create", VAL$(DirFileName))
 ICCAP_FUNC("Manage_ICCAP_VALUE_Vars", "Execute", "Add_to_MDM_VALUES_LIST")
 
 
 !---prepare GUI for 'physical sweeps' (V, I, freq etc.)
 ICCAP_FUNC("Plot_Type_Sel", "Execute")
 ICCAP_FUNC("Identify_Sweeps", "Execute")
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING VAL$(ErrMsg)&"   [OK]", dummy
   ICCAP_FUNC("./GUI_Notes", "Destroy GUI", "Notes")
   RETURN_VALUE 0
 END IF
 ICCAP_FUNC("Get_Sweep_Values", "Execute")
 ICCAP_FUNC("Create_GUI", "Execute")
 
 
 !---handle addt'l GUI for instances (LSYNCs)
 ICCAP_FUNC("Lsync_Prep_Gui_Settings", "Execute")
 IF Lsync_Prep_Gui_Settings[0]<> 2 THEN		! There are LSYNCs present in the .mdm file
   ICCAP_FUNC("Lsync_Create_Gui", "Execute")
 END IF
 
 
 !---update nr. of selected indices (at startup: all are selected)
 ICCAP_FUNC("get_NrSweepIndices", "Execute")
 
 
 !---close 'importing data ...'  GUI
 ICCAP_FUNC("./GUI_Notes", "Destroy GUI", "Notes")
 
 
 !---if LSYNCs are present, verify that the sequence of LSYNC Inputs is located *after* their Master Input
 ICCAP_FUNC("Lsync_Check_Orders", "Execute")
 
 
 !---open the Analyze-and-Cut-GUI
 PRINT "opening the GUI ...   pls. wait ..."
 ICCAP_FUNC("./GUI_Sel_Data", "Display Modeless GUI", "Select Stimuli")
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member XFORM "Lsync_Prep_Gui_Settings"
}
LINK XFORM "______________________1" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "Browse_mdm_File" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR  MDM_FILE_PATH
 GLOBAL_VAR  DirName             ! DUT Variable
 GLOBAL_VAR  DirFileName
 GLOBAL_VAR  ErrMsg
 
 
 ErrMsg = ""
 
 
 !---Call the central dir-file-browser GUI, anticipating its GET_STRINGs
 GUIheader = "Select an .mdm file for analyzing its data and (optionally) cutting it into sub-sweeps."
 Suffix    = "mdm"
 FilenameWildCard  = "*"
 SelPolicy = "Single"	! Single, Multi
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), SYS_PATH$(VAL$(DirName)), VAL$(Suffix), VAL$(FilenameWildCard), VAL$(SelPolicy))
 !############################################################################
 
 !---Check if user canceled the GUI
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 !---Get the selected file incl. its path back to this Model file
 FileName=LOOKUP_VAR(VAL$(Path2Utilities)&"/FileNames")
 !---Get also the dirname as a default directory for next execution of this PEL Program
 MDM_FILE_PATH=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
 
 !---Set SetupVariables
 DirName = VAL$(MDM_FILE_PATH)
 DirFileName = VAL$(DirName)&"/"&VAL$(FileName)
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Identify_Sweeps" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program identifies the Input sweeps, 
 ! which are no parent of LSYNC sweeps.
 ! In SetupVariables, it then creates 
 ! ICCAP_ARRAYs to hold the values 
 ! of the swept Inputs, i.e. it creates
 !    -> SweepxValues
 !    -> SweepxValues_sel
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR  AllSweepIndex
 GLOBAL_VAR  AllSweepNames		! List of Inputs which host a sweep
 GLOBAL_VAR  SweepNames		! List of Inputs which host a sweep, except the Master Sweep of LSYNC children
 GLOBAL_VAR  InputNames		! List of all available Inputs
 GLOBAL_VAR  MasterSweepName
 GLOBAL_VAR  TmpVar
 GLOBAL_VAR  ErrMsg
 
 ! NOTE: This PEL
 ! -> creates ICCAP_ARRAY SweepxValues
 ! -> creates ICCAP_ARRAY SweepxValues_sel
 !------------------------------------------------
 
 ErrMsg=""
 
 !---identify sweeps and their orders
 AllSweepNames=""
 AllSweepIndex=""
 i=1
 LOOP
   dummy= USERC_sweep_name(i, ".", TmpVar)
   EXIT IF VAL$(TmpVar)==""
   DIMENSION_ARRAY(AllSweepNames, i)
   DIMENSION_ARRAY(AllSweepIndex, i)
   AllSweepNames[i-1] = VAL$(TmpVar)
   AllSweepIndex[i-1] = i
   i = i + 1
 END LOOP
 
 
 !---check if no sweeps had been present in .mdm file
 IF VAL$(AllSweepNames)=="" THEN
   ErrMsg = "NOTE: selected .mdm file does not contain any sweeps !"
   RETURN_VALUE -1
 END IF
 	
 
 dummy=ARRAY_COPY(AllSweepNames, SweepNames)
 
 !---delete LSYNC MasterSweep from 'SweepNames' (because it is treated together with its LSYNC children)
 ICCAP_FIND_CHILDREN ".", "Input", InputNames
 MasterSweepName=""
 FOR iInput=0 TO SIZEOF(InputNames)-1
   ErrMsg=""
   MasterSweepName = LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "Master Sweep", ErrMsg)
   !---verify if sweep type is LSYNC  (Background: sweep type SYNC also has field 'Master Sweep'
   SweepType = LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "Sweep Type", ErrMsg)
   IF VAL$(SweepType)=="SYNC" THEN ErrMsg = "it's no LSYNC"
   IF VAL$(ErrMsg)=="" THEN
     FOR iSweepNames=0 TO SIZEOF(SweepNames)-1
       IF VAL$(SweepNames[iSweepNames]) == VAL$(MasterSweepName) THEN
         dummy = ARRAY_REMOVE_AT(SweepNames, iSweepNames)
         iSweepNames = SIZEOF(SweepNames)		!exit the loop
         iInput      = SIZEOF(InputNames)
       END IF
     NEXT iSweepNames
   END IF
 NEXT iInput
 
 
 
 !---create ICCAP_ARRAY for every swept Input
 ErrMsg=""
 ! delete previous ICCAP_ARRAYs 'SweepxValues' and 'SweepxValues_sel'
 i=1
 ErrStr=""
 WHILE ErrStr=="" 
   !before deleting, check, if this Variable exists !!!
   dummy=LOOKUP_VAR("Sweep"&VAL$(i)&"Values", ErrStr)
   IF VAL$(ErrStr)=="" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name[Sweep"&VAL$(i)&"Values]", "") 
     ICCAP_FUNC(".", "SetTableFieldValue", "Name[Sweep"&VAL$(i)&"Values_sel]", "") 
     i = i + 1
   END IF
 END WHILE
 
 
 ! create new ICCAP_ARRAYs 'SweepxValues' and 'SweepxValues_sel'
 FOR i=1 TO SIZEOF(SweepNames)
   !---identify nr. of sweep points to set size of new array
   SweepType = VAL$(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "Sweep Type"))
   IF VAL$(SweepType)=="LIST"  THEN 
     ActSweepPts = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "# of Values"))
   ELSE IF VAL$(SweepType)=="TLIST" THEN 
     ActSweepPts = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "# of Values"))
   ELSE IF VAL$(SweepType)=="LIN"   THEN 
     ActSweepPts = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "# of Points"))
   ELSE IF VAL$(SweepType)=="LIN_DOUBLE" THEN
     ActSweepPts = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "# of Points"))
   ELSE IF VAL$(SweepType)=="LOG"   THEN 
     ActSweepPts = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "Total Pts"))
   ELSE IF VAL$(SweepType)=="HB"    THEN 
     ActSweepPts = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "Saved Order"))+1		! add 1 to also cover included DC !
   ELSE IF VAL$(SweepType)=="SEG"   THEN 
     ActSweepPts = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "# of Segments"))*(VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[i-1]), "# of Points"))-1)
   ELSE
     ErrMsg = "ERROR: .mdm file contains sweep type(s) currently not supported !
       Please adjust Transform /UTILITIES/MDM_UTILITIES/ANALYZE_AND_CUT_MDM_FILES/Identify_Sweeps"
       RETURN_VALUE -1
   END IF
   ICCAP_FUNC(".", "CreateVariableTableVariable", "Sweep"&VAL$(i)&"Values")
   ICCAP_FUNC(".", "SetVariableTableValue", "Sweep"&VAL$(i)&"Values", "ICCAP_ARRAY["&VAL$(ActSweepPts)&"]")
 
   ICCAP_FUNC(".", "CreateVariableTableVariable", "Sweep"&VAL$(i)&"Values_sel")
   ICCAP_FUNC(".", "SetVariableTableValue", "Sweep"&VAL$(i)&"Values_sel", "ICCAP_ARRAY["&VAL$(ActSweepPts)&"]")
 NEXT i
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Get_Sweep_Values" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program fills the ICCAP_ARRAYs 'SweepxData' and 'SweepxData_sel' with data
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR  SweepNames
 !------------------------------------------------
 
 iSweep=1
 WHILE iSweep < SIZEOF(SweepNames)+1
 
   ! get SweepOrder of current SweepName
   act_SweepOrder = VAL(LOOKUP_TABLE_VAL(VAL$(SweepNames[iSweep-1]), "Sweep Order"))
 
   ! identify index stepping
   IndexStepping=1
   i=1
   WHILE i< act_SweepOrder
     IndexStepping = IndexStepping * USERC_num_of_points(i, ".")
     i = i + 1
   END WHILE
 
   !---populate act. array 'SweepXValues'
   SweepType = VAL$(LOOKUP_TABLE_VAL(VAL$(SweepNames[iSweep-1]), "Sweep Type"))
   IF VAL$(SweepType)<>"TLIST" THEN
     !---handle numbers
     tmpInput = DATASET("quiet "&VAL$(SweepNames[iSweep-1]))
     i=0
     imax = USERC_num_of_points(act_SweepOrder, ".")
     IF VAL$(SweepType)=="SEG" THEN imax = imax -1
     WHILE i < imax
       SweepValue = tmpInput[i*IndexStepping]
       ICCAP_FUNC(".", "SetVariableTableValue", "Sweep"&VAL$(iSweep)&"Values["&VAL$(i)&"]", SweepValue)
       ! preset value selection to 'all selected' (this is required for sorting: all selected biases will be re-loaded!)
       ICCAP_FUNC(".", "SetVariableTableValue", "Sweep"&VAL$(iSweep)&"Values_sel["&VAL$(i)&"]", i)
       i = i + 1
     END WHILE
   ELSE
     !---handle strings
     i=0
     WHILE i < USERC_num_of_points(act_SweepOrder, ".")
       SweepValue = VAL$(LOOKUP_TABLE_VAL(VAL$(SweepNames[iSweep-1]), "Value "&VAL$(i+1)))
       ICCAP_FUNC(".", "SetVariableTableValue", "Sweep"&VAL$(iSweep)&"Values["&VAL$(i)&"]", VAL$(SweepValue))
       ! preset value selection to 'all selected' (this is required for sorting: all selected biases will be re-loaded!)
       ICCAP_FUNC(".", "SetVariableTableValue", "Sweep"&VAL$(iSweep)&"Values_sel["&VAL$(i)&"]", i)
       i = i + 1
     END WHILE
   END IF
 
   iSweep = iSweep + 1
 END WHILE
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Create_GUI" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! this Program creates the GUI items for the stimulus (Inputs) -except LSYNCs- in the analyze-and-cut-GUI
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR SweepNames
 GLOBAL_VAR HB_present
 GLOBAL_VAR SEG_present
 !------------------------------------------------
 
 HB_present=0	!switch on/off info (about HB included in mdm) in GUI (nr.sel.sweeps)
 SEG_present=0       !  dto for SEG included in .mdm
 
 !First specify some useful local variables
 ParentGui = "./GUI_Sel_Data.TL_SweepValuesParent"
 ChildGui1 = "TL_SweepValues"
 Path2Gui=VAL$(ParentGui)&"."&VAL$(ChildGui1)
 
 
 !=====Remove existing child GUI======================
 ICCAP_FUNC("./"&VAL$(Path2Gui), "Delete")
 
 
 !=====Create a new child GUI===============
 ChildObject="TS"		!###>ScrollTable
 ICCAP_FUNC(ParentGui, "Add GUI", ChildGui1, ChildObject)
 !Specify Horizontal Orientation
 ICCAP_FUNC(Path2Gui, "Set GUI Options", "OR=HO", "")
 
 
 !======Add a List-GUI for every Sweep to that table======================
 FOR i=0 TO SIZEOF(SweepNames)-1
   ActSweepType=LOOKUP_TABLE_VAL(VAL$(SweepNames[i]), "Sweep Type")
   IF (VAL$(ActSweepType)=="HB") OR (VAL$(ActSweepType)=="HB2") THEN 
     HB_present=1
     CONTINUE	! <====start next iteration
   END IF
   IF (VAL$(ActSweepType)=="SEG")THEN 
     SEG_present=1
     CONTINUE	! <====start next iteration
   END IF
 
   Path2Gui    = VAL$(ParentGui)&"."&VAL$(ChildGui1)
   ChildGui2   = "LI_Sweep"&VAL$(i)
   ChildObject = "LI"		!###>List
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildGui2, ChildObject)
 
   Path2Gui=VAL$(Path2Gui)&"."&VAL$(ChildGui2)
   !---Specify Caption 
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "CA="&VAL$(SweepNames[i]), "")
   !---Specify Items 
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "IT=Sweep"&VAL$(i+1)&"Values", "")
   !---Specify Selection Policy
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "SY=ES", "")
   !---Specify Selected Indices 
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "SI=Sweep"&VAL$(i+1)&"Values_sel", "")
   !---Specify visible items count
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "VI=20", "")
   !---Specify callback (execute Xfm "get_NrSweepIndices" for every item selection
   ICCAP_FUNC(Path2Gui, "Set GUI Callback", "LS", "get_NrSweepIndices", "Execute", "")
 NEXT i
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "get_NrSweepIndices" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! this Program calculates the size of the currently selected data
 
 
 
 GLOBAL_VAR  NrSweepIndices
 GLOBAL_VAR  SweepNames
 GLOBAL_VAR  LsyncPresent
 GLOBAL_VAR  Index_sel
 
 
 NrSweepIndices=1
 FOR i=0 TO SIZEOF(SweepNames)-1
   actSweepValues_sel = "Sweep"&VAL$(i+1)&"Values_sel"
   NrSweepIndices = NrSweepIndices * VAL(LOOKUP_VAR(VAL$(actSweepValues_sel)))
 NEXT i
 
 IF VAL(LsyncPresent)==1 THEN
   NrSweepIndices = NrSweepIndices * SIZEOF(Index_sel)
 END IF
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Load_Another_mdm" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 ICCAP_FUNC("START_MDM_ANALYZER",   "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "______________________2" "711.501"
{
}
LINK XFORM "Lsync_Prep_Gui_Settings" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR InputNames
 GLOBAL_VAR ColNames		!Names of the LSYNC Inputs, incl. the 'Master Sweep'
 GLOBAL_VAR ColSize		!Size of the LSYNC values, as specified in the LSYNC 'Master Sweep'
 GLOBAL_VAR Index		!used for sorting the LSYNC values
 GLOBAL_VAR Index_sel
 GLOBAL_VAR LsyncPresent	!used to manage GUI items
 !-------------------------------------------------------
 
 
 ErrMsg=""
 
 !---identify all Inputs
 ICCAP_FIND_CHILDREN ".", "Input", InputNames
 
 
 !---identify those Inputs which are of SweepType LSYNC or TLSYNC, incl. the LSYNC/TLSYNC MasterSweep
 ColNames="ICCAP_ARRAY[0]"
 N=0
 i=0
 WHILE i < SIZEOF(InputNames)
   IF (LOOKUP_TABLE_VAL(VAL$(InputNames[i]), "Sweep Type") == "LSYNC") OR (LOOKUP_TABLE_VAL(VAL$(InputNames[i]), "Sweep Type") == "TLSYNC") THEN
     IF N==0 THEN
       !---first find the MasterSweep
       ColNames = "ICCAP_ARRAY["&VAL$(N+1)&"]"
       ColNames[0] = LOOKUP_TABLE_VAL(VAL$(InputNames[i]), "Master Sweep")
       !---identify Nr.Points of Master LIST sweep
       !   if necessary, first change from LIN to LIST
       LsyncMasterSweepType = LOOKUP_TABLE_VAL(VAL$(ColNames[N]), "Sweep Type")
       IF VAL$(LsyncMasterSweepType)=="CON" THEN ICCAP_FUNC(VAL$(ColNames[N]), "STFV", "Sweep Type", "LIST")
       IF VAL$(LsyncMasterSweepType)=="LIN" THEN ICCAP_FUNC(VAL$(ColNames[N]), "STFV", "Sweep Type", "LIST")
       ColSize = LOOKUP_TABLE_VAL(VAL$(ColNames[N]), "# of Values")
       N = N + 1
     END IF
     !---add this Input to ColNames
     ColNames = "ICCAP_ARRAY["&VAL$(N+1)&"]"
     ColNames[N] = InputNames[i]
     N = N + 1
   END IF
   i = i + 1
 END WHILE
 
 
 !--exit if no LSYNCs/TLSYNCs are present
 IF N==0 THEN 
   LsyncPresent=0		  !.mdm file contains no LSYNC/TLSYNC sweeps
   RETURN_VALUE 2
 ELSE
   LsyncPresent=1
 END IF
 
 
 !---set Index (required for Sorting)
 Index="ICCAP_ARRAY["&VAL$(ColSize)&"]"
 i=0
 WHILE i < ColSize
   Index[i]=i
   i = i + 1
 END WHILE
 
 
 !---preset indices to 'all selected' (this is required for sorting: all selected biases will be re-loaded!)
 dummy = ARRAY_COPY(Index, Index_sel)
 
 
 !---delete possibly existing old Colx arrays 
 ErrStr=""
 iCol=0
 WHILE ErrStr==""
   VarName="Col"&VAL$(iCol)
   dummy=LOOKUP_VAR(VAL$(VarName), ErrStr)
   IF VAL$(ErrStr)=="" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
     iCol = iCol + 1
   END IF
 END WHILE
 
 
 !---now create the new Colx arrays and fill them with data of the LSYNC Inputs
 iCol=0
 WHILE iCol < SIZEOF(ColNames)
   VarName="Col"&VAL$(iCol)
   ICCAP_FUNC(".", "CreateVariableTableVariable", VAL$(VarName))
   ICCAP_FUNC(".", "SetVariableTableValue", VAL$(VarName), "ICCAP_ARRAY["&VAL$(ColSize)&"]")
   i=0
   WHILE i<ColSize
     TmpVal = LOOKUP_TABLE_VAL(VAL$(ColNames[iCol]), "Value "&VAL$(i+1))		!LIST and thus LSYNC indexing starts with '1'
     ICCAP_FUNC(".", "SetVariableTableValue", "Col"&VAL$(iCol)&"["&VAL$(i)&"]",VAL$(TmpVal))
     i = i+ 1
   END WHILE
   iCol = iCol + 1
 END WHILE
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list XFORM "START_MDM_ANALYZER"
}
LINK XFORM "Lsync_Create_Gui" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! this Program creates the GUI items for the LSYNCs in the analyze-and-cut-GUI
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR  ColNames		!Names of the LSYNC Inputs, incl. the 'Master Sweep'
 GLOBAL_VAR  ColSize
 !---------------------------------
 
 ErrMsg=""
 VisibleColumns=MIN(ColSize, 40)
 
 
 !First specify some useful local variables
 ParentGui = "./GUI_Sel_Data.TL_SweepValuesParent"
 ChildGui1 = "TL_SweepValues"
 Path2TopGui=VAL$(ParentGui)&"."&VAL$(ChildGui1)
 
 
 
 !---Add Gui items for each LSYNC data column
 i=0
 WHILE i < SIZEOF(ColNames)
   !###>Table
   ChildObject ="TL"
   ChildName   ="TL_Col"&VAL$(i)
   ICCAP_FUNC(Path2TopGui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Gui=VAL$(Path2TopGui)&"."&VAL$(ChildName)
   Caption="LSYNC #"&VAL$(i)
   IF i==0 THEN Caption=" MASTER  "
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "CA="&VAL$(Caption), "")
   !  Specify Orientation 
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "OR=VE","")
 
   !###>Label ColumnName
   ChildObject ="LA"
   ChildName   ="LA_ColName"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA="&VAL$(ColNames[i]), "FG=C6", "TO=FH", "")
 
 
   !###>Button Sort Ascendend
   ChildObject ="PB"
   ChildName   ="PB_sort_up"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA=Sort All /\", "TO=FH", "")
   !  Specify Callbacks
   ICCAP_FUNC(Path2Child, "Set GUI Callback", "AC", "gui_Sort_Data", "Execute,"&VAL$(i)&",u", "")
 
   !###>Button Sort Descendend
   ChildObject ="PB"
   ChildName   ="PB_sort_down"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA=Sort All \/", "TO=FH", "")
   !  Specify Callback
   ICCAP_FUNC(Path2Child, "Set GUI Callback", "AC", "gui_Sort_Data", "Execute,"&VAL$(i)&",d", "")
 
 
   !###>Button Move Up
   ChildObject ="PB"
   ChildName   ="PB_move_up"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA=Move Up", "TO=FH", "")
   !  Specify Callbacks
   ICCAP_FUNC(Path2Child, "Set GUI Callback", "AC", "gui_Move_Data", "Execute,u", "")
 
   !###>Button Move Down
   ChildObject ="PB"
   ChildName   ="PB_move_down"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA=Move Down", "TO=FH", "")
   !  Specify Callback
   ICCAP_FUNC(Path2Child, "Set GUI Callback", "AC", "gui_Move_Data", "Execute,d", "")
 
 
   !###>List
   ChildObject ="LI"
   ChildName   ="LI_Instances"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Items, Sel.Indices, Sel.Policy, Visible Items Count
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "IT=Col"&VAL$(i), "SI=%Index_sel", "SY=ES", "VI="&VAL$(VisibleColumns), "")
 
   !---Specify callback (execute Xfm "get_NrSweepIndices" for every item selection
   ICCAP_FUNC(Path2Child, "Set GUI Callback", "LS", "get_NrSweepIndices", "Execute", "")
 
   i = i + 1
 END WHILE
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Lsync_Check_Orders" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program verifies if the sequence of LSYNC Inputs is located *after* their master Input.
 ! If this is not the case, data import may not always work correctly.
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR  LsyncPresent
 GLOBAL_VAR  InputNames		!Names of all Inputs in their order
 GLOBAL_VAR  MasterSweepName
 GLOBAL_VAR  ColNames		!Names of the LSYNC Inputs, incl. the 'Master Sweep'
 GLOBAL_VAR  DirFileName
 !---------------------------------
 
 
 
 !---exit if no LSYNCs are present
 IF VAL(LsyncPresent)==0 THEN RETURN_VALUE 3
 
 
 
 !---re-identify Inputs and their orders (just in case)
 ICCAP_FIND_CHILDREN ".", "Input", InputNames
 
 LsyncAfterMaster=1
 MasterFound=0
 FOR i=0 TO SIZEOF(InputNames)-1
   IF VAL$(InputNames[i])==VAL$(MasterSweepName) THEN
     MasterFound = 1
   ELSE
     ErrMsg=""
     SweepType = LOOKUP_TABLE_VAL(VAL$(InputNames[i]), "Sweep Type", ErrMsg)
     IF (VAL$(SweepType)=="LSYNC") AND (MasterFound==0) THEN 
       LsyncAfterMaster = 0
       BREAK
     END IF
   END IF
 NEXT i
 
 
 !---exit if all is OK
 IF LsyncAfterMaster==1 THEN RETURN_VALUE 1
 
 
 
 GET_STRING "ERROR: In the loaded .mdm file, the sequence of LSYNC Inputs is not locaated *after* their Master Input !
   This may lead to problems when reading subsets of data from this .mdm file.
 
   -> Do you want to fix this problem by saving the .mdm in a correct state ? 
      [OK]      ==>  Strongly recommended !  <==
      [Cancel]  Ignore this message and continue", Dummy
 
 
 !---re-order the LSYNCs
 FOR i=0 TO SIZEOF(ColNames)-1
   IF VAL$(ColNames[i])<>VAL$(MasterSweepName) THEN
     ICCAP_FUNC(VAL$(ColNames[i]), "Save As", "tmp")
     ICCAP_FUNC(VAL$(ColNames[i]), "Delete")
     ICCAP_FUNC(".", "Open Input", "tmp")
   END IF
 NEXT i
 
 
 !---save the corrected .mdm
 ICCAP_FUNC(".", "Export Data Measured", VAL$(DirFileName))
 
 
 
 RETURN_VALUE 2
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Lsync_Import_Selected" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR   Index_sel		!selected index/indices of LSYNCs
 GLOBAL_VAR   Index
 GLOBAL_VAR   ColNames		!Names of the LSYNC Inputs, incl. the 'Master Sweep'
 GLOBAL_VAR   MDM_FILE_PATH
 GLOBAL_VAR   MDM_FILE_NAME
 !------------------------------------------
 
 
 ! This Program updates the LSYNC Inputs incl. the MasterSweep
 ! with the user-selected stimuli.
 ! => It is called by 'gui_Apply_Stimuli_Selection'.
 
 
 
 !---precheck
 IF SIZEOF(Index_sel)<1 THEN 
   GET_STRING "ERROR: No data indices were selected !  [OK]", dummy
   RETURN_VALUE 2
 END IF
 
 
 !---delete the Analyze-and-Cut-GUI (to speed-up)
 ICCAP_FUNC("./GUI_Sel_Data", "Destroy GUI", "Select Stimuli")
 
 
 !---set data size of LSYNC Master
 ICCAP_FUNC(VAL$(ColNames[0]), "SetTableFieldValue", "# of Values", VAL$(SIZEOF(Index_sel)))
 ICCAP_FUNC(VAL$(ColNames[0]), "Redisplay")
 
 
 !---if all are selected, reorder the Index_sel incrementally
 IF SIZEOF(Index_sel)==SIZEOF(Index) THEN
   dummy=ARRAY_SORT_NUM(Index_sel, 10)
 END IF 
 
 
 !---update LSYNC Inputs with user-selected stimuli values
 iCol=0
 WHILE iCol < SIZEOF(ColNames)
   i = 0
   WHILE i < SIZEOF(Index_sel)
     VarValue=LOOKUP_VAR("Col"&VAL$(iCol)&"["&VAL$(Index_sel[i])&"]")
     ICCAP_FUNC(VAL$(ColNames[iCol]), "SetTableFieldValue", "Value "&VAL$(i+1), VAL$(VarValue))	!LIST and thus LSYNC indexing starts with '1'
     i = i + 1
   END WHILE
 
   iCol = iCol + 1
 END WHILE
 
 
 !---import data
 mdm_DirFileName = VAL$(MDM_FILE_PATH)&"/"&VAL$(MDM_FILE_NAME)
 mdm_DirFileName = SYS_PATH$(mdm_DirFileName)		!make path oper.system independent
 ICCAP_FUNC(".", "Import Data", VAL$(mdm_DirFileName))
 
 
 !---re-open the Analyze-and-Cut-GUI
 ICCAP_FUNC("./GUI_Sel_Data", "Display Modeless GUI", "Select Stimuli")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Sort_Data" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR   MDM_FILE_PATH
 GLOBAL_VAR   MDM_FILE_NAME
 GLOBAL_VAR   ColSize		!Size of the LSYNC values, as specified in the LSYNC 'Master Sweep'
 GLOBAL_VAR   ColNames		!Names of the LSYNC Inputs, incl. the 'Master Sweep'
 GLOBAL_VAR   TmpVar			!temporary array, used during sorting
 GLOBAL_VAR   Index			!used for sorting the LSYNC values
 GLOBAL_VAR   Index_sel		!selected index/indices of LSYNCs
 !----------------------------------------
 
 
 !---to be answered from the calling GUI
 GET_STRING "Enter Colum Nr. to be sorted [0 ..2]", "1", ColNr
 GET_STRING "Sort upwards [u] or downwards [d], [none]", "u", SortMode
 
 
 !---delete the Analyze-and-Cut-GUI (to speed-up)
 ICCAP_FUNC("./GUI_Sel_Data", "Destroy GUI", "Select Stimuli")
 
 
 
 PRINT "---ImportCreate original data ..."
 mdm_DirFileName = VAL$(MDM_FILE_PATH)&"/"&VAL$(MDM_FILE_NAME)
 mdm_DirFileName = SYS_PATH$(mdm_DirFileName)		!make path oper.system independent
 ICCAP_FUNC(".", "Import Create", VAL$(mdm_DirFileName))
 
 
 !---get required Sorting Index from user-selected Data Column
 !   first copy sel. data column into array TmpVar
 TmpVar="ICCAP_ARRAY["&VAL$(ColSize)&"]"
 i=0
 WHILE i < ColSize
   TmpVar[i]= LOOKUP_VAR("Col"&VAL$(ColNr)&"["&VAL$(i)&"]")
   i = i + 1
 END WHILE
 
 
 !   apply sorting
 IF SortMode=="u" THEN dummy = ARRAY_SORT_NUM(TmpVar, 0, Index)
 IF SortMode=="d" THEN dummy = ARRAY_RSORT_NUM(TmpVar, 0, Index)
 
 
 PRINT "---sort all the LSYNC arrays after the Sorting Index ..."
 FOR iCol=0 TO SIZEOF(ColNames)-1
   PRINT "sorting LSYNC column nr.";iCol;" ... pls. wait..."
   dummy=ARRAY_REORDER("Col"&VAL$(iCol), "Index")
 NEXT iCol
 
 
 
 
 !---don't forget to also update also the Active-Data-Index, i.e. the user-selected index/indices
 IF SIZEOF(Index_sel)>0 THEN
   !one or more indices were selected
   iIndex_sel=0
   WHILE iIndex_sel < SIZEOF(Index_sel)
     iIndex=0
     WHILE iIndex<SIZEOF(Index)
       IF Index_sel[iIndex_sel]==Index[iIndex] THEN 
         Index_sel[iIndex_sel]=iIndex
         iIndex=SIZEOF(Index)
       END IF
       iIndex = iIndex + 1
     END WHILE
     iIndex_sel = iIndex_sel + 1
   END WHILE
 END IF
 
 
 !---re-open the Analyze-and-Cut-GUI
 ICCAP_FUNC("./GUI_Sel_Data", "Display Modeless GUI", "Select Stimuli")
 
 
 
 
 GET_STRING "To not only sort the Biases/Devices in the GUI,
   but to also update the currently loaded data, 
   hit '==> Re-Load Bias/Device Selection <=='  [OK]", dummy
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Undo_Sort_Data" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR   MDM_FILE_PATH
 GLOBAL_VAR   MDM_FILE_NAME
 GLOBAL_VAR   ColSize		!Size of the LSYNC values, as specified in the LSYNC 'Master Sweep'
 GLOBAL_VAR   ColNames		!Names of the LSYNC Inputs, incl. the 'Master Sweep'
 GLOBAL_VAR   Index			!used for sorting the LSYNC values
 GLOBAL_VAR   TmpVar			!temporary array, used during sorting
 GLOBAL_VAR   Index_sel		!selected index/indices of LSYNCs
 !--------------------------------------
 
 !---ImportCreate original data
 mdm_DirFileName = VAL$(MDM_FILE_PATH)&"/"&VAL$(MDM_FILE_NAME)
 mdm_DirFileName = SYS_PATH$(mdm_DirFileName)		!make path oper.system independent
 ICCAP_FUNC(".", "Import Create", VAL$(mdm_DirFileName))
 
 
 !---start the undo_sorting
 COMPLEX IndexPrevious.M[ColSize]
 iPrev=0
 WHILE iPrev < ColSize
   i=0
   WHILE i < ColSize
     IF Index[i]==iPrev THEN 
       IndexPrevious[iPrev]=i
       i = ColSize
     END IF
     i = i + 1
   END WHILE
   iPrev = iPrev + 1
 END WHILE
 
 
 !---sort all the arrays after the Sorting Index
 iCol=0
 WHILE iCol < SIZEOF(ColNames)
   !  get the unsorted ICCAP_ARRAY
   TmpVar="ICCAP_ARRAY["&VAL$(ColSize)&"]"
   i=0
   WHILE i < ColSize
     !in order to keep the engineering format (e.g. 1u instead of 1E-6), we need to do all variable handling as strings handling
     TmpVar[i]=VAL$(LOOKUP_VAR("Col"&VAL$(iCol)&"["&VAL$(IndexPrevious[i])&"]"))
     i = i + 1
   END WHILE
 
   !  and now set the sorted ICCAP_ARRAY
   i=0
   WHILE i < ColSize
     ICCAP_FUNC(".", "SetVariableTableValue", "Col"&VAL$(iCol)&"["&VAL$(i)&"]",VAL$(TmpVar[i]))
     i = i + 1
   END WHILE
 
   iCol = iCol + 1
 END WHILE
 !  reset aux.variable
 TmpVar=""
 
 
 !---don't forget to also update also the Active-Data-Index, i.e. the user-selected index/indices
 IF SIZEOF(Index_sel)>0 THEN
   !one or more indices were selected
   iIndex_sel=0
   WHILE iIndex_sel < SIZEOF(Index_sel)
     iIndex=0
     WHILE iIndex<SIZEOF(IndexPrevious)
       IF Index_sel[iIndex_sel]==IndexPrevious[iIndex] THEN 
         Index_sel[iIndex_sel]=iIndex
         iIndex=SIZEOF(IndexPrevious)
       END IF
       iIndex = iIndex + 1
     END WHILE
     iIndex_sel = iIndex_sel + 1
   END WHILE
 END IF
 
 
 !---finally, reload sorted data
 iCol=0
 WHILE iCol < SIZEOF(ColNames)
   i = 0
   WHILE i < ColSize
     VarValue=LOOKUP_VAR("Col"&VAL$(iCol)&"["&VAL$(i)&"]")
     ICCAP_FUNC(VAL$(ColNames[iCol]), "SetTableFieldValue", "Value "&VAL$(i+1), VAL$(VarValue))	!LIST and thus LSYNC indexing starts with '1'
     i = i + 1
   END WHILE
 
   iCol = iCol + 1
 END WHILE
 
 !---import undone-sorted data
 ICCAP_FUNC("gui_Apply_Stimuli_Selection", "Execute")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Move_Data" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR   ColNames		!Names of the LSYNC Inputs, incl. the 'Master Sweep'
 GLOBAL_VAR   TmpVar			!temporary array, used during sorting
 GLOBAL_VAR   Index			!used for sorting the LSYNC values
 GLOBAL_VAR   Index_sel		!selected index/indices of LSYNCs
 !----------------------------------------
 
 
 !---to be answered from the calling GUI
 GET_STRING "Move upwards [u] or downwards [d], [none]", "u", MoveMode
 
 
 !---verify if only a single index has been selected
 IF SIZEOF(Index_sel)>1 THEN
   GET_STRING "NOTE: Currently only a single selection is supported [OK]", dummy
   RETURN_VALUE 2
 END IF
 
 FOR iCol = 0 TO SIZEOF(ColNames)-1
   !---clip range
   Index_sel[0] = MAX(Index_sel[0], 0)
   Index_sel[0] = MIN(Index_sel[0], SIZEOF(Index)-1)
 
   !in order to keep the engineering format (e.g. 1u instead of 1E-6), we need to do all variable handling as strings handling
   VarName = "Col"&VAL$(iCol)&"["&VAL$(Index_sel[0])&"]"
   VarValue=VAL$(LOOKUP_VAR(VarName))
 
   !---move upwards
   IF (VAL$(MoveMode)=="u") AND (VAL(Index_sel[0])<>0) THEN
     VarNameAbove = "Col"&VAL$(iCol)&"["&VAL$(VAL(Index_sel[0])-1)&"]"
     VarValueAbove=VAL$(LOOKUP_VAR(VarNameAbove))
     ICCAP_FUNC(".", "SetVariableTableValue", VAL$(VarNameAbove), VAL$(VarValue))
     ICCAP_FUNC(".", "SetVariableTableValue", VAL$(VarName), VAL$(VarValueAbove))
   END IF
 
   !---move downwards
   IF (VAL$(MoveMode)=="d") AND (VAL(Index_sel[0])<SIZEOF(Index)-1) THEN
     VarNameBelow = "Col"&VAL$(iCol)&"["&VAL$(VAL(Index_sel[0])+1)&"]"
     VarValueBelow=VAL$(LOOKUP_VAR(VarNameBelow))
     ICCAP_FUNC(".", "SetVariableTableValue", VAL$(VarNameBelow), VAL$(VarValue))
     ICCAP_FUNC(".", "SetVariableTableValue", VAL$(VarName), VAL$(VarValueBelow))
   END IF
 
 NEXT iCol
 
 
 ! shift the selection index
 IF (VAL$(MoveMode)=="u") THEN  Index_sel[0] = VAL(Index_sel[0])-1
 IF (VAL$(MoveMode)=="d") THEN  Index_sel[0] = VAL(Index_sel[0])+1
 
 
 
 !GET_STRING "To not only move the Biases/Devices in the GUI,
 !  but to also update the currently loaded data, 
 !  hit '==> Re-Load Bias/Device Selection <=='  [OK]", dummy
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_IdentifyData" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 
 
 Path2Utilities    = "/UTILITIES/PLOT_UTILITIES/PLOT_SHOW_LSYNC_VALUES/PLOT_SHOW_LSYNC_VALUES"
 Path2ThisSetup = WHOIS(".", "Parent Setup")		!returns full path to SetupName
 ICCAP_FUNC(VAL$(Path2Utilities), "Execute", VAL$(Path2ThisSetup))
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "______________________3" "711.501"
{
}
LINK XFORM "gui_View_mdm_Header" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR   MDM_FILE_PATH
 GLOBAL_VAR   MDM_FILE_NAME
 GLOBAL_VAR   TmpVar
 !--------------------------------
 
 mdm_DirFileName=VAL$(MDM_FILE_PATH)&"/"&VAL$(MDM_FILE_NAME)
 mdm_DirFileName=SYS_PATH$(mdm_DirFileName)		!make path oper.system independent
 TmpVar=SYSTEM$("head -100 "&VAL$(mdm_DirFileName))
 
 
 !--- opening the GUI
 ICCAP_FUNC("./GUI_ViewMdmHeader", "Display Modeless GUI", "mdm Header")
 
 
 
 
 
 !-----------------------
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Apply_Stimuli_Selection" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR SweepNames
 GLOBAL_VAR MDM_FILE_PATH
 GLOBAL_VAR MDM_FILE_NAME
 GLOBAL_VAR ColNames
 GLOBAL_VAR ErrMsg
 !------------------------------------
 
 ! This Program links to 'SweepxValues_sel' and enters the selected bias points 
 ! of SetupVariables 'SweepxValues' into the corresponding 'Input'.
 ! Finally, it re-imports the data for the selected bias conditions.
 
 ErrMsg=""
 
 !---close a possibly open GUI for LSYNC data identification  (background: the index numbers change at re-loading data subsets)
 ICCAP_FUNC("../../PLOT_UTILITIES/PLOT_SHOW_LSYNC_VALUES/gui_Done", "Execute")
 
 
 FOR iSweep=0 TO SIZEOF(SweepNames)-1
   IF VAL(Debug)==1 THEN PRINT "  handling SweepIndex ";iSweep
   ActSweepType=LOOKUP_TABLE_VAL(VAL$(SweepNames[iSweep]), "Sweep Type")
   IF (VAL$(ActSweepType)=="HB") OR (VAL$(ActSweepType)=="HB2") OR (VAL$(ActSweepType)=="SEG") THEN CONTINUE	!<=====start next iteration
   IF VAL$(ActSweepType)<>"TLIST" THEN
     ICCAP_FUNC(VAL$(SweepNames[iSweep]), "SetTableFieldValue", "Sweep Type", "LIST")
   END IF
   SweepSize_act = VAL(LOOKUP_VAR("Sweep"&VAL$(iSweep+1)&"Values_sel"))
   ! verify if user had selected something
   IF VAL(SweepSize_act)<1 THEN
     ErrMsg="ERROR: no bias was selected for "&VAL$(SweepNames[iSweep])&"!!  [OK]"
     GET_STRING VAL$(ErrMsg), dummy
     RETURN_VALUE 0
   END IF
 
   ICCAP_FUNC(VAL$(SweepNames[iSweep]), "SetTableFieldValue", "# of Values", SweepSize_act)
  
   i = 0
   WHILE i < SweepSize_act
     ! get SweepxValues[SweepxValues_sel[i]]
     tmpSweepValue_sel = LOOKUP_VAR("Sweep"&VAL$(iSweep+1)&"Values_sel["&VAL$(i)&"]")
     SweepValue = LOOKUP_VAR("Sweep"&VAL$(iSweep+1)&"Values["&VAL$(tmpSweepValue_sel)&"]")
     ICCAP_FUNC(VAL$(SweepNames[iSweep]), "SetTableFieldValue", "Value "&VAL$(i+1), SweepValue)
     i = i + 1
   END WHILE
 NEXT iSweep
 
 
 
 !---handle the LSYNCs
 IF SIZEOF(ColNames)>0 THEN ICCAP_FUNC("Lsync_Import_Selected", "Execute")
 
 
 !--- re-load data (Import depending on current Input settings, as Measured Data)
 mdm_DirFileName=VAL$(MDM_FILE_PATH)&"/"&VAL$(MDM_FILE_NAME)
 mdm_DirFileName=SYS_PATH$(mdm_DirFileName)		!make path oper.system independent
 ICCAP_FUNC (".", "Import Data", VAL$(mdm_DirFileName))
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Plot_Type_Sel" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Program sets the Plot Type selections for the GUI, 
 !  and their corresponding X-Axis and Y-Axis Labels for the GUI
 ! It also sets the InputNames and OutputNames for the X-Axis and Y-Axis data selections
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GLOBAL_VAR  PlotTypes
 GLOBAL_VAR  PlotTypes_sel
 GLOBAL_VAR  PlotXaxisLabel
 GLOBAL_VAR  PlotYaxisLabel
 GLOBAL_VAR  InputNames
 GLOBAL_VAR  xAxisNames
 GLOBAL_VAR  xAxisNames_sel
 GLOBAL_VAR  OutputNames
 GLOBAL_VAR  yAxisNames
 GLOBAL_VAR  yAxisNames_sel
 !------------------------------------------
 
 ICCAP_FIND_CHILDREN ".", "Output", OutputNames
 ICCAP_FIND_CHILDREN ".", "Input", InputNames
 
 !---reset user selection
 xAxisNames_sel=-1			! nothing pre-selected for Plot X-Axis
 yAxisNames_sel=-1			! nothing pre-selected for Plot Y-Axis
 
 !---set PlotTypes (sequence must match usage in Xfm 'gui_Show_Plot')
 PlotTypes = "ICCAP_ARRAY[7]"
 PlotTypes[0] = "X_Y Plot"
 PlotTypes[1] = "X_LOG(Y) Plot"
 PlotTypes[2] = "X_MAG(Y) Plot"
 PlotTypes[3] = "Smith Chart"
 PlotTypes[4] = "Polar Diagram"
 PlotTypes[5] = "Scatter Plot"
 PlotTypes[6] = "Histogram"
 
 
 IF (PlotTypes_sel==0) ORELSE (PlotTypes_sel==1) ORELSE (PlotTypes_sel==2) ORELSE (PlotTypes_sel==5) THEN
   PlotXaxisLabel = "Plot X-Axis:"
   PlotYaxisLabel = "Plot Y-Axis:"
   IF PlotTypes_sel==1 THEN PlotYaxisLabel = "Plot Y-Axis  (LOG):"
   IF PlotTypes_sel==2 THEN PlotYaxisLabel = "Plot Y-Axis  (MAG):"
 END IF
 
 IF (PlotTypes_sel==3) OR (PlotTypes_sel==4) THEN
   PlotXaxisLabel = "Index (e.g. freq):"
   PlotYaxisLabel = "Smith/Polar Data:"
   !--preset Input to 'freq'
   FOR i=0 TO SIZEOF(InputNames)-1
     IF VAL$(InputNames[i])=="freq" THEN xAxisNames_sel=i
   NEXT i
   !--preset Output to 'S' or 'S_deemb'
   FOR i=0 TO SIZEOF(OutputNames)-1
     IF (VAL$(OutputNames[i])=="S") OR (VAL$(OutputNames[i])=="S_deemb") THEN yAxisNames_sel=i
   NEXT i
 END IF
 
 IF PlotTypes_sel==6 THEN
   PlotXaxisLabel = "Data Set:"
   PlotYaxisLabel = "n/a"
 END IF
 
 
 !---prepare Plot x-Axis selection
 DIMENSION_ARRAY(xAxisNames, SIZEOF(InputNames)+SIZEOF(OutputNames)+1)
 N=0
 FOR i=0 TO SIZEOF(InputNames)-1
   xAxisNames[N]=InputNames[i]
   N = N + 1
 NEXT i
 xAxisNames[N]="^^^^^^^^^"
 N = N + 1
 FOR i=0 TO SIZEOF(OutputNames)-1
   xAxisNames[N]=OutputNames[i]
   N = N + 1
 NEXT i
 
 
 !---prepare Plot y-Axis selection
 DIMENSION_ARRAY(yAxisNames, SIZEOF(InputNames)+SIZEOF(OutputNames)+1)
 N=0
 FOR i=0 TO SIZEOF(OutputNames)-1
   yAxisNames[N]=OutputNames[i]
   N = N + 1
 NEXT i
 yAxisNames[N]="^^^^^^^^^"
 N = N + 1
 FOR i=0 TO SIZEOF(InputNames)-1
   yAxisNames[N]=InputNames[i]
   N = N + 1
 NEXT i
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Show_Plot" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! NOTE:
 ! The Program displays S12 and S21 when a Polar Diagram is selected, 
 !    S11 and S22 when a Smith Chart is selected
 ! When displaying multi-dimensional data (e.g. Spars) using an XY Plot,
 !    the Program takes the first index, e.g. S.11
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
 GLOBAL_VAR  xAxisNames
 GLOBAL_VAR  xAxisNames_sel
 GLOBAL_VAR  yAxisNames
 GLOBAL_VAR  yAxisNames_sel
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  PlotTypes_sel
 GLOBAL_VAR  Plots2MP
 GLOBAL_VAR  PlotAvailable
 
 
 
 IF (xAxisNames_sel <0) ORELSE (yAxisNames_sel <0) ORELSE (VAL$(xAxisNames[xAxisNames_sel]) == "^^^^^^^^^") ORELSE (VAL$(yAxisNames[yAxisNames_sel]) == "^^^^^^^^^") THEN
   IF VAL(PlotTypes_sel)<>5 THEN
     GET_STRING "ERROR: Pls. select Plot X-Axis and Plot Y-Axis!   [OK]", dummy
     RETURN_VALUE 0
   END IF
 END IF
 
 
 !---link to the selected x and y axis data
 XData = VAL$(xAxisNames[xAxisNames_sel])
 IF VAL(PlotTypes_sel)<>6 THEN YData = VAL$(yAxisNames[yAxisNames_sel])&".M"		!select meas. data only
 
 PlotName=""
 IF PlotTypes_sel==0 THEN PlotName = VAL$(yAxisNames[yAxisNames_sel])&"_vs_"&VAL$(XData)&"__X_Y_Plot"
 IF PlotTypes_sel==1 THEN PlotName = VAL$(yAxisNames[yAxisNames_sel])&"_vs_"&VAL$(XData)&"__X_LOGY_Plot"
 IF PlotTypes_sel==2 THEN PlotName = VAL$(yAxisNames[yAxisNames_sel])&"_vs_"&VAL$(XData)&"__X_MAGY_Plot"
 IF PlotTypes_sel==3 THEN PlotName = VAL$(yAxisNames[yAxisNames_sel])&"_xx_"&VAL$(XData)
 IF PlotTypes_sel==4 THEN PlotName = VAL$(yAxisNames[yAxisNames_sel])&"_xy_"&VAL$(XData)
 IF PlotTypes_sel==5 THEN PlotName = VAL$(yAxisNames[yAxisNames_sel])&"_"&VAL$(XData)&"__SCATTER"
 IF PlotTypes_sel==6 THEN PlotName = VAL$(XData)&"__HISTOGRAM"
 
 IF VAL$(PlotName)=="" THEN RETURN_VALUE 0	
 
 PlotAvailable = 1
 
 !---verify if Plot already exists. If yes, just show it again (to maintain possible user-settings like AutoScale off etc.)
 ICCAP_FIND_CHILDREN ".", "Plot", PlotNames
 PlotExist=0
 FOR i=0 TO SIZEOF(PlotNames)-1
   IF VAL$(PlotNames[i])==VAL$(PlotName) THEN 
     PlotExist=1
     !---update possible user changes in Plot style
     ICCAP_FUNC("Plot_LineStyle_LineColor", "Execute", VAL$(PlotName), "LineColor")
     ICCAP_FUNC("Plot_LineStyle_LineColor", "Execute", VAL$(PlotName), "LineStyle")
   END IF
 NEXT i
 IF PlotExist>0 THEN 
   IF VAL(Plots2MP)==0 THEN ICCAP_FUNC(VAL$(PlotName), "Display Plot")
   IF VAL(Plots2MP)==1 THEN ICCAP_FUNC("_MP_", "Display Plot")
   RETURN_VALUE 2
 END IF
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---create a new Plot
 ICCAP_FUNC(".", "New Plot", VAL$(PlotName))   
 
 !---X_Y GRAPH--------------------------------
 ! NOTE: when displaying S-pars, IC-CAP shows the default REAL(S.11)
 IF PlotTypes_sel==0  THEN 
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Report Type", "XY Graph")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "X Data",   VAL$(XData))
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Y Data 0", VAL$(YData))
 END IF
 
 !---X_LOG(Y) GRAPH--------------------------------
 IF PlotTypes_sel==1  THEN 
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Report Type", "XY Graph")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "X Data",   VAL$(XData))
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Y Data 0", VAL$(YData))
   ICCAP_FUNC(VAL$(PlotName), "SetTableFieldValue", "Y Axis Type", "LOG")
 END IF
 
 !---X_MAG(Y) GRAPH--------------------------------
 IF PlotTypes_sel==2  THEN 
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Report Type", "XY Graph")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "X Data",   VAL$(XData))
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Y Data 0", "MAG("&VAL$(YData)&")")
 END IF
 
 !---Smith Chart--------------------------------
 IF PlotTypes_sel==3  THEN 
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Report Type", "Smith Plot")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Sweep Data", VAL$(XData))
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Smith Data 0", VAL$(YData)&".11")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Smith Data 1", VAL$(YData)&".22")
 END IF
 
 !---POLAR DIAGRAM--------------------------------
 IF PlotTypes_sel==4  THEN 
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Report Type", "Polar Plot")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Sweep Data", VAL$(XData))
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Polar Data 0", VAL$(YData)&".12")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Polar Data 1", VAL$(YData)&".21")
 END IF
 
 
 !---SCATTER PLOT--------------------------------
 IF PlotTypes_sel==5  THEN 
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Report Type", "Scatter Plot")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "X Data",   VAL$(XData))
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Y Data", VAL$(YData))
 END IF
 
 
 !---HISTOGRAM--------------------------------
 IF PlotTypes_sel==6  THEN 
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Report Type", "Histogram")
   ICCAP_FUNC(VAL$(PlotName), "STFV", "Data-set", VAL$(XData))
 END IF
 
 
 ICCAP_FUNC(VAL$(PlotName), "STFV", "Header", VAL$(PlotName))
 
 
 !---update PlotNames for GUI
 ICCAP_FIND_CHILDREN ".", "Plot", PlotNames
 
 
 !---re-open the GUI to reflect the new PlotNames
 ICCAP_FUNC("./GUI_Sel_Data", "Display Modeless GUI", "Select Stimuli")
 
 
 !---display the Plot
 ICCAP_FUNC("Plot_LineStyle_LineColor", "Execute", VAL$(PlotName), "LineColor")
 ICCAP_FUNC("Plot_LineStyle_LineColor", "Execute", VAL$(PlotName), "LineStyle")
 
 IF VAL(Plots2MP)==1 THEN
   ICCAP_FUNC("Create_MultiPlot", "Execute")
 ELSE
   ICCAP_FUNC(VAL$(PlotName), "Display Plot")
 END IF
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Plot_LineStyle_LineColor" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  LineStyle_sel
 GLOBAL_VAR  LineColor_sel
 
 GET_STRING "PlotName", PlotName
 GET_STRING "Action  [LineStyle], [LineColor]", Action
 
 IF VAL$(Action)=="LineStyle" THEN
   PlotStyle=""
   IF VAL(LineStyle_sel)==0 THEN PlotStyle = "Solid Line with Symbols"
   IF VAL(LineStyle_sel)==1 THEN PlotStyle = "Solid Line"
   IF VAL(LineStyle_sel)==2 THEN PlotStyle = "Symbols Only"
   ICCAP_FUNC(VAL$(PlotName)&"/PlotOptions", "SetTableFieldValue", "Measured Trace", VAL$(PlotStyle))
   ICCAP_FUNC(VAL$(PlotName)&"/PlotOptions", "SetTableFieldValue", "Simulated Trace", VAL$(PlotStyle))
   ICCAP_FUNC(VAL$(PlotName)&"/PlotOptions", "SetTableFieldValue", "Transform Result", VAL$(PlotStyle))
 END IF
 
 
 IF VAL$(Action)=="LineColor" THEN
   CurveColoring=""
   IF VAL(LineColor_sel)==0 THEN CurveColoring = "Display all curves with the configured trace color"
   IF VAL(LineColor_sel)==1 THEN CurveColoring = "Change color with each 2nd order curve"
   IF VAL(LineColor_sel)==2 THEN CurveColoring = "Change color with each highest order curve"
   IF VAL(LineColor_sel)==3 THEN CurveColoring = "Change color with every curve"
   ICCAP_FUNC(VAL$(PlotName)&"/PlotOptions", "SetTableFieldValue", "Multicolor", VAL$(CurveColoring))
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Create_MultiPlot" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  PlotNames
 
 
 
 !---if not existing, create MultiPlot _MP_ 
 ICCAP_FIND_CHILDREN ".", "Plot", PlotNames
 MP_exist=0
 FOR i=0 TO SIZEOF(PlotNames)-1
   IF VAL$(PlotNames[i])=="_MP_" THEN 
     MP_exist=1
     dummy=ARRAY_REMOVE_AT("PlotNames", i)
   END IF
 NEXT i
 
 IF MP_exist==0 THEN
   ICCAP_FUNC(".", "New Plot", "_MP_")   
   ICCAP_FUNC("_MP_", "STFV", "Report Type", "MULTI PLOT")
 END IF
 
 
 !---add Plots
 ICCAP_FUNC("_MP_", "STFV", "# of Plots", VAL(SIZEOF(PlotNames)))
 IF SIZEOF(PlotNames)<=3 THEN 
   ICCAP_FUNC("_MP_", "STFV", "Plots Per Row", VAL(SIZEOF(PlotNames)))
 END IF
 
 FOR i=0 TO SIZEOF(PlotNames)-1
   IF VAL$(PlotNames[i])<>"_MP_" THEN
     ICCAP_FUNC("_MP_", "STFV", "Plot "&VAL$(i), VAL$(PlotNames[i]))
   END IF
 NEXT i
 
 
 ICCAP_FUNC("_MP_", "Display Plot")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Delete_Plots" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  PlotAvailable
 GLOBAL_VAR  ShowAreaTools
 !------------------------------------------------
 
 
 
 ErrMsg=""
 
 
 ICCAP_FIND_CHILDREN ".", "Plot", PlotNames
 
 FOR i=0 TO SIZEOF(PlotNames)-1
   ICCAP_FUNC(VAL$(PlotNames[i]), "Delete")
 NEXT i
 
 
 DIMENSION_ARRAY("PlotNames", 0)
 PlotAvailable = 0
 ShowAreaTools = 1
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_AreaToolsOnOff" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ShowAreaTools
 
 
 !---disable the red box, indicating the last clicked Plot
 ICCAP_FUNC("_MP_", "Unselect All")
 
 !---handle Plot Area Tools
 IF VAL(ShowAreaTools)==0 THEN
   ICCAP_FUNC("_MP_", "Area Tools Off")
   ICCAP_FUNC("_MP_", "Title Off")
 ELSE
   ICCAP_FUNC("_MP_", "Area Tools On")
   ICCAP_FUNC("_MP_", "Title On")
 END IF
 
 
 ICCAP_FUNC("_MP_", "Redisplay")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Prepare_Export_mdm" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  SweepNames
 GLOBAL_VAR  AllSweepNames
 GLOBAL_VAR  ErrMsg
 
 
 ! NOTE: this Program also applies a 'dynamic link' [LOOKUP_VAR()] to SweepxValues_sel
 !---------------------------------------------------------------------------
 
 
 ErrMsg=""
 
 !---check if at least a single bias was selected for every sweep
 i=0
 WHILE i < SIZEOF(SweepNames)
   IF VAL(LOOKUP_VAR("Sweep"&VAL$(i+1)&"Values_sel")) == 0 THEN
     ErrMsg="ERROR: No Bias selection was made for Sweep "&VAL$(SweepNames[i])
     GET_STRING VAL$(ErrMsg)&" [OK]", dummy
     RETURN_VALUE 0
   END IF
   i = i + 1
 END WHILE
 
 
 IF SIZEOF(AllSweepNames)>1 THEN
   !---if multiple sweeps are present: before saving the .mdm file, open a GUI to let the user select the sweep order
   ICCAP_FUNC("./GUI_SweepOrders", "Display Modeless GUI", "Select Sweep Order")
 ELSE
   ICCAP_FUNC("gui_Export_mdm", "Execute")
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Export_mdm" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR MDM_FILE_PATH
 GLOBAL_VAR MDM_FILE_NAME
 
 
 ICCAP_FUNC("./GUI_SweepOrders", "Destroy GUI", "Select Sweep Order")
 
 
 !---if possible, change sweep type from LIST to LIN
 ICCAP_FUNC("List2Lin", "Execute")
 
 
 !---let the user select the dir. and filename for the new selected-bias .mdm file
 WorkingDirectory = SYSTEM$("pwd")			!return current location of global IC-CAP directory pointer
 act_MDM_FILE_NAME=VAL$(MDM_FILE_NAME)
 MDM_FILE_NAME = VAL$(MDM_FILE_NAME)&"_xxxxx"		!provide a reasonable default
 act_MDM_FILE_PATH=VAL$(MDM_FILE_PATH)
 IF VAL$(MDM_FILE_PATH)=="" THEN MDM_FILE_PATH="."
 ICCAP_FUNC("/", "Change Directory", SYS_PATH$(VAL$(MDM_FILE_PATH)))	!change to last selected directory of data import
 ICCAP_FUNC(".", "Export Data Measured")
 ICCAP_FUNC("/", "Change Directory", VAL$(WorkingDirectory)) !change back to previous IC-CAP global working directory
 MDM_FILE_NAME=VAL$(act_MDM_FILE_NAME)			!change back to .mdm file name of orig. data
 MDM_FILE_PATH=VAL$(act_MDM_FILE_PATH)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "List2Lin" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !  This Program converts -if possible- a LIST sweep into a LIN sweep.
 !  Advantage for the later use:
 !  - smaller Input icon, modifications by the user can be done easier
 !  - faster (Spice) simulations
 !  - better readability of .mdm file for the user
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 GLOBAL_VAR  InputNames
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  ColNames
 GLOBAL_VAR  RETAIN_DATA
 
 
 !   Note: the following manipulations of the Input settings require the SystemVariable RETAIN_DATA="yes"
 
 !---loop thru all Inputs
 RETAIN_DATA="yes"
 FOR iInput=0 TO SIZEOF(InputNames)-1
   !---change from LIST to LIN only if Input is no LSYNC sweep, or is not Master of LSYNC Inputs
   DoIt=1
   FOR i=0 TO SIZEOF(ColNames)-1
     IF VAL$(InputNames[iInput])==VAL$(ColNames[i]) THEN DoIt=0
   NEXT i
 
   IF DoIt==1 THEN
     ListEqualStepping=1
     ErrMsg=""
     SweepMode = LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "Sweep Type", ErrMsg)
     IF (VAL$(SweepMode)=="LIST") AND (VAL$(ErrMsg)=="") THEN
       NrPts    = VAL(LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "# of Values", ErrMsg))
       StartVal = VAL(LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "Value 1", ErrMsg))
       StopVal  = VAL(LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "Value "&VAL$(NrPts), ErrMsg))
       !---check if LIST stepping is equal
       IF VAL(NrPts)>2 THEN
         FirstStep = VAL(LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "Value 2"))-VAL(StartVal)
         FOR iValues=3 TO VAL(NrPts)
           ActVal = VAL(LOOKUP_TABLE_VAL(VAL$(InputNames[iInput]), "Value "&VAL$(iValues), ErrMsg))
           CalcVal= VAL(StartVal+(iValues-1)*FirstStep)
           IF VAL(ActVal<>0) THEN
             IF (ABS((ActVal-CalcVal)//ActVal) > 1E-6) THEN ListEqualStepping=0	! calculated and current value are different
            ELSE
             IF ActVal<>CalcVal THEN ListEqualStepping=0
           END IF
         NEXT iValues
       END IF
 
       IF VAL(ListEqualStepping)==1 THEN
         !---case single value
         IF VAL(NrPts)==1 THEN
           ICCAP_FUNC(VAL$(InputNames[iInput]), "STFV", "Sweep Type", "CON")
           ICCAP_FUNC(VAL$(InputNames[iInput]), "STFV", "Value",      VAL$(StartVal))
         ELSE
           ICCAP_FUNC(VAL$(InputNames[iInput]), "STFV", "Sweep Type", "LIN")
           ICCAP_FUNC(VAL$(InputNames[iInput]), "STFV", "Start",      VAL$(StartVal))
           ICCAP_FUNC(VAL$(InputNames[iInput]), "STFV", "Stop",       VAL$(StopVal))
           ICCAP_FUNC(VAL$(InputNames[iInput]), "STFV", "# of Points", VAL$(NrPts))
         END IF
       END IF
     END IF
   END IF
 NEXT iInput
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_OrderSweeps" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR  AllSweepIndex
 GLOBAL_VAR  AllSweepNames
 GLOBAL_VAR  AllSweepNames_sel
 GLOBAL_VAR  DirFileName
 GLOBAL_VAR  MDM_FILE_PATH
 GLOBAL_VAR  MDM_FILE_NAME
 GLOBAL_VAR  ErrMsg
 
 
 
 
 !---export the current data into a temporary .mdm file
 act_MDM_FILE_PATH = VAL$(MDM_FILE_PATH)		! remember orig. .mdm directory
 act_MDM_FILE_NAME = VAL$(MDM_FILE_NAME)		! remember orig. .mdm file name
 ICCAP_FUNC(".", "Export Data Measured", "tmp")
 
 
 !---order the sweeps based on user's choice
 tmp=VAL$(AllSweepNames[AllSweepNames_sel-1])
 AllSweepNames[AllSweepNames_sel-1] = AllSweepNames[AllSweepNames_sel]
 AllSweepNames[AllSweepNames_sel]   = tmp
 
 AllSweepNames_sel = AllSweepNames_sel-1
 
 
 !---set the sweeps orders in the Inputs
 N=0
 FOR i=0 TO SIZEOF(AllSweepIndex)-1
   act_SweepType = LOOKUP_TABLE_VAL(VAL$(AllSweepNames[i]), "Sweep Type", ErrMsg)
   IF VAL$(act_SweepType)<>"CON" THEN
     N = N + 1
     ICCAP_FUNC(VAL$(AllSweepNames[i]), "SetTableFieldValue", "Sweep Order", VAL$(N))
   END IF
 NEXT i
 
 
 !---re-import the data and delete temporary .mdm file
 PRINT "  importing data ..."
 ICCAP_FUNC(".", "Import Measured Data", "tmp")
 dummy=SYSTEM("rm tmp.mdm")
 
 
 !---!recover orig. .mdm directory and filename
 MDM_FILE_PATH=VAL$(act_MDM_FILE_PATH)		
 MDM_FILE_NAME=VAL$(act_MDM_FILE_NAME)		
 
 !---save corrected file
 DirFileName=VAL$(MDM_FILE_PATH)&"/"&VAL$(MDM_FILE_NAME)
 ICCAP_FUNC(".", "Export Data Measured", DirFileName)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Manage_ICCAP_VALUE_Vars" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  MDM_VALUES_LIST
 
 
 
 GET_STRING "Action    [Delete], [Add_to_MDM_VALUES_LIST]", Action
 
 
 IF VAL$(Action) == "Add_to_MDM_VALUES_LIST" THEN MDM_VALUES_LIST = ""
 
 
 !---find location of Variable '___Vars_below_stem_from_mdm_file___'
 i=0
 ErrMsg=""
 WHILE VAL$(ErrMsg)==""
   VarName =LOOKUP_TABLE_VAL(".", "Name["&VAL$(i)&"]", ErrMsg)
   EXIT IF VAL$(VarName)=="___Vars_below_stem_from_mdm_file___"
   i = i + 1
 END WHILE
 
 
 !---manage Variables below '___Vars_below_stem_from_mdm_file___'
 i = i + 1
 LOOP
   VarName =LOOKUP_TABLE_VAL(".", "Name["&VAL$(i)&"]")
   EXIT IF (VAL$(VarName)=="")
 
   !---ACTION:  Delete
   IF VAL$(Action) == "Delete" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
   END IF
 
   !---ACTION:  Add_to_MDM_VALUES_LIST
   IF VAL$(Action) == "Add_to_MDM_VALUES_LIST" THEN
     MDM_VALUES_LIST = VAL$(MDM_VALUES_LIST)&","&VAL$(VarName)
     i = i + 1
   END IF
 END LOOP
 
 
 !---trim-off leading comma
 MDM_VALUES_LIST = TRIM$(VAL$(MDM_VALUES_LIST), ",")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_OK" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 
 !---delete GUI
 ICCAP_FUNC("./GUI_Sel_Data", "Destroy GUI", "Select Stimuli")
 
 
 
 !---clean up
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 
 
 RETURN_VALUE 1
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "______________________4" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! For simplicity, we apply 'Program' and not 'Program2'
 
 !---delete Plots
 ICCAP_FUNC("gui_Delete_Plots", "Execute")
 
 
 !---clean up Input and Output icons
 ICCAP_FUNC(".", "Import Delete")
 ICCAP_FUNC(".", "New Input", "See_under_ExtractOptimize")
 ICCAP_FUNC("See_under_ExtractOptimize", "STFV", "Sweep Type", "CON")
 
 
 !---clean up Variables and ICCAP_ARRAYs
 ErrMsg=""
 MDM_VALUES_LIST = ""
 
 SweepNames = "ICCAP_ARRAY[0]"
 AllSweepNames = "ICCAP_ARRAY[0]"
 AllSweepIndex = "ICCAP_ARRAY[0]"
 
 InputNames = "ICCAP_ARRAY[0]"
 OutputNames = "ICCAP_ARRAY[0]"
 xAxisNames  = "ICCAP_ARRAY[0]"
 xAxisNames_sel = -1
 yAxisNames  = "ICCAP_ARRAY[0]"
 yAxisNames_sel = -1
 
 PlotNames   = "ICCAP_ARRAY[0]"
 PlotTypes   = "ICCAP_ARRAY[0]"
 
 ColNames    = "ICCAP_ARRAY[0]"
 Index       = "ICCAP_ARRAY[0]"
 Index_sel   = "ICCAP_ARRAY[0]"
 
 
 
 
 !---delete previously created ICCAP_ARRAYs 'SweepxValues' and 'SweepxValues_sel'
 i=1
 ErrStr=""
 WHILE ErrStr=="" 
   !before deleting, check, if this Variable exists !!!
   dummy=LOOKUP_VAR("Sweep"&VAL$(i)&"Values", ErrStr)
   IF VAL$(ErrStr)=="" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name[Sweep"&VAL$(i)&"Values]", "") 
     ICCAP_FUNC(".", "SetTableFieldValue", "Name[Sweep"&VAL$(i)&"Values_sel]", "") 
     i = i + 1
   END IF
 END WHILE
 
 
 !---delete previously created ICCAP_ARRAYs 'Colx' (representing the LSYNC values)
 i=0
 ErrStr=""
 WHILE ErrStr=="" 
   !before deleting, check, if this Variable exists !!!
   dummy=LOOKUP_VAR("Col"&VAL$(i), ErrStr)
   IF VAL$(ErrStr)=="" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name[Col"&VAL$(i)&"]", "") 
     i = i + 1
   END IF
 END WHILE
 
 
 
 !---delete SetupVariables created by the previous .mdm reading  (ICCAP_VALUES)
 ICCAP_FUNC("Manage_ICCAP_VALUE_Vars", "Execute", "Delete")
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
TABLE "AgilentPNA.4000.16" "711.501"
{
element 0 "Use User Sweep [Yes/No]" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Sweep Type[Step/Analog]" "S"
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port Src Power (dBm)" "-20.00 "
element 0 "Port 2 Src Power (dBm)" "-20.00 "
element 0 "Port Atten Auto [Y/N]" "No"
element 0 "Port Src Atten (dB)" " 0.000 "
element 0 "Port 2 Src Atten (dB)" " 0.000 "
element 0 "Power Slope (dB/GHz)" " 0.000 "
element 0 "Dwell Time (sec) [0=auto]" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor [1-1024]" "1"
element 0 "Ports Mapping" ""
element 0 "Cal Type [Hardware/None]" "H"
element 0 "Cal/State File Name [.csa|.cst only]" ""
element 0 "Use PNA Calibration Settings" "No"
element 0 "Use PNA Receiver Leveling" "No"
element 0 "Delay for timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentPNA.4000.20" "711.501"
{
element 0 "Use User Sweep [Yes/No]" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Sweep Type[Step/Analog]" "S"
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port Src Power (dBm)" "-20.00 "
element 0 "Port 2 Src Power (dBm)" "-20.00 "
element 0 "Port Atten Auto [Y/N]" "No"
element 0 "Port Src Atten (dB)" " 0.000 "
element 0 "Port 2 Src Atten (dB)" " 0.000 "
element 0 "Power Slope (dB/GHz)" " 0.000 "
element 0 "Dwell Time (sec) [0=auto]" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor [1-1024]" "1"
element 0 "Ports Mapping" ""
element 0 "Cal Type [Hardware/None]" "H"
element 0 "Cal/State File Name [.csa|.cst only]" ""
element 0 "Use PNA Calibration Settings" "No"
element 0 "Use PNA Receiver Leveling" "No"
element 0 "Delay for timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
TABLE "HP4145.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Init Command" ""
}
TABLE "AgilentE5270.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "No"
element 0 "Range Manager Mode" "1"
element 0 "Range Manager Setting" "90"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Disable Self-cal" "No"
element 0 "Output I/O Port (ERC Command)" ""
element 0 "Output I/O Port (ERM Command)" ""
element 0 "Format Parameter (FMT Command)" "4"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentB2900.7.23" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Customized Integ Time" " 10.00u"
element 0 "SMU Filters ON" "No"
element 0 "Sampling Mode" "No"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
}
}
LINK DAT "SELECT_IMPORT_DATA" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P29 C25 P220 C10"
element 0 "Name" "suffix"
element 0 "Value" ".mdm"
element 0 "Comment" "file name suffix for .mdm file browsing"
element 1 "Name" "wildcard"
element 1 "Value" ""
element 1 "Comment" "wildcard for .mdm file browsing"
element 2 "Name" "filename"
element 2 "Value" ""
element 3 "Name" "dirname"
element 3 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/Keysight_CA_AirForce/2019-04-23_DC/Data4Mdlg"
element 4 "Name" "dirfilename"
element 4 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5c_ASM-HEMT/___ICCAP/data/San_An/2019-01-22/data/Data4Mdlg/_SanAn_N25PA_4X50_25C~RG_RD_RS~Spar.mdm"
element 5 "Name" "avail_data_files[0]"
element 5 "Value" "_RY153_1~DC_MODELING~id_vds__Output.mdm"
element 6 "Name" "avail_data_files[1]"
element 6 "Value" "_RY153_1~DC_MODELING~id_vgs__Transfer.mdm"
element 7 "Name" "avail_data_files[2]"
element 7 "Value" "_RY153_1~DC_MODELING~id_vgs__Transfer_vdlin.mdm"
element 8 "Name" "avail_data_files"
element 8 "Value" "ICCAP_ARRAY[3]"
element 9 "Name" "mdm_preview"
element 9 "Value" "0"
element 9 "Comment" "flag in GUI"
element 10 "Name" "mdm_filenames[0]"
element 10 "Value" ""
element 11 "Name" "mdm_filenames[1]"
element 11 "Value" ""
element 12 "Name" "mdm_filenames[2]"
element 12 "Value" ""
element 13 "Name" "mdm_filenames[3]"
element 13 "Value" ""
element 14 "Name" "mdm_filenames[4]"
element 14 "Value" ""
element 15 "Name" "mdm_filenames[5]"
element 15 "Value" ""
element 16 "Name" "mdm_filenames[6]"
element 16 "Value" ""
element 17 "Name" "mdm_filenames[7]"
element 17 "Value" ""
element 18 "Name" "mdm_filenames[8]"
element 18 "Value" ""
element 19 "Name" "mdm_filenames[9]"
element 19 "Value" ""
element 20 "Name" "mdm_filenames[10]"
element 20 "Value" ""
element 21 "Name" "mdm_filenames[11]"
element 21 "Value" ""
element 22 "Name" "mdm_filenames[12]"
element 22 "Value" ""
element 23 "Name" "mdm_filenames[13]"
element 23 "Value" ""
element 24 "Name" "mdm_filenames[14]"
element 24 "Value" ""
element 25 "Name" "mdm_filenames[15]"
element 25 "Value" ""
element 26 "Name" "mdm_filenames[16]"
element 26 "Value" ""
element 27 "Name" "mdm_filenames[17]"
element 27 "Value" ""
element 28 "Name" "mdm_filenames[18]"
element 28 "Value" ""
element 29 "Name" "mdm_filenames[19]"
element 29 "Value" ""
element 30 "Name" "mdm_filenames[20]"
element 30 "Value" ""
element 31 "Name" "mdm_filenames[21]"
element 31 "Value" ""
element 32 "Name" "mdm_filenames[22]"
element 32 "Value" ""
element 33 "Name" "mdm_filenames[23]"
element 33 "Value" ""
element 34 "Name" "mdm_filenames[24]"
element 34 "Value" ""
element 35 "Name" "mdm_filenames[25]"
element 35 "Value" ""
element 36 "Name" "mdm_filenames[26]"
element 36 "Value" ""
element 37 "Name" "mdm_filenames[27]"
element 37 "Value" ""
element 38 "Name" "mdm_filenames[28]"
element 38 "Value" ""
element 39 "Name" "mdm_filenames[29]"
element 39 "Value" ""
element 40 "Name" "mdm_filenames[30]"
element 40 "Value" ""
element 41 "Name" "mdm_filenames[31]"
element 41 "Value" ""
element 42 "Name" "mdm_filenames[32]"
element 42 "Value" ""
element 43 "Name" "mdm_filenames[33]"
element 43 "Value" ""
element 44 "Name" "mdm_filenames[34]"
element 44 "Value" ""
element 45 "Name" "mdm_filenames[35]"
element 45 "Value" ""
element 46 "Name" "mdm_filenames[36]"
element 46 "Value" ""
element 47 "Name" "mdm_filenames[37]"
element 47 "Value" ""
element 48 "Name" "mdm_filenames[38]"
element 48 "Value" ""
element 49 "Name" "mdm_filenames[39]"
element 49 "Value" ""
element 50 "Name" "mdm_filenames[40]"
element 50 "Value" ""
element 51 "Name" "mdm_filenames[41]"
element 51 "Value" ""
element 52 "Name" "mdm_filenames[42]"
element 52 "Value" ""
element 53 "Name" "mdm_filenames[43]"
element 53 "Value" ""
element 54 "Name" "mdm_filenames[44]"
element 54 "Value" ""
element 55 "Name" "mdm_filenames[45]"
element 55 "Value" ""
element 56 "Name" "mdm_filenames[46]"
element 56 "Value" ""
element 57 "Name" "mdm_filenames[47]"
element 57 "Value" ""
element 58 "Name" "mdm_filenames[48]"
element 58 "Value" ""
element 59 "Name" "mdm_filenames[49]"
element 59 "Value" ""
element 60 "Name" "mdm_filenames[50]"
element 60 "Value" ""
element 61 "Name" "mdm_filenames[51]"
element 61 "Value" ""
element 62 "Name" "mdm_filenames"
element 62 "Value" "ICCAP_ARRAY[52]"
element 63 "Name" "mdm_path_filenames[0]"
element 63 "Value" ""
element 64 "Name" "mdm_path_filenames[1]"
element 64 "Value" ""
element 65 "Name" "mdm_path_filenames[2]"
element 65 "Value" ""
element 66 "Name" "mdm_path_filenames[3]"
element 66 "Value" ""
element 67 "Name" "mdm_path_filenames[4]"
element 67 "Value" ""
element 68 "Name" "mdm_path_filenames[5]"
element 68 "Value" ""
element 69 "Name" "mdm_path_filenames[6]"
element 69 "Value" ""
element 70 "Name" "mdm_path_filenames[7]"
element 70 "Value" ""
element 71 "Name" "mdm_path_filenames[8]"
element 71 "Value" ""
element 72 "Name" "mdm_path_filenames[9]"
element 72 "Value" ""
element 73 "Name" "mdm_path_filenames[10]"
element 73 "Value" ""
element 74 "Name" "mdm_path_filenames[11]"
element 74 "Value" ""
element 75 "Name" "mdm_path_filenames[12]"
element 75 "Value" ""
element 76 "Name" "mdm_path_filenames[13]"
element 76 "Value" ""
element 77 "Name" "mdm_path_filenames[14]"
element 77 "Value" ""
element 78 "Name" "mdm_path_filenames[15]"
element 78 "Value" ""
element 79 "Name" "mdm_path_filenames[16]"
element 79 "Value" ""
element 80 "Name" "mdm_path_filenames[17]"
element 80 "Value" ""
element 81 "Name" "mdm_path_filenames[18]"
element 81 "Value" ""
element 82 "Name" "mdm_path_filenames[19]"
element 82 "Value" ""
element 83 "Name" "mdm_path_filenames[20]"
element 83 "Value" ""
element 84 "Name" "mdm_path_filenames[21]"
element 84 "Value" ""
element 85 "Name" "mdm_path_filenames[22]"
element 85 "Value" ""
element 86 "Name" "mdm_path_filenames[23]"
element 86 "Value" ""
element 87 "Name" "mdm_path_filenames[24]"
element 87 "Value" ""
element 88 "Name" "mdm_path_filenames[25]"
element 88 "Value" ""
element 89 "Name" "mdm_path_filenames[26]"
element 89 "Value" ""
element 90 "Name" "mdm_path_filenames[27]"
element 90 "Value" ""
element 91 "Name" "mdm_path_filenames[28]"
element 91 "Value" ""
element 92 "Name" "mdm_path_filenames[29]"
element 92 "Value" ""
element 93 "Name" "mdm_path_filenames[30]"
element 93 "Value" ""
element 94 "Name" "mdm_path_filenames[31]"
element 94 "Value" ""
element 95 "Name" "mdm_path_filenames[32]"
element 95 "Value" ""
element 96 "Name" "mdm_path_filenames[33]"
element 96 "Value" ""
element 97 "Name" "mdm_path_filenames[34]"
element 97 "Value" ""
element 98 "Name" "mdm_path_filenames[35]"
element 98 "Value" ""
element 99 "Name" "mdm_path_filenames[36]"
element 99 "Value" ""
element 100 "Name" "mdm_path_filenames[37]"
element 100 "Value" ""
element 101 "Name" "mdm_path_filenames[38]"
element 101 "Value" ""
element 102 "Name" "mdm_path_filenames[39]"
element 102 "Value" ""
element 103 "Name" "mdm_path_filenames[40]"
element 103 "Value" ""
element 104 "Name" "mdm_path_filenames[41]"
element 104 "Value" ""
element 105 "Name" "mdm_path_filenames[42]"
element 105 "Value" ""
element 106 "Name" "mdm_path_filenames[43]"
element 106 "Value" ""
element 107 "Name" "mdm_path_filenames[44]"
element 107 "Value" ""
element 108 "Name" "mdm_path_filenames[45]"
element 108 "Value" ""
element 109 "Name" "mdm_path_filenames[46]"
element 109 "Value" ""
element 110 "Name" "mdm_path_filenames[47]"
element 110 "Value" ""
element 111 "Name" "mdm_path_filenames[48]"
element 111 "Value" ""
element 112 "Name" "mdm_path_filenames[49]"
element 112 "Value" ""
element 113 "Name" "mdm_path_filenames[50]"
element 113 "Value" ""
element 114 "Name" "mdm_path_filenames[51]"
element 114 "Value" ""
element 115 "Name" "mdm_path_filenames"
element 115 "Value" "ICCAP_ARRAY[52]"
element 116 "Name" "act_mdm_filenames"
element 116 "Value" "ICCAP_ARRAY[0]"
element 117 "Name" "act_mdm_path_filenames"
element 117 "Value" "ICCAP_ARRAY[0]"
element 118 "Name" "____________________0"
element 118 "Value" ""
element 119 "Name" "modelname"
element 119 "Value" "/ASM_HEMT_MODELING"
element 120 "Name" "dutnames[0]"
element 120 "Value" "_SanAn_N45PA_4X50_25C_"
element 121 "Name" "dutnames[1]"
element 121 "Value" "________________________________0"
element 122 "Name" "dutnames[2]"
element 122 "Value" "INITIALIZE"
element 123 "Name" "dutnames[3]"
element 123 "Value" "________________________________1"
element 124 "Name" "dutnames[4]"
element 124 "Value" "CONTACT_RESISTANCES"
element 125 "Name" "dutnames[5]"
element 125 "Value" "________________________________2"
element 126 "Name" "dutnames[6]"
element 126 "Value" "RG_RD_RS"
element 127 "Name" "dutnames[7]"
element 127 "Value" "________________________________3"
element 128 "Name" "dutnames[8]"
element 128 "Value" "DC_MODELING"
element 129 "Name" "dutnames[9]"
element 129 "Value" "DC_MODELING_LSYNC"
element 130 "Name" "dutnames[10]"
element 130 "Value" "DC_PULSED"
element 131 "Name" "dutnames[11]"
element 131 "Value" "DC_ModelRobustness"
element 132 "Name" "dutnames[12]"
element 132 "Value" "________________________________4"
element 133 "Name" "dutnames[13]"
element 133 "Value" "SPAR_MODELING"
element 134 "Name" "dutnames[14]"
element 134 "Value" "SPAR_MODELING_LSYNC"
element 135 "Name" "dutnames[15]"
element 135 "Value" "SPAR_ModelRobustness"
element 136 "Name" "dutnames[16]"
element 136 "Value" "________________________________5"
element 137 "Name" "dutnames[17]"
element 137 "Value" "NONLIN_RF_MDLG"
element 138 "Name" "dutnames[18]"
element 138 "Value" "________________________________6"
element 139 "Name" "dutnames[19]"
element 139 "Value" "FINISH_MDLG"
element 140 "Name" "dutnames[20]"
element 140 "Value" "________________________________7"
element 141 "Name" "dutnames[21]"
element 141 "Value" "________________________________8"
element 142 "Name" "dutnames[22]"
element 142 "Value" "__DUTs_below_are_dynamically_copied_from_UTILITIES"
element 143 "Name" "dutnames[23]"
element 143 "Value" "aux_TRANSISTOR_SPAR_MDLG"
element 144 "Name" "dutnames[24]"
element 144 "Value" "aux_NONLIN_RF_MDLG"
element 145 "Name" "dutnames"
element 145 "Value" "ICCAP_ARRAY[25]"
element 146 "Name" "GUI_sel_dut"
element 146 "Value" "ICCAP_ARRAY[0]"
element 146 "Comment" "selected DUTs for data import"
element 147 "Name" "GUI_sel_dut_previous"
element 147 "Value" "ICCAP_ARRAY[0]"
element 147 "Comment" "previous GUI_sel_dut selection"
element 148 "Name" "setupnames"
element 148 "Value" ""
element 149 "Name" "outputnames"
element 149 "Value" "ICCAP_ARRAY[0]"
element 150 "Name" "nr_Path2Setups"
element 150 "Value" "52"
element 151 "Name" "Path2Setups[0]"
element 151 "Value" "INITIALIZE/README_FIRST"
element 152 "Name" "Path2Setups[1]"
element 152 "Value" "INITIALIZE/LOAD_MEAS_DATA"
element 153 "Name" "Path2Setups[2]"
element 153 "Value" "INITIALIZE/PROJECT_NAMING"
element 154 "Name" "Path2Setups[3]"
element 154 "Value" "INITIALIZE/DEFINE_WORK_DIR"
element 155 "Name" "Path2Setups[4]"
element 155 "Value" "INITIALIZE/INIT_MODELING"
element 156 "Name" "Path2Setups[5]"
element 156 "Value" "CONTACT_RESISTANCES/DC_Meas__R_Port1"
element 157 "Name" "Path2Setups[6]"
element 157 "Value" "CONTACT_RESISTANCES/DC_Meas__R_Port2"
element 158 "Name" "Path2Setups[7]"
element 158 "Value" "RG_RD_RS/Spar"
element 159 "Name" "Path2Setups[8]"
element 159 "Value" "DC_MODELING/ig_vgs__Input"
element 160 "Name" "Path2Setups[9]"
element 160 "Value" "DC_MODELING/id_vgs__Transfer_vdlin"
element 161 "Name" "Path2Setups[10]"
element 161 "Value" "DC_MODELING/id_vgs__Transfer"
element 162 "Name" "Path2Setups[11]"
element 162 "Value" "DC_MODELING/id_vds__Output"
element 163 "Name" "Path2Setups[12]"
element 163 "Value" "DC_MODELING/id_vgs__Transfer_125C"
element 164 "Name" "Path2Setups[13]"
element 164 "Value" "DC_MODELING/id_vds__Output_125C"
element 165 "Name" "Path2Setups[14]"
element 165 "Value" "DC_MODELING_LSYNC/id_vgs__all"
element 166 "Name" "Path2Setups[15]"
element 166 "Value" "DC_MODELING_LSYNC/id_vds__all"
element 167 "Name" "Path2Setups[16]"
element 167 "Value" "DC_PULSED/Verify_Sampling_Settings"
element 168 "Name" "Path2Setups[17]"
element 168 "Value" "DC_PULSED/idvd_vg0V0_vd0V0"
element 169 "Name" "Path2Setups[18]"
element 169 "Value" "DC_PULSED/idvd_vg0V0_vd0V0__125C"
element 170 "Name" "Path2Setups[19]"
element 170 "Value" "DC_PULSED/idvd_vgm5V0_vd50V0"
element 171 "Name" "Path2Setups[20]"
element 171 "Value" "DC_PULSED/idvd_vgm5V0_vd50V0__125C"
element 172 "Name" "Path2Setups[21]"
element 172 "Value" "DC_ModelRobustness/id_vgs__Transfer"
element 173 "Name" "Path2Setups[22]"
element 173 "Value" "DC_ModelRobustness/id_vds__Output"
element 174 "Name" "Path2Setups[23]"
element 174 "Value" "SPAR_MODELING/Init_Spar_Modeling"
element 175 "Name" "Path2Setups[24]"
element 175 "Value" "SPAR_MODELING/OffState_vg_swept"
element 176 "Name" "Path2Setups[25]"
element 176 "Value" "SPAR_MODELING/OffState_vd_swept"
element 177 "Name" "Path2Setups[26]"
element 177 "Value" "SPAR_MODELING/OffState_vd_swept_125C"
element 178 "Name" "Path2Setups[27]"
element 178 "Value" "SPAR_MODELING/vg_1stsweep__vd_2nd"
element 179 "Name" "Path2Setups[28]"
element 179 "Value" "SPAR_MODELING/vd_1stsweep__vg_2nd"
element 180 "Name" "Path2Setups[29]"
element 180 "Value" "SPAR_MODELING/Spar_all_freq_vgGTm3"
element 181 "Name" "Path2Setups[30]"
element 181 "Value" "SPAR_MODELING/Spar_all_freq_biases"
element 182 "Name" "Path2Setups[31]"
element 182 "Value" "SPAR_MODELING/Spar_all_freq_vd40_50"
element 183 "Name" "Path2Setups[32]"
element 183 "Value" "SPAR_MODELING/Spar_all_freq_biases_125C"
element 184 "Name" "Path2Setups[33]"
element 184 "Value" "SPAR_MODELING/Model_Fit_Verification"
element 185 "Name" "Path2Setups[34]"
element 185 "Value" "SPAR_MODELING/Model_Fit_Verification_vgGTm3"
element 186 "Name" "Path2Setups[35]"
element 186 "Value" "SPAR_MODELING_LSYNC/Spar_all_freq_bias_LSYNC"
element 187 "Name" "Path2Setups[36]"
element 187 "Value" "SPAR_ModelRobustness/Spar_all_freq_biases"
element 188 "Name" "Path2Setups[37]"
element 188 "Value" "NONLIN_RF_MDLG/Nonlin_RF_Mdlg"
element 189 "Name" "Path2Setups[38]"
element 189 "Value" "FINISH_MDLG/Save_Applied_Meas_Data"
element 190 "Name" "Path2Setups[39]"
element 190 "Value" "FINISH_MDLG/Save_Extracted_Model"
element 191 "Name" "Path2Setups[40]"
element 191 "Value" "aux_TRANSISTOR_SPAR_MDLG/DO_ALL"
element 192 "Name" "Path2Setups[41]"
element 192 "Value" "aux_TRANSISTOR_SPAR_MDLG/S2Y_Mdlg_GUI"
element 193 "Name" "Path2Setups[42]"
element 193 "Value" "aux_NONLIN_RF_MDLG/DO_ALL"
element 194 "Name" "Path2Setups[43]"
element 194 "Value" "aux_NONLIN_RF_MDLG/_______________________"
element 195 "Name" "Path2Setups[44]"
element 195 "Value" "aux_NONLIN_RF_MDLG/Wave_Spar_Load_vs_Pin"
element 196 "Name" "Path2Setups[45]"
element 196 "Value" "aux_NONLIN_RF_MDLG/DC_Currents"
element 197 "Name" "Path2Setups[46]"
element 197 "Value" "aux_NONLIN_RF_MDLG/Pout_Gain_PAE"
element 198 "Name" "Path2Setups[47]"
element 198 "Value" "aux_NONLIN_RF_MDLG/AM_PM"
element 199 "Name" "Path2Setups[48]"
element 199 "Value" "aux_NONLIN_RF_MDLG/Time_Domain"
element 200 "Name" "Path2Setups[49]"
element 200 "Value" "aux_NONLIN_RF_MDLG/IP2_IP3_vs_Pin"
element 201 "Name" "Path2Setups[50]"
element 201 "Value" "aux_NONLIN_RF_MDLG/Nonlin_i_v"
element 202 "Name" "Path2Setups[51]"
element 202 "Value" "aux_NONLIN_RF_MDLG/aux"
element 203 "Name" "Path2Setups"
element 203 "Value" "ICCAP_ARRAY[52]"
element 204 "Name" "status[0]"
element 204 "Value" ""
element 205 "Name" "status[1]"
element 205 "Value" ""
element 206 "Name" "status[2]"
element 206 "Value" ""
element 207 "Name" "status[3]"
element 207 "Value" ""
element 208 "Name" "status[4]"
element 208 "Value" ""
element 209 "Name" "status[5]"
element 209 "Value" ""
element 210 "Name" "status[6]"
element 210 "Value" ""
element 211 "Name" "status[7]"
element 211 "Value" ""
element 212 "Name" "status[8]"
element 212 "Value" ""
element 213 "Name" "status[9]"
element 213 "Value" ""
element 214 "Name" "status[10]"
element 214 "Value" ""
element 215 "Name" "status[11]"
element 215 "Value" ""
element 216 "Name" "status[12]"
element 216 "Value" ""
element 217 "Name" "status[13]"
element 217 "Value" ""
element 218 "Name" "status[14]"
element 218 "Value" ""
element 219 "Name" "status[15]"
element 219 "Value" ""
element 220 "Name" "status[16]"
element 220 "Value" ""
element 221 "Name" "status[17]"
element 221 "Value" ""
element 222 "Name" "status[18]"
element 222 "Value" ""
element 223 "Name" "status[19]"
element 223 "Value" ""
element 224 "Name" "status[20]"
element 224 "Value" ""
element 225 "Name" "status[21]"
element 225 "Value" ""
element 226 "Name" "status[22]"
element 226 "Value" ""
element 227 "Name" "status[23]"
element 227 "Value" ""
element 228 "Name" "status[24]"
element 228 "Value" ""
element 229 "Name" "status[25]"
element 229 "Value" ""
element 230 "Name" "status[26]"
element 230 "Value" ""
element 231 "Name" "status[27]"
element 231 "Value" ""
element 232 "Name" "status[28]"
element 232 "Value" ""
element 233 "Name" "status[29]"
element 233 "Value" ""
element 234 "Name" "status[30]"
element 234 "Value" ""
element 235 "Name" "status[31]"
element 235 "Value" ""
element 236 "Name" "status[32]"
element 236 "Value" ""
element 237 "Name" "status[33]"
element 237 "Value" ""
element 238 "Name" "status[34]"
element 238 "Value" ""
element 239 "Name" "status[35]"
element 239 "Value" ""
element 240 "Name" "status[36]"
element 240 "Value" ""
element 241 "Name" "status[37]"
element 241 "Value" ""
element 242 "Name" "status[38]"
element 242 "Value" ""
element 243 "Name" "status[39]"
element 243 "Value" ""
element 244 "Name" "status[40]"
element 244 "Value" ""
element 245 "Name" "status[41]"
element 245 "Value" ""
element 246 "Name" "status[42]"
element 246 "Value" ""
element 247 "Name" "status[43]"
element 247 "Value" ""
element 248 "Name" "status[44]"
element 248 "Value" ""
element 249 "Name" "status[45]"
element 249 "Value" ""
element 250 "Name" "status[46]"
element 250 "Value" ""
element 251 "Name" "status[47]"
element 251 "Value" ""
element 252 "Name" "status[48]"
element 252 "Value" ""
element 253 "Name" "status[49]"
element 253 "Value" ""
element 254 "Name" "status[50]"
element 254 "Value" ""
element 255 "Name" "status[51]"
element 255 "Value" ""
element 256 "Name" "status"
element 256 "Value" "ICCAP_ARRAY[52]"
element 256 "Comment" "indicator in GUI if .mdm has been loaded"
element 257 "Name" "act_nr_Path2Setups"
element 257 "Value" "0"
element 258 "Name" "GUI_sel_Path2Setup"
element 258 "Value" "-1"
element 259 "Name" "act_Path2Setups"
element 259 "Value" "ICCAP_ARRAY[0]"
element 260 "Name" "Show_act_Path2Setups"
element 260 "Value" "1"
element 260 "Comment" "flag for GUI to show or not the act_Path2Setup column"
element 261 "Name" "act_status"
element 261 "Value" "ICCAP_ARRAY[0]"
element 262 "Name" "____________________1"
element 262 "Value" ""
element 263 "Name" "auxvar[0]"
element 263 "Value" "ig_vgs__Input"
element 264 "Name" "auxvar[1]"
element 264 "Value" "id_vgs__Transfer_vdlin"
element 265 "Name" "auxvar[2]"
element 265 "Value" "id_vgs__Transfer"
element 266 "Name" "auxvar[3]"
element 266 "Value" "id_vds__Output"
element 267 "Name" "auxvar[4]"
element 267 "Value" "id_vgs__Transfer_125C"
element 268 "Name" "auxvar[5]"
element 268 "Value" "id_vds__Output_125C"
element 269 "Name" "auxvar"
element 269 "Value" "ICCAP_ARRAY[6]"
element 270 "Name" "DeviceName"
element 270 "Value" "RY153_1"
element 271 "Name" "GUI_sel_data_file"
element 271 "Value" "-1"
element 271 "Comment" "user-selected .mdm for being loaded"
element 272 "Name" "____________________2"
element 272 "Value" ""
element 273 "Name" "txt_HELP"
element 273 "Value" "If your measured data have been saved previously following the"
element 274 "Name" "____________________3"
element 274 "Value" ""
element 275 "Name" ""
element 275 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "tbl_load_mdms_2_setups"
element 0 "Value" "TL|HT=700|<none>|#215TL_selected_dir:#218TL_filename_filter:#214TL_setups_mdms|1|0"
element 1 "Name" "tbl_load_mdms_2_setups.TL_setups_mdms"
element 1 "Value" "TL|OR=HO|<none>|#19list_Duts:#211list_Setups:#19list_mdms:#211list_status:#216list_avail_files|1"
element 2 "Name" "tbl_load_mdms_2_setups.TL_setups_mdms.list_Setups"
element 2 "Value" "LI|CA=#259available DUT/Setups                                      .:IT=%#215act_Path2Setups:MF=%Show_act_Path2Setups:SX=%#218GUI_sel_Path2Setup:SY=SS:TO=MW&LW|<none>|<none>|0"
element 3 "Name" "tbl_load_mdms_2_setups.TL_setups_mdms.list_mdms"
element 3 "Value" "LI|CA=#259mdm file loaded during this GUI session                   .:IT=%#217act_mdm_filenames:SX=%#218GUI_sel_Path2Setup:SY=SS:TO=MW&LW|<none>|<none>|0"
element 4 "Name" "tbl_load_mdms_2_setups.TL_setups_mdms.list_status"
element 4 "Value" "LI|CA=#214status       .:IT=%#210act_status:SX=%#218GUI_sel_Path2Setup:SY=SS:TO=MW&LW|<none>|<none>|0"
element 5 "Name" "tbl_load_mdms_2_setups.TL_selected_dir.lbl_selected_dir"
element 5 "Value" "LA|CA=#226Selected .mdm data dir\072:TO=FW&TL|<none>|<none>|0"
element 6 "Name" "tbl_load_mdms_2_setups.TL_selected_dir"
element 6 "Value" "TL|FV=T:OR=HO:TO=FH&MH&LH|<none>|#216lbl_selected_dir:#215ed_selected_dir:#210pb_sel_dir|1"
element 7 "Name" "tbl_load_mdms_2_setups.TL_selected_dir.ed_selected_dir"
element 7 "Value" "ED|BG=C9:VA=%#17dirname:TO=TL&dummy|<none>|<none>|0"
element 8 "Name" "tbl_load_mdms_2_setups.TL_selected_dir.pb_sel_dir"
element 8 "Value" "PB|CA=#210Change Dir:TO=FW&LW&TR|AC=#221bt_change_dir_browser&#17Execute|<none>|0"
element 9 "Name" "tbl_load_mdms_2_setups.TL_setups_mdms.list_Duts"
element 9 "Value" "LI|CA=#248available DUTs                                 .:IT=%#18dutnames:SI=%#211GUI_sel_dut:SY=MS:TO=MW&LW|LS=#222identify_active_Setups&#17Execute|<none>|0"
element 10 "Name" "tbl_load_mdms_2_setups.TL_setups_mdms.list_avail_files"
element 10 "Value" "LI|CA=#271avail. mdm files                                                      .:IT=%#216avail_data_files:SX=%#217GUI_sel_data_file:SY=SS|LS=#214load_data_file&#17Execute|<none>|0"
element 11 "Name" "tbl_load_mdms_2_setups.TL_filename_filter"
element 11 "Value" "TL|FV=F:OR=HO:TO=FH&MH&LH|<none>|#214TL_Select_DUTs:#215TL_Data_Loading:#233TL_filefilter_filesuffix_autoload:#15PB_OK|1"
element 12 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_filefilter_filesuffix_autoload.TL_filefilter_n_filesuffix.Wildcard"
element 12 "Value" "ED|CA=#217Filename Wildcard:CO=1:EM=SL:ED=T:VA=%#18wildcard:TO=LW&LH&TT&TR|EP=#221show_avail_data_files&#17Execute|<none>|1"
element 13 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_filefilter_filesuffix_autoload.TL_filefilter_n_filesuffix"
element 13 "Value" "TL|FV=T:OR=HO:TO=MW&LW|<none>|#18Wildcard:#16Suffix:#19bt_update|1"
element 14 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_filefilter_filesuffix_autoload.TL_filefilter_n_filesuffix.Suffix"
element 14 "Value" "ED|CA=#211File Suffix:CO=1:EM=SL:ED=T:VA=%#16suffix:TO=LW&LH&TT&TR|EP=#221show_avail_data_files&#17Execute|<none>|0"
element 15 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Data_Loading.LA_Notes_Manual_Loading"
element 15 "Value" "LA|CA=#3236      HELP\072\012      To manually load mdm files, first select DUT(s) from 'available Duts',\012      then click into the first Setup in 'available DUT/Setups', \012      and select the corresponding .mdm file from 'avail. mdm files'.:FG=C6|<none>|<none>|0"
element 16 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.PB_OK"
element 16 "Value" "PB|CA=#18OK, Done:TO=TR&TT&FH&FW|AC=#15bt_ok&#17Execute|<none>|0"
element 17 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_filefilter_filesuffix_autoload.TL_filefilter_n_filesuffix.bt_update"
element 17 "Value" "PB|CA=#15Apply:TO=LH&dummy|AC=#221show_avail_data_files&#17Execute|<none>|0"
element 18 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Select_DUTs"
element 18 "Value" "TL|OR=VE|<none>|#220PB_Deselect_all_DUTs:#216PB_ClearMeasData:#15Space|1"
element 19 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Select_DUTs.PB_Deselect_all_DUTs"
element 19 "Value" "PB|CA=#217Deselect all DUTs:TO=FH&dummy|AC=#213bt_sel_no_DUT&#17Execute|<none>|0"
element 20 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Select_DUTs.PB_ClearMeasData"
element 20 "Value" "PB|CA=#233Clear all Meas. Data in Modelfile:TO=FH&dummy|AC=#218bt_clear_meas_data&#17Execute|<none>|0"
element 21 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_filefilter_filesuffix_autoload"
element 21 "Value" "TL|OR=VE|<none>|#226TL_filefilter_n_filesuffix:#214CB_mdm_preview:#15Space|1"
element 22 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Data_Loading"
element 22 "Value" "TL|OR=VE|<none>|#223LA_Notes_Manual_Loading:#214TL_AutoLoading|1"
element 23 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Data_Loading.TL_AutoLoading"
element 23 "Value" "TL|FV=T:OR=VE|<none>|#223LA_Notes_Manual_Loading:#17TL_Load|1"
element 24 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Data_Loading.TL_AutoLoading.TL_Load.PB_AutoLoad"
element 24 "Value" "PB|CA=#218Load Automatically:TO=FW&FH|AC=#215auto_load_files&#17Execute|<none>|0"
element 25 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Data_Loading.TL_AutoLoading.LA_Notes_Manual_Loading"
element 25 "Value" "LA|CA=#3120Click here, if mdm files are named DevName~DutName~SetupName.mdm\012(no Dut/Setup and no mdm file selection is required):FG=C6|<none>|<none>|0"
element 26 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_filefilter_filesuffix_autoload.Space"
element 26 "Value" "TL|<none>|<none>|<none>|0"
element 27 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Data_Loading.TL_AutoLoading.TL_Load"
element 27 "Value" "TL|OR=HO|<none>|#211PB_AutoLoad:#219PB_Help_AutoLoading|1"
element 28 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Data_Loading.TL_AutoLoading.TL_Load.PB_Help_AutoLoading"
element 28 "Value" "PB|CA=#14Help:TO=FW&FH|AC=#216HELP_AutoLoading&#17Execute|<none>|0"
element 29 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_Select_DUTs.Space"
element 29 "Value" "TL|<none>|<none>|<none>|0"
element 30 "Name" "tbl_load_mdms_2_setups.TL_filename_filter.TL_filefilter_filesuffix_autoload.CB_mdm_preview"
element 30 "Value" "CB|CA=#237View .mdm Header Only, no Data Import:TS=%mdm_preview|<none>|<none>|0"
element 31 "Name" "GUI_Notes"
element 31 "Value" "TL|<none>|<none>|#18LA_Notes|1|1"
element 32 "Name" "GUI_Notes.LA_Notes"
element 32 "Value" "LA|CA=%#18txt_HELP:FI=FF:FG=C6|<none>|<none>|0"
element 33 "Name" ""
element 33 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,617,409"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 
 
 ! The Programs behind the GUI of this Setup will 
 ! look for available DUT/Setups in a user-specified Model.
 
 ! The user can then select and load .mdm files
 ! for every Setup from a convenient single-window GUI.
 
 ! Note: the Transforms below the 'SELECT_IMPORT_DATA' are
 ! auxiliary Transforms required by the GUI.
 ! The starting Transform is 'SELECT_IMPORT_DATA'
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 ! HOW TO USE 'SELECT_IMPORT_DATA' FROM YOUR MODEL FILE
 ! ====================================================
 
 ! Simply add a Macro or Transform to your local Model
 ! with the following contents
 
 
 !---cal the central data import feature of UTILITIES
 ModelName = WHOIS(".", "Parent Model")
 DataDir = "C:/myData"
 ICCAP_FUNC("/UTILITIES/MDM_UTILITIES/SELECT_IMPORT_DATA/SELECT_IMPORT_DATA", "Execute", VAL$(ModelName), VAL$(DataDir))
 
 ! NOTE: the 3rd and 4th argument in the ICCAP_FUNC anticipates 
 ! the GET_STRINGs in Transform 'IMPORT_DATA' of UTILITIES
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HELP_AutoLoading" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  txt_HELP
 
 !---define text for GUI   'GUI_Notes'
 txt_HELP = "If your measured data have been saved previously following the
 file name convention
 
    Prefix~DutName~SetupName.mdm
 
 and if they are located (preferrably) in a separate data directory
 (e.g. called 'data4modeling'), so that no other .mdm files with
 two '~' separation signs are present, you can easily auto-load these .mdm files.
 
 The .mdm name's Prefix will be ignored, while the DutName and the SetupName will
 serve as Dut/Setup target information for the data import (ImportCreate)."
 
 
 
 
 
 !---open GUI
 Font="FF"	!DF: default font (Arial), FF: fixed font(Courier)
 ICCAP_FUNC("./GUI_Notes.LA_Notes", "Set GUI Options", "FI="&VAL$(Font), "")
 
 ICCAP_FUNC("./GUI_Notes", "Display Modeless GUI", "HELP Auto Loading .mdm Files")
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "SELECT_IMPORT_DATA" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !when this Transform is called by an external Macro,
 !these GET_STRINGs will be answered by the calling Macro
 GET_STRING "enter Modelname (w/o leading '/')", modelname, modelname
 GET_STRING "enter data directory  (can also be set later in the GUI)", ".", dirname
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 DeviceName = ""
 
 
 !---make dir name op.system independent
 dirname = SYS_PATH$(VAL$(dirname))
 
 
 !---identify all DUTs, Setups and fill data arrays
 ICCAP_FUNC("find_all_Duts_Setups", "Execute")
 
 
 !---det avail data files in the current data file directory and open the GUI
 ICCAP_FUNC("get_avail_data_files", "Execute")
 ICCAP_FUNC("./tbl_load_mdms_2_setups", "Display Modeless GUI", "IMPORT DATA")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________1" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "bt_change_dir_browser" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR dirname
 GLOBAL_VAR suffix
 GLOBAL_VAR wildcard
 
 GUIheader = "Select mdm directory (mdm files will be selected later)"
 SelPolicy = "DirOnly"	! Single, Multi, DirOnly
 
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(dirname), VAL$(suffix), VAL$(wildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)=="" THEN
   !---Get the selected directory back
   dirname=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
   !---convert to op.system indep. style
   dirname=SYS_PATH$(VAL$(dirname))
 ELSE
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---update list of currently avail. mdm file
 ICCAP_FUNC("get_avail_data_files", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "get_avail_data_files" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !---initialize Variables
 filename=""
 GUI_sel_data_file=-1
 
 
 !---verify if current directory name exists
 dir_failure=SYSTEM("cd "&VAL$(SYS_PATH$(VAL$(dirname)))&" 2> /dev/null")	!suppress error msg
 IF dir_failure<>0 THEN
   avail_data_files="ICCAP_ARRAY[0]"
   RETURN_VALUE 0
 END IF
 
 !---show the files with correct suffix and wildcard in directory of Setup Variable 'dirname'
 !   execute the unix 'cd' command, followed by the 'ls'command (which returns the found filenames)
 ls_files=SYSTEM$("cd "&VAL$(SYS_PATH$(VAL$(dirname))) &" 2> /dev/null
 ls *"&VAL$(wildcard)&"*"&VAL$(suffix) &" 2> /dev/null")
 
 !---cut the filenames string into its components
 RetVal=CUTSTR(ls_files, avail_data_files)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________2" "711.501"
{
}
LINK XFORM "find_all_Duts_Setups" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !---identify all DUTs in the Model file
 ICCAP_FIND_CHILDREN "/"&VAL$(modelname), "DUT", dutnames
 
 
 
 !---find out how many Setups are present in the whole Model file
 nr_Path2Setups=0
 FOR i=0 TO SIZEOF(dutnames)-1
   !now find the Setups per DUT
   ICCAP_FIND_CHILDREN "/"&VAL$(modelname)&"/"&VAL$(dutnames[i]),"Setup",setupnames
   IF VAL$(setupnames)<>"" THEN nr_Path2Setups=nr_Path2Setups + SIZEOF(setupnames)
 NEXT i
 
 
 !---initialize the arrays referring to the whole Model file 
 DIMENSION_ARRAY(Path2Setups,         nr_Path2Setups)
 DIMENSION_ARRAY(mdm_filenames,       nr_Path2Setups)
 DIMENSION_ARRAY(mdm_path_filenames,  nr_Path2Setups)
 DIMENSION_ARRAY(status,              nr_Path2Setups)
 
 !---fill the arrays
 N=0
 FOR idut=0 TO SIZEOF(dutnames)-1
   !find the Setups per DUT
   ICCAP_FIND_CHILDREN "/"&VAL$(modelname)&"/"&VAL$(dutnames[idut]),"Setup",setupnames
   !fill up the Path2Setups and the Path2mdms arrays
   FOR isetup=0 TO SIZEOF(setupnames)-1
     !compose DUT/Setup path
     Path2Setup=VAL$(dutnames[idut])&"/"&VAL$(setupnames[isetup])
     Path2Setups[N]=VAL$(Path2Setup)
     N = N + 1 
     PRINT ".";		!show activity in Status window. Note: the ; will cause the PRINT statement to output into the same line
   NEXT isetup
 NEXT idut
 PRINT		!this provides a <CR>
 
 setupnames=""
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "identify_active_Setups" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 IF SIZEOF(GUI_sel_dut)==0 THEN 
   DIMENSION_ARRAY(act_Path2Setups        , 0)
   DIMENSION_ARRAY(act_mdm_filenames      , 0)
   DIMENSION_ARRAY(act_mdm_path_filenames , 0)
   DIMENSION_ARRAY(act_status             , 0)
   act_nr_Path2Setups=0
   GUI_sel_Path2Setup=-1
   PRINT "Transform 'identify_active_Setups' is aborted"
   RETURN_VALUE 0
 END IF
 
 
 !---initialize the arrays referring to the whole Model file 
 DIMENSION_ARRAY(act_Path2Setups        , 0)
 DIMENSION_ARRAY(setupnames             , 0)
 DIMENSION_ARRAY(act_mdm_filenames      , 0)
 DIMENSION_ARRAY(act_mdm_path_filenames , 0)
 DIMENSION_ARRAY(act_status             , 0)
 
 
 !---hide build-up of list in GUI
 Show_act_Path2Setups=0
 
 
 !---if user has added a new DUT, identify its name
 !   it might need to be removed if it does not contain Setups with Output of Type 'M' or 'B'
 GUI_sel_dut_new=0
 IF SIZEOF(GUI_sel_dut_previous)<SIZEOF(GUI_sel_dut) THEN
   FOR i=0 TO SIZEOF(GUI_sel_dut)-1
     PreviousSelection=0
     FOR i1=0 TO SIZEOF(GUI_sel_dut_previous)-1
       IF VAL$(dutnames[GUI_sel_dut[i]])==VAL$(dutnames[GUI_sel_dut_previous[i1]]) THEN PreviousSelection=1
     NEXT i1
     IF PreviousSelection==0 THEN 
       GUI_sel_dut_new=i
       i=SIZEOF(GUI_sel_dut)	!exit also outer loop
       BREAK
     END IF
   NEXT i
 !  GET_STRING "the new selected DUT is "&VAL$(dutnames[GUI_sel_dut[GUI_sel_dut_new]]), dummy
 END IF
 
 
 !---fill the act_xxx arrays
 FOR idut=0 TO SIZEOF(GUI_sel_dut)-1
   !find the Setups per selected DUT
   ICCAP_FIND_CHILDREN "/"&VAL$(modelname)&"/"&VAL$(dutnames[GUI_sel_dut[idut]]), "Setup", setupnames
   !fill up the Path2Setups and the Path2mdms arrays
   IF SIZEOF(setupnames)>0 THEN
     FOR isetup=0 TO SIZEOF(setupnames)-1
       !compose DUT/Setup path
       !- verify if there is at least one Output (=requirement for data import) present
       OutputTypeOK=0
       ICCAP_FIND_CHILDREN "/"&VAL$(modelname)&"/"&VAL$(dutnames[GUI_sel_dut[idut]])&"/"&VAL$(setupnames[isetup]), "Output", outputnames
       IF SIZEOF(outputnames)>0 THEN
         !- verify if Output is of type 'M' or 'B'
         FOR ioutput=0 TO SIZEOF(outputnames)-1
         OutputType=LOOKUP_TABLE_VAL("/"&VAL$(modelname)&"/"&VAL$(dutnames[GUI_sel_dut[idut]])&"/"&VAL$(setupnames[isetup])&"/"&VAL$(outputnames[ioutput]), "Type")
         IF VAL$(OutputType)<>"S" THEN
           OutputTypeOK=1
         END IF
         NEXT ioutput 
       END IF
 
       IF VAL(OutputTypeOK)==1 THEN 
         act_Path2Setup=VAL$(dutnames[GUI_sel_dut[idut]])&"/"&VAL$(setupnames[isetup])
         dummy = ARRAY_INSERT_AT(act_Path2Setups, VAL$(act_Path2Setup))
       ELSE
         dummy=ARRAY_REMOVE_AT(setupnames, isetup)
         isetup = isetup -1
       END IF
     NEXT isetup
   END IF
   IF SIZEOF(setupnames)==0 THEN
     dummy=ARRAY_REMOVE_AT(GUI_sel_dut, GUI_sel_dut_new)
     idut = idut -1
     GET_STRING "There are no Setups within this DUT,
 	or the Setups of this DUT have no Output(s) defined, 
 	or have at least 1 Output of Type 'S' (=simulated) !
 	-> The DUT is not added to 'available DUT/Setups'  [OK]", dummy
   END IF
 NEXT idut
 DIMENSION_ARRAY(setupnames,  0)
 DIMENSION_ARRAY(outputnames, 0)
 
 
 DIMENSION_ARRAY(act_mdm_filenames, SIZEOF(act_Path2Setups))
 DIMENSION_ARRAY(act_mdm_path_filenames, SIZEOF(act_Path2Setups))
 DIMENSION_ARRAY(act_status, SIZEOF(act_Path2Setups))
 
 !---remember currently selected DUTs
 dummy=ARRAY_COPY(GUI_sel_dut, GUI_sel_dut_previous)
 
 
 !---show list in GUI
 Show_act_Path2Setups=1
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_sel_no_DUT" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 DIMENSION_ARRAY(GUI_sel_dut,          0)
 DIMENSION_ARRAY(GUI_sel_dut_previous, 0)
 
 ICCAP_FUNC("identify_active_Setups", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_clear_meas_data" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("/"&VAL$(modelname), "Clear Data/Measured")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________3" "711.501"
{
}
LINK XFORM "load_data_file" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !---check if no .mdm data file was selected
 IF VAL(GUI_sel_data_file)<0 THEN 
   RETURN_VALUE -1
 END IF
 
 
 !---verify if selected directory is OK
 dir_fail=SYSTEM("cd "&VAL$(dirname)&" 2> /dev/null")
 IF (dir_fail<>0) OR (VAL$(dirname)=="") THEN 
   GET_STRING "ERROR: Directory 
 "&VAL$(dirname)&"
  not found !   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---prepare file loading
 filename=avail_data_files[GUI_sel_data_file]
 dirfilename=VAL$(SYS_PATH$(VAL$(dirname))&"/"&VAL$(filename))
 
 
 IF mdm_preview==1 THEN 
   ICCAP_FUNC("mdm_preview_only", "Execute", VAL$(dirfilename))
   RETURN_VALUE 2
 END IF
 
 
 !---check if no Setup was selected
 IF VAL(GUI_sel_Path2Setup)<0 THEN 
   GET_STRING "ERROR: no Setup has been selected by the user !  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---load the file
 path2setup="/"&VAL$(modelname)&"/"&VAL$(act_Path2Setups[GUI_sel_Path2Setup])
 ICCAP_FUNC(VAL$(path2setup), "Import Create", VAL$(dirfilename))
 
 
 !---update current mdm info and current status info
 act_mdm_filenames[GUI_sel_Path2Setup]=VAL$(filename)
 act_mdm_path_filenames[GUI_sel_Path2Setup]=VAL$(dirfilename)
 act_status[GUI_sel_Path2Setup]="loaded!"
 
 
 !---update the big all-include data arrays
 path2setup=VAL$(act_Path2Setups[GUI_sel_Path2Setup])
 FOR i=0 TO SIZEOF(Path2Setups)-1
   IF VAL$(path2setup)==VAL$(Path2Setups[i]) THEN
     mdm_filenames[i]=act_mdm_filenames[GUI_sel_Path2Setup]
     mdm_path_filenames[i]=act_mdm_path_filenames[GUI_sel_Path2Setup]
     status[i]=act_status[GUI_sel_Path2Setup]
   END IF
 NEXT i
 
 
 !---increment selection index of Path2Setup
 GUI_sel_Path2Setup=GUI_sel_Path2Setup + 1
 
 
 !---deactivate variable 'GUI_sel_data_file' (to prevent from default toggling state)
 GUI_sel_data_file=-1
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "auto_load_files" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR  modelname
 GLOBAL_VAR  dirname
 GLOBAL_VAR  avail_data_files
 GLOBAL_VAR  auxvar
 GLOBAL_VAR  DeviceName
 
 
 !---verify first, if selected directory is OK
 dir_fail=SYSTEM("cd "&VAL$(dirname)&" 2> /dev/null")
 IF (dir_fail<>0) OR (VAL$(dirname)=="") THEN 
   GET_STRING "ERROR: Directory 
 "&VAL$(dirname)&"
  not found !   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 ModelName_corr = "/"&TRIM$(VAL$(modelname), "/")
 
 N=0
 FOR i=0 TO SIZEOF(avail_data_files)-1
   act_mdm_FileName= VAL$(avail_data_files[i])
   RetVal=CUTSTR(VAL$(act_mdm_FileName), auxvar, "~")
   IF SIZEOF(auxvar)<>3 THEN CONTINUE	! start next loop
   
   !---at loop start, export DeviceName
   IF i==0 THEN 
     DeviceName = VAL$(auxvar[0])
     DeviceName = TRIM$(VAL$(DeviceName), "_")
     ICCAP_FUNC(VAL$(ModelName_corr), "SetVariableTableValue", "DeviceName", VAL$(DeviceName))
   END IF
 
   DutName = VAL$(auxvar[1])
   SetupName = SUBSTR$(VAL$(auxvar[2]), 1, STRLEN(VAL$(auxvar[2]))-4)
 
 
   !---verify if mdm file's DutName and SetupName exist in Model
   ICCAP_FIND_CHILDREN VAL$(ModelName_corr), "DUT",   auxvar
   DutExist=0
   FOR i1=0 TO SIZEOF(auxvar)-1
     IF VAL$(auxvar[i1])==VAL$(DutName) THEN DutExist=1
   NEXT i1
   IF DutExist==0 THEN CONTINUE	!jump to loop start
   
 
   ICCAP_FIND_CHILDREN VAL$(ModelName_corr)&"/"&VAL$(DutName), "Setup",   auxvar
   SetupExist=0
   FOR i1=0 TO SIZEOF(auxvar)-1
     IF VAL$(auxvar[i1])==VAL$(SetupName) THEN SetupExist=1
   NEXT i1
   IF SetupExist==0 THEN CONTINUE	!jump to loop start
 
 
   !---all OK, load the .mdm file----------
   N = N + 1
   Path2Setup=VAL$(ModelName_corr)&"/"&VAL$(DutName)&"/"&VAL$(SetupName)
   IF VAL(Debug)==1 THEN 
     PRINT "  loading data to ";ModelName_corr,DutName,SetupName
     PRINT "-> importing data to Setup ";Path2Setup;" ..."
   END IF
   mdm_DirFileName = VAL$(SYS_PATH$(VAL$(dirname)))&"/"&VAL$(act_mdm_FileName)
   ICCAP_FUNC(VAL$(Path2Setup), "Import Create", VAL$(mdm_DirFileName))
 NEXT i
 
 
 GET_STRING VAL$(N)&" .mdm files have been imported.   [OK]", dummy
 
 
 !---close GUI
 ICCAP_FUNC("bt_ok", "Execute")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "mdm_preview_only" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GET_STRING "enter dirfilename of mdm file", dirfilename
 
 mdm_header=SYSTEM$("head -35 "&VAL$(dirfilename))
 
 GET_STRING VAL$(mdm_header), "OK", dummy
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________4" "711.501"
{
}
LINK XFORM "bt_ok" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 ICCAP_FUNC("./tbl_load_mdms_2_setups", "Destroy GUI", "IMPORT DATA")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---reset the arrays
 DIMENSION_ARRAY(dutnames,    0)
 DIMENSION_ARRAY(setupnames,  0)
 DIMENSION_ARRAY(outputnames, 0)
 
 DIMENSION_ARRAY(Path2Setups,        0)
 DIMENSION_ARRAY(mdm_filenames,      0)
 DIMENSION_ARRAY(mdm_path_filenames, 0)
 DIMENSION_ARRAY(status,             0)
 
 DIMENSION_ARRAY(act_Path2Setups,        0)
 DIMENSION_ARRAY(act_mdm_filenames,      0)
 DIMENSION_ARRAY(act_mdm_path_filenames, 0)
 DIMENSION_ARRAY(act_status,             0)
 
 DIMENSION_ARRAY(avail_data_files, 0)
 
 
 DIMENSION_ARRAY(GUI_sel_dut,          0)
 DIMENSION_ARRAY(GUI_sel_dut_previous, 0)
 
 
 
 GUI_sel_Path2Setup = -1
 mdm_preview = 0
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "SELECT_EXPORT_DATA" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.8 7266 6095"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 C16 P326 C10"
element 0 "Name" "modelname"
element 0 "Value" "EEHEMT_MODELING"
element 1 "Name" "DUTs[0]"
element 1 "Value" "EXTERNAL_PARAMS_Spar"
element 2 "Name" "DUTs[1]"
element 2 "Value" "EXTERNAL_PARAMS_DC"
element 3 "Name" "DUTs[2]"
element 3 "Value" "DC_MODELING"
element 4 "Name" "DUTs[3]"
element 4 "Value" "SPAR_MODELING"
element 5 "Name" "DUTs[4]"
element 5 "Value" "NONLIN_RF_MDLG"
element 6 "Name" "DUTs[5]"
element 6 "Value" "aux_NONLIN_RF_MDLG"
element 7 "Name" "DUTs"
element 7 "Value" "ICCAP_ARRAY[6]"
element 8 "Name" "selectedDUTs"
element 8 "Value" ""
element 9 "Name" "Setups[0]"
element 9 "Value" "ig_vgs__Input"
element 10 "Name" "Setups[1]"
element 10 "Value" "id_vgs__Transfer_VDSO"
element 11 "Name" "Setups[2]"
element 11 "Value" "id_vgs__Transfer"
element 12 "Name" "Setups[3]"
element 12 "Value" "id_vds__Output"
element 13 "Name" "Setups[4]"
element 13 "Value" "Save_n_Compare"
element 14 "Name" "Setups"
element 14 "Value" "ICCAP_ARRAY[5]"
element 15 "Name" "Outputs"
element 15 "Value" ""
element 16 "Name" "mdm_dir"
element 16 "Value" "/cygdrive/d/d_SisConsult/30_TOOLS___/5_Mdlg/5_Xtors/5_III_V/5a_EEHEMT/ICCAP/data/CustomMMIC/2019-10-04/Data4Mdlg"
element 17 "Name" "mdm_prefix"
element 17 "Value" "_CustomMMIC_4x100~"
element 18 "Name" "______________________"
element 18 "Value" ""
element 19 "Name" ""
element 19 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "SELECT_DUTs_4_EXPORT"
element 0 "Value" "TL|HT=500:OR=VE:TO=TT&TL:WD=500|<none>|#212TL_OK_Cancel:#215TL_selected_dir:#213TL_mdm_prefix:#220LA_Sel_Duts_4_Export:#19TL_Export:#13sep:#220LI_Sel_Duts_4_Export|1|0"
element 1 "Name" "SELECT_DUTs_4_EXPORT.LA_Sel_Duts_4_Export"
element 1 "Value" "LA|CA=#3140- From the list below,\012  select the DUTs for which you want to export meas.data from.\012- Then hit  [\075\075>  Export Data  <\075\075].:FG=C6:TO=FW&FH&TL|<none>|<none>|0"
element 2 "Name" "SELECT_DUTs_4_EXPORT.TL_Export"
element 2 "Value" "TL|NC=2:OR=HO:TO=FH&dummy|<none>|#214PB_export_data|1"
element 3 "Name" "SELECT_DUTs_4_EXPORT.TL_Export.PB_export_data"
element 3 "Value" "PB|CA=#233\075\075>  Export Data  <\075\075:TO=FW&FH|AC=#221manage_and_export_mdm&#17Execute|<none>|0"
element 4 "Name" "SELECT_DUTs_4_EXPORT.TL_selected_dir"
element 4 "Value" "TL|FV=T:OR=VE:TO=FH&MH&LH|<none>|#215ED_selected_dir:#210PB_sel_dir|1"
element 5 "Name" "SELECT_DUTs_4_EXPORT.TL_selected_dir.ED_selected_dir"
element 5 "Value" "ED|BG=C9:CA=#219.mdm Export Dir\072:ED=T:VA=%#17mdm_dir:TO=TL&dummy|<none>|<none>|0"
element 6 "Name" "SELECT_DUTs_4_EXPORT.TL_selected_dir.PB_sel_dir"
element 6 "Value" "PB|CA=#210Change Dir:TO=FW&FH&TR|AC=#221bt_change_dir_browser&#210Execute, 1|<none>|0"
element 7 "Name" "SELECT_DUTs_4_EXPORT.sep"
element 7 "Value" "SE|OR=HO:TO=FH&MH&LH|<none>|<none>|0"
element 8 "Name" "SELECT_DUTs_4_EXPORT.TL_mdm_prefix.ED_mdm_prefix"
element 8 "Value" "ED|CA=#232mdm Prefix (e.g.\072  myDevice~):VA=%#210mdm_prefix|<none>|<none>|0"
element 9 "Name" "SELECT_DUTs_4_EXPORT.TL_mdm_prefix"
element 9 "Value" "TL|FV=T:OR=HO:TO=FH&dummy|<none>|#213ED_mdm_prefix|1"
element 10 "Name" "SELECT_DUTs_4_EXPORT.LI_Sel_Duts_4_Export"
element 10 "Value" "LI|IT=%#14DUTs:SI=%#212selectedDUTs:SY=ES|<none>|<none>|0"
element 11 "Name" "SELECT_DUTs_4_EXPORT.TL_OK_Cancel"
element 11 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#13sep:#19PB_Cancel:#17PB_Done|1"
element 12 "Name" "SELECT_DUTs_4_EXPORT.TL_OK_Cancel.PB_Cancel"
element 12 "Value" "PB|CA=#16Cancel:TO=FW&FH|AC=#212bt_ok_cancel&#17Execute|<none>|0"
element 13 "Name" "SELECT_DUTs_4_EXPORT.TL_OK_Cancel.sep"
element 13 "Value" "LA|TO=LH&MH&FH|<none>|<none>|0"
element 14 "Name" "SELECT_DUTs_4_EXPORT.TL_OK_Cancel.PB_Done"
element 14 "Value" "PB|CA=#18OK, Done:TO=FW&FH|AC=#212bt_ok_cancel&#17Execute|<none>|0"
element 15 "Name" ""
element 15 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,932,790"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 
 ! This GUI allows to select DUTs from a Model file,
 ! and for the selected DUTs, a Data Export 
 ! into .mdm files for all Setups within the
 ! selected DUTs will be applied.
 
 
 !HINTS:
 !============================================================
 !###  If you want to add Transform data to your .mdm files  ###
 !you need to specify (in SetupVariables) the SystemVariable
 !->  MDM_EXPORT_XFORM_DATA=1
 !->  MDM_XFORM_LIST (see details below)
 !    probably best in the DUT or Model Variable table 
 !    of your Model file.
 !EXAMPLE: for de-embedding, you may want the data behind 
 !         Transform 'S_deemb' being exported. 
 !
 !
 !###  If you want to add Variables to the .mdm file  ###
 !you need to specify the SystemVariable
 !->  MDM_VALUES_LIST
 !    probably best in the DUT or Model Variable table 
 !    of your Model file which this Transforms works on.
 !EXAMPLE: date, username, devicename, lotname, wafername 
 !         L, W, MULT (or _M), SA, SB etc.
 
 ! NOTES:
 ! ======
 ! MDM_XFORM_LIST specifies a comma separated list of 
 ! Transform names that will be exported when the 
 ! corresponding Setup is exported.  
 ! In addition you may specify the mode, nodes, and 
 ! other data which will appear in the new Output of the loaded .mdm file.  
 ! This means: Each transform entry in the comma separated
 ! list will appear in the .mdm file as an Output.  
 
 
 ! MDM_VALUES_LIST specifies a space or comma separated 
 ! list of Parameter or Variable names.  The values 
 ! of these Paramters/Variables are written to the MDM file.  
 ! When an .mdm file with values stored in it, is imported 
 ! or used to auto-create a Setup, these Paramters/Variables 
 ! are automatically reset to the values stored 
 ! in the .mdm file.  However, if a Parameter or 
 ! Variable does not exist in the Setup being imported to, 
 ! a Variable will be created for that value in the 
 ! Setup Variables Table.
 ! 
 ! HINT: the lists are either comma separated, or space separated,
 ! but not both !!!
 
 ! NOTE: 
 ! See SystemVariables/DataManagerOptions for details.
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! Simply add a Macro or Transform to your local Model
 ! with the following contents:
 !--------------------------------------------------------
 
 
 Path2Model = WHOIS(".", "Parent Model")
 
 GET_STRING "Enter [an optional] prefix for the mdm file names
 	[ending with a separator sign like ~   e.g.  4711~]", mdm_Prefix
 
 DataDir = "."	! although the GUI offes a dir browser, you can also define here a specific data directory
 
 !---call the central Macro in UTILITIES.mdl
 Path2Utilities="/UTILITIES/MDM_UTILITIES/SELECT_EXPORT_DATA/SELECT_EXPORT_DATA"
 ICCAP_FUNC(Path2Utilities, "Execute", VAL$(Path2Model), VAL$(mdm_Prefix), VAL$(DataDir))
 
 ! NOTE: the arguments after "Execute" in the ICCAP_FUNC above 
 ! anticipate the GET_STRINGs in Transform 'SELECT_EXPORT_DATA' in UTILITIES.mdl
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________1" "711.501"
{
}
LINK XFORM "SELECT_EXPORT_DATA" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. Xfm '/UTILITIES/MDM_UTILITIES/SELECT_EXPORT_DATA' ..."
 
 GLOBAL_VAR  modelname
 GLOBAL_VAR  DUTs
 GLOBAL_VAR  Setups
 GLOBAL_VAR  Outputs
 GLOBAL_VAR  mdm_prefix
 GLOBAL_VAR  mdm_dir
 
 
 !---this program exports the data of all the Setups of user-selected DUTs 
 
 GET_STRING "Enter model name  [without leading '/']", modelname, modelname
 GET_STRING "Enter prefix for mdm file names [e.g. my_device~]", mdm_prefix, mdm_prefix
 GET_STRING "Enter data directory (can also be set later in the GUI)", mdm_dir, mdm_dir
 
 
 !---normalize mdm_prefix: add a trailing '~' independently of user's input
 mdm_prefix = TRIM$(VAL$(mdm_prefix), "~")&"~"
 !---make dir name op.system independent
 mdm_dir = SYS_PATH$(VAL$(mdm_dir))
 
 
 !---find all DUTs
 DUTs=""
 selectedDUTs  =""
 ICCAP_FIND_CHILDREN "/"&VAL$(modelname), "DUT", DUTs
 
 
 !---remove DUTs which do not include meas. data
 iDUT=0
 WHILE iDUT < SIZEOF(DUTs)
   DutDataAvail=0
   !---find names of the Setups of the current DUT
   Setups=""
   ICCAP_FIND_CHILDREN "/"&VAL$(modelname)&"/"&VAL$(DUTs[iDUT]), "Setup" ,Setups
   iSetup=0
   FOR iSetup = 0 TO SIZEOF(Setups)-1
     ! check if the Setup has Outputs (data)
     Outputs=""
     ICCAP_FIND_CHILDREN "/"&VAL$(modelname)&"/"&VAL$(DUTs[iDUT])&"/"&VAL$(Setups[iSetup]), "Output", Outputs
     FOR iOutput=0 TO SIZEOF(Outputs)-1
       Path2Output = "/"&VAL$(modelname)&"/"&VAL$(DUTs[iDUT])&"/"&VAL$(Setups[iSetup])&"/"&VAL$(Outputs[iOutput])
       OutputType = LOOKUP_TABLE_VAL(VAL$(Path2Output), "Type")
       IF VAL$(OutputType)<>"S" THEN DutDataAvail=1
     NEXT iOutput
   NEXT iSetup
 
   IF DutDataAvail==0 THEN
     dummy = ARRAY_REMOVE_AT(DUTs, iDUT)
     iDUT = iDUT - 1
   END IF
 
   iDUT = iDUT + 1
 END WHILE
 
 
 !---open the DUT Selection GUI
 ICCAP_FUNC("./SELECT_DUTs_4_EXPORT", "Display Modeless GUI", "EXPORT DATA")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________2" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "bt_change_dir_browser" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR mdm_dir
 
 GUIheader = "Select mdm directory for meas. data export"
 SelPolicy = "DirOnly"	! Single, Multi, DirOnly
 suffix = ""
 wildcard = ""
 
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(mdm_dir), VAL$(suffix), VAL$(wildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)=="" THEN
   !---Get the selected directory back
   mdm_dir=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
   !---convert to op.system indep. style
   mdm_dir=SYS_PATH$(VAL$(mdm_dir))
 ELSE
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "manage_and_export_mdm" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. Xfm 'manage_and_export_mdm' ..."
 
 
 !---first check if nothing was selected
 IF VAL$(selectedDUTs)=="" THEN 
   GET_STRING "ERROR: nothing selected ! [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 !---verify if selected directory is OK
 dir_fail=SYSTEM("cd "&VAL$(mdm_dir)&" 2> /dev/null")
 IF (dir_fail<>0) OR (VAL$(mdm_dir)=="") THEN 
   GET_STRING "ERROR: Directory 
 "&VAL$(mdm_dir)&"
  not found !   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---now export the data in the Setups of the selected DUTs
 ICCAP_FUNC("/", "Status Window")		! brings status window to top level
 N=0
 iDut=0
 WHILE iDut < SIZEOF(selectedDUTs)
   dutindex=selectedDUTs[iDut]  
   !---find names of the setups of the current dut
   Path2Dut = "/"&VAL$(modelname)&"/"&VAL$(DUTs[dutindex])
   ICCAP_FIND_CHILDREN VAL$(Path2Dut), "Setup", Setups
   iSetup=0
   WHILE iSetup < SIZEOF(Setups)
     !---export mdm files for all setups of current DUT
     !---check if the Setup is not empty (has no Output tiles)
     Path2Setup = VAL$(Path2Dut)&"/"&VAL$(Setups[iSetup])
     ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Output", Outputs
     IF VAL$(Outputs)<>"" THEN
       ExportSetupData=1
       !---verify if Setup has meas. data and not just 0 values
       MeasData=0
       FOR iOutput=0 TO SIZEOF(Outputs)-1
         Path2Output = VAL$(Path2Setup)&"/"&VAL$(Outputs[iOutput])
         tmpOutputData = DATASET("quiet "&VAL$(Path2Output))
         !---if it's S-paramaters, it's multi-dimensional data -> build the mean val from S11.M
         OutputMode = LOOKUP_TABLE_VAL(VAL$(Path2Output), "Mode")
         !---check if it's Spar or MultiPort Spar
         IF (VAL$(OutputMode)=="S") ORELSE (VAL$(OutputMode)=="M") THEN  
           tmp=0
           FOR i=0 TO SIZEOF(tmpOutputData)-1
             tmp = tmp + tmpOutputData.M.11[i]
           NEXT i
           IF tmp<>0 THEN MeasData=1
         ELSE 		!---no S-parameters
           IF MEAN(tmpOutputData.M)<>0 THEN MeasData=1
         END IF
       NEXT iOutput
 
       !---handle Setups with zero data      
       IF MeasData==0 THEN 
         ExportSetupData="no"
         GET_STRING "Seems that Setup "&VAL$(Path2Setup)&" has no meas. data !
              Do you want to export the data anyway ? [no], [yes]", VAL$(ExportSetupData), ExportSetupData
       END IF
       
       !---upon request, export data of this Setup
       IF LWC$(VAL$(ExportSetupData))<>"no" THEN
         N = N + 1
         path2setup ="/"&VAL$(modelname)&"/"&VAL$(DUTs[dutindex])&"/"&VAL$(Setups[iSetup])
         mdmfilename=VAL$(mdm_prefix)&VAL$(DUTs[dutindex])&"~"&VAL$(Setups[iSetup])
         mdmdirfilename=VAL$(mdm_dir)&"/"&VAL$(mdmfilename)
         PRINT "exporting data of "&VAL$(path2setup)&"..."
         ICCAP_FUNC(path2setup, "Export Data Measured", mdmdirfilename)
       END IF
     END IF
     iSetup = iSetup+1
   END WHILE
   iDut = iDut + 1
 END WHILE
 
 !ICCAP_FUNC("Clean_Up", "Execute")
 
 GET_STRING "Data of "&VAL$(N)&" Setups have been exported!   [OK]", dummy
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_ok_cancel" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. Xfm 'bt_cancel' ..."
 
 selectedDUTs=""
 
 ICCAP_FUNC("./SELECT_DUTs_4_EXPORT", "Destroy GUI", "EXPORT DATA")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec. Xfm 'Clean_Up' ..."
 
 !---reset the arrays
 DUTs           ="ICCAP_ARRAY[0]"
 Setups         ="ICCAP_ARRAY[0]"
 Outputs        ="ICCAP_ARRAY[0]"
 selectedDUTs   ="ICCAP_ARRAY[0]"
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
}
LINK DUT "_____________________________________3" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "MDLG_GUI" "711.501"
{
View tree_dut 0 "0"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 C10 C10 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P15 P100 P100 P100 P100 P100 P100 P100"
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "GENERAL_MDLG_GUI" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.6639351523742 7513 3326"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P284 P187 P174"
element 0 "Name" "!PLOT_TRACE_LINE_WIDTH"
element 0 "Value" "it's an ICCAP/Main/SystemVariable !!!"
element 1 "Name" "ErrMsg"
element 1 "Value" ""
element 2 "Name" "tmpVar[0]"
element 2 "Value" "_MP_ParamEvolution_"
element 3 "Name" "tmpVar[1]"
element 3 "Value" "_MP_"
element 4 "Name" "tmpVar"
element 4 "Value" "ICCAP_ARRAY[2]"
element 5 "Name" "tmpRead"
element 5 "Value" "}"
element 6 "Name" "Path2Setup"
element 6 "Value" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/.."
element 7 "Name" "Path2Xfm"
element 7 "Value" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS"
element 8 "Name" "Plots"
element 8 "Value" "../../CalVerify_SHORT/SHORT/L10_L20, ../../CalVerify_OPEN/OPEN/C10_C20, ../../CalVerify_THRU/THRU/_TD_, ../../CalVerify_THRU/THRU/_Z0_, ../../CalVerify_LOAD/LOAD/R10_R20, ../../CalVerify_LOAD/LOAD/L10_L20, !../../CalVerify_OPEN/OPEN/Sxx, !../../CalVerify_SHORT/SHORT/Sxx, !../../CalVerify_LOAD/LOAD/Sxx, !../../CalVerify_THRU/THRU/Sxx, !../../CalVerify_THRU/THRU/Sxy"
element 9 "Name" "PlotNames"
element 9 "Value" "ICCAP_ARRAY[0]"
element 10 "Name" "PlotNames_sel"
element 10 "Value" "ICCAP_ARRAY[0]"
element 11 "Name" "Path2FirstPlot"
element 11 "Value" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_SHORT/SHORT/L10_L20"
element 12 "Name" "Parameters"
element 12 "Value" "n/a"
element 13 "Name" "ParamNames"
element 13 "Value" "ICCAP_ARRAY[0]"
element 14 "Name" "ParamNames_sel"
element 14 "Value" "ICCAP_ARRAY[0]"
element 15 "Name" "ParamName_ViewValues"
element 15 "Value" "0"
element 16 "Name" "MdlgStep"
element 16 "Value" "ICCAP_ARRAY[0]"
element 17 "Name" "MdlgStep_sel"
element 17 "Value" "0"
element 18 "Name" "Comment"
element 18 "Value" "Verify the results of all the calibration re-measurement:
 -> the SHORT re-measurement is the most challenging verification test
 -> followed by the OPEN
 -> the THRU
 -> and the LOAD"
element 19 "Name" "TuneFast"
element 19 "Value" "1"
element 19 "Comment" "Flag defined in the GUI"
element 20 "Name" "ShowAreaTools"
element 20 "Value" "1"
element 21 "Name" "ParamEvolutionShowAreaTools"
element 21 "Value" "0"
element 22 "Name" "__________________________1"
element 22 "Value" ""
element 23 "Name" "FlagDefineExtrBox"
element 23 "Value" "0"
element 24 "Name" "GUI_Sensitivity_PO_Features"
element 24 "Value" "0"
element 24 "Comment" "grey out Params&Plots buttons or not"
element 25 "Name" "GUI_Sensitivity_Undo"
element 25 "Value" "0"
element 25 "Comment" "grey out Undo-Optimize button or not"
element 26 "Name" "PO_Error_Choices[0]"
element 26 "Value" "Abs"
element 27 "Name" "PO_Error_Choices[1]"
element 27 "Value" "Rel"
element 28 "Name" "PO_Error_Choices"
element 28 "Value" "ICCAP_ARRAY[2]"
element 29 "Name" "PO_Error_Choices_sel"
element 29 "Value" "1"
element 30 "Name" "PO_OptType_Choices[0]"
element 30 "Value" "Levenb-Marqu"
element 31 "Name" "PO_OptType_Choices[1]"
element 31 "Value" "Gradient"
element 32 "Name" "PO_OptType_Choices[2]"
element 32 "Value" "Rand.MiniMax"
element 33 "Name" "PO_OptType_Choices[3]"
element 33 "Value" "Sensitivity"
element 34 "Name" "PO_OptType_Choices"
element 34 "Value" "ICCAP_ARRAY[4]"
element 35 "Name" "PO_OptType_Choices_sel"
element 35 "Value" "0"
element 36 "Name" "String2Array"
element 36 "Value" "ICCAP_ARRAY[0]"
element 37 "Name" "avail_ParamGroup"
element 37 "Value" "ICCAP_ARRAY[0]"
element 38 "Name" "avail_ParamGroup_sel"
element 38 "Value" "ICCAP_ARRAY[0]"
element 39 "Name" "avail_ParamGroup_sel2add"
element 39 "Value" "-1"
element 40 "Name" "avail_ParamNames"
element 40 "Value" "ICCAP_ARRAY[0]"
element 41 "Name" "avail_ParamNames_sel"
element 41 "Value" "ICCAP_ARRAY[0]"
element 42 "Name" "ParamNamesWildCard"
element 42 "Value" ""
element 43 "Name" "NrModelParameters"
element 43 "Value" "3"
element 44 "Name" "Params"
element 44 "Value" "ICCAP_ARRAY[0]"
element 45 "Name" "txt_HELP"
element 45 "Value" "#############################################################################################"
element 46 "Name" "Filename_LogMdlgStep"
element 46 "Value" "_LogMdlgStep.txt"
element 47 "Name" "__________________________2"
element 47 "Value" ""
element 48 "Name" "ParamNames_act"
element 48 "Value" ""
element 48 "Comment" "used by Xfm 'GUI_Edit_Parent_Xfm'"
element 49 "Name" "PlotNames_act"
element 49 "Value" "Sxx, Sxy, !Zxx, C10_C20, !MAG_Sxx, !PH_Sxx, !Isolation, !Z12, !C12"
element 49 "Comment" "used by Xfm 'GUI_Edit_Parent_Xfm'"
element 50 "Name" "XfmContents"
element 50 "Value" ""
element 51 "Name" "__________________________3"
element 51 "Value" ""
element 52 "Name" "XPos"
element 52 "Value" "536"
element 53 "Name" "YPos"
element 53 "Value" "138"
element 54 "Name" "NrParamGroupItems"
element 54 "Value" "5"
element 55 "Name" "Reset_Plot_Colors"
element 55 "Value" "0"
element 55 "Comment" "activated in GUI Checkbox: do reset Plot Colors"
element 56 "Name" "__________________________4"
element 56 "Value" ""
element 57 "Name" "LSYNC_exist"
element 57 "Value" "0"
element 58 "Name" "__________________________5"
element 58 "Value" ""
element 59 "Name" ""
element 59 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "GUI_MultiPlot_TOP"
element 0 "Value" "TL|OR=HO|<none>|#211TL_Comments:#213TL_PO_Actions|1|0"
element 1 "Name" "GUI_MultiPlot_TOP.TL_Comments.LA_Comment"
element 1 "Value" "LA|BG=C83:CA=%#17Comment:FI=DF|<none>|<none>|0"
element 2 "Name" "GUI_MultiPlot_RIGHT"
element 2 "Value" "TL|<none>|<none>|#217TL_Header_Extract:#218TL_TuneOptimParams:#14SEP1:#18TL_Plots:#216PB_EditParentXfm|0|2"
element 3 "Name" "GUI_MultiPlot_TOP_RIGHT"
element 3 "Value" "TL|<none>|<none>|#15PB_OK:#19PB_Cancel:#17PB_Help|0|1"
element 4 "Name" "GUI_MultiPlot_TOP_RIGHT.PB_OK"
element 4 "Value" "PB|CA=#210OK, Done !:TO=FH&dummy|AC=#213GUI_OK_Cancel&#210Execute,OK|<none>|0"
element 5 "Name" "GUI_MultiPlot_TOP_RIGHT.PB_Cancel"
element 5 "Value" "PB|CA=#16Cancel:SF=%GUI_Sensitivity_PO_Features:TO=FH&dummy|AC=#213GUI_OK_Cancel&#214Execute,Cancel|<none>|0"
element 6 "Name" "GUI_AddParamNames"
element 6 "Value" "TL|HT=650|<none>|#15PB_OK:#18LA_Notes:#19TL_Params|0|3"
element 7 "Name" "GUI_AddParamNames.LA_Notes"
element 7 "Value" "LA|CA=#281Select Model Params to be \012Added to Current Param \012Selection. Then, hit OK.:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 8 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.LA_Header"
element 8 "Value" "LA|CA=#220TUNE/OPTIMIZE PARAMS:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 9 "Name" "GUI_MultiPlot_TOP.TL_Comments"
element 9 "Value" "TL|OR=VE|<none>|#210LA_Comment|1"
element 10 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams"
element 10 "Value" "TL|MF=%GUI_Sensitivity_PO_Features:OR=VE|<none>|#19LA_Header:#215TL_ParamHistory:#19TL_Params|1"
element 11 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_ParamHistory"
element 11 "Value" "TL|FV=T:OR=VE:SF=%NrModelParameters:TO=FH&dummy|<none>|#210SB_History:#217PB_ParamEvolution|1"
element 12 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_ParamHistory.PB_ParamEvolution"
element 12 "Value" "PB|CA=#223Show MdlParam.Evolution:TO=FH&dummy|AC=#219GUI_Param_Evolution&#17Execute|<none>|0"
element 13 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_Params.LI_ParamNames"
element 13 "Value" "LI|CA=#217Select Parameters:IT=%#210ParamNames:SI=%#214ParamNames_sel:SY=ES|LS=#217GUI_ParamNamesSel&#17Execute|<none>|0"
element 14 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_Params"
element 14 "Value" "TL|FV=T:OR=VE|<none>|#213LI_ParamNames:#215TL_ManageParams:#223LI_PARAMGROUP_Selection|1"
element 15 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_Params.TL_ManageParams.PB_AddParams"
element 15 "Value" "PB|CA=#13Add:TO=FH&dummy|AC=#214GUI_Add_Params&#218Execute,Create GUI|<none>|0|3"
element 16 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_Params.TL_ManageParams"
element 16 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#212PB_AddParams:#212PB_DelParams:#220PB_RestoreOrigParams|1|3"
element 17 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_Params.TL_ManageParams.PB_DelParams"
element 17 "Value" "PB|CA=#13Del:TO=FW&FH|AC=#213GUI_DelParams&#17Execute|<none>|0"
element 18 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_Params.LI_PARAMGROUP_Selection"
element 18 "Value" "LI|CA=#219Select Param. Group:IT=%#216avail_ParamGroup:SI=%#220avail_ParamGroup_sel:SY=ES:TO=FH&dummy:VI=%#217NrParamGroupItems|LS=#216GUI_Param_Groups&#17Execute|<none>|0"
element 19 "Name" "GUI_MultiPlot_RIGHT.TL_Header_Extract.LA_Header_Extract"
element 19 "Value" "LA|CA=#3551\075\075\075\075\075\075\075\075\075\075\075\075\075\075\012CURRENT STATUS\072\012PREPARING A \012BOX-DEFINED \012PARAM. EXTRACTION \012\075\075\075\075\075\075\075\075\075\075\075\075\075\075\012\012-> To specify a new \012*black* extraction box, \012click the left mouse button \012and draw the box.\012\012Then, hit the 'R' key \012(like 'Rectangle')\012on your keyboard, \012and hit the 'OK, Done !' \012button on the upper right \012of this Window, to apply \012this new extraction box.\012\075\075\075\075\075\075\075\075\075\075\075\075\075\075:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 20 "Name" "GUI_MultiPlot_RIGHT.TL_Header_Extract"
element 20 "Value" "TL|MF=%FlagDefineExtrBox:OR=VE|<none>|#217LA_Header_Extract:#15space|0"
element 21 "Name" "GUI_MultiPlot_RIGHT.TL_Header_Extract.space"
element 21 "Value" "TL|<none>|<none>|<none>|0"
element 22 "Name" "GUI_MultiPlot_TOP_RIGHT.PB_Help"
element 22 "Value" "PB|CA=#219Help Using This GUI:MF=%GUI_Sensitivity_PO_Features:TO=FH&dummy|AC=#16README&#17Execute|<none>|0"
element 23 "Name" "GUI_ParamEvolution"
element 23 "Value" "TL|OR=HO|<none>|#210SB_History:#18LA_Notes:#212TL_Utilities:#15Space:#15PB_OK|0|4"
element 24 "Name" "GUI_ParamEvolution.SB_History"
element 24 "Value" "SB|CA=#219Model Param History:ED=T:IT=%#18MdlgStep:TO=FH&dummy:SW=F:SS=%#212MdlgStep_sel:ST=TS|EP=#217GUI_Spin_MdlgStep&#17Execute:VI=#217GUI_Spin_MdlgStep&#17Execute:VD=#217GUI_Spin_MdlgStep&#17Execute|<none>|1"
element 25 "Name" "GUI_ParamEvolution.LA_Notes"
element 25 "Value" "LA|CA=#3391The intention with this ModelParameter Evolution Plot is to give a graphical view on the parameter values.\012If you are not happy with their current physical values, you can identify the modeling step in the history,\012for which the corresponding parameter (still) have been physical.\012Just enter that modeling step into the field to the left, and continue with modeling in the main GUI.:FG=C6|<none>|<none>|1"
element 26 "Name" "GUI_ParamEvolution.Space"
element 26 "Value" "TL|<none>|<none>|<none>|0"
element 27 "Name" "GUI_Help"
element 27 "Value" "TS|HT=600:WD=800|<none>|#19lbl_Notes|0|5"
element 28 "Name" "GUI_Help.lbl_Notes"
element 28 "Value" "LA|BG=C9:CA=%#18txt_HELP:FI=FF:FG=C6|<none>|<none>|0"
element 29 "Name" "GUI_AddParamNames.PB_OK"
element 29 "Value" "PB|CA=#12OK:TO=FW&FH&TR|AC=#214GUI_Add_Params&#210Execute,OK|<none>|0"
element 30 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions"
element 30 "Value" "TL|NC=4:OR=VE:TO=FW&FH|<none>|#17TL_Tune:#211PB_Simulate:#215CB_AreaToolsOff:#211PB_Optimize:#17PB_UnDo:#218CB_ResetPlotColors:#210LA_OptType:#19LA_OptErr:#220LA_Show_LSYNC_Values:#218DC_PO_Optim_Choice:#218DC_PO_Error_Choice:#220CB_Show_LSYNC_Values|1"
element 31 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.TL_Tune.PB_Tune"
element 31 "Value" "PB|CA=#14Tune:TO=FH&dummy|AC=#214GUI_PO_Actions&#212Execute,Tune|<none>|1"
element 32 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.TL_Tune"
element 32 "Value" "TL|MF=%GUI_Sensitivity_PO_Features:OR=HO|<none>|#17PB_Tune:#212CB_TuneSpeed|1"
element 33 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.TL_Tune.CB_TuneSpeed"
element 33 "Value" "CB|CA=#14Fast:TS=%TuneFast|<none>|<none>|0"
element 34 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.PB_Simulate"
element 34 "Value" "PB|CA=#215Simul. PO Plots:MF=%GUI_Sensitivity_PO_Features:TO=FH&dummy|AC=#214GUI_PO_Actions&#219Execute,SimulateAll:TC=#225./GUI_Help_ParamAutoLimit&#241Display Modeless GUI, Help ParamAutoLimit|<none>|0"
element 35 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.CB_AreaToolsOff"
element 35 "Value" "CB|CA=#213Area Tools On:TS=%ShowAreaTools|TC=#218GUI_AreaToolsOnOff&#17Execute|<none>|0"
element 36 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.PB_Optimize"
element 36 "Value" "PB|CA=#18Optimize:MF=%GUI_Sensitivity_PO_Features:TO=FH&dummy|AC=#214GUI_PO_Actions&#226Execute,AutosetAndOptimize|<none>|0"
element 37 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.PB_UnDo"
element 37 "Value" "PB|CA=#214Undo Tune/Opt.:MF=%GUI_Sensitivity_PO_Features:TO=FH&dummy|AC=#214GUI_PO_Actions&#217Execute,UndoOptim|<none>|0"
element 38 "Name" "GUI_ParamEvolution.PB_OK"
element 38 "Value" "PB|CA=#12OK:TO=FW&FH&TT&TR|AC=#219_MP_ParamEvolution_&#15Close|<none>|0|7"
element 39 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_Params.TL_ManageParams.PB_RestoreOrigParams"
element 39 "Value" "PB|CA=#17Restore:TO=FH&dummy|AC=#218GUI_Restore_Params&#17Execute|<none>|0"
element 40 "Name" "GUI_ParamEvolution.TL_Utilities.DC_ViewParamValues"
element 40 "Value" "DC|CA=#223Show Model Param.Values:IT=%#210ParamNames:SX=%#220ParamName_ViewValues:TO=FW&FH&TT|LS=#216View_ParamValues&#17Execute|<none>|0"
element 41 "Name" "GUI_ParamEvolution.TL_Utilities"
element 41 "Value" "TL|NC=2:OR=VE|<none>|#218DC_ViewParamValues:#216CB_ShowAreaTools:#222LA_OnlyMdlVarSupported|1"
element 42 "Name" "GUI_ParamEvolution.TL_Utilities.CB_ShowAreaTools"
element 42 "Value" "CB|CA=#215Show Area Tools:TS=%ParamEvolutionShowAreaTools|TC=#224GUI_ParamEvolAreaToolsOn&#17Execute|<none>|0"
element 43 "Name" "GUI_EditParentXfm"
element 43 "Value" "TL|CA=#221Edit Parent Transform:HT=600:OR=VE:WD=700:LX=%#14XPos:LY=%#14YPos|<none>|#223TL_PlotNames_ParamNames:#13SEP:#219ED_XfmMacroContents:#212TL_OK_Cancel|1|6"
element 44 "Name" "GUI_EditParentXfm.TL_PlotNames_ParamNames.ED_PlotNames_act"
element 44 "Value" "ED|CA=#19Plots\072:ED=T:VA=%#213PlotNames_act:TO=FH&dummy|<none>|<none>|0"
element 45 "Name" "GUI_MultiPlot_RIGHT.SEP1"
element 45 "Value" "LA|CA=#260\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075:TO=FH&dummy|<none>|<none>|0"
element 46 "Name" "GUI_MultiPlot_RIGHT.TL_Plots.LI_PlotNames"
element 46 "Value" "LI|CA=#212Select Plots:IT=%#19PlotNames:SI=%#213PlotNames_sel:SY=ES|LS=#216GUI_PlotNamesSel&#17Execute|<none>|0"
element 47 "Name" "GUI_MultiPlot_RIGHT.TL_Plots"
element 47 "Value" "TL|FV=T:OR=VE|<none>|#212LI_PlotNames:#216TL_Add_Del_Plots|1"
element 48 "Name" "GUI_MultiPlot_RIGHT.TL_Plots.TL_Add_Del_Plots.PB_AddPlots"
element 48 "Value" "PB|CA=#13Add:TO=FH&dummy|AC=#216GUI_Manage_Plots&#211Execute,Add|<none>|0|3"
element 49 "Name" "GUI_MultiPlot_RIGHT.TL_Plots.TL_Add_Del_Plots"
element 49 "Value" "TL|OR=HO:TO=FH&TB|<none>|#211PB_AddPlots:#211PB_DelPlots:#219PB_RestoreOrigPlots|1|3"
element 50 "Name" "GUI_MultiPlot_RIGHT.TL_Plots.TL_Add_Del_Plots.PB_DelPlots"
element 50 "Value" "PB|CA=#13Del:TO=FH&MW|AC=#216GUI_Manage_Plots&#214Execute,Delete|<none>|0|3"
element 51 "Name" "GUI_MultiPlot_RIGHT.TL_Plots.TL_Add_Del_Plots.PB_RestoreOrigPlots"
element 51 "Value" "PB|CA=#17Restore:TO=FH&dummy|AC=#217GUI_Restore_Plots&#17Execute|<none>|0"
element 52 "Name" "GUI_MultiPlot_RIGHT.PB_EditParentXfm"
element 52 "Value" "PB|CA=#215Edit Parent Xfm:TO=FW&FH|AC=#219GUI_Edit_Parent_Xfm&#17Execute|<none>|0"
element 53 "Name" "GUI_EditParentXfm.ED_XfmMacroContents"
element 53 "Value" "ED|CA=#3221NOTES\072 For Edit/Search and for Edit/Replace features, copy from the editor field below into an external editor, \012perform there your manipulations, and paste the result back into the IC-CAP window. Finally, hit [OK].:EM=ML:ED=T:VA=%#211XfmContents|<none>|<none>|0"
element 54 "Name" "GUI_EditParentXfm.TL_OK_Cancel"
element 54 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#19PB_Cancel:#15PB_OK|1"
element 55 "Name" "GUI_EditParentXfm.TL_OK_Cancel.PB_Cancel"
element 55 "Value" "PB|CA=#16Cancel:TO=FW&FH|AC=#219GUI_CloseXfmEditing&#214Execute,Cancel|<none>|0"
element 56 "Name" "GUI_EditParentXfm.TL_OK_Cancel.PB_OK"
element 56 "Value" "PB|CA=#12OK:TO=FW&FH|AC=#219GUI_CloseXfmEditing&#210Execute,OK|<none>|0"
element 57 "Name" "GUI_EditParentXfm.TL_PlotNames_ParamNames"
element 57 "Value" "TL|CA=#279Currently Used Params and Plots (for copy-pasting into Editor Window below)\072:OR=VE:TO=FH&dummy|<none>|#217ED_ParamNames_act:#216ED_PlotNames_act|1"
element 58 "Name" "GUI_EditParentXfm.TL_PlotNames_ParamNames.ED_ParamNames_act"
element 58 "Value" "ED|CA=#214Parameters\072:ED=T:VA=%#214ParamNames_act:TO=FH&dummy|<none>|<none>|0"
element 59 "Name" "GUI_EditParentXfm.SEP"
element 59 "Value" "LA|CA=#11 :TO=FH&dummy|<none>|<none>|0"
element 60 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.CB_ResetPlotColors"
element 60 "Value" "CB|CA=#217Reset Plot Colors:TO=FH&dummy:TS=%Reset_Plot_Colors|TC=#221GUI_Reset_Plot_Colors&#17Execute|<none>|0"
element 61 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.CB_Show_LSYNC_Values"
element 61 "Value" "CB|CA=#212LSYNC Values:MF=%GUI_Sensitivity_PO_Features:SF=%LSYNC_exist:TO=FH&dummy:TS=%tmpVar|AC=#215Identify_LSYNCs&#216Execute,identify:TC=#215Identify_LSYNCs&#216Execute,open GUI|<none>|0"
element 62 "Name" "GUI_ParamEvolution.TL_Utilities.LA_OnlyMdlVarSupported"
element 62 "Value" "LA|BG=C8:CA=#3193\075\075>  ONLY History of 'Model Parameters' is supported !\012         \075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075\075:FG=C6|<none>|<none>|0"
element 63 "Name" "GUI_MultiPlot_RIGHT.TL_TuneOptimParams.TL_ParamHistory.SB_History"
element 63 "Value" "SB|CA=#219Model Param History:ED=T:IT=%#18MdlgStep:TO=FH&dummy:SW=F:SS=%#212MdlgStep_sel:ST=TS|VD=#217GUI_Spin_MdlgStep&#17Execute:VI=#217GUI_Spin_MdlgStep&#17Execute:EP=#217GUI_Spin_MdlgStep&#17Execute|<none>|1"
element 64 "Name" "GUI_AddParamNames.TL_Params.TL_ParamNamesFilter.ED_Filter"
element 64 "Value" "ED|VA=%#218ParamNamesWildCard:TO=FH&dummy|EP=#216GUI_FilterParams&#17Execute|<none>|1"
element 65 "Name" "GUI_AddParamNames.TL_Params"
element 65 "Value" "TL|CA=#215Selected Params:OR=VE|<none>|#19LA_Filter:#219TL_ParamNamesFilter:#218LI_AvailParamNames|1"
element 66 "Name" "GUI_AddParamNames.TL_Params.LI_AvailParamNames"
element 66 "Value" "LI|IT=%#216avail_ParamNames:SI=%#220avail_ParamNames_sel:SY=ES|<none>|<none>|0"
element 67 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.LA_Show_LSYNC_Values"
element 67 "Value" "LA|CA=#211       Show:MF=%GUI_Sensitivity_PO_Features:SF=%LSYNC_exist:TO=FH&dummy|<none>|<none>|1|7"
element 68 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.LA_OptType"
element 68 "Value" "LA|CA=#212Opt.Type\072:MF=%GUI_Sensitivity_PO_Features:TO=FW&FH|<none>|<none>|0|7"
element 69 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.LA_OptErr"
element 69 "Value" "LA|CA=#212Opt.Err.\072:MF=%GUI_Sensitivity_PO_Features:TO=FH&dummy|<none>|<none>|0|7"
element 70 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.DC_PO_Optim_Choice"
element 70 "Value" "DC|IT=%#218PO_OptType_Choices:MF=%GUI_Sensitivity_PO_Features:SX=%#222PO_OptType_Choices_sel:TO=MW&TR:VO=2|LS=#216GUI_PO_Sel_Optim&#17Execute|<none>|0"
element 71 "Name" "GUI_MultiPlot_TOP.TL_PO_Actions.DC_PO_Error_Choice"
element 71 "Value" "DC|SC=1:IT=%#216PO_Error_Choices:MF=%GUI_Sensitivity_PO_Features:SX=%#220PO_Error_Choices_sel:TO=MW&dummy:VO=2|LS=#216GUI_PO_Sel_Error&#17Execute|<none>|0"
element 72 "Name" "GUI_AddParamNames.TL_Params.TL_ParamNamesFilter"
element 72 "Value" "TL|OR=HO:TO=FW&FH|<none>|#17LA_Left:#19ED_Filter:#18LA_Right|1"
element 73 "Name" "GUI_AddParamNames.TL_Params.TL_ParamNamesFilter.LA_Left"
element 73 "Value" "LA|CA=#11*:TO=FW&FH|<none>|<none>|0"
element 74 "Name" "GUI_AddParamNames.TL_Params.TL_ParamNamesFilter.LA_Right"
element 74 "Value" "LA|CA=#11*:TO=FW&FH|<none>|<none>|0"
element 75 "Name" "GUI_AddParamNames.TL_Params.LA_Filter"
element 75 "Value" "LA|CA=#268Parameter Name Filter\012  (case sensitive).\012Enter * to show all.:TO=FH&dummy|EP=#216GUI_FilterParams&#17Execute|<none>|1"
element 76 "Name" ""
element 76 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 ! General Info
 ! ================================================
 ! START_MDLG_GUI is a central Program, located in UTILITIES, which opens a PlotOptimizer 
 ! and a MultiPlot related to a comma or comma-blank separated
 !   - list of individual Plots (no MultiPlots however !), 
 !   - and a list of Parameters or Variables.
 
 ! E.g.: Plots      = 'id_vg, gm_vg'
 !       Parameters = 'VTH, U0'
 
 
 !==> Detailed info about how to use this functionality in your PEL environment 
 !can be found in Transforms '_How2Use__START_MDLG_GUI' and '_How2Use__DEFINE_EXTR_BOX'
 
 
 
 
 !--define the contents for Variable txt_HELP, to be displayed in the help GUI 'GUI_Help':
 txt_HELP="#############################################################################################
 ##### VERY IMPORTANT:  Located behind this GUI is the IC-CAP PlotOptimizer, 
       mandatory for the functionning of this Modeling GUI. 
       -> Do not manually modify anything within that PlotOptimizer Window.
       -> Just leave it as it is and where it is !!!
 ##### ALSO VERY IMPORTANT: When closing this GUI, hit the Button 'OK, Done !'.
       -> Do not hit the X button on the upper right of the Window !!!
       -> Do not close the Window using File/Close !!!
 #############################################################################################
 
 | This General Modeling User Interface (located in UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI, 
 | and called from your currently active Model), has been developed to simplify the use of IC-CAP
 | for every-day modeling problems, and to reduce the required mouse-clicks to an absolute
 | minimum. With a single click on the 'Execute' button of the calling PEL Program: 
 | -> a Window will pop up, including the pre-defined Plots,
 | -> with pre-defined Model (or DUT) Parameters (or Variables) for Tuning/Optimization
 |     Note: Model Parameters:    - in the parameter list, just define their names
 |           DUT Parameters:      - apply  DutName.ParamName
 |           Model Variables:     - just define their names
 |           DUT/Setup Variables: - apply  Dutname/VarName  or  DutName/SetupName/VarName
 | -> then, define the optimization ranges (blue boxes) inside a Plot:
 |     Note:  on your keyboard,
 |     hit 'r' [rectangle] to define a fitting box (multiple fitting boxes are possible)
 |     hit 'd' to [delete] all fitting boxes
 |     hit 's' [single] to define a new 'single' fitting box
 |     Note: by clicking into the 'PO' area field of a displayed Plot, 
 |           it either becomes a target for the optimizer (blue) or not (white).
 | and finally,
 | -> manually tune the parameters or let the optimizer find a solution.
 |
 | #############################################################################################
 | ##### the optimizer behind this GUI (the standard IC-CAP PlotOptimizer Window)
 |    is programmed for max. 25 optimizer iterations. 
 |    Therefore, it is recommended to hit the Optimizer button several times,
 |    until the fitting does not change any more.
 |    Reason: with every hit of button 'Optimize', the current param limits are re-centered
 |    around the current param. value, providing a better optimizer convergence.
 |    Hint: hit 'Show MdlParam.Evolution' to verify if the parameters have reached final values.
 |
 | ##### plots from other Setups can be added to the current modeling step [hit 'Add' in 
 |    GUI section 'Select Plots'], as well as Model Parameters [hit 'Add' in 
 |    section 'Select Parameters']. The added Model Parameters or Plots will be activated
 |    for tuning/optimization, in addition to the already activated Parameters/Plots.
 |    Note: Adding DutParameters is only possible by adding them manually to the param.list
 |          in the PEL program.
 |
 | ##### a special feature of this GUI is to enable monitoring your modeling
 |    progress. Spin 'History of Model Params' to switch from current to previous fittings 
 |    (within the same modeling task).
 |    Included in this history feature is the support of DUT Parameters, 
 |    if they belong to the parent DUT of the calling PEL's Setup.
 |
 | ##### hit 'Show MdlParam.Evolution' to get Plots of the model parameter value evolution.
 |    This allows to compare different fits during your modeling approach, 
 |    and also to go back to better, previous fittings during a modeling session.
 |    However, this is currently *only supported for ModelParameters*,
 |          and *not for DUT Parameters*, and *not for Variables*.
 |
 | ##### a typical modeling scenario is that during parameter tuning, other Parameters
 |    and Plots might become of interest, besides the ones pre-set in the starting PEL code.
 |    As already mentioned, the 'Add'-plots and 'Add'-params push buttons enable this.
 |    To make such a change permanent, the parent start-up PEL program has to be adapted.
 |    This is enabled by hitting 'Edit Parent Xfm':
 |     - a separate window with the calling PEL code pops up,
 |     - and the user can modify the list of parameters and plots.
 |    This change will become effective with the next execution of the calling PEL program.
 |
 | ##### about the Optimizer choice 'Opt.Type':
 |    -> Levenberg-Marquardt: fine-tuning (most often used optimizer, default)
 |    -> Gradient: more crude optimizer type
 |    -> Random MiniMax: most crude optimizer
 |    -> Sensitivity: when selected, the Status Window 
 |       reports which selected parameters are important and which not.
 |       The Optimizer choice is reset to 'Levenberg-Marquardt'.
 |
 | ##### about the Check Box 'Area Tools On':
 |       this is useful for documentation: When unchecked, you can
 |       - select the curve line width
 |       - the area tools will be switched-off, 
 |       - and also the blue PlotOptimizer frame (=disable plots from PlotOptimizer)
 |       - on Windows, hit [Ctrl][C] to copy-paste the Plots in high resolution into Word/PowerPoint.
 |       When done, check back to Areal Tools On.
 |
 | ##### about the Check Box 'Reset Plot Colors':
 |       - hit when you had activated in a Plot the feature 'Legend',
 |         and the Plot curve colors are mixed colors.
 |
 | ##### about the Check Box 'LSYNC Values':
 |       - becomes active if LSYNC sweeps are present.
 |         In this case, hit this check box to get a separate GUI
 |         for identifying the LSYNC stimulus values.
 |
 #############################################################################################"
 
 
 !---call the HELP GUI
 ICCAP_FUNC("./GUI_Help", "Display Modeless GUI", "HELP")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________1" "711.501"
{
}
LINK XFORM "_How2Use__START_MDLG_GUI" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 ! =====================================================
 !          HOW TO USE  Transform  'START_MDLG_GUI'
 ! =====================================================
 
 
 ! Copy-paste the Program below as a Transform into the 
 ! corresponding Setup of your ModelFile. 
 ! Rename it to e.g. 'fit_IS_N_RS'
 ! and adjust the lines 
 ! 'Plots = ....', 'Parameters = ....', 'Comment = ....' and 'PO_Error = ....'
 ! according to your needs.
 !=====================================================================================
 
 
 !---------------cut here--------------------------------------------------
 !---the next 2 lines are optional: if required, perform a quick pre-setting of Lin/Log scaling, *before* opening a Plot
 ICCAP_FUNC("id_vg", "STFV", "Y Axis Type", "Lin" )   ! only keyword 'Lin' or 'Log' is supported, case sensitive !
 ICCAP_FUNC("gm_vg", "STFV", "Y Axis Type", "Log" )   ! only keyword 'Lin' or 'Log' is supported, case sensitive !
 
 
 
 !======================================================================================================================================================================================================================================================
 !---define here which individual Plots (*no* MultiPlots!) and which Parameters you want to use for this modeling step (a comma or comma-blank separated list)
 Plots      = "id_vg, gm_vg"
 			! Choices: Enter a comma-blanc separated list of Plots
 			!          -you can also include Plots of other Setups, using ../../Setup/Plot
 			!          -you can preceed plot names with a ! to enter them to the Plot list of the GUI as candidates, 
 			!            but not as currently active targets for the PO, e.g. !idvg
 			!          -setting Plots="all" will automatically show all Plots of current Setup, except MultiPlots.   
 			!           NOTE: the Plot sequence in the GUI is the sequence of Plots in tab 'Plots'
 			!          -setting Plots="" will open a GUI to manually select from all Plots of the current ModelFile
 Parameters = "VTH, U0"
 			! Choices: Enter a comma-blanc separated list of ModelParameters or Model Variables
 			!          You can preceed parameter names with a ! to enter them as candidates, e.g. !VTH
 			!          When linking to DutParameters: define Dutname.ParameterName
 			!          When linking to Variables: ModelVariables w/o any path, Dut and Setup by Dutname/Setupname/Variablename
 			!          -Parameters = "":    open the GUI without any Parameters predefined.
 			!                         User can select parameters from the GUI by himself.
 			!          -Parameters = "n/a": show only MultiPlot incl. Comment, no PlotSelect or ParamSelect GUI. No PlotOptimizer opened in the background: -> no simul/optim/tuning available
 			!                         Useful when just displaying current extraction results, without Tuning/Optimization.
 			!	 -Parameters = "Compare": show only MultiPlot incl. Comment, no ParamSelect GUI, but have the PlotOptimizer activated in the background to allow simulations  (e.g. when called by 'Compare_with_Previous')
 Comment    = "Adjust VTH and U0"
 			! The Comment will be displayed on top left of the MultiPlot. Enter "" for 'no comment'.
 			! If the Comment starts with 'FF: ', it will be displayed with Fixed Font (Couriel). Useful for pseudo-graphics.
 PO_Error   = "Relative"
 			! Preset of PlotOptimizer error. Choices: "Relative", "Absolute", "" (keeps last selection)
 !---call the starting Transform in UTILITIES:                                                        WHOAMI() = path to this Transform
 ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/START_MDLG_GUI", "Execute", Plots, Parameters, WHOAMI(), Comment, PO_Error)
 !======================================================================================================================================================================================================================================================
 !
 !---optional: activate Plot Legend for 1st Plot  (useful for TEMP mdlg etc.)
 !ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/_MP_", "Legend On", "0")
 
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "START_MDLG_GUI" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---for small monitors, reduce nr. of displayed ParamGroup Names
 GLOBAL_VAR  NrParamGroupItems
 NrParamGroupItems = 5	! [1] ... [5=default] ... 
 
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  Path2Xfm
 GLOBAL_VAR  Path2Setup		! path to Setup of the Transform whcih is calling this Program
 GLOBAL_VAR  Path2FirstPlot		! first Plot in PlotOptimizer
 GLOBAL_VAR  Plots			! originally selected Plot names for PlotOptimizer
 GLOBAL_VAR  PlotNames		! requested Plot targets for PlotOptimizer
 GLOBAL_VAR  PlotNames_sel
 GLOBAL_VAR  Parameters		! originally selected Parameter names for PlotOptimizer
 GLOBAL_VAR  ParamNames		! requested Parameter names for PlotOptimizer
 GLOBAL_VAR  ParamNames_sel		! currently selected Parameter names for PlotOptimizer
 GLOBAL_VAR  MdlgStep		! optimizer/tuner modeling steps
 GLOBAL_VAR  MdlgStep_sel
 GLOBAL_VAR  Comment			! comment for MultiPlot
 GLOBAL_VAR  PO_Error_Choices		! PlotOptimizer Error Setting: Absolute, Relative
 GLOBAL_VAR  PO_Error_Choices_sel
 GLOBAL_VAR  FlagDefineExtrBox		! flag if 'DEFINE_EXTR_BOX' or 'START_MDLG_GUI' mode
 GLOBAL_VAR  GUI_Sensitivity_PO_Features	! grey out buttons linked to PlotOPtimizer or not
 GLOBAL_VAR  GUI_Sensitivity_Undo	! grey out Undo-Optimize button or not
 GLOBAL_VAR  PO_OptType_Choices_sel	! 
 GLOBAL_VAR  NrModelParameters
 GLOBAL_VAR  ShowAreaTools		! Area Tools in Plots on/off
 GLOBAL_VAR  TuneFast
 
 
 
 !--- the following questions will be answered by the calling PEL Program
 	! [comma separated list of Plots, incl. support of paths to other Setups]
 GET_STRING "Specify a list of Plots you want the PlotOptimizer to apply to", Plots
 	! Entering "" means: open a GUI to manually select from all Plots of the current ModelFile
 	! Entering "All" means: show all Plots of current Setup
 GET_STRING "Specify the ModelParameters you want to use in the PlotOptimizer", Parameters
 	! [comma separated list of ModelParameters]
 	! Entering "" means: no params. preselected, user can select parameters on his own from the GUI
 	! Entering "n/a" means: only pre-view of Plots, no access to simulations
 
 GET_STRING "Specify absolute path to calling Transform", Path2Xfm
 
 GET_STRING "Comment", Comment
 
 GET_STRING "Enter PO PlotOptimizer Error [Relative], [Absolute]", PO_Error	
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 !---define max. optimizer evaluation steps 
 !   Note: we limit to 25 steps, then the user should re-hit the 'Optimize' button, the param. value limits are centered again, and the optim. is performed (with a better convergence!)
 MaxEvals=25
 
 
 !---clear Status Window
 ICCAP_FUNC("/", "Clear Status Output")
 ICCAP_FUNC("/", "Clear Status Errors")
 
 
 
 ICCAP_FUNC("Check_SysVars", "Execute")
 
 
 !---reset variables
 ICCAP_FUNC("Clean_Up", "Execute")
 FlagDefineExtrBox = 0
 ShowAreaTools     = 1
 TuneFast          = 1
 
 Path2Setup = VAL$(Path2Xfm)&"/.."
 
 
 !---close Plots possibly opened by the user before starting this program
 ICCAP_FUNC(VAL$(Path2Setup), "Close All")
 
 
 !---if requested, show all Plots of current Setup
 IF UPC$(VAL$(Plots))=="ALL" THEN ICCAP_FUNC("ShowAllPlots", "Execute")
 
 
 !---pre-check
 IF VAL$(Plots)=="" THEN 
   !---create array 'PlotNames' out of requested string 'Plots'
   ICCAP_FUNC("GUI_Manage_Plots", "Execute", "Add")
   IF SIZEOF(PlotNames)==0 THEN 
     GET_STRING "ERROR: no Plots selected !   [OK]", dummy
     RETURN_VALUE 0
   END IF
   Plots=""
   FOR i=0 TO SIZEOF(PlotNames)-1
     Plots=VAL$(Plots)&VAL$(PlotNames[i])&", "
   NEXT i
   !--get rid of trailing ', '
   Plots=TRIM$(VAL$(Plots), ", ")
   !---reset PlotNames  (will be re-defined later)
   DIMENSION_ARRAY(PlotNames, 0)
 END IF
 
 
 !---close MultiPlot and reset MP settings
 ICCAP_FUNC("_MP_", "Close")
 ICCAP_FUNC("_MP_", "STFV", "# of Plots", 1)
 ICCAP_FUNC("_MP_", "STFV", "Plot 0", "")
 
 
 
 !==============PLOTS=====================================
 
 !---get PlotNames
 RetVal = CUTSTR(VAL$(Plots), PlotNames, ",")
 IF SIZEOF(PlotNames)==0 THEN RETURN_VALUE -1
 
 
 !---identify first active (non-uncommented) Plot
 Path2FirstPlot=""
 FOR i=0 TO SIZEOF(PlotNames)-1
   IF STRPOS(VAL$(PlotNames[i]), "!")==0 THEN 
     Path2FirstPlot=VAL$(Path2Setup)&"/"&TRIM$(VAL$(PlotNames[i]), " ")	!get rid of blanks
     BREAK
   END IF
 NEXT i
 IF VAL$(Path2FirstPlot)=="" THEN
   GET_STRING "ERROR: no active Plot available !  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---clear PlotOptimizer
 ICCAP_FUNC(VAL$(Path2Setup)&"/../../PlotOptimizer", "Clear PlotOptimizer")
 
 
 !---reflect if Plot was commented out: -> make it inactive
 PlotNames_sel="ICCAP_ARRAY[0]"
 i=0
 FOR iPlot=0 TO SIZEOF(PlotNames)-1
   IF STRPOS(VAL$(PlotNames[iPlot]), "!")==0 THEN
     PlotNames_sel="ICCAP_ARRAY["&VAL$(i+1)&"]"
     PlotNames_sel[i]=iPlot
     PlotNames[iPlot]=TRIM$(VAL$(PlotNames[iPlot]), " ")		! cut-off blanks
     i = i + 1
   ELSE
     PlotNames[iPlot]=TRIM$(VAL$(PlotNames[iPlot]), "! ")	! cut-off '!' and blanks
   END IF
 NEXT iPlot
 
 
 !---link the Plots into the local MultiPlot
 ICCAP_FUNC("_MP_", "STFV", "# of Plots", SIZEOF(PlotNames_sel))
 FOR iPlot=0 TO SIZEOF(PlotNames_sel)-1
   IF VAL$(PlotNames[PlotNames_sel[iPlot]])<>"" THEN		! user may have defined empty Plot names to provide a nicer spacing in the MultiPlot
     Plot_i=VAL$(Path2Setup)&"/"&VAL$(PlotNames[PlotNames_sel[iPlot]])
     ICCAP_FUNC("_MP_", "STFV", "Plot "&VAL$(iPlot), VAL$(Plot_i))
   END IF
 NEXT iPlot
 
 
 !---set font of Comment
 Path2GUI = "./GUI_MultiPlot_TOP.TL_Comments.LA_Comment"
 ICCAP_FUNC(Path2GUI, "Set GUI Options", "FI=DF", "")	!default font:  Arial
 IF STRPOS(VAL$(Comment), "FF: ")==1 THEN
   Comment = SUBSTR$(VAL$(Comment), 5)
   ICCAP_FUNC(Path2GUI, "Set GUI Options", "FI=FF", "")	!fixed font:  Courier
 END IF
 
 
 !---display MultiPlot
 ICCAP_FUNC("LineUpPlots", "Execute", iPlot)
 ICCAP_FUNC("_MP_", "Display Plot")
 
 
 !---set axes to what is specified in the original Plot definitions (to be applied to the opened MP !!)
 FOR iPlot=0 TO SIZEOF(PlotNames)-1
   ICCAP_FUNC("_MP_", "Reset to Saved Options", VAL$(iPlot))
   ICCAP_FUNC("_MP_", "DeleteGlobalRegions", VAL$(iPlot))
 NEXT iPlot
 
 
 !---set Autoscale for all Plot children of _MP_
 ICCAP_FUNC("_MP_", "Autoscale On")
 
 !---switch on Area Tools
 ICCAP_FUNC("_MP_", "Area Tools On")
 
 
 
 !==============PARAMETERS================================
 
 !---show or grey out PO buttons in GUI
 GUI_Sensitivity_Undo=0		!don't activate Optimize-Undo button
 GUI_Sensitivity_PO_Features=1		!show GUI buttons linked to PlotOPtimizer
 
 IF VAL$(Parameters)=="" THEN
   DIMENSION_ARRAY(ParamNames, 1)
   ParamNames[0]= "=> Hit 'Add' Params <="	! add keyword if no params. had been preset
 END IF
 
 IF VAL$(Parameters)<>"" THEN
   IF (LWC$(VAL$(Parameters))=="n/a") ORELSE (LWC$(VAL$(Parameters))=="compare") THEN 
     GUI_Sensitivity_PO_Features=0	!switch-off GUI buttons linked to PlotOPtimizer, and exit Program: user only wants the Plots to show a result
     IF LWC$(VAL$(Parameters))=="n/a" THEN  RETURN_VALUE 3	!show only Plots
     Parameters=""
   ELSE
     !---get ParameterNames
     RetVal = CUTSTR(VAL$(Parameters), ParamNames, ",")
 
     !---reflect if parameter was commented out: -> make it inactive
     ParamNames_sel="ICCAP_ARRAY[0]"
     i=0
     FOR iParam=0 TO SIZEOF(ParamNames)-1
       IF STRPOS(VAL$(ParamNames[iParam]), "!")==0 THEN
         ParamNames_sel="ICCAP_ARRAY["&VAL$(i+1)&"]"
         ParamNames_sel[i]=iParam
         ParamNames[iParam]=TRIM$(VAL$(ParamNames[iParam]), " ")		! cut-off blanks
         i = i + 1
       ELSE
         ParamNames[iParam]=TRIM$(VAL$(ParamNames[iParam]), "! ")	! cut-off '!' and blanks
       END IF
     NEXT iParam
 
     !---bring active parameters into the PlotOptimizer
     FOR iParam=0 TO SIZEOF(ParamNames_sel)-1
       actParamName = VAL$(ParamNames[ParamNames_sel[iParam]])
 
       !---verify that the param. value is just a number, and not an equation
       ErrMsg = ""
       Path2ModelParams = VAL$(Path2Setup)&"/../../ParameterSet"
       ParamValEntryEval  = LOOKUP_TABLE_VAL_EVAL(VAL$(Path2ModelParams), "Value["&VAL$(actParamName)&"]", ErrMsg)
       IF VAL$(ErrMsg)=="" THEN  !---if ErrMsg<>"", then it's probably a DUT Parameter -> skip and assume there is no equation involved
         ParamValEntry      = LOOKUP_TABLE_VAL(VAL$(Path2ModelParams),      "Value["&VAL$(actParamName)&"]")
         IF VAL$(ParamValEntry) <> VAL$(ParamValEntryEval) THEN
           ErrMsg = "ERROR: "&VAL$(actParamName)&" parameter value is not just a number ! 
            => Tuning/Optimization impossible !"
           GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
         END IF
       END IF
 
       !---add param name to PlotOptimizer
       ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Name["&VAL$(iParam)&"]", VAL$(actParamName))	
     NEXT iParam
   END IF
 
   NrModelParameters = SIZEOF(ParamNames_sel)
 
 END IF
 
 
 !---save current ModelParam Values
 DIMENSION_ARRAY(MdlgStep, 1)
 MdlgStep[0] = 0
 MdlgStep_sel = 0
 ICCAP_FUNC(VAL$(Path2Setup)&"/../../ParameterSet", "Save As", "./tmp_MdlgGUI_0.mps")
 !---save also the DUT Params of the calling Setup
 ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "Save As", "./tmp_MdlgGUI_0.dps")
 
 
 !---check available PARAMGROUPs
 ICCAP_FUNC("Read_Param_Groups", "Execute")
 
 !==============etc========================================
 !---if LSYNC exist in Setup, enable push button 'Show LSYNC Values'
 ICCAP_FUNC("Identify_LSYNCs", "Execute", "identify")
 
 
 !==============PO SETTINGS================================
 !---switch-off printouts
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Print Parameters", "Final and intermediate Values")   ! choices:  "Never", "Final Values Only", "Final and intermediate Values"
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Print Error", "Final, intermediate and Summary")      ! choices:  "Never", "Final value only", "Summary", "Final, intermediate and Summary"
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Print Sens Results", "Intermediate Values")           ! choices:  "Never", "Intermediate Values", "Final Values"
 
 
 
 !---set PlotOptimizer options
 IF PO_Error=="Absolute" THEN 
   PO_Error_Choices_sel=0
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "SetError", "Absolute")
 ELSEIF PO_Error=="Relative" THEN 
   PO_Error_Choices_sel=1
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "SetError", "Relative")
 END IF
 
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "SetAlgorithm", "Levenberg-Marquardt")
 PO_OptType_Choices_sel=0	!reset user choice to Levenberg-Marquardt
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Max Evals", VAL(MaxEvals))
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Param Delta", "10m")
 
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Param Delta", "10m")
 
 !---autoset parameter min and max values. 
 !   NOTE: SystemVariable AUTOSET_COEFF is applied for range of min and max
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "AutoSet Min Max")
 
 
 
 
 
 !==============ACTIVATE AND OPEN PLOTOPTIMIZER================================
 
 !---enable the MultiPlot sub-Plot '0' to synchronizes it with the Plot Optimizer window.
 ICCAP_FUNC("_MP_", "EnablePlot", "0") 
 ICCAP_FUNC("_MP_", "Autoconfigure")	!autoconfigure all MultiPlot sub-Plots for PlotOptimizer: enter automatically the fields 'Target' and 'Simulated'
 ICCAP_FUNC("_MP_", "Undo Zoom")
 
 
 !---open PlotOptimizer window
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot), "Open PlotOptimizer")
 
 
 !---simulate to make sure all is consistent in the Plots with the current param values 
 IF VAL(Debug)==1 THEN PRINT ">> simulating ... "
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Simulate All")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________2" "711.501"
{
}
LINK XFORM "_How2Use__DEFINE_EXTR_BOX" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! Transform 'DEFINE_EXTR_BOX' re-uses the MultiPlot of 'START_MDLG_GUI', to allow the specification
 ! of a parameter extraction box for your parameter extraction PEL programs.
 ! Advantage: same look and feel for both, box-selection plot for direct parameter extraction, and tune/optimize plot.
 ! NOTE: the Plot, from which the extraction box will be selected, must be PlotOptimizer auto-configurable
 ! 	i.e. show 'meas.' *and* 'simul.' data, or correspnding 'meas.' *and* 'simul.' Transform data.
 
 
 !########################################################################################
 
 ! HOW TO USE
 ! =============
 ! In your ModelFile's Setup, add the SetupVariables X_LOW and X_HIGH.
 ! Then, add a Transform with these lines:
 
 
 !---------------cut here--------------------------------------------------
 
 !================================================================================================================================================
 !===call the central extraction box selection utility============================================================================================
  PlotName = "myPlotName"
  Comment  = "myComment"
 !                                                                                                 WHOAMI() = path to this Transform
  ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/DEFINE_EXTR_BOX", "Execute", VAL$(PlotName), WHOAMI(), VAL$(Comment))
 !------------------------------------------------------------------------------------------------------------------------------------------------
 !	---handle user request for new box selection (keep these lines as they are, don't change them!)
 	ErrMsg=LOOKUP_VAR("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/ErrMsg")
 	IF (VAL$(ErrMsg)<>"") THEN 		! user requests a new extraction box location
 	  IF (VAL$(ErrMsg)<>"User hit Cancel") THEN GET_STRING "ERROR: "&VAL$(ErrMsg)&"    [OK]", dummy
 	  RETURN_VALUE 0
 	END IF
 !================================================================================================================================================
 !
 !
 !---now comes your parameter extraction PEL code
 !  ...
 !  ...
 !  ...
 !
 !
 !---finally call the main Transform 'START_MDLG_GUI' to show the result and to allow fine-tuning/optimization
 !================================================================================================================================================
 !===call the central General Modeling GUI for parameter fine-tuning or optimization==============================================================
 !---define here which individual Plots (*no* MultiPlots!) and which Parameters you want to use (a comma-separated list)
  Plots      = "myPlot(s)"
  Parameters = "myParameters"
  Comment    = "myComment"
  PO_Error   = "Relative"		! Choices: "Relative", "Absolute", "" (keeps last selection)
 !                                                                                                     WHOAMI() = path to this Transform
  ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/START_MDLG_GUI", "Execute", Plots, Parameters, WHOAMI(), Comment, PO_Error)
 !================================================================================================================================================
 
 
 !############################################################################################
 !>>>IMPORTANT NOTE<<<<<<<<<
 ! The second call of the 'General Modeling' Utility, i.e. calling 'START_MDLG_GUI',
 ! *is mandatory* for this 'DEFINE_EXTR_BOX' Transform to work properly !!!
 !############################################################################################
 
 
 !---For experts:
 !   The Program execution sequence of 'DEFINE_EXTR_BOX' is like this:
 !   - call /UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/DEFINE_EXTR_BOX, 
 !      and transfer PlotName, TransformName and Comment
 !   - DEFINE_EXTR_BOX gets the box bounds from the SetupVariables of the calling Transform
 !   - DEFINE_EXTR_BOX opens a MultiPlot, overlaid by a GET_STRING window,
 !      asking the user if the currently shown extraction box is OK or not.
 !     > User hits OK in the GET_STRING window: 
 !       - DEFINE_EXTR_BOX is ending, 
 !       - the MultiPlot is closed
 !       - and the subsequent user-extraction in the remote Transform is executed
 !     > User hits Cancel in the GET_STRING window:
 !       - the remote calling Transform is ended,
 !         (handled by the ErrMsg check in the remote calling Transform)
 !       - the user defines a new box and hits OK in the (still open !!!) MultiPlot GUI, 
 !         this re-executes the remote Transform due to the Variable 'FlagDefineExtrBox' in MDLG_GUI/GENERAL_MDLG_GUI/SetupVariables
 !         (this re-execution is handled by Transform 'GUI_OK_Cancel')
 !         By re-executing the remote Transform, the checking of the correctly defined box re-starts.        
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "DEFINE_EXTR_BOX" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This utility re-uses the MultiPlot of 'START_MDLG_GUI', to allow the specification
 ! of a parameter extraction box for your parameter extraction PEL programs.
 ! Advantage: same look and feel for both, box-selection plot for direct parameter extraction, and tune/optimize plot.
 ! NOTE: the Plot, from which the extraction box will be selected, must be PlotOptimizer auto-configurable
 ! 	i.e. show 'meas.' *and* 'simul.' data, or correspnding 'meas.' *and* 'simul.' Transform data.
 !
 !
 !
 
 !~~~~~~~start of Program 'DEFINE_EXTR_BOX'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  FlagDefineExtrBox
 GLOBAL_VAR  GUI_Sensitivity_PO_Features
 GLOBAL_VAR  Comment
 GLOBAL_VAR  ParamNames_sel
 GLOBAL_VAR  Path2FirstPlot
 GLOBAL_VAR  PlotNames_sel
 GLOBAL_VAR  Path2Xfm
 
 
 !--- the following questions will be answered by the calling PEL Program
 GET_STRING "PlotName", PlotName
 GET_STRING "Specify absolute path to calling Transform", Path2Xfm
 GET_STRING "Comment", Comment
 
 
 
 
 !---init variables
 ErrMsg = ""
 Path2Setup=VAL$(Path2Xfm)&"/.."
 Path2FirstPlot = VAL$(Path2Setup)&"/"&VAL$(PlotName)
 ParamNames_sel = -1
 PlotNames_sel  = -1
 FlagDefineExtrBox       = 1
 GUI_Sensitivity_PO_Features = 0	!grey out GENERAL_MDLG_GUI BUTTONS
 
 
 !---close all possibly opened Plots in currently active Setup
 ICCAP_FUNC(VAL$(Path2Setup), "Close All")
 
 
 !---switch off potentially defined Plots-per-Row in MultiPlot
 ICCAP_FUNC("_MP_", "STFV", "Plots Per Row", "")
 
 
 !---close a possibly opened MultiPlot, and add a single Plot to MultiPlot
 ICCAP_FUNC("_MP_", "Close")
 ICCAP_FUNC("_MP_", "STFV", "# of Plots", 1)
 ICCAP_FUNC("_MP_", "STFV", "Plot 0", VAL$(Path2FirstPlot))
 
 
 !---get box settings of currently active Plot from remote SetupVariables
 tmp_X_LOW  = LOOKUP_VAR(VAL$(Path2Setup)&"/X_LOW",  ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 tmp_X_HIGH = LOOKUP_VAR(VAL$(Path2Setup)&"/X_HIGH", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN 
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 tmp_Y_LOW  = LOOKUP_VAR(VAL$(Path2Setup)&"/Y_LOW",  ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN tmp_Y_LOW=1E-18	!to satisfy both, LIN and LOG y-axis, and in LIN, assuming that the shown meas. data are all positive
 tmp_Y_HIGH = LOOKUP_VAR(VAL$(Path2Setup)&"/Y_HIGH", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN tmp_Y_HIGH=1E6
 
 
 !---exit if no values for X_LOW etc. had been defined yet
 IF (VAL$(tmp_X_LOW)=="") OR (VAL$(tmp_X_HIGH)=="") OR (VAL$(tmp_Y_LOW)=="") OR (VAL$(tmp_Y_HIGH)=="") THEN
   ErrMsg = "X_LOW, X_HIGH, Y_LOW or Y_HIGH have no values set !
     Please set them to some starting values (Apply 'Copy to Variables' in the Plot '"&VAL$(PlotName)&"')"
   RETURN_VALUE 0
 END IF
 
 
 !---visualize the already defined extraction box as a black frame
 Color=0    !0=black, 1=red, 2=yellow, 3=green, 4=light blue, 5=blue, 6=purple, 7=grey
 !ICCAP_FUNC("myPlotName",                "SetUserRegion", myRegionName, x1, x2, y1, y2, Color, ReferenceAxis)
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot), "SetUserRegion", "dummy", VAL(tmp_X_LOW), VAL(tmp_X_HIGH), VAL(tmp_Y_LOW), VAL(tmp_Y_HIGH), Color, "Y")
 
 
 !--add Plot to PlotOptimizer and open PlotOptimizer, to allow (mis-)using the blue box for extractions ;-)
 ICCAP_FUNC("_MP_", "EnablePlot", "0") 
 ICCAP_FUNC("_MP_", "Autoconfigure")
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot), "Open PlotOptimizer")
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot), "DeleteGlobalRegions")
 
 
 !---Display MultiPlot
 ICCAP_FUNC("_MP_", "Display Plot")
 
 
 !---switch on autoscale
 ICCAP_FUNC("_MP_", "Autoscale On") 
 
 !---switch on Area Tools
 ICCAP_FUNC("_MP_", "Area Tools On")
 
 
 !---open user dialog if box settings are OK
 ErrMsg="User hit Cancel"
 GET_STRING VAL$(Comment)&"
 	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 	Is the currently defined *black* extraction box OK ?
 	If not OK, or not visible, hit [Cancel] now, define another box with the left mouse button 
             and hit the 'R' key (like 'Rectangle'). 
 	Then, push the 'OK, Done !' button to apply this new extraction box selection.", dummy
 ErrMsg=""
 
 
 !---deactivate extraction box visualization
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot), "DeleteAllUserRegions")
 
 
 !---exit
 RETURN_VALUE 1
 
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________3" "711.501"
{
}
LINK XFORM "GUI_PlotNamesSel" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  PlotNames	! requested Plot names for PlotOptimizer
 GLOBAL_VAR  PlotNames_sel	! currently active Plot names for PlotOptimizer
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  Path2FirstPlot	! first Plot in PlotOptimizer
 GLOBAL_VAR  Parameters
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---link the user-selected Plots into the local MultiPlot
 ICCAP_FUNC("_MP_", "STFV", "# of Plots", SIZEOF(PlotNames_sel))
 FOR iPlot=0 TO SIZEOF(PlotNames_sel)-1
   Plot_i=VAL$(Path2Setup)&"/"&VAL$(PlotNames[PlotNames_sel[iPlot]])
   ICCAP_FUNC("_MP_", "STFV", "Plot "&VAL$(iPlot), VAL$(Plot_i))
 NEXT iPlot
 
 
 
 !---redisplay MultiPlot
 ICCAP_FUNC("LineUpPlots", "Execute", iPlot)
 ICCAP_FUNC("_MP_", "Display Plot")
 
 
 !---activate Plots in PO
 FOR iPlot=0 TO SIZEOF(PlotNames_sel)-1
   ICCAP_FUNC("_MP_", "EnablePlot", iPlot) 
 NEXT iPlot
 ICCAP_FUNC("_MP_", "AutoconfigureAndEnable")
 
 
 !---set Autoscale for all Plot children of _MP_
 ICCAP_FUNC("_MP_", "Autoscale On")
 
 
 !---simulate to make sure all is consistent in the Plots with the current param values 
 IF VAL$(Parameters)<>"n/a" THEN
  IF VAL(Debug)==1 THEN  PRINT ">> simulating ... ";
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Simulate All")
   IF VAL(Debug)==1 THEN PRINT "done!"
 END IF
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Restore_Plots" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Plots		! originally selected Plot names for PlotOptimizer
 GLOBAL_VAR  PlotNames	! requested Plot names for PlotOptimizer
 GLOBAL_VAR  PlotNames_sel	! currently active Plot names for PlotOptimizer
 
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 !---recover original start-up PlotNames
 RetVal = CUTSTR(VAL$(Plots), PlotNames, ",")
 
 
 !---reflect if plot was commented out: -> make it inactive
 PlotNames_sel="ICCAP_ARRAY[0]"
 i=0
 FOR iPlot=0 TO SIZEOF(PlotNames)-1
   IF STRPOS(VAL$(PlotNames[iPlot]), "!")==0 THEN
     PlotNames_sel="ICCAP_ARRAY["&VAL$(i+1)&"]"
     PlotNames_sel[i]=iPlot
     PlotNames[iPlot]=TRIM$(VAL$(PlotNames[iPlot]), " ")		! cut-off blanks
     i = i + 1
   ELSE
     PlotNames[iPlot]=TRIM$(VAL$(PlotNames[iPlot]), "! ")	! cut-off '!' and blanks
   END IF
 NEXT iPlot
 
 
 ICCAP_FUNC("GUI_PlotNamesSel", "Execute")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Manage_Plots" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  PlotNames_sel
 
 
 GET_STRING "Action: [Add], [Delete]", "Add", Action
 
 IF VAL$(Action)== "Delete" THEN
   !~~~remove selected plots~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   IF SIZEOF(PlotNames_sel)==SIZEOF(PlotNames) THEN
     GET_STRING "ERROR: you cannot delete all Plots !!  [OK]", dummy
     RETURN_VALUE 0
   END IF
   FOR i=0 TO SIZEOF(PlotNames_sel)-1
     dummy=ARRAY_REMOVE_AT(PlotNames, PlotNames_sel[i])
     !---adjust indices of further selected to-be-deleted plots
     FOR i1=i TO SIZEOF(PlotNames_sel)-1
       IF PlotNames_sel[i1]>0 THEN PlotNames_sel[i1]=PlotNames_sel[i1]-1
     NEXT i1
   NEXT i
 
   !---reset selected Plots
   DIMENSION_ARRAY(PlotNames_sel, 1)
   PlotNames_sel[0]=0
 
   ICCAP_FUNC("GUI_PlotNamesSel", "Execute")
   RETURN_VALUE 2
 END IF
 
 
 
 IF VAL$(Action)== "Add" THEN
   !~~~add more plots~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   !---get ModelName from Path2Setup
   tmp=TRIM$(VAL$(Path2Setup), "/")
   Location=STRPOS(VAL$(tmp), "/") 
   ModelName=SUBSTR$(VAL$(Path2Setup), 1, Location)
 
 
   !---open Plot Selection GUI from 
   ICCAP_FUNC("../../PLOT_UTILITIES/PLOT_SELECT/SELECT_PLOTS", "Execute", VAL$(ModelName))
 
 
   !---exit if no Plot was selected
   IF SIZEOF(../../PLOT_UTILITIES/PLOT_SELECT/SELECT_PLOTS/Plot_Target)==0 THEN RETURN_VALUE 0
 
 
 
   !---copy selected Plots back and link them into the local MultiPlot
   FOR i=0 TO SIZEOF(../../PLOT_UTILITIES/PLOT_SELECT/Plot_Target)-1
     dummy=ARRAY_INSERT_AT(PlotNames, "../../"&VAL$(../../PLOT_UTILITIES/PLOT_SELECT/Plot_Target[i]))
     !activate selection 
     dummy=ARRAY_INSERT_AT("PlotNames_sel", VAL$(SIZEOF(PlotNames)-1))
   NEXT i
   !---update MultiPlot 
   ICCAP_FUNC("GUI_PlotNamesSel", "Execute")
 
   RETURN_VALUE 1
 END IF
 
 
 !---return -1 if user had neither selected 'Add' nor 'Delete'
 RETURN_VALUE -1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PO_Actions" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  Path2FirstPlot		! path to 1st Plot of the PlotOptimizer
 GLOBAL_VAR  MdlgStep
 GLOBAL_VAR  MdlgStep_sel
 GLOBAL_VAR  GUI_Sensitivity_Undo
 GLOBAL_VAR  ParamNames_sel
 GLOBAL_VAR  PO_OptType_Choices
 GLOBAL_VAR  PO_OptType_Choices_sel
 GLOBAL_VAR  Parameters
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  TuneFast
 GLOBAL_VAR  ShowAreaTools
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GET_STRING "What to do ?
   [SimulateAll], [Tune], [AutosetAndOptimize], [UndoOptim]", Action
 
 ! ===Choices===
 ! Tune:               depending on flag TuneSpeed, will hit the 'Tune Slow' or 'Tune Fast' icon in the PlotOptimizer
 ! SimulateAll:        will hit the 'Simulate' icon in the PlotOptimizer
 ! AutosetAndOptimize: will hit the 'Autoset Min/Max And Optimize' icon in the PlotOptimizer (center the parameter limits around the current param value, then optimize)
 ! UndoOptim:          will hit the 'Undo Optimize' icon in the PlotOptimizer
 
 
 !---if it's just 'SimulateAll', do it and exit
 IF (VAL$(Action)=="SimulateAll") THEN
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "SimulateAll")	
   RETURN_VALUE 2
 END IF
 
 
 !---exit if ShowAreaTools == 0
 IF VAL(ShowAreaTools)<>1 THEN
   GET_STRING "Error: pls. activate check box 'Area Tools'   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---check if no parameters have been selected
 IF SIZEOF(ParamNames_sel)==0 THEN
   GET_STRING "ERROR: no parameters selected   [OK]", dummy
   !---handle special case 'Sensitivity Analysis'
   IF VAL$(PO_OptType_Choices[PO_OptType_Choices_sel])== "Sensitivity" THEN PO_OptType_Choices_sel=0
   RETURN_VALUE 3
 END IF
 
 
 !---check if user has stepped back in mdlg step history
 !   if yes, then clear all history above this currently selected mdlg step
 IF MdlgStep_sel<>SIZEOF(MdlgStep)-1 THEN 
   GET_STRING "OK to delete all previous Modeling Step Results "&VAL$(MdlgStep_sel+1)&" -> "&VAL$(SIZEOF(MdlgStep)-1)&" ? [OK], [Cancel]", dummy
   DIMENSION_ARRAY(MdlgStep, MdlgStep_sel+1)
 END IF
 
 
 !---if tuning, activate the undo button in the GUI
 IF (VAL$(Action)=="Tune") THEN 
   Action = "TuneSlow"
   IF VAL(TuneFast)==1 THEN Action = "TuneFast"
   GUI_Sensitivity_Undo=0
 END IF
 
 
 !---if optimize, activate the undo button in the GUI
 IF (VAL$(Action)=="AutosetAndOptimize") THEN GUI_Sensitivity_Undo=1
 
 
 !---autoset parameter min and max values
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "AutoSet Min Max")	! apply SystemVariable AUTOSET_COEFF for min and max param. values centered around current value
 !                                                                               ! if SystemVariable AUTOSET_COEFF is not defined, the default is 5
 
 
 
 !===finally, perform the requested action===============================
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", VAL$(Action))	
 !=======================================================================
 
 
 
 !---pop up Status Window if Sensitivity was requested
 IF VAL$(PO_OptType_Choices[PO_OptType_Choices_sel])== "Sensitivity" THEN
   GUI_Sensitivity_Undo=0
   ICCAP_FUNC("/", "Status Window") 	! brings status window to top level
   PO_OptType_Choices_sel=0
   ICCAP_FUNC("GUI_PO_Sel_Optim", "Execute")
   GET_STRING "See the Status window for the results of parameter Sensitivity Analysis.
     Note: The Optimizer Choice has been set back to Levenberg-Marquardt  [OK]", dummy
   RETURN_VALUE 2
 END IF
 
 
 !---save current ModelParam Values for param.history
 MdlgStep_sel=-1
 IF (VAL$(Action)<>"UndoOptim") THEN
   IF VAL$(PO_OptType_Choices[PO_OptType_Choices_sel])<> "Sensitivity" THEN
     IF VAL$(ParamNames[0])<>"=> Hit 'Add' Params <=" THEN
       DIMENSION_ARRAY(MdlgStep, SIZEOF(MdlgStep)+1)
       ICCAP_FUNC(VAL$(Path2Setup)&"/../../ParameterSet", "Save As", "./tmp_MdlgGUI_"&VAL$(SIZEOF(MdlgStep)-1)&".mps")
       ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "Save As", "./tmp_MdlgGUI_"&VAL$(SIZEOF(MdlgStep)-1)&".dps")
       FOR i=0 TO SIZEOF(MdlgStep)-1
         MdlgStep[i] = VAL(i)
       NEXT i
     END IF
   END IF
 ELSE
   GUI_Sensitivity_Undo=0
   dummy=ARRAY_REMOVE_AT(MdlgStep, SIZEOF(MdlgStep)-1)
 END IF
 MdlgStep_sel = SIZEOF(MdlgStep)-1
 
 
 ICCAP_FUNC("Create_ParamEvolution", "Execute")
 ICCAP_FUNC("_MP_ParamEvolution_", "Replot")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Spin_MdlgStep" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  Path2FirstPlot		! path to 1st Plot of the PlotOptimizer
 GLOBAL_VAR  MdlgStep
 GLOBAL_VAR  MdlgStep_sel
 GLOBAL_VAR  GUI_Sensitivity_Undo
 GLOBAL_VAR  Parameters
 GLOBAL_VAR  NrModelParameters
 
 
 !~~~stop if required~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 IF SIZEOF(MdlgStep)==0 THEN RETURN_VALUE 0
 !---send warning if no ModelParameters had been used
 IF VAL(NrModelParameters)<1 THEN 
   GET_STRING "ERROR: no ModelParameters defined !
     Seems you had defined DutParameters, 
       and currently, for Parameter Evolution, 
       only ModelParameters are supported !  [OK]", dummy
   RETURN_VALUE 0
 END IF
 !---correct wrong user input
 IF VAL(MdlgStep_sel) >  SIZEOF(MdlgStep)-1 THEN MdlgStep_sel = SIZEOF(MdlgStep)-1
 IF VAL(MdlgStep_sel) < 0                   THEN MdlgStep_sel = 0
 
 
 !~~~do it~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---switch off UndoOptimize button
 GUI_Sensitivity_Undo=0
 
 
 !---load history parameters
 FileName="./tmp_MdlgGUI_"&VAL$(MdlgStep[MdlgStep_sel])
 IF VAL(Debug)==1 THEN PRINT "  > loading ";FileName;".mps"
 ICCAP_FUNC(VAL$(Path2Setup)&"/../../ParameterSet", "Open", VAL$(FileName)&".mps")
 IF VAL(Debug)==1 THEN PRINT "  > loading ";FileName;".dps"
 ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "Open", VAL$(FileName)&".dps")
 
 
 !---simulate with loaded history params
 IF VAL$(Parameters)<>"n/a" THEN
   IF VAL(Debug)==1 THEN PRINT ">> simulating ... "
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Simulate All")
 END IF
 
 
 !---autoset parameter min and max values
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "AutoSet Min Max")	! apply SystemVariable AUTOSET_COEFF for min and max param. values centered around current value
 !                                                                               ! if SystemVariable AUTOSET_COEFF is not defined, the default is 5
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_OK_Cancel" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR Path2Setup
 GLOBAL_VAR Path2Xfm
 GLOBAL_VAR Path2FirstPlot
 GLOBAL_VAR Parameters
 GLOBAL_VAR ErrMsg
 GLOBAL_VAR FlagDefineExtrBox
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GET_STRING "What to do ? [OK], [Cancel]", Answer
 
 
 !---first, close the possibly opened GUI 'GUI_EditParentXfm'
 ICCAP_FUNC("GUI_CloseXfmEditing", "Execute", "Cancel")
 
 
 IF VAL$(Answer)=="Cancel" THEN
   IF VAL$(Parameters)<>"n/a" THEN
     !---load back start parameter 
     FileName="./tmp_MdlgGUI_0"
     ICCAP_FUNC(VAL$(Path2Setup)&"/../../ParameterSet", "Open", VAL$(FileName)&".mps")
     ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "Open", VAL$(FileName)&".dps")
     !---simulate 
     IF VAL(Debug)==1 THEN PRINT ">> simulating ... ";
     ICCAP_FUNC(VAL$(Path2FirstPlot)&"/PlotOptimizer", "Simulate All")
     IF VAL(Debug)==1 THEN PRINT "done!"
 
   ICCAP_FUNC("Clean_Up", "Execute")
 
   END IF
 END IF
 
 
 
 !~~~special case~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 IF VAL(FlagDefineExtrBox)==1 THEN
   !---if GUI/MP was opened by 'DEFINE_EXTR_BOX', copy the box bounds to the X_LOW, X_HIGH etc. of the Plot's Setup
   tmp_X_LOW = VAL(LOOKUP_TABLE_VAL(VAL$(Path2FirstPlot)&"/../../../PlotOptimizer", "X Min[0]"))
   tmp_X_HIGH = VAL(LOOKUP_TABLE_VAL(VAL$(Path2FirstPlot)&"/../../../PlotOptimizer", "X Max[0]"))
   tmp_Y_LOW = VAL(LOOKUP_TABLE_VAL(VAL$(Path2FirstPlot)&"/../../../PlotOptimizer", "Target Min[0]"))
   tmp_Y_HIGH = VAL(LOOKUP_TABLE_VAL(VAL$(Path2FirstPlot)&"/../../../PlotOptimizer", "Target Max[0]"))
 
 
   !---the PlotOptimizer handles the y-axis target limits differently for LOG or LIN
   Y_AxisType = "LIN"
   PO_Target=LOOKUP_TABLE_VAL(VAL$(Path2FirstPlot)&"/../../../PlotOptimizer", "Target[0]")
   IF STRPOS(VAL$(PO_Target), "LOG")>0 THEN Y_AxisType="LOG10"
   IF VAL$(Y_AxisType)=="LOG10" THEN
     tmp_Y_LOW = 10^tmp_Y_LOW
     tmp_Y_HIGH = 10^tmp_Y_HIGH
   END IF
 
 
   !---if user had specified a box, export it to the Setup of the Plot
   IF tmp_X_LOW <> tmp_X_HIGH THEN
     ErrMsg=""
     dummy=LOOKUP_VAR(VAL$(Path2FirstPlot)&"/../X_LOW", ErrMsg)
     IF VAL$(ErrMsg)=="" THEN ICCAP_FUNC(VAL$(Path2FirstPlot)&"/..", "SetVariableTableValue", "X_LOW", VAL(tmp_X_LOW))
     ErrMsg=""
     dummy=LOOKUP_VAR(VAL$(Path2FirstPlot)&"/../X_HIGH", ErrMsg)
     IF VAL$(ErrMsg)=="" THEN ICCAP_FUNC(VAL$(Path2FirstPlot)&"/..", "SetVariableTableValue", "X_HIGH", VAL(tmp_X_HIGH))
     ErrMsg=""
     dummy=LOOKUP_VAR(VAL$(Path2FirstPlot)&"/../Y_LOW", ErrMsg)
     IF VAL$(ErrMsg)=="" THEN ICCAP_FUNC(VAL$(Path2FirstPlot)&"/..", "SetVariableTableValue", "Y_LOW", VAL(tmp_Y_LOW))
     ErrMsg=""
     dummy=LOOKUP_VAR(VAL$(Path2FirstPlot)&"/../Y_HIGH", ErrMsg)
     IF VAL$(ErrMsg)=="" THEN ICCAP_FUNC(VAL$(Path2FirstPlot)&"/..", "SetVariableTableValue", "Y_HIGH", VAL(tmp_Y_HIGH))
   END IF
 
 
   !---re-execute calling Transform to accept the (new) extraction box
   ! In the case of 'DEFINE_EXTR_BOX', the MultiPlot is still open when the user hits Cancel (to define a new extraction box)
   ! This allows us to now re-execute the original remote box-extraction Transform again !!!
   ! Note: argument 1 anticipates the selection choice in the Transform 
   ICCAP_FUNC(VAL$(Path2Xfm), "Execute", 1)
 
 
   !---exit
   RETURN_VALUE 2
 END IF
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 !---close PlotOptimizer
 ICCAP_FUNC(VAL$(Path2Setup)&"/../../PlotOptimizer", "Close")
 
 
 !---close other Plots of active Setup (may have been opened by the user additionally)
 ICCAP_FUNC(VAL$(Path2Setup), "Close All")
 
 
 !---close Plots
 ICCAP_FUNC("_MP_", "Close")
 ICCAP_FUNC("_MP_ParamEvolution_", "Close")
 
 
 !---delete .mps and .dps files (parameter history)
 dummy=SYSTEM("rm ./tmp_MdlgGUI_*.mps 2> /dev/null") ! ' 2> /dev/null' supress error messages
 dummy=SYSTEM("rm ./tmp_MdlgGUI_*.dps 2> /dev/null") ! ' 2> /dev/null' supress error messages
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "ShowAllPlots" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  Plots
 GLOBAL_VAR  ErrMsg
 
 
 ErrMsg = ""
 Plots = ""
 
 !---identify all Plots of this Setup, except MultiPlots
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Plot", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   IF STRPOS(VAL$(tmpVar[i]), "MP") > 0 THEN 
     dummy=ARRAY_REMOVE_AT(tmpVar, i)
     i = i -1
   END IF
 NEXT i
 
 IF SIZEOF(tmpVar)==0 THEN
   ErrMsg= "ERROR: no plots found in current Setup !!"
   RETURN_VALUE -1
 END IF
 
 
 !---set Variable 'Plots'
 Plots = VAL$(tmpVar[0])
 FOR i=1 TO SIZEOF(tmpVar)-1
   Plots = VAL$(Plots)&", "&VAL$(tmpVar[i])
 NEXT i
 
 tmpVar=""
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "LineUpPlots" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GET_INT "Enter Nr. of Plots", iPlot
 IF iPlot<=0 THEN RETURN_VALUE 0
 
 
 ICCAP_FUNC("_MP_", "STFV", "Plots Per Row", iPlot)
 
 IF iPlot >= 3 THEN ICCAP_FUNC("_MP_", "STFV", "Plots Per Row", 2)
 
 IF iPlot >= 5 THEN ICCAP_FUNC("_MP_", "STFV", "Plots Per Row", 3)
 
 IF iPlot >=10 THEN ICCAP_FUNC("_MP_", "STFV", "Plots Per Row", "")
 
 
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PO_Sel_Error" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Path2FirstPlot		! first Plot in PlotOptimizer
 GLOBAL_VAR  PO_Error_Choices		! PlotOptimizer Error Setting: Absolute, Relative
 GLOBAL_VAR  PO_Error_Choices_sel
 
 
 !---verify settings
 IF PO_Error_Choices_sel<0 THEN RETURN_VALUE 0
 
 
 !---set PO error as requested from user in the GUI
 IF PO_Error_Choices_sel==0 THEN ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "SetError", "Absolute")
 IF PO_Error_Choices_sel==1 THEN ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "SetError", "Relative")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PO_Sel_Optim" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Path2FirstPlot		! first Plot in PlotOptimizer
 GLOBAL_VAR  PO_OptType_Choices
 GLOBAL_VAR  PO_OptType_Choices_sel
 
 
 !---verify settings
 IF PO_OptType_Choices_sel<0 THEN RETURN_VALUE 0
 
 
 !---set PO error as requested from user in the GUI
 !
 !===Levenberg-Marquardt===
 IF VAL(PO_OptType_Choices_sel)==0 THEN ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Set Algorithm", "L")
 
 !===Gradient===
 IF VAL(PO_OptType_Choices_sel)==1 THEN ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Set Algorithm", "B")
 
 !===Rand.MiniMax===
 IF VAL(PO_OptType_Choices_sel)==2 THEN ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Set Algorithm", "U")
 
 
 !===Sensitivity===
 IF VAL(PO_OptType_Choices_sel)==3 THEN 
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Set Algorithm", "S")
   !---auto-execute Sensitivity Analysis
   ICCAP_FUNC("GUI_PO_Actions", "Execute", "AutosetAndOptimize")
 END IF
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_AreaToolsOnOff" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ShowAreaTools
 GLOBAL_VAR  PLOT_TRACE_LINE_WIDTH
 GLOBAL_VAR  Path2FirstPlot		! first Plot in PlotOptimizer
 
 
 !---disable the red box, indicating the last clicked Plot
 ICCAP_FUNC("_MP_", "Unselect All")
 
 
 !---handle Plot Area Tools
 IF VAL(ShowAreaTools)==0 THEN
   ICCAP_FUNC("_MP_", "Area Tools Off")
   ICCAP_FUNC("_MP_", "Title Off")
   PLOT_TRACE_LINE_WIDTH = 2
 ELSE
   ICCAP_FUNC("_MP_", "Area Tools On")
   ICCAP_FUNC("_MP_", "Title On")
   PLOT_TRACE_LINE_WIDTH = 0
 END IF
 
 
 !---ask user for line width
 GET_INT "Line Width [0] .. [4]", PLOT_TRACE_LINE_WIDTH, PLOT_TRACE_LINE_WIDTH
 
 
 ICCAP_FUNC("_MP_", "Redisplay")
 IF VAL(ShowAreaTools)==0 THEN
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Disable All")
 ELSE
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Enable All")
 ENDIF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Reset_Plot_Colors" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Reset_Plot_Colors
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  PlotNames_sel
 
 
 
 CurveColoring = "Display all curves with the configured trace color"
 
 FOR iPlot=0 TO SIZEOF(PlotNames_sel)-1
   IF VAL$(PlotNames[PlotNames_sel[iPlot]])<>"" THEN		! user may have defined empty Plot names to provide a nicer spacing in the MultiPlot
     Path2Plot=VAL$(Path2Setup)&"/"&VAL$(PlotNames[PlotNames_sel[iPlot]])
   ICCAP_FUNC(VAL$(Path2Plot)&"/PlotOptions", "SetTableFieldValue", "Multicolor", VAL$(CurveColoring))
   ICCAP_FUNC(VAL$(Path2Plot), "Replot")
   END IF
 NEXT iPlot
 
 
 dummy = WAIT(1)
 Reset_Plot_Colors = 0
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________4" "711.501"
{
}
LINK XFORM "GUI_Add_Params" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  avail_ParamNames
 GLOBAL_VAR  avail_ParamNames_sel
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  ParamNamesWildCard
 GLOBAL_VAR  NrModelParameters
 GLOBAL_VAR  avail_ParamGroup_sel2add
 
 
 !===this Program is called by button 'Add Params' in Main GUI
 
 GET_STRING "What to Do ?  [Create GUI], [OK]", Action
 
 IF VAL$(Action) == "Create GUI" THEN
   !---close parameter evolution Plot
   ICCAP_FUNC("_MP_ParamEvolution_", "Close")
 
 
   avail_ParamGroup_sel2add=-1
   ParamNamesWildCard="pls. wait ..."
   ModelName=VAL$(Path2Setup)&"/../.."
 
 
   !---read avail parameter names
   avail_ParamNames_sel=-1
   N=0
   i=0
   LOOP
     ErrMsg=""
     avail_ParamName=LOOKUP_TABLE_VAL("/"&VAL$(ModelName)&"/ParameterSet", "Param Name["&VAL$(i)&"]", ErrMsg)
 
     EXIT IF VAL$(ErrMsg)<>"" 	!end of param. table was reached
 
     !---verify if entry is a number (otherwise, it could be a link to another param, or it could be an equation)
     ParamVal     = LOOKUP_TABLE_VAL("/"&VAL$(ModelName)&"/ParameterSet", "Value["&VAL$(i)&"]")
     ParamValEval = LOOKUP_TABLE_VAL_EVAL("/"&VAL$(ModelName)&"/ParameterSet", "Value["&VAL$(i)&"]")
     IF VAL(ParamVal)<>VAL(ParamValEval) THEN
       !we found a link or a formula, skip it
     ELSE
       DIMENSION_ARRAY("avail_ParamNames", N+1)
       avail_ParamNames[N]=avail_ParamName
       N = N + 1
     END IF
     i = i + 1
   END LOOP
 
   ParamNamesWildCard=""
 
   !---display modeless GUI with avail param.names
   ICCAP_FUNC("./GUI_AddParamNames", "Display Modeless GUI", "Select Parameters to be added")
 
 
 ELSE IF VAL$(Action) == "OK" THEN    !---close the GUI
   ICCAP_FUNC("./GUI_AddParamNames", "Destroy GUI", "Select Parameters to be added")
 
   !---if present, remove keyword "=> Hit 'Add' Params <="  (had been added by 'START_MDLG_GUI' if param. list was "")
   IF SIZEOF(ParamNames)>0 THEN
     IF VAL$(ParamNames[0]) == "=> Hit 'Add' Params <=" THEN DIMENSION_ARRAY(ParamNames, 0)
   END IF
 
 
   !---add selected parameters to existing ParamNames
   IndexOffset = SIZEOF(ParamNames)
   FOR iParam=0 TO SIZEOF(avail_ParamNames_sel)-1
     AddtlParamName=VAL$(avail_ParamNames[avail_ParamNames_sel[iParam]])
     !---verify if user-selected param had not already been included in the current param. list
     AddParam=1
     FOR i=0 TO IndexOffset-1
       IF VAL$(ParamNames[i])==VAL$(AddtlParamName) THEN AddParam=0
     NEXT i
     !---add param name
     IF AddParam==1 THEN 
       !append at the end of array ParamNames
       dummy=ARRAY_INSERT_AT("ParamNames", AddtlParamName)
       !activate selection 
       dummy=ARRAY_INSERT_AT("ParamNames_sel", VAL$(SIZEOF(ParamNames)-1))
     END IF
   NEXT iParam
   ICCAP_FUNC("GUI_ParamNamesSel", "Execute")
 
   NrModelParameters=SIZEOF(ParamNames)
 
 END IF
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_ParamNamesSel" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  Path2FirstPlot		! first Plot in PlotOptimizer
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ParamNames_sel
 GLOBAL_VAR  NrModelParameters
 
 
 !===this Program is called from the Add-Params Sub-GUI
 
 
 !---clear current parameters in the PlotOptimizer
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Clear Table")	
 
 !---activate selected parameters in the PlotOptimizer
 FOR iParam=0 TO SIZEOF(ParamNames_sel)-1
   actParamName = VAL$(ParamNames[ParamNames_sel[iParam]])
 
   !---verify that the param. value is just a number, and not an equation
   ErrMsg = ""
   Path2ModelParams = VAL$(Path2Setup)&"/../../ParameterSet"
   ParamValEntryEval  = LOOKUP_TABLE_VAL_EVAL(VAL$(Path2ModelParams), "Value["&VAL$(actParamName)&"]", ErrMsg)
   IF VAL$(ErrMsg)=="" THEN  !---if ErrMsg<>"", then it's probably a DUT Parameter -> skip and assume there is no equation involved
     ParamValEntry      = LOOKUP_TABLE_VAL(VAL$(Path2ModelParams),      "Value["&VAL$(actParamName)&"]")
     IF VAL$(ParamValEntry) <> VAL$(ParamValEntryEval) THEN
       ErrMsg = "ERROR: "&VAL$(actParamName)&" parameter value is not just a number ! 
         Currently: "&VAL$(actParamName)&" = "&VAL$(ParamValEntry)&"
         => Tuning/Optimization impossible !"
       GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
       RETURN_VALUE -1
     END IF
   END IF
 
   !---add param name to PlotOptimizer
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Name["&VAL$(iParam)&"]", VAL$(actParamName))	
 NEXT iParam
 
 NrModelParameters = SIZEOF(ParamNames_sel)
 
 
 !---autoset parameter min and max values
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "AutoSet Min Max")	! apply SystemVariable AUTOSET_COEFF for min and max param. values centered around current value
 !                                                                               ! if SystemVariable AUTOSET_COEFF is not defined, the default is 5
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_FilterParams" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR  ParamNamesWildCard
 GLOBAL_VAR  avail_ParamNames
 
 IF VAL$(ParamNamesWildCard)=="" THEN RETURN_VALUE 2
 IF VAL$(ParamNamesWildCard)=="*" THEN 
   ICCAP_FUNC("GUI_Add_Params", "Execute", "Create GUI")
   RETURN_VALUE 2
 END IF
 
 
 !===this Program is called from the Add-Params Sub-GUI
 !   it filters the avail. parameters by user-entered search string
 
 !---delete GUI (to speed up performance)
 ICCAP_FUNC("./GUI_AddParamNames", "Destroy GUI", "Select Parameters to be added")
 
 
 !---trim-off leading or trailing '*'
 ParamNamesWildCard_trim=TRIM$(VAL$(ParamNamesWildCard), "*")
 !---delete not requested params
 FOR i=0 TO SIZEOF(avail_ParamNames)-1
   IF STRPOS(VAL$(avail_ParamNames[i]), VAL$(ParamNamesWildCard_trim))<1 THEN
     dummy=ARRAY_REMOVE_AT(avail_ParamNames, i)
     i = i - 1
   END IF
 NEXT i
 
 
 !---re-open GUI
 ICCAP_FUNC("./GUI_AddParamNames", "Display Modeless GUI", "Select Parameters to be added")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_DelParams" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ParamNames_sel
 
 
 !===this Program is called by button 'Del Params' in Main GUI
 
 !---close parameter evolution Plot
 ICCAP_FUNC("_MP_ParamEvolution_", "Close")
 
 
 !---remove selected params
 FOR i=0 TO SIZEOF(ParamNames_sel)-1
   dummy=ARRAY_REMOVE_AT(ParamNames, ParamNames_sel[i])
   !---adjust indices of further selected params
   FOR i1=i TO SIZEOF(ParamNames_sel)-1
     ParamNames_sel[i1]=ParamNames_sel[i1]-1
   NEXT i1
 NEXT i
 
 !---deselect all params
 ParamNames_sel=-1
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Restore_Params" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Path2FirstPlot		! first Plot in PlotOptimizer
 GLOBAL_VAR  Parameters		! originally selected Parameter names for PlotOptimizer
 GLOBAL_VAR  ParamNames		! requested Parameter names for PlotOptimizer
 GLOBAL_VAR  ParamNames_sel		! currently selected Parameter names for PlotOptimizer
 GLOBAL_VAR  avail_ParamGroup_sel
 
 
 !===this Program is called by button 'Restore Params' in Main GUI
 
 !---clear current parameters in the PlotOptimizer
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "Clear Table")	
 
 
 !---recover original start-up ParameterNames
 RetVal = CUTSTR(VAL$(Parameters), ParamNames, ",")
 
 
 !---handle special case of free user selection of param. names
 IF (SIZEOF(ParamNames)==1) ANDALSO (VAL$(ParamNames[0])=="") THEN
   ParamNames[0]= "=> Hit 'Add' Params <="	! add keyword if no params. had been preset
 END IF
 
 
 !---deselect param groups
 avail_ParamGroup_sel=-1
 
 
 !---reflect if parameter was commented out: -> make it inactive
 ParamNames_sel="ICCAP_ARRAY[0]"
 i=0
 FOR iParam=0 TO SIZEOF(ParamNames)-1
   IF STRPOS(VAL$(ParamNames[iParam]), "!")==0 THEN
     ParamNames_sel="ICCAP_ARRAY["&VAL$(i+1)&"]"
     ParamNames_sel[i]=iParam
     ParamNames[iParam]=TRIM$(VAL$(ParamNames[iParam]), " ")		! cut-off blanks
     i = i + 1
   ELSE
     ParamNames[iParam]=TRIM$(VAL$(ParamNames[iParam]), "! ")	! cut-off '!' and blanks
   END IF
 NEXT iParam
 
 
 !---bring active parameters into the PlotOptimizer
 FOR iParam=0 TO SIZEOF(ParamNames_sel)-1
   ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "STFV", "Name["&VAL$(iParam)&"]", VAL$(ParamNames[ParamNames_sel[iParam]]))	
 NEXT iParam
 
 
 !---autoset parameter min and max values
 ICCAP_FUNC("Plot "&VAL$(Path2FirstPlot)&"/PlotOptimizer", "AutoSet Min Max")	! apply SystemVariable AUTOSET_COEFF for min and max param. values centered around current value
 !                                                                               ! if SystemVariable AUTOSET_COEFF is not defined, the default is 5
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________5" "711.501"
{
}
LINK XFORM "Read_Param_Groups" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  avail_ParamGroup
 GLOBAL_VAR  avail_ParamGroup_sel
 GLOBAL_VAR  String2Array
 GLOBAL_VAR  NrParamGroupItems
 GLOBAL_VAR  ErrMsg
 
 
 ! This Program identifies the Variables with the keyword PARAMGROUP_xxxx
 ! -----------------------------------------------------------------------------------------------
  
 ! HINT:
 !========================================
 !   Grouping ModelParameters in a ModelFile
 !============###############==================
 !
 !- under ModelVariables, 
 !  - specify the   SYSTEM_VARIABLE   PARAMGROUP_xxxx
 !                                    ===============
 !       (xxxx = DC, CV, Spar etc., you can apply your own naming convention)
 !  - set its value to a comma delimited list of your selected parameter grouping  .
 !  - and the Model (and DUT) Parameters will be grouped.
 !
 !Example:
 !----------
 !PARAMGROUP_DC="RS,DMAIN.IS,DMAIN.N"
 !PARAMGROUP_CV="DMAIN.CJO,DMAIN.M,DMAIN.VJ,DMAIN.FC"
 !
 
 
 
 
 !~~~~~~~~here it comes~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 ModelName=VAL$(Path2Setup)&"/../.."
 
 
 !---clear arrays
 avail_ParamGroup    = "ICCAP_ARRAY[0]"	
 avail_ParamGroup_sel= "ICCAP_ARRAY[0]"
 
 
 !---find ModelVariables PARAMGROUP_xxxx  in specified Model
 N=0
 i=0
 ErrMsg=""
 WHILE VAL$(ErrMsg)==""
   ParamGroup=LOOKUP_TABLE_VAL("/"&VAL$(ModelName)&"/Variables", "Name["&VAL$(i)&"]", ErrMsg)
   IF STRPOS(VAL$(ParamGroup), "PARAMGROUP_")>0 THEN
     DIMENSION_ARRAY("avail_ParamGroup", N+1)
     !---strip off prefix PARAMGOUP_
     ParamGroup = SUBSTR$(VAL$(ParamGroup), 12)
     !---add to array
     avail_ParamGroup[N]=VAL$(ParamGroup)
     N = N + 1
   END IF
   i = i + 1
 END WHILE
 ErrMsg=""
 
 
 !---if no PARAMGROUP_xxx was found, add a note
 IF SIZEOF(avail_ParamGroup)==0 THEN
   dummy=ARRAY_INSERT_AT("avail_ParamGroup", "n/a")
   NrParamGroupItems = 2
 END IF
 
 
 
 !---clear
 String2Array="ICCAP_ARRAY[0]"
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Param_Groups" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ParamNames_sel
 GLOBAL_VAR  avail_ParamGroup
 GLOBAL_VAR  avail_ParamGroup_sel
 GLOBAL_VAR  String2Array
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  Path2FirstPlot
 GLOBAL_VAR  NrModelParameters
 
 
 !---exit if only a hint exists in array avail_ParamGroup
 IF VAL$(avail_ParamGroup[0])=="n/a" THEN
   ModelName=WHOIS(VAL$(Path2Setup), "Parent Model PartName")
   GET_STRING "HELP: no ModelVariable 'PARAMGROUP_xxx' found in ModelFile '"&VAL$(ModelName)&"'
 
 	========================================
 	   Grouping ModelParameters in a ModelFile
 	============###############==================
 	
 	- under ModelVariables, 
 	  - specify the   SYSTEM_VARIABLE   PARAMGROUP_xxxx
 	                                    ===============
 	       (xxxx = DC, CV, Spar etc., you can apply your own naming convention)
 	  - set its value to a comma delimited list of your preferred parameter grouping  .
 	  - and the Model (and DUT) Parameters will be grouped,
 	     and can be selected by this GUI item.
 
 	[OK]", dummy
   avail_ParamGroup_sel = -1
   RETURN_VALUE 2
 END IF
 
 
 !---handle special case if hint => Hit 'Add' Params <=  exists in ParamNames
 IF (SIZEOF(ParamNames)>0) ANDALSO (VAL$(ParamNames[0])=="=> Hit 'Add' Params <=") THEN DIMENSION_ARRAY("ParamNames", 0)
 
 
 ModelName=VAL$(Path2Setup)&"/../.."
 
 !---clear current param user selection
 ParamNames=""
 ParamNames_sel=-1
 
 !---add parameters of selected PARAMGROUP to array
 FOR iParamGroup=0 TO SIZEOF(avail_ParamGroup_sel)-1
   !---initialize
   String2Array=""
   !---calc. path to currently selected PARAMGROUP
   Path2Var="/"&VAL$(ModelName)&"/PARAMGROUP_"&VAL$(avail_ParamGroup[avail_ParamGroup_sel[iParamGroup]])
   !---get string of param names of currently selected PARAMGROUP_
   PARAMGROUP_Value=LOOKUP_VAR(VAL$(Path2Var))
   !---cut string chain (separated by ',') into its components
   dummy = CUTSTR(VAL$(PARAMGROUP_Value), String2Array, ",")
   !---get rid of possibly existing additional ' ' separators
   FOR i=0 TO SIZEOF(String2Array)-1
     String2Array[i]=TRIM$(VAL$(String2Array[i]), " ")
   NEXT i
 
   !---export selected parameters into ParamNames
   IndexOffset = SIZEOF(ParamNames)
   DIMENSION_ARRAY("ParamNames", IndexOffset+(SIZEOF(String2Array)))
   FOR iParam=0 TO SIZEOF(String2Array)-1
     ParamNames[IndexOffset+iParam]= VAL$(String2Array[iParam])
   NEXT iParam
 
 NEXT iParamGroup
 
 
 !---remove param.name if its value is not a number (could be a link to another param, or it could be an equation)
 FOR i=0 TO SIZEOF(ParamNames)-1
   ParamVal     = LOOKUP_TABLE_VAL("/"&VAL$(ModelName)&"/ParameterSet", "Value["&VAL$(ParamNames[i])&"]")
   ParamValEval = LOOKUP_TABLE_VAL_EVAL("/"&VAL$(ModelName)&"/ParameterSet", "Value["&VAL$(ParamNames[i])&"]")
   IF VAL(ParamVal)<>VAL(ParamValEval) THEN
     !we found a link or a formula, remove the param.name
     dummy=ARRAY_REMOVE_AT(ParamNames, i)
   END IF
 NEXT i
 
 
 
 !---clear
 String2Array="ICCAP_ARRAY[0]"
 
 
 !---switch on parameter history
 NrModelParameters=SIZEOF(ParamNames)
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________6" "711.501"
{
}
LINK XFORM "GUI_Param_Evolution" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  NrModelParameters
 GLOBAL_VAR  ParamEvolutionShowAreaTools
 
 
 !---send warning if no ModelParameters had been used
 IF VAL(NrModelParameters)<1 THEN 
   GET_STRING "ERROR: no ModelParameters defined !
     Seems you had defined DutParameters, 
       and currently, for Parameter Evolution, 
       only ModelParameters are supported !  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 
 !---close parameter evolution Plot
 ICCAP_FUNC("_MP_ParamEvolution_", "Close")
 
 
 ICCAP_FUNC("Create_ParamEvolution", "Execute")
 
 
 ICCAP_FUNC("_MP_ParamEvolution_", "Display Plot")
 ParamEvolutionShowAreaTools=0
 ICCAP_FUNC("_MP_ParamEvolution_", "Area Tools Off")
 ICCAP_FUNC("_MP_ParamEvolution_", "Title Off")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Create_ParamEvolution" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! This Program reads the values of ParamNames out of the history .mps files
 ! and fills up the array 'Params'
 
 GLOBAL_VAR  Params
 GLOBAL_VAR  tmpRead
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  MdlgStep
 GLOBAL_VAR  MdlgStep_sel
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  NrModelParameters
 
 IF VAL(NrModelParameters)<1 THEN RETURN_VALUE 0
 IF VAL$(ParamNames[0])=="=> Hit 'Add' Params <=" THEN RETURN_VALUE 0
 
 
 ErrMsg=""
 DirFileName="./tmp_MdlgGUI_0.mps"
 
 
 !---Find out how many parameters are included in .mps file: Search for keyword "param"
 SearchString = "param"
 NrMpsParams = VAL(SYSTEM$("grep '"&VAL$(SearchString)&"' "&VAL$(DirFileName)&" | wc -l "))
 !PRINT "NrMpsParams=";NrMpsParams
 
 IF NrMpsParams==0 THEN  RETURN_VALUE -1		!no mps history files available
 
 
 !---init array 'Params'
 Params=""					!initialize
 DIMENSION_ARRAY(Params, SIZEOF(ParamNames))
 FOR i=0 TO SIZEOF(Params)-1
   DIMENSION_ARRAY(Params[i], SIZEOF(MdlgStep))	!add as many fields as we currently have .mps history files
 NEXT i
 
 
 !---read .mps history files
 FOR iHistory=0 TO SIZEOF(MdlgStep)-1
   !PRINT "iHistory=";iHistory
   !---read param.names and values----------------
   !   the following PEL code is deducted from 'UTILITIES/Read_Params/PARAMS_2_MDM'
   !---search for 1st line with keyword "param"
   DirFileName="./tmp_MdlgGUI_"&VAL$(iHistory)&".mps"
   r_stream = USERC_open(VAL$(DirFileName), "r")
   tmpRead=""
   WHILE VAL$(tmpRead)<>"param"
     dummy = USERC_readstr(r_stream, 0, "%s", tmpRead)	!tmpRead is a Setup Variable
   END WHILE
 
   !---read param name and value from current .mps history file
   LOOP
     ! possible formats of parameter lines in an .mps file:
     ! param MAIN.PE " 750.0"
     ! param MAIN.PE " 750.0m"
     ! param MAIN.PE "-750.0m"
     dummy = USERC_readstr(r_stream, 0, "%s", tmpRead)
 
     EXIT IF VAL$(tmpRead)=="}"
 
     actParamName=VAL$(tmpRead)
 
     !---check if current ParamName is part of array ParamNames. If yes, add its value to 'Params'
     FOR iParamName=0 TO SIZEOF(ParamNames)-1
     !PRINT "iParamName=";iParamName
       IF VAL$(ParamNames[iParamName])==VAL$(actParamName) THEN 
         !---read value
         dummy = USERC_readstr(r_stream, 0, "%s", tmpRead)
         !---check if only the " was read and not (yet) the parameter value
         IF VAL$(tmpRead)=='"' THEN dummy = USERC_readstr(r_stream, 0, "%s", tmpRead)
         !---cut off possible leading and trailing "
         tmpRead = TRIM$(VAL$(tmpRead),'"')
         Params[iParamName][iHistory] = tmpRead
       END IF
     NEXT iParamName
   END LOOP
 
   dummy = USERC_close(r_stream)
 
 NEXT iHistory
 
 
 ICCAP_FUNC("Visu_ParamEvolution", "Execute")
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Visu_ParamEvolution" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  Params
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  MdlgStep
 GLOBAL_VAR  tmpVar
 
 
 IF VAL$(ParamNames[0])=="=> Hit 'Add' Params <=" THEN RETURN_VALUE 0
 
 
 !---enter nr. of Plots into MultiPlot
 ICCAP_FUNC("_MP_ParamEvolution_", "STFV", "# of Plots", SIZEOF(ParamNames))
 
 
 !---delete possibly existing Inputs/Outputs and Parameter Plots
 ICCAP_FUNC(".", "Import Delete")
 ICCAP_FIND_CHILDREN ".", "Plot", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   IF STRPOS(VAL$(tmpVar[i]), "_MP_") == 0 THEN ICCAP_FUNC(VAL$(tmpVar[i]), "Delete")
 NEXT i
 
 
 !---create Input 'Index'
 ICCAP_FUNC(".", "New Input", "Index")
 ICCAP_FUNC("Index", "STFV", "Start", 0)
 ICCAP_FUNC("Index", "STFV", "Stop", VAL(SIZEOF(MdlgStep)-1))
 ICCAP_FUNC("Index", "STFV", "Step Size", 1)
 
 
 !---create Outputs for every ParamName (to be able to display them in a Plot)
 FOR iParamName=0 TO SIZEOF(ParamNames)-1
   tmpVar = VAL$(ParamNames[iParamName])
   !---replace possible '.' by '_'
   BadChar  = "."
   GoodChar = "_"
   ICCAP_FUNC("Replace_Chars", "Execute", VAL$(BadChar), VAL$(GoodChar))
   !---replace possible '/' by '_'
   BadChar  = "/"
   GoodChar = "_"
   ICCAP_FUNC("Replace_Chars", "Execute", VAL$(BadChar), VAL$(GoodChar))
   ParamName=VAL$(tmpVar)
 
   IF (VAL$(ParamName)<>"") ANDALSO (VAL$(ParamName)<>"=> 'Add' Params <=") THEN
     !---create new Output(s) for Parameter(s)
     ICCAP_FUNC(".", "New Output", VAL$(ParamName))
     ICCAP_FUNC(VAL$(ParamName), "STFV", "Type", "M")
 
 
     !---copy param values to Output
     COMPLEX tmp.M[SIZEOF(MdlgStep)]
     FOR i=0 TO SIZEOF(tmp)-1
       tmp[i]=Params[iParamName][i]
     NEXT i
 
     dummy=COPY2OUTPUT(tmp, VAL$(ParamName), "M")
 
 
     !---add Plot for new Output
     PlotName = "_"&VAL$(ParamName)&"_"
     ICCAP_FUNC(".", "New Plot", VAL$(PlotName))
     ICCAP_FUNC(VAL$(PlotName), "STFV", "X Data", "Index!!Tuning/Optimization Step")
     ICCAP_FUNC(VAL$(PlotName), "STFV", "Y Data 0", VAL$(ParamName))
     ICCAP_FUNC(VAL$(PlotName), "STFV", "Header", VAL$(VAL$(ParamNames[iParamName])))
 
 
     !---add Plot to MultiPlot
     ICCAP_FUNC("_MP_ParamEvolution_", "STFV", "Plot "&VAL$(iParamName), VAL$(PlotName))
   END IF
 
 NEXT iParamName
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "View_ParamValues" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ParamName_ViewValues
 GLOBAL_VAR  tmpVar
 
 
 IF VAL(ParamName_ViewValues)<0 THEN RETURN_VALUE -1
 
 tmpVar = VAL$(ParamNames[ParamName_ViewValues])
 
 !---replace possible '.' by '_'
 BadChar  = "."
 GoodChar = "_"
 ICCAP_FUNC("Replace_Chars", "Execute", VAL$(BadChar), VAL$(GoodChar))
 !---replace possible '/' by '_'
 BadChar  = "/"
 GoodChar = "_"
 ICCAP_FUNC("Replace_Chars", "Execute", VAL$(BadChar), VAL$(GoodChar))
 
 OutputName=VAL$(tmpVar)
 
 ICCAP_FUNC(VAL$(OutputName), "View")
 
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_ParamEvolAreaToolsOn" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ParamEvolutionShowAreaTools
 
 
 IF VAL(ParamEvolutionShowAreaTools)==0 THEN
   ICCAP_FUNC("_MP_ParamEvolution_", "Area Tools Off")
 ELSE
   ICCAP_FUNC("_MP_ParamEvolution_", "Area Tools On")
 END IF
 
 
 
 ICCAP_FUNC("_MP_ParamEvolution_", "Redisplay")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________7" "711.501"
{
}
LINK XFORM "GUI_Edit_Parent_Xfm" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GLOBAL_VAR  ParamNames
 GLOBAL_VAR  ParamNames_sel
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  PlotNames_sel
 GLOBAL_VAR  ParamNames_act
 GLOBAL_VAR  PlotNames_act
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  Path2Xfm
 GLOBAL_VAR  XfmContents
 
 
 !---exit if Transform Name is 'dummy'  (happens when doing nonlin-RF mdlg)
 dummy = CUTSTR(VAL$(Path2Xfm), tmpVar, "/")
 IF LWC$(VAL$(tmpVar[SIZEOF(tmpVar)-1]))=="dummy" THEN
   GET_STRING "NOTE:  Parent Transform editing not possible for nonlin-RF   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---show current selection of Plots and Parameter
 !   for the user to copy-paste into the Transform
 ParamNames_act = ""
 FOR i=0 TO SIZEOF(ParamNames)-1
   ParamName_sel=0
   FOR i_sel = 0 TO SIZEOF(ParamNames_sel)-1
     IF ParamNames_sel[i_sel]==i THEN ParamName_sel=1
   NEXT i_sel
   IF ParamName_sel==0 THEN ParamNames_act = VAL$(ParamNames_act)&"!"
   ParamNames_act = VAL$(ParamNames_act)&VAL$(ParamNames[i])&", "
 NEXT i
 ParamNames_act=TRIM$(VAL$(ParamNames_act), ", ")
 
 PlotNames_act = ""
 FOR i=0 TO SIZEOF(PlotNames)-1
   PlotName_sel=0
   FOR i_sel = 0 TO SIZEOF(PlotNames_sel)-1
     IF PlotNames_sel[i_sel]==i THEN PlotName_sel=1
   NEXT i_sel
   IF PlotName_sel==0 THEN PlotNames_act = VAL$(PlotNames_act)&"!"
   PlotNames_act = VAL$(PlotNames_act)&VAL$(PlotNames[i])&", "
 NEXT i
 PlotNames_act=TRIM$(VAL$(PlotNames_act), ", ")
 
 
 !---import the contents of the Program into a temp. variable
 XfmContents=LOOKUP_TABLE_VAL(VAL$(Path2Xfm), "Program")   !"Program" is the keyword to get all the Program/Program2 PEL code into the Variable 'MacroXfmContents'
 
 !---open Transform for editing
 ICCAP_FUNC("./GUI_EditParentXfm", "Display Modeless GUI", "Edit Parent Transform")
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_CloseXfmEditing" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI("PartName")&"..."
 
 
 GLOBAL_VAR  Path2Xfm
 GLOBAL_VAR  XfmContents
 
 
 !---this is answered by the calling GUI
 GET_STRING "What to do ?  [OK], [Cancel]", Answer
 
 
 !---destroy GUI
 ICCAP_FUNC("./GUI_EditParentXfm", "Destroy GUI", "Edit Parent Transform")
 
 !---copy edited text back into Transform
 IF VAL$(Answer)=="OK" THEN
   ICCAP_FUNC(Path2Xfm, "STFV", "Program", ASCII$(VAL$(XfmContents)))     !"Program" is the keyword to access the Transform Editor Field, ASCII$ is mandatory to keep CR and LF (carriage return, line feed)
 END IF
 
 
 XfmContents=""
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_________________8" "711.501"
{
}
LINK XFORM "Replace_Chars" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR tmpVar
 
 
 !---in Variable 'tmpVar', replace possible '.' by '_'
 
 GET_STRING "BadChar",  ".", BadChar
 GET_STRING "GoodChar", "_", GoodChar
 
 ! find out how many chars are included in the bad characters string
 StringLengthBad=STRLEN(VAL$(BadChar))
 ! do the char. exchange
 StringPos = 1
 WHILE StringPos > 0
   StringPos = STRPOS(VAL$(tmpVar), VAL$(BadChar))
   IF StringPos > 0 THEN  
     StringLength = STRLEN(VAL$(tmpVar))
     IF StringLength > 1 THEN
       IF StringPos > 1 THEN
         tmpVar = SUBSTR$(VAL$(tmpVar), 1, StringPos-1)&VAL$(GoodChar)&SUBSTR$(VAL$(tmpVar), StringPos+StringLengthBad, StringLength)
       ELSE
         !the bad char is already the first char
         tmpVar = VAL$(GoodChar)&SUBSTR$(VAL$(tmpVar), StringPos+StringLengthBad, StringLength)
       END IF
     ELSE	
       !string consisted only of the BadChar
       tmpVar=""
     END IF
   END IF
 END WHILE
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Check_SysVars" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 ! The IC-CAP SystemVariable 'PLOT_TRACE_LINE_WIDTH' is used by Transform
 ! 'GUI_AreaToolsOnOff' to enable nice plot traces for screen shots.
 
 
 !---the SystemVariable PLOT_TRACE_LINE_WIDTH needs to exist on the ICCAP/Main/Tools/SystemVariables level, so we create it now.
 ICCAP_FUNC("/", "CreateVariableTableVariable", "PLOT_TRACE_LINE_WIDTH")	!If the Variable name exists already, no action is taken.
 !         If the Variable name already exists, no action is taken.
 
 
 
 !---set its value to default
 ICCAP_FUNC(".", "SetVariableTableValue", "PLOT_TRACE_LINE_WIDTH", 0)
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Identify_LSYNCs" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  Path2Setup
 GLOBAL_VAR  LSYNC_exist
 
 
 GET_STRING "Action   [identify], [open GUI]", Answer
 
 dummy = WAIT(1)
 tmpVar=""
 
 IF VAL$(Answer)== "identify" THEN
   ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input",     tmpVar
 
   LSYNC_exist=0
   FOR i=0 TO SIZEOF(tmpVar)-1
     SweepType =  LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/"&VAL$(tmpVar[i]), "Sweep Type")
     IF VAL$(SweepType)=="LSYNC" THEN LSYNC_exist=1
   NEXT i
 ELSEIF VAL$(Answer)== "open GUI" THEN
   ICCAP_FUNC("/UTILITIES/PLOT_UTILITIES/PLOT_SHOW_LSYNC_VALUES/PLOT_SHOW_LSYNC_VALUES", "Execute", VAL$(Path2Setup))
 END IF
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !---delete possibly existing MdlgGUI .mps and .dps files (parameter history)
 dummy=SYSTEM("rm ./tmp_MdlgGUI_*.mps  2> /dev/null")	!  ' 2> /dev/null'  supress error messages
 dummy=SYSTEM("rm ./tmp_MdlgGUI_*.dps  2> /dev/null")	!  ' 2> /dev/null'  supress error messages
 
 
 !---reset arrays
 PlotNames      = "ICCAP_ARRAY[0]"
 PlotNames_sel  = "ICCAP_ARRAY[0]"
 ParamNames     = "ICCAP_ARRAY[0]"
 ParamNames_sel = "ICCAP_ARRAY[0]"
 MdlgStep       = "ICCAP_ARRAY[0]"
 MdlgStep_sel   = 0
 avail_ParamGroup     = "ICCAP_ARRAY[0]"
 avail_ParamGroup_sel = "ICCAP_ARRAY[0]"
 avail_ParamNames     = "ICCAP_ARRAY[0]"
 avail_ParamNames_sel = "ICCAP_ARRAY[0]"
 avail_ParamGroup_sel2add = -1
 
 Params = "ICCAP_ARRAY[0]"
 
 String2Array="ICCAP_ARRAY[0]"
 
 !---reset Input/Outputs
 ICCAP_FUNC(".", "Import Delete")
 ICCAP_FUNC(".", "New Input", "see_under_ExtractOptimize")
 ICCAP_FUNC("see_under_ExtractOptimize", "STFV", "Sweep Type", "CON")
 
 
 !---delete possibly existing Plots except Plot names containing  '_MP_'
 ICCAP_FIND_CHILDREN ".", "Plot", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   IF STRPOS(VAL$(tmpVar[i]), "_MP_") == 0 THEN ICCAP_FUNC(VAL$(tmpVar[i]), "Delete")
 NEXT i
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK PLOT "_MP_ParamEvolution_" "711.501"
{
View plot_window 0 "5,11,39245,26846"
View draw_ds 0 "B,0,1576"
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "8"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "0"
element "Header" "Model Parameter Value Evolution During Current Modeling Procedure"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_MAIN_LSG_"
element "Plot 1" "_MAIN_LDG_"
element "Plot 2" "_MAIN_LFP1_"
element "Plot 3" "_MAIN_DFP1_"
element "Plot 4" "_MAIN_LFP2_"
element "Plot 5" "_MAIN_DFP2_"
element "Plot 6" "_MAIN_XGW_"
element "Plot 7" "_MAIN_TBAR_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./GUI_ParamEvolution"
element "GUI 1 Location" "U"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_MP_" "711.501"
{
View draw_ds 0 "B,0,0"
View plot_window 0 "__iccapDataBlock"
TABLE "ICVIEWDATA"
{
98,119,48342,25894,{/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_SHORT/SHORT/L10_L20:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_OPEN/OPEN/C10_C20:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_THRU/THRU/_TD_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&/CA
L_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_THRU/THRU/_Z0_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_LOAD/LOAD/R10_R20:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_LOAD/LOAD/L10_L20:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC}
__iccapDataBlockEnd
}
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "6"
element "# of GUIs" "3"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_SHORT/SHORT/L10_L20"
element "Plot 1" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_OPEN/OPEN/C10_C20"
element "Plot 2" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_THRU/THRU/_TD_"
element "Plot 3" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_THRU/THRU/_Z0_"
element "Plot 4" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_LOAD/LOAD/R10_R20"
element "Plot 5" "/CAL_VERIFY/Analyze_Results/At_a_Glance/SHOW_PLOTS/../../../CalVerify_LOAD/LOAD/L10_L20"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "GUI_MultiPlot_TOP"
element "GUI 1 Location" "U"
element "GUI 2" "GUI_MultiPlot_TOP_RIGHT"
element "GUI 2 Location" "UR"
element "GUI 3" "GUI_MultiPlot_RIGHT"
element "GUI 3 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
data "711.501"
{
}
}
}
LINK DUT "_____________________________________4" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "PLOT_UTILITIES" "711.501"
{
View tree_dut 0 "0"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "PLOT_SELECT" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "0.85976257973069 3882 2551"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P242 P218 C10"
element 0 "Name" "ModelName"
element 0 "Value" "/ASM_HEMT_MODELING"
element 1 "Name" "DutNames[0]"
element 1 "Value" "_SanAn_N45PA_4X50_25C_"
element 2 "Name" "DutNames[1]"
element 2 "Value" "________________________________0"
element 3 "Name" "DutNames[2]"
element 3 "Value" "INITIALIZE"
element 4 "Name" "DutNames[3]"
element 4 "Value" "________________________________1"
element 5 "Name" "DutNames[4]"
element 5 "Value" "CONTACT_RESISTANCES"
element 6 "Name" "DutNames[5]"
element 6 "Value" "________________________________2"
element 7 "Name" "DutNames[6]"
element 7 "Value" "RG_RD_RS"
element 8 "Name" "DutNames[7]"
element 8 "Value" "________________________________3"
element 9 "Name" "DutNames[8]"
element 9 "Value" "DC_MODELING"
element 10 "Name" "DutNames[9]"
element 10 "Value" "DC_MODELING_LSYNC"
element 11 "Name" "DutNames[10]"
element 11 "Value" "DC_PULSED"
element 12 "Name" "DutNames[11]"
element 12 "Value" "DC_ModelRobustness"
element 13 "Name" "DutNames[12]"
element 13 "Value" "________________________________4"
element 14 "Name" "DutNames[13]"
element 14 "Value" "SPAR_MODELING"
element 15 "Name" "DutNames[14]"
element 15 "Value" "SPAR_MODELING_LSYNC"
element 16 "Name" "DutNames[15]"
element 16 "Value" "SPAR_ModelRobustness"
element 17 "Name" "DutNames[16]"
element 17 "Value" "________________________________5"
element 18 "Name" "DutNames[17]"
element 18 "Value" "NONLIN_RF_MDLG"
element 19 "Name" "DutNames[18]"
element 19 "Value" "________________________________6"
element 20 "Name" "DutNames[19]"
element 20 "Value" "FINISH_MDLG"
element 21 "Name" "DutNames[20]"
element 21 "Value" "________________________________7"
element 22 "Name" "DutNames[21]"
element 22 "Value" "________________________________8"
element 23 "Name" "DutNames[22]"
element 23 "Value" "__DUTs_below_are_dynamically_copied_from_UTILITIES"
element 24 "Name" "DutNames[23]"
element 24 "Value" "aux_TRANSISTOR_SPAR_MDLG"
element 25 "Name" "DutNames[24]"
element 25 "Value" "aux_NONLIN_RF_MDLG"
element 26 "Name" "DutNames"
element 26 "Value" "ICCAP_ARRAY[25]"
element 27 "Name" "DutNames_sel"
element 27 "Value" "13"
element 28 "Name" "NrDutNames"
element 28 "Value" "26"
element 29 "Name" "SetupNames[0]"
element 29 "Value" "Init_Spar_Modeling"
element 30 "Name" "SetupNames[1]"
element 30 "Value" "OffState_vg_swept"
element 31 "Name" "SetupNames[2]"
element 31 "Value" "OffState_vd_swept"
element 32 "Name" "SetupNames[3]"
element 32 "Value" "OffState_vd_swept_125C"
element 33 "Name" "SetupNames[4]"
element 33 "Value" "vg_1stsweep__vd_2nd"
element 34 "Name" "SetupNames[5]"
element 34 "Value" "vd_1stsweep__vg_2nd"
element 35 "Name" "SetupNames[6]"
element 35 "Value" "Spar_all_freq_vgGTm3"
element 36 "Name" "SetupNames[7]"
element 36 "Value" "Spar_all_freq_biases"
element 37 "Name" "SetupNames[8]"
element 37 "Value" "Spar_all_freq_vd40_50"
element 38 "Name" "SetupNames[9]"
element 38 "Value" "Spar_all_freq_biases_125C"
element 39 "Name" "SetupNames[10]"
element 39 "Value" "Model_Fit_Verification"
element 40 "Name" "SetupNames[11]"
element 40 "Value" "Model_Fit_Verification_vgGTm3"
element 41 "Name" "SetupNames"
element 41 "Value" "ICCAP_ARRAY[12]"
element 42 "Name" "SetupNames_sel"
element 42 "Value" "7"
element 43 "Name" "PlotNames[0]"
element 43 "Value" "MP_Spar"
element 44 "Name" "PlotNames[1]"
element 44 "Value" "S11"
element 45 "Name" "PlotNames[2]"
element 45 "Value" "S12"
element 46 "Name" "PlotNames[3]"
element 46 "Value" "S21"
element 47 "Name" "PlotNames[4]"
element 47 "Value" "S22"
element 48 "Name" "PlotNames[5]"
element 48 "Value" "_MP_PI_Schematic_"
element 49 "Name" "PlotNames[6]"
element 49 "Value" "_CGS_"
element 50 "Name" "PlotNames[7]"
element 50 "Value" "_RGS_"
element 51 "Name" "PlotNames[8]"
element 51 "Value" "_CGD_"
element 52 "Name" "PlotNames[9]"
element 52 "Value" "_RGD_"
element 53 "Name" "PlotNames[10]"
element 53 "Value" "_GM_AC_"
element 54 "Name" "PlotNames[11]"
element 54 "Value" "_TAU_"
element 55 "Name" "PlotNames[12]"
element 55 "Value" "_ft_"
element 56 "Name" "PlotNames[13]"
element 56 "Value" "_fmax_"
element 57 "Name" "PlotNames[14]"
element 57 "Value" "_H21_"
element 58 "Name" "PlotNames[15]"
element 58 "Value" "_CDS_"
element 59 "Name" "PlotNames[16]"
element 59 "Value" "_RDS_"
element 60 "Name" "PlotNames[17]"
element 60 "Value" "_Ciss_"
element 61 "Name" "PlotNames[18]"
element 61 "Value" "_Crss_"
element 62 "Name" "PlotNames[19]"
element 62 "Value" "_Coss_"
element 63 "Name" "PlotNames[20]"
element 63 "Value" "id_vd"
element 64 "Name" "PlotNames[21]"
element 64 "Value" "vg_vd"
element 65 "Name" "PlotNames[22]"
element 65 "Value" "ig_vd"
element 66 "Name" "PlotNames[23]"
element 66 "Value" "T_Device"
element 67 "Name" "PlotNames"
element 67 "Value" "ICCAP_ARRAY[24]"
element 68 "Name" "PlotNames_sel[0]"
element 68 "Value" "6"
element 69 "Name" "PlotNames_sel[1]"
element 69 "Value" "8"
element 70 "Name" "PlotNames_sel[2]"
element 70 "Value" "10"
element 71 "Name" "PlotNames_sel[3]"
element 71 "Value" "11"
element 72 "Name" "PlotNames_sel[4]"
element 72 "Value" "15"
element 73 "Name" "PlotNames_sel"
element 73 "Value" "ICCAP_ARRAY[5]"
element 74 "Name" "PlotName"
element 74 "Value" "_CDS_"
element 75 "Name" "_____select_targets_______________"
element 75 "Value" ""
element 76 "Name" "Plot_Target[0]"
element 76 "Value" "SPAR_MODELING/Spar_all_freq_biases/_CGS_"
element 77 "Name" "Plot_Target[1]"
element 77 "Value" "SPAR_MODELING/Spar_all_freq_biases/_CGD_"
element 78 "Name" "Plot_Target[2]"
element 78 "Value" "SPAR_MODELING/Spar_all_freq_biases/_CDS_"
element 79 "Name" "Plot_Target[3]"
element 79 "Value" "SPAR_MODELING/Spar_all_freq_biases/_GM_AC_"
element 80 "Name" "Plot_Target[4]"
element 80 "Value" "SPAR_MODELING/Spar_all_freq_biases/_TAU_"
element 81 "Name" "Plot_Target"
element 81 "Value" "ICCAP_ARRAY[5]"
element 82 "Name" "Plot_Target_sel[0]"
element 82 "Value" "0"
element 83 "Name" "Plot_Target_sel[1]"
element 83 "Value" "1"
element 84 "Name" "Plot_Target_sel[2]"
element 84 "Value" "2"
element 85 "Name" "Plot_Target_sel[3]"
element 85 "Value" "3"
element 86 "Name" "Plot_Target_sel[4]"
element 86 "Value" "4"
element 87 "Name" "Plot_Target_sel"
element 87 "Value" "ICCAP_ARRAY[5]"
element 88 "Name" "________search_plot_in_other_Setups_____"
element 88 "Value" ""
element 89 "Name" "CheckMorePlots"
element 89 "Value" "0"
element 90 "Name" "tmpDutNames"
element 90 "Value" "ICCAP_ARRAY[0]"
element 91 "Name" "tmpSetupNames"
element 91 "Value" "ICCAP_ARRAY[0]"
element 92 "Name" "tmpPlotNames"
element 92 "Value" "ICCAP_ARRAY[0]"
element 93 "Name" "tmpDutSetup"
element 93 "Value" "ICCAP_ARRAY[0]"
element 94 "Name" "tmpDutSetup_sel"
element 94 "Value" "ICCAP_ARRAY[0]"
element 95 "Name" "tmpDutSetup_GuiSize"
element 95 "Value" "2"
element 96 "Name" "tmpVar[0]"
element 96 "Value" "HICUM2_Extract"
element 97 "Name" "tmpVar[1]"
element 97 "Value" "FINISH_MODELING"
element 98 "Name" "tmpVar[2]"
element 98 "Value" "Documentation"
element 99 "Name" "tmpVar[3]"
element 99 "Value" "_7k_TEMP_Spar_all_bias__PI_Schematic"
element 100 "Name" "tmpVar"
element 100 "Value" "ICCAP_ARRAY[4]"
element 101 "Name" "______________________________1"
element 101 "Value" ""
element 102 "Name" "GUI_xPos"
element 102 "Value" "72"
element 103 "Name" "GUI_yPos"
element 103 "Value" "162"
element 104 "Name" "______________________________2"
element 104 "Value" ""
element 105 "Name" ""
element 105 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_PlotSelection_and_Save_Properties"
element 0 "Value" "TL|CA=%#19ModelName:OR=VE|<none>|#220TL_Duts_Setups_Plots:#230CB_check4plots_in_other_Setups|1|3"
element 1 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties"
element 1 "Value" "TL|OR=HO|<none>|#236TL_PlotSelection_and_Save_Properties:#228TL_SelectedPlots_and_Actions|1|2"
element 2 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions"
element 2 "Value" "TL|CA=#214Selected Plots:FV=F:OR=VE:TO=FW&LW|<none>|#216TL_SelectedPlots:#214TL_PlotActions:#219PB_DisplayMultiPlot:#15Space|1|1"
element 3 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.TL_SelectedPlots"
element 3 "Value" "TL|NC=2:OR=VE|<none>|#213SelectTargets|1"
element 4 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.TL_SelectedPlots.SelectTargets"
element 4 "Value" "LI|CA=#264Selected Plots                                                 .:IT=%#211Plot_Target:SB=SH:SI=%#215Plot_Target_sel:SY=ES|LS=#216Create_MultiPlot&#213Execute,1\012|<none>|1"
element 5 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_PlotSelection_and_Save_Properties.TL_Duts_Setups_Plots"
element 5 "Value" "TL|OR=HO|<none>|#17LI_Duts:#19LI_Setups:#18LI_Plots|1"
element 6 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_PlotSelection_and_Save_Properties.CB_check4plots_in_other_Setups"
element 6 "Value" "CB|CA=#3100Check For Same PlotName In Setups Of Other DUTs\012(typical Application\072 MOS Transistor Modeling):TO=FH&dummy:TS=%CheckMorePlots|<none>|<none>|0"
element 7 "Name" "TL_Search_Multiple_Plots"
element 7 "Value" "TL|WD=500|<none>|#211TL_PlotName:#217LI_Multiple_Plots|1|1"
element 8 "Name" "TL_Search_Multiple_Plots.LI_Multiple_Plots"
element 8 "Value" "LI|CA=#238DUT/Setups with the same Plot Name\072:IT=%#211tmpDutSetup:SI=%#215tmpDutSetup_sel:SY=ES:VI=%#219tmpDutSetup_GuiSize|<none>|<none>|0"
element 9 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.TL_PlotActions"
element 9 "Value" "TL|DO=FW&FH:OR=HO:TO=MH&LH|<none>|#19PB_MoveUp:#211PB_MoveDown:#213PB_RemovePlot:#18PB_Clear|1"
element 10 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.TL_PlotActions.PB_MoveUp"
element 10 "Value" "PB|CA=#15/\134|AC=#217MovePlotSelection&#210Execute,up|<none>|0"
element 11 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.TL_PlotActions.PB_MoveDown"
element 11 "Value" "PB|CA=#15\134/|AC=#217MovePlotSelection&#212Execute,down|<none>|0"
element 12 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.TL_PlotActions.PB_RemovePlot"
element 12 "Value" "PB|CA=#11X|AC=#219RemovePlotSelection&#17Execute|<none>|0"
element 13 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.TL_PlotActions.PB_Clear"
element 13 "Value" "PB|CA=#15Clear|AC=#214RemoveAllPlots&#17Execute|<none>|0"
element 14 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.PB_DisplayMultiPlot"
element 14 "Value" "PB|CA=#17Preview:TO=MH&LH&TT|AC=#216Create_MultiPlot&#19Execute,2|<none>|0"
element 15 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_PlotSelection_and_Save_Properties.TL_Duts_Setups_Plots.LI_Plots"
element 15 "Value" "LI|CA=#231Available Plots               .:IT=%#19PlotNames:SI=%#213PlotNames_sel:SY=ES|RC=#212searchSetups&#17execute:LS=#215def_Plot_Target&#17Execute|<none>|0"
element 16 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_PlotSelection_and_Save_Properties.TL_Duts_Setups_Plots.LI_Duts"
element 16 "Value" "LI|CA=#243Available Duts                            .:IT=%#18DutNames:SX=%#212DutNames_sel:SY=SS:VI=%#210NrDutNames|LS=#212searchSetups&#17Execute:RC=#212searchSetups&#17execute|<none>|0"
element 17 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_PlotSelection_and_Save_Properties.TL_Duts_Setups_Plots.LI_Setups"
element 17 "Value" "LI|CA=#231Available Setups              .:IT=%#210SetupNames:SX=%#214SetupNames_sel:SY=SS|LS=#211searchPlots&#17Execute:RC=#212searchSetups&#17execute|<none>|0"
element 18 "Name" "TL_Search_Multiple_Plots.TL_PlotName.LA_PlotName"
element 18 "Value" "LA|CA=#223Current Plot Name\072  :FG=C6:TO=FW&FH|<none>|<none>|0"
element 19 "Name" "TL_Search_Multiple_Plots.TL_PlotName"
element 19 "Value" "TL|OR=HO|<none>|#211LA_PlotName:#214LA_PlotName__1:#15Space:#15PB_OK|1"
element 20 "Name" "TL_Search_Multiple_Plots.TL_PlotName.LA_PlotName__1"
element 20 "Value" "LA|CA=%#18PlotName:FG=C6:TO=FW&FH|<none>|<none>|0"
element 21 "Name" "TL_Search_Multiple_Plots.TL_PlotName.Space"
element 21 "Value" "TL|<none>|<none>|<none>|0"
element 22 "Name" "TL_Search_Multiple_Plots.TL_PlotName.PB_OK"
element 22 "Value" "PB|CA=#12OK:TO=FW&FH|AC=#226./TL_Search_Multiple_Plots&#246Destroy GUI,Select Plots from other DUT/Setups|<none>|0"
element 23 "Name" "TL_Sel_Plots"
element 23 "Value" "TL|HT=450:LX=%#18GUI_xPos:LY=%#18GUI_yPos|<none>|#15PB_OK:#229TL_Targets_and_SaveProperties|1|0"
element 24 "Name" "TL_Sel_Plots.PB_OK"
element 24 "Value" "PB|CA=#18OK, Done:TO=FW&FH&TR|AC=#216PB_OK_PlotSelect&#17Execute|<none>|0"
element 25 "Name" "TL_Sel_Plots.TL_Targets_and_SaveProperties.TL_SelectedPlots_and_Actions.Space"
element 25 "Value" "TL|<none>|<none>|<none>|0"
element 26 "Name" "TL_Close_MP"
element 26 "Value" "TL|<none>|<none>|#211PB_Close_MP|1|2"
element 27 "Name" "TL_Close_MP.PB_Close_MP"
element 27 "Value" "PB|CA=#15Close:TO=FW&FH|AC=#210Multi_Plot&#15Close|<none>|0"
element 28 "Name" ""
element 28 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 !---in your local Model, apply the following PEL lines to call
 
 
 !  > SELECT_PLOTS   <
 !-----------------------------------
 ModelName = WHOIS(".", "Parent Model")
 ICCAP_FUNC("/UTILITIES/PLOT_UTILITIES/PLOT_SELECT/SELECT_PLOTS", "Execute", VAL$(ModelName))
 
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "SELECT_PLOTS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This Program creates a MultiPlot from user-selected Plots
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 GLOBAL_VAR  ModelName
 
 
 GET_STRING "Enter Model name", ModelName, ModelName
 
 ModelName = "/"&TRIM$(VAL$(ModelName), "/")
 
 ICCAP_FUNC("Clean_Up", "Execute")
 ICCAP_FUNC("searchDUTs", "Execute")
 
 !---open the GUI
                                 !Modal GUI is required, because of call from  MDLG_GUI/GENERAL_MDLG_GUI                            
 ICCAP_FUNC("./TL_Sel_Plots", "Display Modal GUI", "Select Plot Targets")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "searchDUTs" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !--- initialize
 DutNames_sel=-1
 
 SetupNames = "ICCAP_ARRAY[0]"
 SetupNames_sel = -1
 
 PlotNames = "ICCAP_ARRAY[0]"
 PlotNames_sel = -1
 
 !--- find existing Duts
 ICCAP_FIND_CHILDREN VAL$(ModelName), "DUT", DutNames
 
 
 !--- consider non-existing DUTs
 IF SIZEOF(DutNames) == 0  THEN RETURN_VALUE 2
 
 !--- adjust GUI List size
 FOR NrDutNames=0 TO SIZEOF(DutNames)-1
   EXIT IF VAL$(DutNames[NrDutNames])=="FINISH_MODELING"
 NEXT NrDutNames
 NrDutNames = NrDutNames+1
 
 IF DutNames_sel<>-1 THEN ICCAP_FUNC("searchSetups", "Execute")
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "searchSetups" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 IF DutNames_sel==-1 THEN RETURN_VALUE 3
 
 !--- initialize
 SetupNames_sel = -1
 
 PlotNames = "ICCAP_ARRAY[0]"
 PlotNames_sel = -1
 
 
 !--- find existing Setups
 ICCAP_FIND_CHILDREN VAL$(ModelName)&"/"&VAL$(DutNames[DutNames_sel]), "Setup", SetupNames
 
 
 !--- consider non-existing Setups
 IF SIZEOF(SetupNames) == 0 THEN  RETURN_VALUE 2
 
 
 IF SetupNames_sel<>-1 THEN ICCAP_FUNC("searchPlots", "Execute")
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "searchPlots" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 IF SetupNames_sel==-1 THEN RETURN_VALUE 3
 
 !--- initialize
 PlotNames_sel = -1
 
 !--- check existing Plots
 ICCAP_FIND_CHILDREN VAL$(ModelName)&"/"&VAL$(DutNames[DutNames_sel])&"/"&VAL$(SetupNames[SetupNames_sel]), "Plot", PlotNames
 
 
 !--- consider non-existing Plots
 IF SIZEOF(PlotNames) == 0 THEN RETURN_VALUE 2
 
 
 
 ICCAP_FUNC("def_Plot_Target", "Execute")
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "def_Plot_Target" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 IF PlotNames_sel == -1 THEN RETURN_VALUE 2
 
 
 FOR iPlotNames_sel=0 TO SIZEOF(PlotNames_sel)-1
   PlotName=VAL$(PlotNames[PlotNames_sel[iPlotNames_sel]])
 
 
   !---upon user request, check if selected Plot exists also in other Dut/Setups
   IF VAL(CheckMorePlots)==1 THEN 
     ICCAP_FUNC("CheckPlotOtherSetups", "Execute")
     RETURN_VALUE 2
   END IF
 
   DutSetupPlotName=VAL$(DutNames[DutNames_sel])&"/"&VAL$(SetupNames[SetupNames_sel])&"/"&VAL$(PlotName)
 
   !---skip if it's a MultiPlot
   Path2Plot= "/"&VAL$(ModelName)&"/"&VAL$(DutSetupPlotName)
   PlotType = LOOKUP_TABLE_VAL(VAL$(Path2Plot), "Report Type")
   IF VAL$(PlotType)=="MULTI PLOT" THEN
     GET_STRING "ERROR: the selected Plot '"&VAL$(PlotName)&"' is a MultiPlot,
       and therefore, cannot be added to another MultiPlot !  [OK]", dummy
     CONTINUE
   END IF
 
   !---insert selected Plot if not already included in selection
   N=0
   FOR i=0 TO SIZEOF(Plot_Target)-1
     IF VAL$(Plot_Target[i])==VAL$(DutSetupPlotName) THEN N = N + 1
   NEXT i
 
   IF N==0 THEN
     dummy=ARRAY_INSERT_AT(Plot_Target, VAL$(DutSetupPlotName))
     dummy=ARRAY_INSERT_AT(Plot_Target_sel, SIZEOF(Plot_Target)-1)	!activate its selection
   END IF
 NEXT iPlotNames_sel
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "CheckPlotOtherSetups" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Transform handles the special case of
 ! including Plots (with the same name) from other DUT/Setups
 ! (Application scaling modeling, e.g. MOS mdlg)
 
 
 GLOBAL_VAR  ModelName
 GLOBAL_VAR  PlotNames
 GLOBAL_VAR  PlotNames_sel
 GLOBAL_VAR  tmpDutNames
 GLOBAL_VAR  tmpSetupNames
 GLOBAL_VAR  tmpPlotNames
 GLOBAL_VAR  tmpDutSetup
 GLOBAL_VAR  tmpDutSetup_sel
 GLOBAL_VAR  tmpDutSetup_GuiSize
 GLOBAL_VAR  Plot_Target
 GLOBAL_VAR  Plot_Target_sel
 GLOBAL_VAR  PlotName		!also Caption for GUI
 
 
 !---exit if no Plot was selected
 IF PlotNames_sel == -1 THEN RETURN_VALUE 2
 
 
 DIMENSION_ARRAY(tmpDutNames, 0)
 DIMENSION_ARRAY(tmpSetupNames, 0)
 DIMENSION_ARRAY(tmpPlotNames, 0)
 DIMENSION_ARRAY(tmpDutSetup, 0)
 
 ICCAP_FIND_CHILDREN VAL$(ModelName),"DUT",tmpDutNames
 FOR idut=0 TO SIZEOF(tmpDutNames)-1
   ICCAP_FIND_CHILDREN VAL$(ModelName)&"/"&VAL$(tmpDutNames[idut]), "Setup", tmpSetupNames
   FOR isetup=0 TO SIZEOF(tmpSetupNames)-1
     ICCAP_FIND_CHILDREN VAL$(ModelName)&"/"&VAL$(tmpDutNames[idut])&"/"&VAL$(tmpSetupNames[isetup]), "Plot", tmpPlotNames
     FOR iplot=0 TO SIZEOF(tmpPlotNames)-1
       IF VAL$(tmpPlotNames[iplot])==VAL$(PlotName) THEN
         !another Plot with the same plot name is found in another Dut/Setup
         !fill the array for GUI selectPlot  (add some space between DUT_name and Setup_name for better readability
         dummy=ARRAY_INSERT_AT(tmpDutSetup, VAL$(tmpDutNames[idut])&" / "&VAL$(tmpSetupNames[isetup]))
       END IF
     NEXT iplot
   NEXT isetup
 NEXT idut
 
 !---set arrays back
 DIMENSION_ARRAY(tmpDutNames, 0)
 DIMENSION_ARRAY(tmpSetupNames, 0)
 DIMENSION_ARRAY(tmpPlotNames, 0)
 
 
 !---display GUI
 IF SIZEOF(tmpDutSetup)>1 THEN
   !---open the modal GUI
   tmpDutSetup_sel=-1
   tmpDutSetup_GuiSize=SIZEOF(tmpDutSetup)
   ICCAP_FUNC("./TL_Search_Multiple_Plots", "Display Modal GUI", "Select Plots from other DUT/Setups")
 ELSE
   !---just take that plot, since the same plot name does not exist in any other Setup
   DIMENSION_ARRAY(tmpDutSetup_sel, 1)
   tmpDutSetup_sel[0]=0
 END IF
 
 
 !---continue and add the selected Plot of the different Dut/Setups
 IF SIZEOF(tmpDutSetup_sel)>0 THEN
   FOR i=0 TO SIZEOF(tmpDutSetup_sel)-1
     tmp=VAL$(tmpDutSetup[tmpDutSetup_sel[i]])
 
     !get rid of ' ' in the path (was added above for better readability)
     BadChar$=" "
     GoodChar$=""
     StringPos=1
     WHILE StringPos>0
       StringPos=STRPOS(VAL$(tmp), VAL$(BadChar$))
       IF StringPos>0 THEN  
         StringLength=STRLEN(VAL$(tmp))
         tmp=SUBSTR$(VAL$(tmp), 1, StringPos-1)&VAL$(GoodChar$)&SUBSTR$(VAL$(tmp), StringPos+1, StringLength)
       END IF
     END WHILE
     DutSetupPlotName=VAL$(tmp)&"/"&VAL$(PlotName)
 
     !---verify if selected Dut/Setup/Plot is not already present in current selection
     N=0
     FOR i1=0 TO SIZEOF(Plot_Target)-1
       IF VAL$(Plot_Target[i1])==VAL$(DutSetupPlotName) THEN N = N + 1
     NEXT i1
 
     IF N==0 THEN
       dummy=ARRAY_INSERT_AT(Plot_Target, VAL$(DutSetupPlotName))
       dummy=ARRAY_INSERT_AT(Plot_Target_sel, SIZEOF(Plot_Target)-1)	!activate its selection
     END IF
   NEXT i
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____actions_PlotSelect______" "711.501"
{
}
LINK XFORM "Browse_PlotSaveDir" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  PlotSaveDir
 
 
 GUIheader = "Select Directory For Saving Selected Plot(s)"
 DirName   = VAL$(PlotSaveDir)
 Suffix    = ""
 FilenameWildcard = ""
 SelPolicy = "DirOnly"		! Single, Multi, DirOnly
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Path2Utilities="/UTILITIES/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(DirName), VAL$(Suffix), VAL$(FilenameWildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)=="" THEN
   !---Get the selected directory back
   PlotSaveDir=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
   !---convert to op.system indep. style
   PlotSaveDir=SYS_PATH$(VAL$(PlotSaveDir))
 ELSE
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "RemovePlotSelection" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---remove selected plots
 FOR i=0 TO SIZEOF(Plot_Target_sel)-1
   dummy=ARRAY_REMOVE_AT(Plot_Target, Plot_Target_sel[i])
   !---adjust indices of further selected plots
   FOR i1=i TO SIZEOF(Plot_Target_sel)-1
     Plot_Target_sel[i1]=Plot_Target_sel[i1]-1
   NEXT i1
 NEXT i
 
 !---deselect all Plots
 Plot_Target_sel=-1
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "MovePlotSelection" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! this is answered by the GUI item
 GET_STRING "up or down?", direction
 
 
 ! This is a tricky algorithm if multiple indicies are selected.  
 ! Essentially, we want to move all selected indicies up or down, 
 ! unless the first or last is selected, then it's a no-op.   
 
 
 incr=1
 mn=0
 allmn=0
 allmx=SIZEOF(Plot_Target)-1
 mx=SIZEOF(Plot_Target_sel)-1
 
 IF direction=="down" THEN
   incr=-1
   mn=mx
   mx=0
   allmn=allmx
   allmx=0
 END IF
 
 IF VAL$(Plot_Target_sel)<>"" THEN
   IF Plot_Target_sel[mn]<>allmn THEN
     i=mn
     WHILE (incr>0 AND i<=mx) OR (incr<0 AND i>=0)
       tmp = val$(Plot_Target[Plot_Target_sel[i]])
       Plot_Target[Plot_Target_sel[i]] = Plot_Target[Plot_Target_sel[i]-incr]
       Plot_Target[Plot_Target_sel[i]-incr] = tmp
       Plot_Target_sel[i] = Plot_Target_sel[i]-incr
       i=i+incr
     END WHILE
   END IF
 END IF
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "RemoveAllPlots" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! Remove all Plots
 
 Plot_Target="ICCAP_ARRAY[0]"
 Plot_Target_sel="ICCAP_ARRAY[0]"
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Create_MultiPlot" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GET_INT "Create Only [1],  Create and Display [2]", 1, Answer
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---this Transform creates a local MultiPlot here, in this very Setup
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 !---exit it no Plots available
 IF SIZEOF(Plot_Target)==0 THEN RETURN_VALUE 0
 
 
 
 !---create MultiPlot
 ICCAP_FUNC("Multi_Plot", "STFV", "# of Plots", SIZEOF(Plot_Target_sel))
 IF SIZEOF(Plot_Target_sel) == 0 THEN 
   ICCAP_FUNC("Multi_Plot", "STFV", "Plot 0", "")
 ELSE
   FOR i=0 TO SIZEOF(Plot_Target_sel)-1
     Path2Plot=VAL$(ModelName)&"/"&VAL$(Plot_Target[Plot_Target_sel[i]])
     ICCAP_FUNC("Multi_Plot", "STFV", "Plot " & VAL$(i), Path2Plot)
   NEXT i
 END IF
 ICCAP_FUNC("Multi_Plot", "STFV", "Plots Per Row", 0)
 ICCAP_FUNC("Multi_Plot", "STFV", "Orientation", "H")
 
 
 
 IF VAL(Answer)==2 THEN
   ICCAP_FUNC("Multi_Plot", "Display Plot")
   ICCAP_FUNC("Multi_Plot", "Autoscale On")	!autoscale on for all plots inside the multiplot
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "PB_OK_PlotSelect" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("./TL_Sel_Plots", "Destroy GUI", "Select Plot Targets")
 ICCAP_FUNC("Multi_Plot", "Close")
 
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !close all ICCAP_ARRAYs to that the Setup Variable List becomes 'readable-by-a-human' again
 DutNames   = "ICCAP_ARRAY[0]"
 SetupNames = "ICCAP_ARRAY[0]"
 PlotNames  = "ICCAP_ARRAY[0]"
 
 Plot_Target       = "ICCAP_ARRAY[0]"
 Plot_Target_sel   = "ICCAP_ARRAY[0]"
 
 tmpDutNames     = "ICCAP_ARRAY[0]"
 tmpSetupNames   = "ICCAP_ARRAY[0]"
 tmpPlotNames    = "ICCAP_ARRAY[0]"
 tmpDutSetup     = "ICCAP_ARRAY[0]"
 tmpDutSetup_sel = "ICCAP_ARRAY[0]"
 
 
 !---reset MultiPlot
 ICCAP_FUNC("Multi_Plot", "Close")
 ICCAP_FUNC("Multi_Plot", "STFV", "# of Plots", 1) 	!min. 1 PLot per MultiPlot
 ICCAP_FUNC("Multi_Plot", "STFV", "Plot 0", "")
 ICCAP_FUNC("Multi_Plot", "STFV", "Header", "")
 ICCAP_FUNC("Multi_Plot", "STFV", "Footer", "")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________4" "711.501"
{
}
LINK PLOT "Multi_Plot" "711.501"
{
View draw_ds 0 "B,289,0"
View plot_window 0 "4,23,40225,24207"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "Yes" "N"
element 0 "Annotation Text" ""
element 0 "PEL Transform" "./AnnotatePlot"
element 0 "PEL Call Type" "0"
element 0 "Font Type" "Arial For CAE" "N"
element 0 "Font Size" "12.00" "N"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "6.750" "N"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "1"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "0"
element "Header" ""
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" ""
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "./TL_Close_MP"
element "GUI 1 Location" "U"
}
PlotOptimizerOpt Enable 0
}
}
data "711.501"
{
}
}
LINK DAT "PLOT_SAVE" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "0.78291105598866 3535 2323"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P236 C10 C10"
element 0 "Name" "Path2MultiPlot"
element 0 "Value" "../PLOT_SELECT/Multi_Plot"
element 1 "Name" "ModelName"
element 1 "Value" "/my_LED_Meas"
element 2 "Name" "PlotSaveDir"
element 2 "Value" "."
element 3 "Name" "PlotFileName"
element 3 "Value" "my_Saved_Plots"
element 4 "Name" "PlotFileType"
element 4 "Value" "png"
element 5 "Name" "Exch_BW"
element 5 "Value" "0"
element 6 "Name" "ImageWidth"
element 6 "Value" "1600"
element 7 "Name" "ImageHeight"
element 7 "Value" "1200"
element 8 "Name" "ImageDpi"
element 8 "Value" "150"
element 9 "Name" "tmpVar[0]"
element 9 "Value" ".."
element 10 "Name" "tmpVar[1]"
element 10 "Value" "PLOT_SELECT"
element 11 "Name" "tmpVar[2]"
element 11 "Value" "Multi_Plot"
element 12 "Name" "tmpVar"
element 12 "Value" "ICCAP_ARRAY[3]"
element 13 "Name" "______________________________1"
element 13 "Value" ""
element 14 "Name" "GUI_xPos"
element 14 "Value" "664"
element 15 "Name" "GUI_yPos"
element 15 "Value" "117"
element 16 "Name" "______________________________2"
element 16 "Value" ""
element 17 "Name" ""
element 17 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_Save_Plot.TL_PrintPlotProperties.ED_ImageWidth"
element 0 "Value" "ED|CA=#234Image Width [Pixel]      typ. 1600:VA=%#210ImageWidth:TO=FH&dummy|<none>|<none>|0"
element 1 "Name" "TL_Save_Plot.TL_PrintPlotProperties"
element 1 "Value" "TL|CA=#216Image Properties:TO=FW&FH|<none>|#213ED_ImageWidth:#214ED_ImageHeight:#214ED_DotsPerInch:#210CB_Exch_BW|1"
element 2 "Name" "TL_Save_Plot.TL_PrintPlotProperties.ED_ImageHeight"
element 2 "Value" "ED|CA=#235Image Height [Pixel]      typ. 1200:VA=%#211ImageHeight:TO=FH&dummy|<none>|<none>|0"
element 3 "Name" "TL_Save_Plot.TL_PrintPlotProperties.ED_DotsPerInch"
element 3 "Value" "ED|CA=#238Pixel Per Inch                 typ.150:VA=%#18ImageDpi:TO=FH&dummy|<none>|<none>|0"
element 4 "Name" "TL_Save_Plot.TL_PrintPlotProperties.CB_Exch_BW"
element 4 "Value" "CB|CA=#232Exch. b/w Background When Saving:TS=%Exch_BW|<none>|<none>|0"
element 5 "Name" "TL_Save_Plot"
element 5 "Value" "TL|OR=VE:LX=%#18GUI_xPos:LY=%#18GUI_yPos|<none>|#15PB_OK:#214TL_PlotSaveDir:#215TL_PlotFileName:#15Sep_1:#15Sep_2:#219PB_DisplayMultiPlot:#222TL_PrintPlotProperties:#17TL_Save|1|0"
element 6 "Name" "TL_Save_Plot.PB_OK"
element 6 "Value" "PB|CA=#18OK, Done:TO=FW&FH&TR|AC=#214./TL_Save_Plot&#221Destroy GUI,Save Plot|<none>|0"
element 7 "Name" "TL_Save_Plot.TL_PlotSaveDir"
element 7 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#214ED_PlotSaveDir:#19PB_Browse|1"
element 8 "Name" "TL_Save_Plot.TL_PlotSaveDir.ED_PlotSaveDir"
element 8 "Value" "ED|CA=#234Directory for Saving the Plot File:VA=%#211PlotSaveDir|<none>|<none>|0"
element 9 "Name" "TL_Save_Plot.TL_PlotSaveDir.PB_Browse"
element 9 "Value" "PB|CA=#16Browse:TO=FW&FH&TB|AC=#218Browse_PlotSaveDir&#17Execute|<none>|0"
element 10 "Name" "TL_Save_Plot.TL_PlotFileName.ED_PlotFileName"
element 10 "Value" "ED|CA=#218\012Plot File Name:VA=%#212PlotFileName:TO=FH&dummy|<none>|<none>|0|3"
element 11 "Name" "TL_Save_Plot.TL_Save"
element 11 "Value" "TL|OR=VE|<none>|#212PB_SavePlots|1"
element 12 "Name" "TL_Save_Plot.TL_Save.PB_SavePlots"
element 12 "Value" "PB|CA=#232\075\075>  Save   Plot <\075\075:TO=MH&dummy|AC=#214Save_MultiPlot&#17Execute|<none>|1"
element 13 "Name" "TL_Save_Plot.PB_DisplayMultiPlot"
element 13 "Value" "PB|CA=#17Preview:TO=MH&LH&TT|AC=#231../PLOT_SELECT/Create_MultiPlot&#19Execute,2|<none>|0"
element 14 "Name" "TL_Save_Plot.TL_PlotFileName"
element 14 "Value" "TL|FV=T:OR=HO|<none>|#215ED_PlotFileName:#217ED_PlotFileFormat|1|3"
element 15 "Name" "TL_Save_Plot.TL_PlotFileName.ED_PlotFileFormat"
element 15 "Value" "ED|CA=#232File Format\072\012jpg, bmp, png:CO=5:VA=%#212PlotFileType:TO=FH&MW|<none>|<none>|0|3"
element 16 "Name" "TL_Save_Plot.Sep_1"
element 16 "Value" "LA|<none>|<none>|<none>|0"
element 17 "Name" "TL_Save_Plot.Sep_2"
element 17 "Value" "SE|OR=HO|<none>|<none>|0"
element 18 "Name" ""
element 18 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "SELECT_PLOTS_n_SAVE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This Program saves a MultiPlot in .jpg, .png or .bmp format
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 GLOBAL_VAR  Path2MultiPlot
 GLOBAL_VAR  PlotSaveDir
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  ModelName
 GLOBAL_VAR  PlotFileName
 
 
 
 GET_STRING "Enter Model name incl. leading /", VAL$(ModelName), ModelName
 
 
 
 ICCAP_FUNC("../PLOT_SELECT/SELECT_PLOTS", "Execute", VAL$(ModelName))
 ICCAP_FUNC("../PLOT_SELECT/Create_MultiPlot", "Execute", 1)
 
 Path2MultiPlot = "../PLOT_SELECT/Multi_Plot"
 
 PlotSaveDir = "."    ! IC-CAP  home directory
 PlotSaveDir = VAL$(SYS_PATH$(VAL$(PlotSaveDir)))
 
 ICCAP_FUNC("./TL_Save_Plot", "Display Modal GUI", "Save Plot")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "Display_MultiPlot" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  Path2MultiPlot	!set by 'SAVE_PLOTS'
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---this Transform displays the remote model's MultiPlot
 !   to be saved to a file
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 ICCAP_FUNC(VAL$(Path2MultiPlot), "Display Plot")
 ICCAP_FUNC(VAL$(Path2MultiPlot), "Area Tools Off")
 ICCAP_FUNC(VAL$(Path2MultiPlot), "Title Off")
 ICCAP_FUNC(VAL$(Path2MultiPlot), "Unselect All")
 
 
 !---if child plot colors change, switch on legend in 1st child plot
 NrChildPlots = VAL(LOOKUP_TABLE_VAL(VAL$(Path2MultiPlot), "# of Plots"))
 FOR i=0 TO NrChildPlots-1
   !---get path to child plot
   Path2ChildPlot = LOOKUP_TABLE_VAL(VAL$(Path2MultiPlot), "Plot "&VAL$(i))
   !---handle empty entry in MultiPlot
   IF VAL$(Path2ChildPlot)=="" THEN CONTINUE
   IF SUBSTR$(VAL$(Path2ChildPlot), 1, 1)<>"/" THEN  	!there is a rel. path to the child plot
     Path2ChildPlot = VAL$(Path2MultiPlot)&"/"&VAL$(Path2ChildPlot)
   END IF
   ChildColorSetting =  LOOKUP_TABLE_VAL(VAL$(Path2ChildPlot)&"/PlotOptions", "Multicolor")
   !---switch on Legend
   IF VAL$(ChildColorSetting)=="Change color with each highest order curve" THEN
     ICCAP_FUNC(VAL$(Path2MultiPlot), "Legend On", VAL$(i))
     BREAK
   END IF
 NEXT i
 
 
 RETURN_VALUE 1
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Save_MultiPlot" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  PlotSaveDir		!set by 'SAVE_PLOTS'
 GLOBAL_VAR  Path2MultiPlot	!set by 'SAVE_PLOTS'
 GLOBAL_VAR  PlotFileName		!set by 'SAVE_PLOTS'
 GLOBAL_VAR  PlotFileType
 GLOBAL_VAR  Exch_BW
 GLOBAL_VAR  ImageWidth
 GLOBAL_VAR  ImageHeight
 GLOBAL_VAR  ImageDpi
 
 
 ! This program saves the MultiPlot to a file.
 ! The Plot FileName is "__MultiPlotName"
 ! NOTE: png is typically 10 times smaller than jpg
 
 
 
 !---verify if directory for plot saving is OK
 dir_fail=SYSTEM("cd "&VAL$(PlotSaveDir)&" 2> /dev/null")
 IF (dir_fail<>0) OR (VAL$(PlotSaveDir)=="") THEN 
   GET_STRING "ERROR: Directory 
 "&VAL$(PlotSaveDir)&"
  not found !   [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !---set up DirFileName   directory/__MultiPlotName   ( the leading '__' ensures the file location at the top of the directory, for easier identification
 PlotDirFileName = VAL$(PlotSaveDir)&"/__"&VAL$(PlotFileName)&"."&VAL$(PlotFileType)
 PlotDirFileName = VAL$(SYS_PATH$(VAL$(PlotDirFileName)))
 
 
 ICCAP_FUNC(VAL$(Path2MultiPlot), "Unselect All")
 
 IF VAL(Exch_BW) == 1 THEN ICCAP_FUNC("Multi_Plot", "Exchange Black-White")
 
 ICCAP_FUNC("Display_MultiPlot", "Execute")
 dummy = WAIT(1)		! for the user's convenience
 
 !==============================================================================================================
 !  (can only 'Create Image' if Plot is open)
 ICCAP_FUNC(VAL$(Path2MultiPlot), "Create Image", VAL$(PlotDirFileName), ImageWidth, ImageHeight, ImageDpi)
 !==============================================================================================================
 
 IF VAL(Exch_BW) == 1 THEN ICCAP_FUNC("Multi_Plot", "Exchange Black-White")
 
 
 ICCAP_FUNC(VAL$(Path2MultiPlot), "Close")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________4" "711.501"
{
}
LINK XFORM "Browse_PlotSaveDir" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  PlotSaveDir
 
 
 GUIheader = "Select Directory For Saving Selected Plot(s)"
 DirName   = VAL$(PlotSaveDir)
 Suffix    = ""
 FilenameWildcard = ""
 SelPolicy = "DirOnly"		! Single, Multi, DirOnly
 
 !############################################################################
 !---Call the central GUI, anticipating its GET_STRINGs
 Path2Utilities="/DEPOTS/DIR_FILE_BROWSER/DIR_FILE_BROWSER_WindowsStyle"
 ICCAP_FUNC(VAL$(Path2Utilities)&"/BROWSE_DIR_FILE", "Execute", VAL$(GUIheader), VAL$(DirName), VAL$(Suffix), VAL$(FilenameWildcard), VAL$(SelPolicy))
 !############################################################################
 
 
 ErrMsg=LOOKUP_VAR(VAL$(Path2Utilities)&"/ErrMsg")
 IF VAL$(ErrMsg)=="" THEN
   !---Get the selected directory back
   PlotSaveDir=LOOKUP_VAR(VAL$(Path2Utilities)&"/ActDirPath")
   !---convert to op.system independent style
   PlotSaveDir=SYS_PATH$(VAL$(PlotSaveDir))
 ELSE
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "PLOT_SHOW_LSYNC_VALUES" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.1553947749762 5216 3943"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P29 P154 P287 C10"
element 0 "Name" "ErrMsg"
element 0 "Value" ""
element 1 "Name" "MDM_FILE_PATH"
element 1 "Value" "C:\tmp"
element 2 "Name" "MDM_FILE_NAME"
element 2 "Value" "PCM_25dev.mdm"
element 3 "Name" "OrigMdmFilePath"
element 3 "Value" "C:\tmp"
element 4 "Name" "OrigMdmFileName"
element 4 "Value" "PCM_25dev.mdm"
element 5 "Name" "Path2Setup"
element 5 "Value" "/UTILITIES/MDM_UTILITIES/ANALYZE_AND_CUT_MDM_FILES"
element 6 "Name" "InputNames[0]"
element 6 "Value" "time"
element 7 "Name" "InputNames[1]"
element 7 "Value" "vg_qu"
element 8 "Name" "InputNames[2]"
element 8 "Value" "vd_qu"
element 9 "Name" "InputNames[3]"
element 9 "Value" "vd_pulsed"
element 10 "Name" "InputNames[4]"
element 10 "Value" "vg_aux"
element 11 "Name" "InputNames[5]"
element 11 "Value" "vd_aux"
element 12 "Name" "InputNames[6]"
element 12 "Value" "vg_pulsed"
element 13 "Name" "InputNames"
element 13 "Value" "ICCAP_ARRAY[7]"
element 14 "Name" "LsyncColNames[0]"
element 14 "Value" "vd_pulsed"
element 15 "Name" "LsyncColNames[1]"
element 15 "Value" "vg_pulsed"
element 16 "Name" "LsyncColNames"
element 16 "Value" "ICCAP_ARRAY[2]"
element 17 "Name" "LsyncColSize"
element 17 "Value" "763"
element 18 "Name" "Index"
element 18 "Value" "ICCAP_ARRAY[0]"
element 19 "Name" "IndSel"
element 19 "Value" "259"
element 20 "Name" "DataIndex[0]"
element 20 "Value" "1"
element 21 "Name" "DataIndex[1]"
element 21 "Value" "2"
element 22 "Name" "DataIndex[2]"
element 22 "Value" "3"
element 23 "Name" "DataIndex[3]"
element 23 "Value" "4"
element 24 "Name" "DataIndex[4]"
element 24 "Value" "5"
element 25 "Name" "DataIndex[5]"
element 25 "Value" "6"
element 26 "Name" "DataIndex[6]"
element 26 "Value" "7"
element 27 "Name" "DataIndex[7]"
element 27 "Value" "8"
element 28 "Name" "DataIndex[8]"
element 28 "Value" "9"
element 29 "Name" "DataIndex[9]"
element 29 "Value" "10"
element 30 "Name" "DataIndex[10]"
element 30 "Value" "11"
element 31 "Name" "DataIndex[11]"
element 31 "Value" "12"
element 32 "Name" "DataIndex[12]"
element 32 "Value" "13"
element 33 "Name" "DataIndex[13]"
element 33 "Value" "14"
element 34 "Name" "DataIndex[14]"
element 34 "Value" "15"
element 35 "Name" "DataIndex[15]"
element 35 "Value" "16"
element 36 "Name" "DataIndex[16]"
element 36 "Value" "17"
element 37 "Name" "DataIndex[17]"
element 37 "Value" "18"
element 38 "Name" "DataIndex[18]"
element 38 "Value" "19"
element 39 "Name" "DataIndex[19]"
element 39 "Value" "20"
element 40 "Name" "DataIndex[20]"
element 40 "Value" "21"
element 41 "Name" "DataIndex[21]"
element 41 "Value" "22"
element 42 "Name" "DataIndex[22]"
element 42 "Value" "23"
element 43 "Name" "DataIndex[23]"
element 43 "Value" "24"
element 44 "Name" "DataIndex[24]"
element 44 "Value" "25"
element 45 "Name" "DataIndex[25]"
element 45 "Value" "26"
element 46 "Name" "DataIndex[26]"
element 46 "Value" "27"
element 47 "Name" "DataIndex[27]"
element 47 "Value" "28"
element 48 "Name" "DataIndex[28]"
element 48 "Value" "29"
element 49 "Name" "DataIndex[29]"
element 49 "Value" "30"
element 50 "Name" "DataIndex[30]"
element 50 "Value" "31"
element 51 "Name" "DataIndex[31]"
element 51 "Value" "32"
element 52 "Name" "DataIndex[32]"
element 52 "Value" "33"
element 53 "Name" "DataIndex[33]"
element 53 "Value" "34"
element 54 "Name" "DataIndex[34]"
element 54 "Value" "35"
element 55 "Name" "DataIndex[35]"
element 55 "Value" "36"
element 56 "Name" "DataIndex[36]"
element 56 "Value" "37"
element 57 "Name" "DataIndex[37]"
element 57 "Value" "38"
element 58 "Name" "DataIndex[38]"
element 58 "Value" "39"
element 59 "Name" "DataIndex[39]"
element 59 "Value" "40"
element 60 "Name" "DataIndex[40]"
element 60 "Value" "41"
element 61 "Name" "DataIndex[41]"
element 61 "Value" "42"
element 62 "Name" "DataIndex[42]"
element 62 "Value" "43"
element 63 "Name" "DataIndex[43]"
element 63 "Value" "44"
element 64 "Name" "DataIndex[44]"
element 64 "Value" "45"
element 65 "Name" "DataIndex[45]"
element 65 "Value" "46"
element 66 "Name" "DataIndex[46]"
element 66 "Value" "47"
element 67 "Name" "DataIndex[47]"
element 67 "Value" "48"
element 68 "Name" "DataIndex[48]"
element 68 "Value" "49"
element 69 "Name" "DataIndex[49]"
element 69 "Value" "50"
element 70 "Name" "DataIndex[50]"
element 70 "Value" "51"
element 71 "Name" "DataIndex[51]"
element 71 "Value" "52"
element 72 "Name" "DataIndex[52]"
element 72 "Value" "53"
element 73 "Name" "DataIndex[53]"
element 73 "Value" "54"
element 74 "Name" "DataIndex[54]"
element 74 "Value" "55"
element 75 "Name" "DataIndex[55]"
element 75 "Value" "56"
element 76 "Name" "DataIndex[56]"
element 76 "Value" "57"
element 77 "Name" "DataIndex[57]"
element 77 "Value" "58"
element 78 "Name" "DataIndex[58]"
element 78 "Value" "59"
element 79 "Name" "DataIndex[59]"
element 79 "Value" "60"
element 80 "Name" "DataIndex[60]"
element 80 "Value" "61"
element 81 "Name" "DataIndex[61]"
element 81 "Value" "62"
element 82 "Name" "DataIndex[62]"
element 82 "Value" "63"
element 83 "Name" "DataIndex[63]"
element 83 "Value" "64"
element 84 "Name" "DataIndex[64]"
element 84 "Value" "65"
element 85 "Name" "DataIndex[65]"
element 85 "Value" "66"
element 86 "Name" "DataIndex[66]"
element 86 "Value" "67"
element 87 "Name" "DataIndex[67]"
element 87 "Value" "68"
element 88 "Name" "DataIndex[68]"
element 88 "Value" "69"
element 89 "Name" "DataIndex[69]"
element 89 "Value" "70"
element 90 "Name" "DataIndex[70]"
element 90 "Value" "71"
element 91 "Name" "DataIndex[71]"
element 91 "Value" "72"
element 92 "Name" "DataIndex[72]"
element 92 "Value" "73"
element 93 "Name" "DataIndex[73]"
element 93 "Value" "74"
element 94 "Name" "DataIndex[74]"
element 94 "Value" "75"
element 95 "Name" "DataIndex[75]"
element 95 "Value" "76"
element 96 "Name" "DataIndex[76]"
element 96 "Value" "77"
element 97 "Name" "DataIndex[77]"
element 97 "Value" "78"
element 98 "Name" "DataIndex[78]"
element 98 "Value" "79"
element 99 "Name" "DataIndex[79]"
element 99 "Value" "80"
element 100 "Name" "DataIndex[80]"
element 100 "Value" "81"
element 101 "Name" "DataIndex[81]"
element 101 "Value" "82"
element 102 "Name" "DataIndex[82]"
element 102 "Value" "83"
element 103 "Name" "DataIndex[83]"
element 103 "Value" "84"
element 104 "Name" "DataIndex[84]"
element 104 "Value" "85"
element 105 "Name" "DataIndex[85]"
element 105 "Value" "86"
element 106 "Name" "DataIndex[86]"
element 106 "Value" "87"
element 107 "Name" "DataIndex[87]"
element 107 "Value" "88"
element 108 "Name" "DataIndex[88]"
element 108 "Value" "89"
element 109 "Name" "DataIndex[89]"
element 109 "Value" "90"
element 110 "Name" "DataIndex[90]"
element 110 "Value" "91"
element 111 "Name" "DataIndex[91]"
element 111 "Value" "92"
element 112 "Name" "DataIndex[92]"
element 112 "Value" "93"
element 113 "Name" "DataIndex[93]"
element 113 "Value" "94"
element 114 "Name" "DataIndex[94]"
element 114 "Value" "95"
element 115 "Name" "DataIndex[95]"
element 115 "Value" "96"
element 116 "Name" "DataIndex[96]"
element 116 "Value" "97"
element 117 "Name" "DataIndex[97]"
element 117 "Value" "98"
element 118 "Name" "DataIndex[98]"
element 118 "Value" "99"
element 119 "Name" "DataIndex[99]"
element 119 "Value" "100"
element 120 "Name" "DataIndex[100]"
element 120 "Value" "101"
element 121 "Name" "DataIndex[101]"
element 121 "Value" "102"
element 122 "Name" "DataIndex[102]"
element 122 "Value" "103"
element 123 "Name" "DataIndex[103]"
element 123 "Value" "104"
element 124 "Name" "DataIndex[104]"
element 124 "Value" "105"
element 125 "Name" "DataIndex[105]"
element 125 "Value" "106"
element 126 "Name" "DataIndex[106]"
element 126 "Value" "107"
element 127 "Name" "DataIndex[107]"
element 127 "Value" "108"
element 128 "Name" "DataIndex[108]"
element 128 "Value" "109"
element 129 "Name" "DataIndex[109]"
element 129 "Value" "110"
element 130 "Name" "DataIndex[110]"
element 130 "Value" "111"
element 131 "Name" "DataIndex[111]"
element 131 "Value" "112"
element 132 "Name" "DataIndex[112]"
element 132 "Value" "113"
element 133 "Name" "DataIndex[113]"
element 133 "Value" "114"
element 134 "Name" "DataIndex[114]"
element 134 "Value" "115"
element 135 "Name" "DataIndex[115]"
element 135 "Value" "116"
element 136 "Name" "DataIndex[116]"
element 136 "Value" "117"
element 137 "Name" "DataIndex[117]"
element 137 "Value" "118"
element 138 "Name" "DataIndex[118]"
element 138 "Value" "119"
element 139 "Name" "DataIndex[119]"
element 139 "Value" "120"
element 140 "Name" "DataIndex[120]"
element 140 "Value" "121"
element 141 "Name" "DataIndex[121]"
element 141 "Value" "122"
element 142 "Name" "DataIndex[122]"
element 142 "Value" "123"
element 143 "Name" "DataIndex[123]"
element 143 "Value" "124"
element 144 "Name" "DataIndex[124]"
element 144 "Value" "125"
element 145 "Name" "DataIndex[125]"
element 145 "Value" "126"
element 146 "Name" "DataIndex[126]"
element 146 "Value" "127"
element 147 "Name" "DataIndex[127]"
element 147 "Value" "128"
element 148 "Name" "DataIndex[128]"
element 148 "Value" "129"
element 149 "Name" "DataIndex[129]"
element 149 "Value" "130"
element 150 "Name" "DataIndex[130]"
element 150 "Value" "131"
element 151 "Name" "DataIndex[131]"
element 151 "Value" "132"
element 152 "Name" "DataIndex[132]"
element 152 "Value" "133"
element 153 "Name" "DataIndex[133]"
element 153 "Value" "134"
element 154 "Name" "DataIndex[134]"
element 154 "Value" "135"
element 155 "Name" "DataIndex[135]"
element 155 "Value" "136"
element 156 "Name" "DataIndex[136]"
element 156 "Value" "137"
element 157 "Name" "DataIndex[137]"
element 157 "Value" "138"
element 158 "Name" "DataIndex[138]"
element 158 "Value" "139"
element 159 "Name" "DataIndex[139]"
element 159 "Value" "140"
element 160 "Name" "DataIndex[140]"
element 160 "Value" "141"
element 161 "Name" "DataIndex[141]"
element 161 "Value" "142"
element 162 "Name" "DataIndex[142]"
element 162 "Value" "143"
element 163 "Name" "DataIndex[143]"
element 163 "Value" "144"
element 164 "Name" "DataIndex[144]"
element 164 "Value" "145"
element 165 "Name" "DataIndex[145]"
element 165 "Value" "146"
element 166 "Name" "DataIndex[146]"
element 166 "Value" "147"
element 167 "Name" "DataIndex[147]"
element 167 "Value" "148"
element 168 "Name" "DataIndex[148]"
element 168 "Value" "149"
element 169 "Name" "DataIndex[149]"
element 169 "Value" "150"
element 170 "Name" "DataIndex[150]"
element 170 "Value" "151"
element 171 "Name" "DataIndex[151]"
element 171 "Value" "152"
element 172 "Name" "DataIndex[152]"
element 172 "Value" "153"
element 173 "Name" "DataIndex[153]"
element 173 "Value" "154"
element 174 "Name" "DataIndex[154]"
element 174 "Value" "155"
element 175 "Name" "DataIndex[155]"
element 175 "Value" "156"
element 176 "Name" "DataIndex[156]"
element 176 "Value" "157"
element 177 "Name" "DataIndex[157]"
element 177 "Value" "158"
element 178 "Name" "DataIndex[158]"
element 178 "Value" "159"
element 179 "Name" "DataIndex[159]"
element 179 "Value" "160"
element 180 "Name" "DataIndex[160]"
element 180 "Value" "161"
element 181 "Name" "DataIndex[161]"
element 181 "Value" "162"
element 182 "Name" "DataIndex[162]"
element 182 "Value" "163"
element 183 "Name" "DataIndex[163]"
element 183 "Value" "164"
element 184 "Name" "DataIndex[164]"
element 184 "Value" "165"
element 185 "Name" "DataIndex[165]"
element 185 "Value" "166"
element 186 "Name" "DataIndex[166]"
element 186 "Value" "167"
element 187 "Name" "DataIndex[167]"
element 187 "Value" "168"
element 188 "Name" "DataIndex[168]"
element 188 "Value" "169"
element 189 "Name" "DataIndex[169]"
element 189 "Value" "170"
element 190 "Name" "DataIndex[170]"
element 190 "Value" "171"
element 191 "Name" "DataIndex[171]"
element 191 "Value" "172"
element 192 "Name" "DataIndex[172]"
element 192 "Value" "173"
element 193 "Name" "DataIndex[173]"
element 193 "Value" "174"
element 194 "Name" "DataIndex[174]"
element 194 "Value" "175"
element 195 "Name" "DataIndex[175]"
element 195 "Value" "176"
element 196 "Name" "DataIndex[176]"
element 196 "Value" "177"
element 197 "Name" "DataIndex[177]"
element 197 "Value" "178"
element 198 "Name" "DataIndex[178]"
element 198 "Value" "179"
element 199 "Name" "DataIndex[179]"
element 199 "Value" "180"
element 200 "Name" "DataIndex[180]"
element 200 "Value" "181"
element 201 "Name" "DataIndex[181]"
element 201 "Value" "182"
element 202 "Name" "DataIndex[182]"
element 202 "Value" "183"
element 203 "Name" "DataIndex[183]"
element 203 "Value" "184"
element 204 "Name" "DataIndex[184]"
element 204 "Value" "185"
element 205 "Name" "DataIndex[185]"
element 205 "Value" "186"
element 206 "Name" "DataIndex[186]"
element 206 "Value" "187"
element 207 "Name" "DataIndex[187]"
element 207 "Value" "188"
element 208 "Name" "DataIndex[188]"
element 208 "Value" "189"
element 209 "Name" "DataIndex[189]"
element 209 "Value" "190"
element 210 "Name" "DataIndex[190]"
element 210 "Value" "191"
element 211 "Name" "DataIndex[191]"
element 211 "Value" "192"
element 212 "Name" "DataIndex[192]"
element 212 "Value" "193"
element 213 "Name" "DataIndex[193]"
element 213 "Value" "194"
element 214 "Name" "DataIndex[194]"
element 214 "Value" "195"
element 215 "Name" "DataIndex[195]"
element 215 "Value" "196"
element 216 "Name" "DataIndex[196]"
element 216 "Value" "197"
element 217 "Name" "DataIndex[197]"
element 217 "Value" "198"
element 218 "Name" "DataIndex[198]"
element 218 "Value" "199"
element 219 "Name" "DataIndex[199]"
element 219 "Value" "200"
element 220 "Name" "DataIndex[200]"
element 220 "Value" "201"
element 221 "Name" "DataIndex[201]"
element 221 "Value" "202"
element 222 "Name" "DataIndex[202]"
element 222 "Value" "203"
element 223 "Name" "DataIndex[203]"
element 223 "Value" "204"
element 224 "Name" "DataIndex[204]"
element 224 "Value" "205"
element 225 "Name" "DataIndex[205]"
element 225 "Value" "206"
element 226 "Name" "DataIndex[206]"
element 226 "Value" "207"
element 227 "Name" "DataIndex[207]"
element 227 "Value" "208"
element 228 "Name" "DataIndex[208]"
element 228 "Value" "209"
element 229 "Name" "DataIndex[209]"
element 229 "Value" "210"
element 230 "Name" "DataIndex[210]"
element 230 "Value" "211"
element 231 "Name" "DataIndex[211]"
element 231 "Value" "212"
element 232 "Name" "DataIndex[212]"
element 232 "Value" "213"
element 233 "Name" "DataIndex[213]"
element 233 "Value" "214"
element 234 "Name" "DataIndex[214]"
element 234 "Value" "215"
element 235 "Name" "DataIndex[215]"
element 235 "Value" "216"
element 236 "Name" "DataIndex[216]"
element 236 "Value" "217"
element 237 "Name" "DataIndex[217]"
element 237 "Value" "218"
element 238 "Name" "DataIndex[218]"
element 238 "Value" "219"
element 239 "Name" "DataIndex[219]"
element 239 "Value" "220"
element 240 "Name" "DataIndex[220]"
element 240 "Value" "221"
element 241 "Name" "DataIndex[221]"
element 241 "Value" "222"
element 242 "Name" "DataIndex[222]"
element 242 "Value" "223"
element 243 "Name" "DataIndex[223]"
element 243 "Value" "224"
element 244 "Name" "DataIndex[224]"
element 244 "Value" "225"
element 245 "Name" "DataIndex[225]"
element 245 "Value" "226"
element 246 "Name" "DataIndex[226]"
element 246 "Value" "227"
element 247 "Name" "DataIndex[227]"
element 247 "Value" "228"
element 248 "Name" "DataIndex[228]"
element 248 "Value" "229"
element 249 "Name" "DataIndex[229]"
element 249 "Value" "230"
element 250 "Name" "DataIndex[230]"
element 250 "Value" "231"
element 251 "Name" "DataIndex[231]"
element 251 "Value" "232"
element 252 "Name" "DataIndex[232]"
element 252 "Value" "233"
element 253 "Name" "DataIndex[233]"
element 253 "Value" "234"
element 254 "Name" "DataIndex[234]"
element 254 "Value" "235"
element 255 "Name" "DataIndex[235]"
element 255 "Value" "236"
element 256 "Name" "DataIndex[236]"
element 256 "Value" "237"
element 257 "Name" "DataIndex[237]"
element 257 "Value" "238"
element 258 "Name" "DataIndex[238]"
element 258 "Value" "239"
element 259 "Name" "DataIndex[239]"
element 259 "Value" "240"
element 260 "Name" "DataIndex[240]"
element 260 "Value" "241"
element 261 "Name" "DataIndex[241]"
element 261 "Value" "242"
element 262 "Name" "DataIndex[242]"
element 262 "Value" "243"
element 263 "Name" "DataIndex[243]"
element 263 "Value" "244"
element 264 "Name" "DataIndex[244]"
element 264 "Value" "245"
element 265 "Name" "DataIndex[245]"
element 265 "Value" "246"
element 266 "Name" "DataIndex[246]"
element 266 "Value" "247"
element 267 "Name" "DataIndex[247]"
element 267 "Value" "248"
element 268 "Name" "DataIndex[248]"
element 268 "Value" "249"
element 269 "Name" "DataIndex[249]"
element 269 "Value" "250"
element 270 "Name" "DataIndex[250]"
element 270 "Value" "251"
element 271 "Name" "DataIndex[251]"
element 271 "Value" "252"
element 272 "Name" "DataIndex[252]"
element 272 "Value" "253"
element 273 "Name" "DataIndex[253]"
element 273 "Value" "254"
element 274 "Name" "DataIndex[254]"
element 274 "Value" "255"
element 275 "Name" "DataIndex[255]"
element 275 "Value" "256"
element 276 "Name" "DataIndex[256]"
element 276 "Value" "257"
element 277 "Name" "DataIndex[257]"
element 277 "Value" "258"
element 278 "Name" "DataIndex[258]"
element 278 "Value" "259"
element 279 "Name" "DataIndex[259]"
element 279 "Value" "260"
element 280 "Name" "DataIndex[260]"
element 280 "Value" "261"
element 281 "Name" "DataIndex[261]"
element 281 "Value" "262"
element 282 "Name" "DataIndex[262]"
element 282 "Value" "263"
element 283 "Name" "DataIndex[263]"
element 283 "Value" "264"
element 284 "Name" "DataIndex[264]"
element 284 "Value" "265"
element 285 "Name" "DataIndex[265]"
element 285 "Value" "266"
element 286 "Name" "DataIndex[266]"
element 286 "Value" "267"
element 287 "Name" "DataIndex[267]"
element 287 "Value" "268"
element 288 "Name" "DataIndex[268]"
element 288 "Value" "269"
element 289 "Name" "DataIndex[269]"
element 289 "Value" "270"
element 290 "Name" "DataIndex[270]"
element 290 "Value" "271"
element 291 "Name" "DataIndex[271]"
element 291 "Value" "272"
element 292 "Name" "DataIndex[272]"
element 292 "Value" "273"
element 293 "Name" "DataIndex[273]"
element 293 "Value" "274"
element 294 "Name" "DataIndex[274]"
element 294 "Value" "275"
element 295 "Name" "DataIndex[275]"
element 295 "Value" "276"
element 296 "Name" "DataIndex[276]"
element 296 "Value" "277"
element 297 "Name" "DataIndex[277]"
element 297 "Value" "278"
element 298 "Name" "DataIndex[278]"
element 298 "Value" "279"
element 299 "Name" "DataIndex[279]"
element 299 "Value" "280"
element 300 "Name" "DataIndex[280]"
element 300 "Value" "281"
element 301 "Name" "DataIndex[281]"
element 301 "Value" "282"
element 302 "Name" "DataIndex[282]"
element 302 "Value" "283"
element 303 "Name" "DataIndex[283]"
element 303 "Value" "284"
element 304 "Name" "DataIndex[284]"
element 304 "Value" "285"
element 305 "Name" "DataIndex[285]"
element 305 "Value" "286"
element 306 "Name" "DataIndex[286]"
element 306 "Value" "287"
element 307 "Name" "DataIndex[287]"
element 307 "Value" "288"
element 308 "Name" "DataIndex[288]"
element 308 "Value" "289"
element 309 "Name" "DataIndex[289]"
element 309 "Value" "290"
element 310 "Name" "DataIndex[290]"
element 310 "Value" "291"
element 311 "Name" "DataIndex[291]"
element 311 "Value" "292"
element 312 "Name" "DataIndex[292]"
element 312 "Value" "293"
element 313 "Name" "DataIndex[293]"
element 313 "Value" "294"
element 314 "Name" "DataIndex[294]"
element 314 "Value" "295"
element 315 "Name" "DataIndex[295]"
element 315 "Value" "296"
element 316 "Name" "DataIndex[296]"
element 316 "Value" "297"
element 317 "Name" "DataIndex[297]"
element 317 "Value" "298"
element 318 "Name" "DataIndex[298]"
element 318 "Value" "299"
element 319 "Name" "DataIndex[299]"
element 319 "Value" "300"
element 320 "Name" "DataIndex[300]"
element 320 "Value" "301"
element 321 "Name" "DataIndex[301]"
element 321 "Value" "302"
element 322 "Name" "DataIndex[302]"
element 322 "Value" "303"
element 323 "Name" "DataIndex[303]"
element 323 "Value" "304"
element 324 "Name" "DataIndex[304]"
element 324 "Value" "305"
element 325 "Name" "DataIndex[305]"
element 325 "Value" "306"
element 326 "Name" "DataIndex[306]"
element 326 "Value" "307"
element 327 "Name" "DataIndex[307]"
element 327 "Value" "308"
element 328 "Name" "DataIndex[308]"
element 328 "Value" "309"
element 329 "Name" "DataIndex[309]"
element 329 "Value" "310"
element 330 "Name" "DataIndex[310]"
element 330 "Value" "311"
element 331 "Name" "DataIndex[311]"
element 331 "Value" "312"
element 332 "Name" "DataIndex[312]"
element 332 "Value" "313"
element 333 "Name" "DataIndex[313]"
element 333 "Value" "314"
element 334 "Name" "DataIndex[314]"
element 334 "Value" "315"
element 335 "Name" "DataIndex[315]"
element 335 "Value" "316"
element 336 "Name" "DataIndex[316]"
element 336 "Value" "317"
element 337 "Name" "DataIndex[317]"
element 337 "Value" "318"
element 338 "Name" "DataIndex[318]"
element 338 "Value" "319"
element 339 "Name" "DataIndex[319]"
element 339 "Value" "320"
element 340 "Name" "DataIndex[320]"
element 340 "Value" "321"
element 341 "Name" "DataIndex[321]"
element 341 "Value" "322"
element 342 "Name" "DataIndex[322]"
element 342 "Value" "323"
element 343 "Name" "DataIndex[323]"
element 343 "Value" "324"
element 344 "Name" "DataIndex[324]"
element 344 "Value" "325"
element 345 "Name" "DataIndex[325]"
element 345 "Value" "326"
element 346 "Name" "DataIndex[326]"
element 346 "Value" "327"
element 347 "Name" "DataIndex[327]"
element 347 "Value" "328"
element 348 "Name" "DataIndex[328]"
element 348 "Value" "329"
element 349 "Name" "DataIndex[329]"
element 349 "Value" "330"
element 350 "Name" "DataIndex[330]"
element 350 "Value" "331"
element 351 "Name" "DataIndex[331]"
element 351 "Value" "332"
element 352 "Name" "DataIndex[332]"
element 352 "Value" "333"
element 353 "Name" "DataIndex[333]"
element 353 "Value" "334"
element 354 "Name" "DataIndex[334]"
element 354 "Value" "335"
element 355 "Name" "DataIndex[335]"
element 355 "Value" "336"
element 356 "Name" "DataIndex[336]"
element 356 "Value" "337"
element 357 "Name" "DataIndex[337]"
element 357 "Value" "338"
element 358 "Name" "DataIndex[338]"
element 358 "Value" "339"
element 359 "Name" "DataIndex[339]"
element 359 "Value" "340"
element 360 "Name" "DataIndex[340]"
element 360 "Value" "341"
element 361 "Name" "DataIndex[341]"
element 361 "Value" "342"
element 362 "Name" "DataIndex[342]"
element 362 "Value" "343"
element 363 "Name" "DataIndex[343]"
element 363 "Value" "344"
element 364 "Name" "DataIndex[344]"
element 364 "Value" "345"
element 365 "Name" "DataIndex[345]"
element 365 "Value" "346"
element 366 "Name" "DataIndex[346]"
element 366 "Value" "347"
element 367 "Name" "DataIndex[347]"
element 367 "Value" "348"
element 368 "Name" "DataIndex[348]"
element 368 "Value" "349"
element 369 "Name" "DataIndex[349]"
element 369 "Value" "350"
element 370 "Name" "DataIndex[350]"
element 370 "Value" "351"
element 371 "Name" "DataIndex[351]"
element 371 "Value" "352"
element 372 "Name" "DataIndex[352]"
element 372 "Value" "353"
element 373 "Name" "DataIndex[353]"
element 373 "Value" "354"
element 374 "Name" "DataIndex[354]"
element 374 "Value" "355"
element 375 "Name" "DataIndex[355]"
element 375 "Value" "356"
element 376 "Name" "DataIndex[356]"
element 376 "Value" "357"
element 377 "Name" "DataIndex[357]"
element 377 "Value" "358"
element 378 "Name" "DataIndex[358]"
element 378 "Value" "359"
element 379 "Name" "DataIndex[359]"
element 379 "Value" "360"
element 380 "Name" "DataIndex[360]"
element 380 "Value" "361"
element 381 "Name" "DataIndex[361]"
element 381 "Value" "362"
element 382 "Name" "DataIndex[362]"
element 382 "Value" "363"
element 383 "Name" "DataIndex[363]"
element 383 "Value" "364"
element 384 "Name" "DataIndex[364]"
element 384 "Value" "365"
element 385 "Name" "DataIndex[365]"
element 385 "Value" "366"
element 386 "Name" "DataIndex[366]"
element 386 "Value" "367"
element 387 "Name" "DataIndex[367]"
element 387 "Value" "368"
element 388 "Name" "DataIndex[368]"
element 388 "Value" "369"
element 389 "Name" "DataIndex[369]"
element 389 "Value" "370"
element 390 "Name" "DataIndex[370]"
element 390 "Value" "371"
element 391 "Name" "DataIndex[371]"
element 391 "Value" "372"
element 392 "Name" "DataIndex[372]"
element 392 "Value" "373"
element 393 "Name" "DataIndex[373]"
element 393 "Value" "374"
element 394 "Name" "DataIndex[374]"
element 394 "Value" "375"
element 395 "Name" "DataIndex[375]"
element 395 "Value" "376"
element 396 "Name" "DataIndex[376]"
element 396 "Value" "377"
element 397 "Name" "DataIndex[377]"
element 397 "Value" "378"
element 398 "Name" "DataIndex[378]"
element 398 "Value" "379"
element 399 "Name" "DataIndex[379]"
element 399 "Value" "380"
element 400 "Name" "DataIndex[380]"
element 400 "Value" "381"
element 401 "Name" "DataIndex[381]"
element 401 "Value" "382"
element 402 "Name" "DataIndex[382]"
element 402 "Value" "383"
element 403 "Name" "DataIndex[383]"
element 403 "Value" "384"
element 404 "Name" "DataIndex[384]"
element 404 "Value" "385"
element 405 "Name" "DataIndex[385]"
element 405 "Value" "386"
element 406 "Name" "DataIndex[386]"
element 406 "Value" "387"
element 407 "Name" "DataIndex[387]"
element 407 "Value" "388"
element 408 "Name" "DataIndex[388]"
element 408 "Value" "389"
element 409 "Name" "DataIndex[389]"
element 409 "Value" "390"
element 410 "Name" "DataIndex[390]"
element 410 "Value" "391"
element 411 "Name" "DataIndex[391]"
element 411 "Value" "392"
element 412 "Name" "DataIndex[392]"
element 412 "Value" "393"
element 413 "Name" "DataIndex[393]"
element 413 "Value" "394"
element 414 "Name" "DataIndex[394]"
element 414 "Value" "395"
element 415 "Name" "DataIndex[395]"
element 415 "Value" "396"
element 416 "Name" "DataIndex[396]"
element 416 "Value" "397"
element 417 "Name" "DataIndex[397]"
element 417 "Value" "398"
element 418 "Name" "DataIndex[398]"
element 418 "Value" "399"
element 419 "Name" "DataIndex[399]"
element 419 "Value" "400"
element 420 "Name" "DataIndex[400]"
element 420 "Value" "401"
element 421 "Name" "DataIndex[401]"
element 421 "Value" "402"
element 422 "Name" "DataIndex[402]"
element 422 "Value" "403"
element 423 "Name" "DataIndex[403]"
element 423 "Value" "404"
element 424 "Name" "DataIndex[404]"
element 424 "Value" "405"
element 425 "Name" "DataIndex[405]"
element 425 "Value" "406"
element 426 "Name" "DataIndex[406]"
element 426 "Value" "407"
element 427 "Name" "DataIndex[407]"
element 427 "Value" "408"
element 428 "Name" "DataIndex[408]"
element 428 "Value" "409"
element 429 "Name" "DataIndex[409]"
element 429 "Value" "410"
element 430 "Name" "DataIndex[410]"
element 430 "Value" "411"
element 431 "Name" "DataIndex[411]"
element 431 "Value" "412"
element 432 "Name" "DataIndex[412]"
element 432 "Value" "413"
element 433 "Name" "DataIndex[413]"
element 433 "Value" "414"
element 434 "Name" "DataIndex[414]"
element 434 "Value" "415"
element 435 "Name" "DataIndex[415]"
element 435 "Value" "416"
element 436 "Name" "DataIndex[416]"
element 436 "Value" "417"
element 437 "Name" "DataIndex[417]"
element 437 "Value" "418"
element 438 "Name" "DataIndex[418]"
element 438 "Value" "419"
element 439 "Name" "DataIndex[419]"
element 439 "Value" "420"
element 440 "Name" "DataIndex[420]"
element 440 "Value" "421"
element 441 "Name" "DataIndex[421]"
element 441 "Value" "422"
element 442 "Name" "DataIndex[422]"
element 442 "Value" "423"
element 443 "Name" "DataIndex[423]"
element 443 "Value" "424"
element 444 "Name" "DataIndex[424]"
element 444 "Value" "425"
element 445 "Name" "DataIndex[425]"
element 445 "Value" "426"
element 446 "Name" "DataIndex[426]"
element 446 "Value" "427"
element 447 "Name" "DataIndex[427]"
element 447 "Value" "428"
element 448 "Name" "DataIndex[428]"
element 448 "Value" "429"
element 449 "Name" "DataIndex[429]"
element 449 "Value" "430"
element 450 "Name" "DataIndex[430]"
element 450 "Value" "431"
element 451 "Name" "DataIndex[431]"
element 451 "Value" "432"
element 452 "Name" "DataIndex[432]"
element 452 "Value" "433"
element 453 "Name" "DataIndex[433]"
element 453 "Value" "434"
element 454 "Name" "DataIndex[434]"
element 454 "Value" "435"
element 455 "Name" "DataIndex[435]"
element 455 "Value" "436"
element 456 "Name" "DataIndex[436]"
element 456 "Value" "437"
element 457 "Name" "DataIndex[437]"
element 457 "Value" "438"
element 458 "Name" "DataIndex[438]"
element 458 "Value" "439"
element 459 "Name" "DataIndex[439]"
element 459 "Value" "440"
element 460 "Name" "DataIndex[440]"
element 460 "Value" "441"
element 461 "Name" "DataIndex[441]"
element 461 "Value" "442"
element 462 "Name" "DataIndex[442]"
element 462 "Value" "443"
element 463 "Name" "DataIndex[443]"
element 463 "Value" "444"
element 464 "Name" "DataIndex[444]"
element 464 "Value" "445"
element 465 "Name" "DataIndex[445]"
element 465 "Value" "446"
element 466 "Name" "DataIndex[446]"
element 466 "Value" "447"
element 467 "Name" "DataIndex[447]"
element 467 "Value" "448"
element 468 "Name" "DataIndex[448]"
element 468 "Value" "449"
element 469 "Name" "DataIndex[449]"
element 469 "Value" "450"
element 470 "Name" "DataIndex[450]"
element 470 "Value" "451"
element 471 "Name" "DataIndex[451]"
element 471 "Value" "452"
element 472 "Name" "DataIndex[452]"
element 472 "Value" "453"
element 473 "Name" "DataIndex[453]"
element 473 "Value" "454"
element 474 "Name" "DataIndex[454]"
element 474 "Value" "455"
element 475 "Name" "DataIndex[455]"
element 475 "Value" "456"
element 476 "Name" "DataIndex[456]"
element 476 "Value" "457"
element 477 "Name" "DataIndex[457]"
element 477 "Value" "458"
element 478 "Name" "DataIndex[458]"
element 478 "Value" "459"
element 479 "Name" "DataIndex[459]"
element 479 "Value" "460"
element 480 "Name" "DataIndex[460]"
element 480 "Value" "461"
element 481 "Name" "DataIndex[461]"
element 481 "Value" "462"
element 482 "Name" "DataIndex[462]"
element 482 "Value" "463"
element 483 "Name" "DataIndex[463]"
element 483 "Value" "464"
element 484 "Name" "DataIndex[464]"
element 484 "Value" "465"
element 485 "Name" "DataIndex[465]"
element 485 "Value" "466"
element 486 "Name" "DataIndex[466]"
element 486 "Value" "467"
element 487 "Name" "DataIndex[467]"
element 487 "Value" "468"
element 488 "Name" "DataIndex[468]"
element 488 "Value" "469"
element 489 "Name" "DataIndex[469]"
element 489 "Value" "470"
element 490 "Name" "DataIndex[470]"
element 490 "Value" "471"
element 491 "Name" "DataIndex[471]"
element 491 "Value" "472"
element 492 "Name" "DataIndex[472]"
element 492 "Value" "473"
element 493 "Name" "DataIndex[473]"
element 493 "Value" "474"
element 494 "Name" "DataIndex[474]"
element 494 "Value" "475"
element 495 "Name" "DataIndex[475]"
element 495 "Value" "476"
element 496 "Name" "DataIndex[476]"
element 496 "Value" "477"
element 497 "Name" "DataIndex[477]"
element 497 "Value" "478"
element 498 "Name" "DataIndex[478]"
element 498 "Value" "479"
element 499 "Name" "DataIndex[479]"
element 499 "Value" "480"
element 500 "Name" "DataIndex[480]"
element 500 "Value" "481"
element 501 "Name" "DataIndex[481]"
element 501 "Value" "482"
element 502 "Name" "DataIndex[482]"
element 502 "Value" "483"
element 503 "Name" "DataIndex[483]"
element 503 "Value" "484"
element 504 "Name" "DataIndex[484]"
element 504 "Value" "485"
element 505 "Name" "DataIndex[485]"
element 505 "Value" "486"
element 506 "Name" "DataIndex[486]"
element 506 "Value" "487"
element 507 "Name" "DataIndex[487]"
element 507 "Value" "488"
element 508 "Name" "DataIndex[488]"
element 508 "Value" "489"
element 509 "Name" "DataIndex[489]"
element 509 "Value" "490"
element 510 "Name" "DataIndex[490]"
element 510 "Value" "491"
element 511 "Name" "DataIndex[491]"
element 511 "Value" "492"
element 512 "Name" "DataIndex[492]"
element 512 "Value" "493"
element 513 "Name" "DataIndex[493]"
element 513 "Value" "494"
element 514 "Name" "DataIndex[494]"
element 514 "Value" "495"
element 515 "Name" "DataIndex[495]"
element 515 "Value" "496"
element 516 "Name" "DataIndex[496]"
element 516 "Value" "497"
element 517 "Name" "DataIndex[497]"
element 517 "Value" "498"
element 518 "Name" "DataIndex[498]"
element 518 "Value" "499"
element 519 "Name" "DataIndex[499]"
element 519 "Value" "500"
element 520 "Name" "DataIndex[500]"
element 520 "Value" "501"
element 521 "Name" "DataIndex[501]"
element 521 "Value" "502"
element 522 "Name" "DataIndex[502]"
element 522 "Value" "503"
element 523 "Name" "DataIndex[503]"
element 523 "Value" "504"
element 524 "Name" "DataIndex[504]"
element 524 "Value" "505"
element 525 "Name" "DataIndex[505]"
element 525 "Value" "506"
element 526 "Name" "DataIndex[506]"
element 526 "Value" "507"
element 527 "Name" "DataIndex[507]"
element 527 "Value" "508"
element 528 "Name" "DataIndex[508]"
element 528 "Value" "509"
element 529 "Name" "DataIndex[509]"
element 529 "Value" "510"
element 530 "Name" "DataIndex[510]"
element 530 "Value" "511"
element 531 "Name" "DataIndex[511]"
element 531 "Value" "512"
element 532 "Name" "DataIndex[512]"
element 532 "Value" "513"
element 533 "Name" "DataIndex[513]"
element 533 "Value" "514"
element 534 "Name" "DataIndex[514]"
element 534 "Value" "515"
element 535 "Name" "DataIndex[515]"
element 535 "Value" "516"
element 536 "Name" "DataIndex[516]"
element 536 "Value" "517"
element 537 "Name" "DataIndex[517]"
element 537 "Value" "518"
element 538 "Name" "DataIndex[518]"
element 538 "Value" "519"
element 539 "Name" "DataIndex[519]"
element 539 "Value" "520"
element 540 "Name" "DataIndex[520]"
element 540 "Value" "521"
element 541 "Name" "DataIndex[521]"
element 541 "Value" "522"
element 542 "Name" "DataIndex[522]"
element 542 "Value" "523"
element 543 "Name" "DataIndex[523]"
element 543 "Value" "524"
element 544 "Name" "DataIndex[524]"
element 544 "Value" "525"
element 545 "Name" "DataIndex[525]"
element 545 "Value" "526"
element 546 "Name" "DataIndex[526]"
element 546 "Value" "527"
element 547 "Name" "DataIndex[527]"
element 547 "Value" "528"
element 548 "Name" "DataIndex[528]"
element 548 "Value" "529"
element 549 "Name" "DataIndex[529]"
element 549 "Value" "530"
element 550 "Name" "DataIndex[530]"
element 550 "Value" "531"
element 551 "Name" "DataIndex[531]"
element 551 "Value" "532"
element 552 "Name" "DataIndex[532]"
element 552 "Value" "533"
element 553 "Name" "DataIndex[533]"
element 553 "Value" "534"
element 554 "Name" "DataIndex[534]"
element 554 "Value" "535"
element 555 "Name" "DataIndex[535]"
element 555 "Value" "536"
element 556 "Name" "DataIndex[536]"
element 556 "Value" "537"
element 557 "Name" "DataIndex[537]"
element 557 "Value" "538"
element 558 "Name" "DataIndex[538]"
element 558 "Value" "539"
element 559 "Name" "DataIndex[539]"
element 559 "Value" "540"
element 560 "Name" "DataIndex[540]"
element 560 "Value" "541"
element 561 "Name" "DataIndex[541]"
element 561 "Value" "542"
element 562 "Name" "DataIndex[542]"
element 562 "Value" "543"
element 563 "Name" "DataIndex[543]"
element 563 "Value" "544"
element 564 "Name" "DataIndex[544]"
element 564 "Value" "545"
element 565 "Name" "DataIndex[545]"
element 565 "Value" "546"
element 566 "Name" "DataIndex[546]"
element 566 "Value" "547"
element 567 "Name" "DataIndex[547]"
element 567 "Value" "548"
element 568 "Name" "DataIndex[548]"
element 568 "Value" "549"
element 569 "Name" "DataIndex[549]"
element 569 "Value" "550"
element 570 "Name" "DataIndex[550]"
element 570 "Value" "551"
element 571 "Name" "DataIndex[551]"
element 571 "Value" "552"
element 572 "Name" "DataIndex[552]"
element 572 "Value" "553"
element 573 "Name" "DataIndex[553]"
element 573 "Value" "554"
element 574 "Name" "DataIndex[554]"
element 574 "Value" "555"
element 575 "Name" "DataIndex[555]"
element 575 "Value" "556"
element 576 "Name" "DataIndex[556]"
element 576 "Value" "557"
element 577 "Name" "DataIndex[557]"
element 577 "Value" "558"
element 578 "Name" "DataIndex[558]"
element 578 "Value" "559"
element 579 "Name" "DataIndex[559]"
element 579 "Value" "560"
element 580 "Name" "DataIndex[560]"
element 580 "Value" "561"
element 581 "Name" "DataIndex[561]"
element 581 "Value" "562"
element 582 "Name" "DataIndex[562]"
element 582 "Value" "563"
element 583 "Name" "DataIndex[563]"
element 583 "Value" "564"
element 584 "Name" "DataIndex[564]"
element 584 "Value" "565"
element 585 "Name" "DataIndex[565]"
element 585 "Value" "566"
element 586 "Name" "DataIndex[566]"
element 586 "Value" "567"
element 587 "Name" "DataIndex[567]"
element 587 "Value" "568"
element 588 "Name" "DataIndex[568]"
element 588 "Value" "569"
element 589 "Name" "DataIndex[569]"
element 589 "Value" "570"
element 590 "Name" "DataIndex[570]"
element 590 "Value" "571"
element 591 "Name" "DataIndex[571]"
element 591 "Value" "572"
element 592 "Name" "DataIndex[572]"
element 592 "Value" "573"
element 593 "Name" "DataIndex[573]"
element 593 "Value" "574"
element 594 "Name" "DataIndex[574]"
element 594 "Value" "575"
element 595 "Name" "DataIndex[575]"
element 595 "Value" "576"
element 596 "Name" "DataIndex[576]"
element 596 "Value" "577"
element 597 "Name" "DataIndex[577]"
element 597 "Value" "578"
element 598 "Name" "DataIndex[578]"
element 598 "Value" "579"
element 599 "Name" "DataIndex[579]"
element 599 "Value" "580"
element 600 "Name" "DataIndex[580]"
element 600 "Value" "581"
element 601 "Name" "DataIndex[581]"
element 601 "Value" "582"
element 602 "Name" "DataIndex[582]"
element 602 "Value" "583"
element 603 "Name" "DataIndex[583]"
element 603 "Value" "584"
element 604 "Name" "DataIndex[584]"
element 604 "Value" "585"
element 605 "Name" "DataIndex[585]"
element 605 "Value" "586"
element 606 "Name" "DataIndex[586]"
element 606 "Value" "587"
element 607 "Name" "DataIndex[587]"
element 607 "Value" "588"
element 608 "Name" "DataIndex[588]"
element 608 "Value" "589"
element 609 "Name" "DataIndex[589]"
element 609 "Value" "590"
element 610 "Name" "DataIndex[590]"
element 610 "Value" "591"
element 611 "Name" "DataIndex[591]"
element 611 "Value" "592"
element 612 "Name" "DataIndex[592]"
element 612 "Value" "593"
element 613 "Name" "DataIndex[593]"
element 613 "Value" "594"
element 614 "Name" "DataIndex[594]"
element 614 "Value" "595"
element 615 "Name" "DataIndex[595]"
element 615 "Value" "596"
element 616 "Name" "DataIndex[596]"
element 616 "Value" "597"
element 617 "Name" "DataIndex[597]"
element 617 "Value" "598"
element 618 "Name" "DataIndex[598]"
element 618 "Value" "599"
element 619 "Name" "DataIndex[599]"
element 619 "Value" "600"
element 620 "Name" "DataIndex[600]"
element 620 "Value" "601"
element 621 "Name" "DataIndex[601]"
element 621 "Value" "602"
element 622 "Name" "DataIndex[602]"
element 622 "Value" "603"
element 623 "Name" "DataIndex[603]"
element 623 "Value" "604"
element 624 "Name" "DataIndex[604]"
element 624 "Value" "605"
element 625 "Name" "DataIndex[605]"
element 625 "Value" "606"
element 626 "Name" "DataIndex[606]"
element 626 "Value" "607"
element 627 "Name" "DataIndex[607]"
element 627 "Value" "608"
element 628 "Name" "DataIndex[608]"
element 628 "Value" "609"
element 629 "Name" "DataIndex[609]"
element 629 "Value" "610"
element 630 "Name" "DataIndex[610]"
element 630 "Value" "611"
element 631 "Name" "DataIndex[611]"
element 631 "Value" "612"
element 632 "Name" "DataIndex[612]"
element 632 "Value" "613"
element 633 "Name" "DataIndex[613]"
element 633 "Value" "614"
element 634 "Name" "DataIndex[614]"
element 634 "Value" "615"
element 635 "Name" "DataIndex[615]"
element 635 "Value" "616"
element 636 "Name" "DataIndex[616]"
element 636 "Value" "617"
element 637 "Name" "DataIndex[617]"
element 637 "Value" "618"
element 638 "Name" "DataIndex[618]"
element 638 "Value" "619"
element 639 "Name" "DataIndex[619]"
element 639 "Value" "620"
element 640 "Name" "DataIndex[620]"
element 640 "Value" "621"
element 641 "Name" "DataIndex[621]"
element 641 "Value" "622"
element 642 "Name" "DataIndex[622]"
element 642 "Value" "623"
element 643 "Name" "DataIndex[623]"
element 643 "Value" "624"
element 644 "Name" "DataIndex[624]"
element 644 "Value" "625"
element 645 "Name" "DataIndex[625]"
element 645 "Value" "626"
element 646 "Name" "DataIndex[626]"
element 646 "Value" "627"
element 647 "Name" "DataIndex[627]"
element 647 "Value" "628"
element 648 "Name" "DataIndex[628]"
element 648 "Value" "629"
element 649 "Name" "DataIndex[629]"
element 649 "Value" "630"
element 650 "Name" "DataIndex[630]"
element 650 "Value" "631"
element 651 "Name" "DataIndex[631]"
element 651 "Value" "632"
element 652 "Name" "DataIndex[632]"
element 652 "Value" "633"
element 653 "Name" "DataIndex[633]"
element 653 "Value" "634"
element 654 "Name" "DataIndex[634]"
element 654 "Value" "635"
element 655 "Name" "DataIndex[635]"
element 655 "Value" "636"
element 656 "Name" "DataIndex[636]"
element 656 "Value" "637"
element 657 "Name" "DataIndex[637]"
element 657 "Value" "638"
element 658 "Name" "DataIndex[638]"
element 658 "Value" "639"
element 659 "Name" "DataIndex[639]"
element 659 "Value" "640"
element 660 "Name" "DataIndex[640]"
element 660 "Value" "641"
element 661 "Name" "DataIndex[641]"
element 661 "Value" "642"
element 662 "Name" "DataIndex[642]"
element 662 "Value" "643"
element 663 "Name" "DataIndex[643]"
element 663 "Value" "644"
element 664 "Name" "DataIndex[644]"
element 664 "Value" "645"
element 665 "Name" "DataIndex[645]"
element 665 "Value" "646"
element 666 "Name" "DataIndex[646]"
element 666 "Value" "647"
element 667 "Name" "DataIndex[647]"
element 667 "Value" "648"
element 668 "Name" "DataIndex[648]"
element 668 "Value" "649"
element 669 "Name" "DataIndex[649]"
element 669 "Value" "650"
element 670 "Name" "DataIndex[650]"
element 670 "Value" "651"
element 671 "Name" "DataIndex[651]"
element 671 "Value" "652"
element 672 "Name" "DataIndex[652]"
element 672 "Value" "653"
element 673 "Name" "DataIndex[653]"
element 673 "Value" "654"
element 674 "Name" "DataIndex[654]"
element 674 "Value" "655"
element 675 "Name" "DataIndex[655]"
element 675 "Value" "656"
element 676 "Name" "DataIndex[656]"
element 676 "Value" "657"
element 677 "Name" "DataIndex[657]"
element 677 "Value" "658"
element 678 "Name" "DataIndex[658]"
element 678 "Value" "659"
element 679 "Name" "DataIndex[659]"
element 679 "Value" "660"
element 680 "Name" "DataIndex[660]"
element 680 "Value" "661"
element 681 "Name" "DataIndex[661]"
element 681 "Value" "662"
element 682 "Name" "DataIndex[662]"
element 682 "Value" "663"
element 683 "Name" "DataIndex[663]"
element 683 "Value" "664"
element 684 "Name" "DataIndex[664]"
element 684 "Value" "665"
element 685 "Name" "DataIndex[665]"
element 685 "Value" "666"
element 686 "Name" "DataIndex[666]"
element 686 "Value" "667"
element 687 "Name" "DataIndex[667]"
element 687 "Value" "668"
element 688 "Name" "DataIndex[668]"
element 688 "Value" "669"
element 689 "Name" "DataIndex[669]"
element 689 "Value" "670"
element 690 "Name" "DataIndex[670]"
element 690 "Value" "671"
element 691 "Name" "DataIndex[671]"
element 691 "Value" "672"
element 692 "Name" "DataIndex[672]"
element 692 "Value" "673"
element 693 "Name" "DataIndex[673]"
element 693 "Value" "674"
element 694 "Name" "DataIndex[674]"
element 694 "Value" "675"
element 695 "Name" "DataIndex[675]"
element 695 "Value" "676"
element 696 "Name" "DataIndex[676]"
element 696 "Value" "677"
element 697 "Name" "DataIndex[677]"
element 697 "Value" "678"
element 698 "Name" "DataIndex[678]"
element 698 "Value" "679"
element 699 "Name" "DataIndex[679]"
element 699 "Value" "680"
element 700 "Name" "DataIndex[680]"
element 700 "Value" "681"
element 701 "Name" "DataIndex[681]"
element 701 "Value" "682"
element 702 "Name" "DataIndex[682]"
element 702 "Value" "683"
element 703 "Name" "DataIndex[683]"
element 703 "Value" "684"
element 704 "Name" "DataIndex[684]"
element 704 "Value" "685"
element 705 "Name" "DataIndex[685]"
element 705 "Value" "686"
element 706 "Name" "DataIndex[686]"
element 706 "Value" "687"
element 707 "Name" "DataIndex[687]"
element 707 "Value" "688"
element 708 "Name" "DataIndex[688]"
element 708 "Value" "689"
element 709 "Name" "DataIndex[689]"
element 709 "Value" "690"
element 710 "Name" "DataIndex[690]"
element 710 "Value" "691"
element 711 "Name" "DataIndex[691]"
element 711 "Value" "692"
element 712 "Name" "DataIndex[692]"
element 712 "Value" "693"
element 713 "Name" "DataIndex[693]"
element 713 "Value" "694"
element 714 "Name" "DataIndex[694]"
element 714 "Value" "695"
element 715 "Name" "DataIndex[695]"
element 715 "Value" "696"
element 716 "Name" "DataIndex[696]"
element 716 "Value" "697"
element 717 "Name" "DataIndex[697]"
element 717 "Value" "698"
element 718 "Name" "DataIndex[698]"
element 718 "Value" "699"
element 719 "Name" "DataIndex[699]"
element 719 "Value" "700"
element 720 "Name" "DataIndex[700]"
element 720 "Value" "701"
element 721 "Name" "DataIndex[701]"
element 721 "Value" "702"
element 722 "Name" "DataIndex[702]"
element 722 "Value" "703"
element 723 "Name" "DataIndex[703]"
element 723 "Value" "704"
element 724 "Name" "DataIndex[704]"
element 724 "Value" "705"
element 725 "Name" "DataIndex[705]"
element 725 "Value" "706"
element 726 "Name" "DataIndex[706]"
element 726 "Value" "707"
element 727 "Name" "DataIndex[707]"
element 727 "Value" "708"
element 728 "Name" "DataIndex[708]"
element 728 "Value" "709"
element 729 "Name" "DataIndex[709]"
element 729 "Value" "710"
element 730 "Name" "DataIndex[710]"
element 730 "Value" "711"
element 731 "Name" "DataIndex[711]"
element 731 "Value" "712"
element 732 "Name" "DataIndex[712]"
element 732 "Value" "713"
element 733 "Name" "DataIndex[713]"
element 733 "Value" "714"
element 734 "Name" "DataIndex[714]"
element 734 "Value" "715"
element 735 "Name" "DataIndex[715]"
element 735 "Value" "716"
element 736 "Name" "DataIndex[716]"
element 736 "Value" "717"
element 737 "Name" "DataIndex[717]"
element 737 "Value" "718"
element 738 "Name" "DataIndex[718]"
element 738 "Value" "719"
element 739 "Name" "DataIndex[719]"
element 739 "Value" "720"
element 740 "Name" "DataIndex[720]"
element 740 "Value" "721"
element 741 "Name" "DataIndex[721]"
element 741 "Value" "722"
element 742 "Name" "DataIndex[722]"
element 742 "Value" "723"
element 743 "Name" "DataIndex[723]"
element 743 "Value" "724"
element 744 "Name" "DataIndex[724]"
element 744 "Value" "725"
element 745 "Name" "DataIndex[725]"
element 745 "Value" "726"
element 746 "Name" "DataIndex[726]"
element 746 "Value" "727"
element 747 "Name" "DataIndex[727]"
element 747 "Value" "728"
element 748 "Name" "DataIndex[728]"
element 748 "Value" "729"
element 749 "Name" "DataIndex[729]"
element 749 "Value" "730"
element 750 "Name" "DataIndex[730]"
element 750 "Value" "731"
element 751 "Name" "DataIndex[731]"
element 751 "Value" "732"
element 752 "Name" "DataIndex[732]"
element 752 "Value" "733"
element 753 "Name" "DataIndex[733]"
element 753 "Value" "734"
element 754 "Name" "DataIndex[734]"
element 754 "Value" "735"
element 755 "Name" "DataIndex[735]"
element 755 "Value" "736"
element 756 "Name" "DataIndex[736]"
element 756 "Value" "737"
element 757 "Name" "DataIndex[737]"
element 757 "Value" "738"
element 758 "Name" "DataIndex[738]"
element 758 "Value" "739"
element 759 "Name" "DataIndex[739]"
element 759 "Value" "740"
element 760 "Name" "DataIndex[740]"
element 760 "Value" "741"
element 761 "Name" "DataIndex[741]"
element 761 "Value" "742"
element 762 "Name" "DataIndex[742]"
element 762 "Value" "743"
element 763 "Name" "DataIndex[743]"
element 763 "Value" "744"
element 764 "Name" "DataIndex[744]"
element 764 "Value" "745"
element 765 "Name" "DataIndex[745]"
element 765 "Value" "746"
element 766 "Name" "DataIndex[746]"
element 766 "Value" "747"
element 767 "Name" "DataIndex[747]"
element 767 "Value" "748"
element 768 "Name" "DataIndex[748]"
element 768 "Value" "749"
element 769 "Name" "DataIndex[749]"
element 769 "Value" "750"
element 770 "Name" "DataIndex[750]"
element 770 "Value" "751"
element 771 "Name" "DataIndex[751]"
element 771 "Value" "752"
element 772 "Name" "DataIndex[752]"
element 772 "Value" "753"
element 773 "Name" "DataIndex[753]"
element 773 "Value" "754"
element 774 "Name" "DataIndex[754]"
element 774 "Value" "755"
element 775 "Name" "DataIndex[755]"
element 775 "Value" "756"
element 776 "Name" "DataIndex[756]"
element 776 "Value" "757"
element 777 "Name" "DataIndex[757]"
element 777 "Value" "758"
element 778 "Name" "DataIndex[758]"
element 778 "Value" "759"
element 779 "Name" "DataIndex[759]"
element 779 "Value" "760"
element 780 "Name" "DataIndex[760]"
element 780 "Value" "761"
element 781 "Name" "DataIndex[761]"
element 781 "Value" "762"
element 782 "Name" "DataIndex[762]"
element 782 "Value" "763"
element 783 "Name" "DataIndex"
element 783 "Value" "ICCAP_ARRAY[763]"
element 784 "Name" "PlotIndex"
element 784 "Value" "12950"
element 785 "Name" "MasterSweepIndex"
element 785 "Value" "2"
element 786 "Name" "ShowMasterSweepIndex"
element 786 "Value" "0"
element 787 "Name" "Col0[0]"
element 787 "Value" "-18.13m"
element 788 "Name" "Col0[1]"
element 788 "Value" "1.085"
element 789 "Name" "Col0[2]"
element 789 "Value" "1.984"
element 790 "Name" "Col0[3]"
element 790 "Value" "2.976"
element 791 "Name" "Col0[4]"
element 791 "Value" "3.984"
element 792 "Name" "Col0[5]"
element 792 "Value" "4.973"
element 793 "Name" "Col0[6]"
element 793 "Value" "5.989"
element 794 "Name" "Col0[7]"
element 794 "Value" "6.974"
element 795 "Name" "Col0[8]"
element 795 "Value" "7.997"
element 796 "Name" "Col0[9]"
element 796 "Value" "8.973"
element 797 "Name" "Col0[10]"
element 797 "Value" "9.952"
element 798 "Name" "Col0[11]"
element 798 "Value" "10.99"
element 799 "Name" "Col0[12]"
element 799 "Value" "12.00"
element 800 "Name" "Col0[13]"
element 800 "Value" "12.99"
element 801 "Name" "Col0[14]"
element 801 "Value" "14.03"
element 802 "Name" "Col0[15]"
element 802 "Value" "14.99"
element 803 "Name" "Col0[16]"
element 803 "Value" "15.99"
element 804 "Name" "Col0[17]"
element 804 "Value" "17.01"
element 805 "Name" "Col0[18]"
element 805 "Value" "18.00"
element 806 "Name" "Col0[19]"
element 806 "Value" "19.02"
element 807 "Name" "Col0[20]"
element 807 "Value" "20.00"
element 808 "Name" "Col0[21]"
element 808 "Value" "21.02"
element 809 "Name" "Col0[22]"
element 809 "Value" "22.01"
element 810 "Name" "Col0[23]"
element 810 "Value" "22.99"
element 811 "Name" "Col0[24]"
element 811 "Value" "24.01"
element 812 "Name" "Col0[25]"
element 812 "Value" "25.02"
element 813 "Name" "Col0[26]"
element 813 "Value" "25.98"
element 814 "Name" "Col0[27]"
element 814 "Value" "26.98"
element 815 "Name" "Col0[28]"
element 815 "Value" "27.99"
element 816 "Name" "Col0[29]"
element 816 "Value" "29.01"
element 817 "Name" "Col0[30]"
element 817 "Value" "29.99"
element 818 "Name" "Col0[31]"
element 818 "Value" "-21.34m"
element 819 "Name" "Col0[32]"
element 819 "Value" "1.082"
element 820 "Name" "Col0[33]"
element 820 "Value" "1.983"
element 821 "Name" "Col0[34]"
element 821 "Value" "3.000"
element 822 "Name" "Col0[35]"
element 822 "Value" "3.989"
element 823 "Name" "Col0[36]"
element 823 "Value" "5.000"
element 824 "Name" "Col0[37]"
element 824 "Value" "5.988"
element 825 "Name" "Col0[38]"
element 825 "Value" "6.976"
element 826 "Name" "Col0[39]"
element 826 "Value" "7.967"
element 827 "Name" "Col0[40]"
element 827 "Value" "9.000"
element 828 "Name" "Col0[41]"
element 828 "Value" "9.952"
element 829 "Name" "Col0[42]"
element 829 "Value" "10.99"
element 830 "Name" "Col0[43]"
element 830 "Value" "12.00"
element 831 "Name" "Col0[44]"
element 831 "Value" "13.01"
element 832 "Name" "Col0[45]"
element 832 "Value" "14.00"
element 833 "Name" "Col0[46]"
element 833 "Value" "15.02"
element 834 "Name" "Col0[47]"
element 834 "Value" "15.99"
element 835 "Name" "Col0[48]"
element 835 "Value" "17.01"
element 836 "Name" "Col0[49]"
element 836 "Value" "18.02"
element 837 "Name" "Col0[50]"
element 837 "Value" "19.01"
element 838 "Name" "Col0[51]"
element 838 "Value" "20.00"
element 839 "Name" "Col0[52]"
element 839 "Value" "21.01"
element 840 "Name" "Col0[53]"
element 840 "Value" "22.01"
element 841 "Name" "Col0[54]"
element 841 "Value" "22.99"
element 842 "Name" "Col0[55]"
element 842 "Value" "24.01"
element 843 "Name" "Col0[56]"
element 843 "Value" "24.99"
element 844 "Name" "Col0[57]"
element 844 "Value" "25.95"
element 845 "Name" "Col0[58]"
element 845 "Value" "26.98"
element 846 "Name" "Col0[59]"
element 846 "Value" "27.99"
element 847 "Name" "Col0[60]"
element 847 "Value" "28.97"
element 848 "Name" "Col0[61]"
element 848 "Value" "30.00"
element 849 "Name" "Col0[62]"
element 849 "Value" "-23.80m"
element 850 "Name" "Col0[63]"
element 850 "Value" "1.085"
element 851 "Name" "Col0[64]"
element 851 "Value" "1.985"
element 852 "Name" "Col0[65]"
element 852 "Value" "2.999"
element 853 "Name" "Col0[66]"
element 853 "Value" "3.987"
element 854 "Name" "Col0[67]"
element 854 "Value" "4.997"
element 855 "Name" "Col0[68]"
element 855 "Value" "5.987"
element 856 "Name" "Col0[69]"
element 856 "Value" "6.976"
element 857 "Name" "Col0[70]"
element 857 "Value" "7.995"
element 858 "Name" "Col0[71]"
element 858 "Value" "9.002"
element 859 "Name" "Col0[72]"
element 859 "Value" "9.952"
element 860 "Name" "Col0[73]"
element 860 "Value" "10.97"
element 861 "Name" "Col0[74]"
element 861 "Value" "12.00"
element 862 "Name" "Col0[75]"
element 862 "Value" "13.01"
element 863 "Name" "Col0[76]"
element 863 "Value" "14.00"
element 864 "Name" "Col0[77]"
element 864 "Value" "15.02"
element 865 "Name" "Col0[78]"
element 865 "Value" "15.99"
element 866 "Name" "Col0[79]"
element 866 "Value" "17.01"
element 867 "Name" "Col0[80]"
element 867 "Value" "18.03"
element 868 "Name" "Col0[81]"
element 868 "Value" "19.01"
element 869 "Name" "Col0[82]"
element 869 "Value" "20.00"
element 870 "Name" "Col0[83]"
element 870 "Value" "21.02"
element 871 "Name" "Col0[84]"
element 871 "Value" "22.01"
element 872 "Name" "Col0[85]"
element 872 "Value" "23.02"
element 873 "Name" "Col0[86]"
element 873 "Value" "24.01"
element 874 "Name" "Col0[87]"
element 874 "Value" "24.99"
element 875 "Name" "Col0[88]"
element 875 "Value" "25.95"
element 876 "Name" "Col0[89]"
element 876 "Value" "26.98"
element 877 "Name" "Col0[90]"
element 877 "Value" "27.99"
element 878 "Name" "Col0[91]"
element 878 "Value" "29.00"
element 879 "Name" "Col0[92]"
element 879 "Value" "29.99"
element 880 "Name" "Col0[93]"
element 880 "Value" "-26.23m"
element 881 "Name" "Col0[94]"
element 881 "Value" "1.086"
element 882 "Name" "Col0[95]"
element 882 "Value" "1.983"
element 883 "Name" "Col0[96]"
element 883 "Value" "3.002"
element 884 "Name" "Col0[97]"
element 884 "Value" "3.986"
element 885 "Name" "Col0[98]"
element 885 "Value" "4.967"
element 886 "Name" "Col0[99]"
element 886 "Value" "5.991"
element 887 "Name" "Col0[100]"
element 887 "Value" "6.974"
element 888 "Name" "Col0[101]"
element 888 "Value" "7.993"
element 889 "Name" "Col0[102]"
element 889 "Value" "8.973"
element 890 "Name" "Col0[103]"
element 890 "Value" "9.955"
element 891 "Name" "Col0[104]"
element 891 "Value" "10.96"
element 892 "Name" "Col0[105]"
element 892 "Value" "12.00"
element 893 "Name" "Col0[106]"
element 893 "Value" "13.02"
element 894 "Name" "Col0[107]"
element 894 "Value" "14.00"
element 895 "Name" "Col0[108]"
element 895 "Value" "15.02"
element 896 "Name" "Col0[109]"
element 896 "Value" "16.00"
element 897 "Name" "Col0[110]"
element 897 "Value" "17.01"
element 898 "Name" "Col0[111]"
element 898 "Value" "18.00"
element 899 "Name" "Col0[112]"
element 899 "Value" "19.01"
element 900 "Name" "Col0[113]"
element 900 "Value" "20.00"
element 901 "Name" "Col0[114]"
element 901 "Value" "21.01"
element 902 "Name" "Col0[115]"
element 902 "Value" "22.01"
element 903 "Name" "Col0[116]"
element 903 "Value" "23.02"
element 904 "Name" "Col0[117]"
element 904 "Value" "24.01"
element 905 "Name" "Col0[118]"
element 905 "Value" "24.99"
element 906 "Name" "Col0[119]"
element 906 "Value" "25.98"
element 907 "Name" "Col0[120]"
element 907 "Value" "26.98"
element 908 "Name" "Col0[121]"
element 908 "Value" "27.99"
element 909 "Name" "Col0[122]"
element 909 "Value" "29.00"
element 910 "Name" "Col0[123]"
element 910 "Value" "29.99"
element 911 "Name" "Col0[124]"
element 911 "Value" "-20.07m"
element 912 "Name" "Col0[125]"
element 912 "Value" "1.084"
element 913 "Name" "Col0[126]"
element 913 "Value" "1.984"
element 914 "Name" "Col0[127]"
element 914 "Value" "3.002"
element 915 "Name" "Col0[128]"
element 915 "Value" "4.014"
element 916 "Name" "Col0[129]"
element 916 "Value" "5.001"
element 917 "Name" "Col0[130]"
element 917 "Value" "5.991"
element 918 "Name" "Col0[131]"
element 918 "Value" "7.003"
element 919 "Name" "Col0[132]"
element 919 "Value" "7.992"
element 920 "Name" "Col0[133]"
element 920 "Value" "8.972"
element 921 "Name" "Col0[134]"
element 921 "Value" "9.925"
element 922 "Name" "Col0[135]"
element 922 "Value" "10.96"
element 923 "Name" "Col0[136]"
element 923 "Value" "12.00"
element 924 "Name" "Col0[137]"
element 924 "Value" "13.01"
element 925 "Name" "Col0[138]"
element 925 "Value" "14.00"
element 926 "Name" "Col0[139]"
element 926 "Value" "15.02"
element 927 "Name" "Col0[140]"
element 927 "Value" "15.99"
element 928 "Name" "Col0[141]"
element 928 "Value" "16.98"
element 929 "Name" "Col0[142]"
element 929 "Value" "18.00"
element 930 "Name" "Col0[143]"
element 930 "Value" "19.01"
element 931 "Name" "Col0[144]"
element 931 "Value" "20.00"
element 932 "Name" "Col0[145]"
element 932 "Value" "21.01"
element 933 "Name" "Col0[146]"
element 933 "Value" "22.00"
element 934 "Name" "Col0[147]"
element 934 "Value" "23.02"
element 935 "Name" "Col0[148]"
element 935 "Value" "23.98"
element 936 "Name" "Col0[149]"
element 936 "Value" "24.99"
element 937 "Name" "Col0[150]"
element 937 "Value" "25.97"
element 938 "Name" "Col0[151]"
element 938 "Value" "26.98"
element 939 "Name" "Col0[152]"
element 939 "Value" "28.01"
element 940 "Name" "Col0[153]"
element 940 "Value" "28.98"
element 941 "Name" "Col0[154]"
element 941 "Value" "30.02"
element 942 "Name" "Col0[155]"
element 942 "Value" "-25.44m"
element 943 "Name" "Col0[156]"
element 943 "Value" "1.085"
element 944 "Name" "Col0[157]"
element 944 "Value" "1.989"
element 945 "Name" "Col0[158]"
element 945 "Value" "2.974"
element 946 "Name" "Col0[159]"
element 946 "Value" "3.987"
element 947 "Name" "Col0[160]"
element 947 "Value" "4.994"
element 948 "Name" "Col0[161]"
element 948 "Value" "5.989"
element 949 "Name" "Col0[162]"
element 949 "Value" "6.977"
element 950 "Name" "Col0[163]"
element 950 "Value" "7.993"
element 951 "Name" "Col0[164]"
element 951 "Value" "8.973"
element 952 "Name" "Col0[165]"
element 952 "Value" "9.957"
element 953 "Name" "Col0[166]"
element 953 "Value" "10.99"
element 954 "Name" "Col0[167]"
element 954 "Value" "12.00"
element 955 "Name" "Col0[168]"
element 955 "Value" "13.01"
element 956 "Name" "Col0[169]"
element 956 "Value" "14.00"
element 957 "Name" "Col0[170]"
element 957 "Value" "15.02"
element 958 "Name" "Col0[171]"
element 958 "Value" "15.99"
element 959 "Name" "Col0[172]"
element 959 "Value" "17.01"
element 960 "Name" "Col0[173]"
element 960 "Value" "18.00"
element 961 "Name" "Col0[174]"
element 961 "Value" "19.01"
element 962 "Name" "Col0[175]"
element 962 "Value" "20.00"
element 963 "Name" "Col0[176]"
element 963 "Value" "20.99"
element 964 "Name" "Col0[177]"
element 964 "Value" "21.98"
element 965 "Name" "Col0[178]"
element 965 "Value" "23.02"
element 966 "Name" "Col0[179]"
element 966 "Value" "24.01"
element 967 "Name" "Col0[180]"
element 967 "Value" "24.99"
element 968 "Name" "Col0[181]"
element 968 "Value" "25.95"
element 969 "Name" "Col0[182]"
element 969 "Value" "26.95"
element 970 "Name" "Col0[183]"
element 970 "Value" "27.99"
element 971 "Name" "Col0[184]"
element 971 "Value" "29.01"
element 972 "Name" "Col0[185]"
element 972 "Value" "29.99"
element 973 "Name" "Col0[186]"
element 973 "Value" "-20.29m"
element 974 "Name" "Col0[187]"
element 974 "Value" "1.083"
element 975 "Name" "Col0[188]"
element 975 "Value" "1.983"
element 976 "Name" "Col0[189]"
element 976 "Value" "3.000"
element 977 "Name" "Col0[190]"
element 977 "Value" "4.013"
element 978 "Name" "Col0[191]"
element 978 "Value" "4.999"
element 979 "Name" "Col0[192]"
element 979 "Value" "5.988"
element 980 "Name" "Col0[193]"
element 980 "Value" "7.000"
element 981 "Name" "Col0[194]"
element 981 "Value" "7.962"
element 982 "Name" "Col0[195]"
element 982 "Value" "8.976"
element 983 "Name" "Col0[196]"
element 983 "Value" "9.950"
element 984 "Name" "Col0[197]"
element 984 "Value" "10.99"
element 985 "Name" "Col0[198]"
element 985 "Value" "11.99"
element 986 "Name" "Col0[199]"
element 986 "Value" "13.01"
element 987 "Name" "Col0[200]"
element 987 "Value" "14.02"
element 988 "Name" "Col0[201]"
element 988 "Value" "15.02"
element 989 "Name" "Col0[202]"
element 989 "Value" "16.00"
element 990 "Name" "Col0[203]"
element 990 "Value" "17.00"
element 991 "Name" "Col0[204]"
element 991 "Value" "18.00"
element 992 "Name" "Col0[205]"
element 992 "Value" "19.01"
element 993 "Name" "Col0[206]"
element 993 "Value" "20.00"
element 994 "Name" "Col0[207]"
element 994 "Value" "20.99"
element 995 "Name" "Col0[208]"
element 995 "Value" "22.00"
element 996 "Name" "Col0[209]"
element 996 "Value" "23.02"
element 997 "Name" "Col0[210]"
element 997 "Value" "24.01"
element 998 "Name" "Col0[211]"
element 998 "Value" "24.98"
element 999 "Name" "Col0[212]"
element 999 "Value" "25.98"
element 1000 "Name" "Col0[213]"
element 1000 "Value" "26.95"
element 1001 "Name" "Col0[214]"
element 1001 "Value" "27.99"
element 1002 "Name" "Col0[215]"
element 1002 "Value" "28.98"
element 1003 "Name" "Col0[216]"
element 1003 "Value" "30.02"
element 1004 "Name" "Col0[217]"
element 1004 "Value" "-20.86m"
element 1005 "Name" "Col0[218]"
element 1005 "Value" "1.085"
element 1006 "Name" "Col0[219]"
element 1006 "Value" "1.983"
element 1007 "Name" "Col0[220]"
element 1007 "Value" "2.973"
element 1008 "Name" "Col0[221]"
element 1008 "Value" "4.013"
element 1009 "Name" "Col0[222]"
element 1009 "Value" "4.994"
element 1010 "Name" "Col0[223]"
element 1010 "Value" "5.982"
element 1011 "Name" "Col0[224]"
element 1011 "Value" "7.000"
element 1012 "Name" "Col0[225]"
element 1012 "Value" "7.987"
element 1013 "Name" "Col0[226]"
element 1013 "Value" "8.968"
element 1014 "Name" "Col0[227]"
element 1014 "Value" "9.952"
element 1015 "Name" "Col0[228]"
element 1015 "Value" "10.99"
element 1016 "Name" "Col0[229]"
element 1016 "Value" "11.99"
element 1017 "Name" "Col0[230]"
element 1017 "Value" "12.98"
element 1018 "Name" "Col0[231]"
element 1018 "Value" "14.00"
element 1019 "Name" "Col0[232]"
element 1019 "Value" "14.98"
element 1020 "Name" "Col0[233]"
element 1020 "Value" "15.99"
element 1021 "Name" "Col0[234]"
element 1021 "Value" "17.00"
element 1022 "Name" "Col0[235]"
element 1022 "Value" "17.99"
element 1023 "Name" "Col0[236]"
element 1023 "Value" "19.01"
element 1024 "Name" "Col0[237]"
element 1024 "Value" "19.99"
element 1025 "Name" "Col0[238]"
element 1025 "Value" "21.01"
element 1026 "Name" "Col0[239]"
element 1026 "Value" "22.00"
element 1027 "Name" "Col0[240]"
element 1027 "Value" "23.01"
element 1028 "Name" "Col0[241]"
element 1028 "Value" "24.00"
element 1029 "Name" "Col0[242]"
element 1029 "Value" "24.98"
element 1030 "Name" "Col0[243]"
element 1030 "Value" "25.97"
element 1031 "Name" "Col0[244]"
element 1031 "Value" "26.97"
element 1032 "Name" "Col0[245]"
element 1032 "Value" "28.01"
element 1033 "Name" "Col0[246]"
element 1033 "Value" "28.98"
element 1034 "Name" "Col0[247]"
element 1034 "Value" "29.99"
element 1035 "Name" "Col0[248]"
element 1035 "Value" "-26.60m"
element 1036 "Name" "Col0[249]"
element 1036 "Value" "1.069"
element 1037 "Name" "Col0[250]"
element 1037 "Value" "1.959"
element 1038 "Name" "Col0[251]"
element 1038 "Value" "2.966"
element 1039 "Name" "Col0[252]"
element 1039 "Value" "3.974"
element 1040 "Name" "Col0[253]"
element 1040 "Value" "4.979"
element 1041 "Name" "Col0[254]"
element 1041 "Value" "5.963"
element 1042 "Name" "Col0[255]"
element 1042 "Value" "6.973"
element 1043 "Name" "Col0[256]"
element 1043 "Value" "7.992"
element 1044 "Name" "Col0[257]"
element 1044 "Value" "8.995"
element 1045 "Name" "Col0[258]"
element 1045 "Value" "9.948"
element 1046 "Name" "Col0[259]"
element 1046 "Value" "10.99"
element 1047 "Name" "Col0[260]"
element 1047 "Value" "11.99"
element 1048 "Name" "Col0[261]"
element 1048 "Value" "13.01"
element 1049 "Name" "Col0[262]"
element 1049 "Value" "14.02"
element 1050 "Name" "Col0[263]"
element 1050 "Value" "15.01"
element 1051 "Name" "Col0[264]"
element 1051 "Value" "15.98"
element 1052 "Name" "Col0[265]"
element 1052 "Value" "17.00"
element 1053 "Name" "Col0[266]"
element 1053 "Value" "18.02"
element 1054 "Name" "Col0[267]"
element 1054 "Value" "19.00"
element 1055 "Name" "Col0[268]"
element 1055 "Value" "19.99"
element 1056 "Name" "Col0[269]"
element 1056 "Value" "21.00"
element 1057 "Name" "Col0[270]"
element 1057 "Value" "22.00"
element 1058 "Name" "Col0[271]"
element 1058 "Value" "23.01"
element 1059 "Name" "Col0[272]"
element 1059 "Value" "23.99"
element 1060 "Name" "Col0[273]"
element 1060 "Value" "25.01"
element 1061 "Name" "Col0[274]"
element 1061 "Value" "25.97"
element 1062 "Name" "Col0[275]"
element 1062 "Value" "27.00"
element 1063 "Name" "Col0[276]"
element 1063 "Value" "27.98"
element 1064 "Name" "Col0[277]"
element 1064 "Value" "29.00"
element 1065 "Name" "Col0[278]"
element 1065 "Value" "29.98"
element 1066 "Name" "Col0[279]"
element 1066 "Value" "-24.18m"
element 1067 "Name" "Col0[280]"
element 1067 "Value" "977.2m"
element 1068 "Name" "Col0[281]"
element 1068 "Value" "1.951"
element 1069 "Name" "Col0[282]"
element 1069 "Value" "2.971"
element 1070 "Name" "Col0[283]"
element 1070 "Value" "3.970"
element 1071 "Name" "Col0[284]"
element 1071 "Value" "4.968"
element 1072 "Name" "Col0[285]"
element 1072 "Value" "5.978"
element 1073 "Name" "Col0[286]"
element 1073 "Value" "6.983"
element 1074 "Name" "Col0[287]"
element 1074 "Value" "7.991"
element 1075 "Name" "Col0[288]"
element 1075 "Value" "8.968"
element 1076 "Name" "Col0[289]"
element 1076 "Value" "9.944"
element 1077 "Name" "Col0[290]"
element 1077 "Value" "10.98"
element 1078 "Name" "Col0[291]"
element 1078 "Value" "12.01"
element 1079 "Name" "Col0[292]"
element 1079 "Value" "13.00"
element 1080 "Name" "Col0[293]"
element 1080 "Value" "14.02"
element 1081 "Name" "Col0[294]"
element 1081 "Value" "15.00"
element 1082 "Name" "Col0[295]"
element 1082 "Value" "15.98"
element 1083 "Name" "Col0[296]"
element 1083 "Value" "17.00"
element 1084 "Name" "Col0[297]"
element 1084 "Value" "18.01"
element 1085 "Name" "Col0[298]"
element 1085 "Value" "19.00"
element 1086 "Name" "Col0[299]"
element 1086 "Value" "19.99"
element 1087 "Name" "Col0[300]"
element 1087 "Value" "21.03"
element 1088 "Name" "Col0[301]"
element 1088 "Value" "22.02"
element 1089 "Name" "Col0[302]"
element 1089 "Value" "23.00"
element 1090 "Name" "Col0[303]"
element 1090 "Value" "24.01"
element 1091 "Name" "Col0[304]"
element 1091 "Value" "25.01"
element 1092 "Name" "Col0[305]"
element 1092 "Value" "25.99"
element 1093 "Name" "Col0[306]"
element 1093 "Value" "26.96"
element 1094 "Name" "Col0[307]"
element 1094 "Value" "27.97"
element 1095 "Name" "Col0[308]"
element 1095 "Value" "28.99"
element 1096 "Name" "Col0[309]"
element 1096 "Value" "30.01"
element 1097 "Name" "Col0[310]"
element 1097 "Value" "-20.98m"
element 1098 "Name" "Col0[311]"
element 1098 "Value" "1.022"
element 1099 "Name" "Col0[312]"
element 1099 "Value" "1.930"
element 1100 "Name" "Col0[313]"
element 1100 "Value" "2.953"
element 1101 "Name" "Col0[314]"
element 1101 "Value" "3.974"
element 1102 "Name" "Col0[315]"
element 1102 "Value" "4.962"
element 1103 "Name" "Col0[316]"
element 1103 "Value" "5.974"
element 1104 "Name" "Col0[317]"
element 1104 "Value" "6.976"
element 1105 "Name" "Col0[318]"
element 1105 "Value" "7.979"
element 1106 "Name" "Col0[319]"
element 1106 "Value" "8.984"
element 1107 "Name" "Col0[320]"
element 1107 "Value" "9.956"
element 1108 "Name" "Col0[321]"
element 1108 "Value" "10.99"
element 1109 "Name" "Col0[322]"
element 1109 "Value" "11.99"
element 1110 "Name" "Col0[323]"
element 1110 "Value" "13.01"
element 1111 "Name" "Col0[324]"
element 1111 "Value" "14.03"
element 1112 "Name" "Col0[325]"
element 1112 "Value" "15.00"
element 1113 "Name" "Col0[326]"
element 1113 "Value" "15.99"
element 1114 "Name" "Col0[327]"
element 1114 "Value" "17.01"
element 1115 "Name" "Col0[328]"
element 1115 "Value" "18.00"
element 1116 "Name" "Col0[329]"
element 1116 "Value" "19.01"
element 1117 "Name" "Col0[330]"
element 1117 "Value" "20.02"
element 1118 "Name" "Col0[331]"
element 1118 "Value" "21.01"
element 1119 "Name" "Col0[332]"
element 1119 "Value" "22.00"
element 1120 "Name" "Col0[333]"
element 1120 "Value" "22.99"
element 1121 "Name" "Col0[334]"
element 1121 "Value" "23.99"
element 1122 "Name" "Col0[335]"
element 1122 "Value" "24.98"
element 1123 "Name" "Col0[336]"
element 1123 "Value" "25.97"
element 1124 "Name" "Col0[337]"
element 1124 "Value" "26.98"
element 1125 "Name" "Col0[338]"
element 1125 "Value" "27.98"
element 1126 "Name" "Col0[339]"
element 1126 "Value" "29.00"
element 1127 "Name" "Col0[340]"
element 1127 "Value" "29.99"
element 1128 "Name" "Col0[341]"
element 1128 "Value" "-23.70m"
element 1129 "Name" "Col0[342]"
element 1129 "Value" "1.073"
element 1130 "Name" "Col0[343]"
element 1130 "Value" "1.900"
element 1131 "Name" "Col0[344]"
element 1131 "Value" "2.914"
element 1132 "Name" "Col0[345]"
element 1132 "Value" "3.950"
element 1133 "Name" "Col0[346]"
element 1133 "Value" "4.959"
element 1134 "Name" "Col0[347]"
element 1134 "Value" "5.989"
element 1135 "Name" "Col0[348]"
element 1135 "Value" "6.966"
element 1136 "Name" "Col0[349]"
element 1136 "Value" "7.969"
element 1137 "Name" "Col0[350]"
element 1137 "Value" "8.967"
element 1138 "Name" "Col0[351]"
element 1138 "Value" "9.937"
element 1139 "Name" "Col0[352]"
element 1139 "Value" "10.97"
element 1140 "Name" "Col0[353]"
element 1140 "Value" "12.01"
element 1141 "Name" "Col0[354]"
element 1141 "Value" "13.02"
element 1142 "Name" "Col0[355]"
element 1142 "Value" "14.01"
element 1143 "Name" "Col0[356]"
element 1143 "Value" "15.01"
element 1144 "Name" "Col0[357]"
element 1144 "Value" "16.01"
element 1145 "Name" "Col0[358]"
element 1145 "Value" "16.99"
element 1146 "Name" "Col0[359]"
element 1146 "Value" "18.01"
element 1147 "Name" "Col0[360]"
element 1147 "Value" "19.00"
element 1148 "Name" "Col0[361]"
element 1148 "Value" "20.01"
element 1149 "Name" "Col0[362]"
element 1149 "Value" "21.00"
element 1150 "Name" "Col0[363]"
element 1150 "Value" "22.01"
element 1151 "Name" "Col0[364]"
element 1151 "Value" "23.00"
element 1152 "Name" "Col0[365]"
element 1152 "Value" "24.01"
element 1153 "Name" "Col0[366]"
element 1153 "Value" "25.01"
element 1154 "Name" "Col0[367]"
element 1154 "Value" "25.99"
element 1155 "Name" "Col0[368]"
element 1155 "Value" "26.96"
element 1156 "Name" "Col0[369]"
element 1156 "Value" "28.00"
element 1157 "Name" "Col0[370]"
element 1157 "Value" "28.99"
element 1158 "Name" "Col0[371]"
element 1158 "Value" "29.98"
element 1159 "Name" "Col0[372]"
element 1159 "Value" "-22.77m"
element 1160 "Name" "Col0[373]"
element 1160 "Value" "1.006"
element 1161 "Name" "Col0[374]"
element 1161 "Value" "2.017"
element 1162 "Name" "Col0[375]"
element 1162 "Value" "2.916"
element 1163 "Name" "Col0[376]"
element 1163 "Value" "3.934"
element 1164 "Name" "Col0[377]"
element 1164 "Value" "4.979"
element 1165 "Name" "Col0[378]"
element 1165 "Value" "5.973"
element 1166 "Name" "Col0[379]"
element 1166 "Value" "6.976"
element 1167 "Name" "Col0[380]"
element 1167 "Value" "7.976"
element 1168 "Name" "Col0[381]"
element 1168 "Value" "8.951"
element 1169 "Name" "Col0[382]"
element 1169 "Value" "9.954"
element 1170 "Name" "Col0[383]"
element 1170 "Value" "10.98"
element 1171 "Name" "Col0[384]"
element 1171 "Value" "12.02"
element 1172 "Name" "Col0[385]"
element 1172 "Value" "13.00"
element 1173 "Name" "Col0[386]"
element 1173 "Value" "14.02"
element 1174 "Name" "Col0[387]"
element 1174 "Value" "15.00"
element 1175 "Name" "Col0[388]"
element 1175 "Value" "15.99"
element 1176 "Name" "Col0[389]"
element 1176 "Value" "17.01"
element 1177 "Name" "Col0[390]"
element 1177 "Value" "17.99"
element 1178 "Name" "Col0[391]"
element 1178 "Value" "18.98"
element 1179 "Name" "Col0[392]"
element 1179 "Value" "20.00"
element 1180 "Name" "Col0[393]"
element 1180 "Value" "21.02"
element 1181 "Name" "Col0[394]"
element 1181 "Value" "22.01"
element 1182 "Name" "Col0[395]"
element 1182 "Value" "23.00"
element 1183 "Name" "Col0[396]"
element 1183 "Value" "24.00"
element 1184 "Name" "Col0[397]"
element 1184 "Value" "24.99"
element 1185 "Name" "Col0[398]"
element 1185 "Value" "25.98"
element 1186 "Name" "Col0[399]"
element 1186 "Value" "26.95"
element 1187 "Name" "Col0[400]"
element 1187 "Value" "28.00"
element 1188 "Name" "Col0[401]"
element 1188 "Value" "28.99"
element 1189 "Name" "Col0[402]"
element 1189 "Value" "29.98"
element 1190 "Name" "Col0[403]"
element 1190 "Value" "-20.91m"
element 1191 "Name" "Col0[404]"
element 1191 "Value" "976.3m"
element 1192 "Name" "Col0[405]"
element 1192 "Value" "2.077"
element 1193 "Name" "Col0[406]"
element 1193 "Value" "2.909"
element 1194 "Name" "Col0[407]"
element 1194 "Value" "3.913"
element 1195 "Name" "Col0[408]"
element 1195 "Value" "4.952"
element 1196 "Name" "Col0[409]"
element 1196 "Value" "5.969"
element 1197 "Name" "Col0[410]"
element 1197 "Value" "6.970"
element 1198 "Name" "Col0[411]"
element 1198 "Value" "7.975"
element 1199 "Name" "Col0[412]"
element 1199 "Value" "8.973"
element 1200 "Name" "Col0[413]"
element 1200 "Value" "9.952"
element 1201 "Name" "Col0[414]"
element 1201 "Value" "11.01"
element 1202 "Name" "Col0[415]"
element 1202 "Value" "12.02"
element 1203 "Name" "Col0[416]"
element 1203 "Value" "13.01"
element 1204 "Name" "Col0[417]"
element 1204 "Value" "14.02"
element 1205 "Name" "Col0[418]"
element 1205 "Value" "15.00"
element 1206 "Name" "Col0[419]"
element 1206 "Value" "16.00"
element 1207 "Name" "Col0[420]"
element 1207 "Value" "17.01"
element 1208 "Name" "Col0[421]"
element 1208 "Value" "18.00"
element 1209 "Name" "Col0[422]"
element 1209 "Value" "18.99"
element 1210 "Name" "Col0[423]"
element 1210 "Value" "20.01"
element 1211 "Name" "Col0[424]"
element 1211 "Value" "21.02"
element 1212 "Name" "Col0[425]"
element 1212 "Value" "22.01"
element 1213 "Name" "Col0[426]"
element 1213 "Value" "23.00"
element 1214 "Name" "Col0[427]"
element 1214 "Value" "24.02"
element 1215 "Name" "Col0[428]"
element 1215 "Value" "25.00"
element 1216 "Name" "Col0[429]"
element 1216 "Value" "25.97"
element 1217 "Name" "Col0[430]"
element 1217 "Value" "26.97"
element 1218 "Name" "Col0[431]"
element 1218 "Value" "27.98"
element 1219 "Name" "Col0[432]"
element 1219 "Value" "28.98"
element 1220 "Name" "Col0[433]"
element 1220 "Value" "30.00"
element 1221 "Name" "Col0[434]"
element 1221 "Value" "-25.92m"
element 1222 "Name" "Col0[435]"
element 1222 "Value" "967.8m"
element 1223 "Name" "Col0[436]"
element 1223 "Value" "1.991"
element 1224 "Name" "Col0[437]"
element 1224 "Value" "2.992"
element 1225 "Name" "Col0[438]"
element 1225 "Value" "3.908"
element 1226 "Name" "Col0[439]"
element 1226 "Value" "4.937"
element 1227 "Name" "Col0[440]"
element 1227 "Value" "5.962"
element 1228 "Name" "Col0[441]"
element 1228 "Value" "6.962"
element 1229 "Name" "Col0[442]"
element 1229 "Value" "7.964"
element 1230 "Name" "Col0[443]"
element 1230 "Value" "8.989"
element 1231 "Name" "Col0[444]"
element 1231 "Value" "9.994"
element 1232 "Name" "Col0[445]"
element 1232 "Value" "11.00"
element 1233 "Name" "Col0[446]"
element 1233 "Value" "12.01"
element 1234 "Name" "Col0[447]"
element 1234 "Value" "13.00"
element 1235 "Name" "Col0[448]"
element 1235 "Value" "14.01"
element 1236 "Name" "Col0[449]"
element 1236 "Value" "15.00"
element 1237 "Name" "Col0[450]"
element 1237 "Value" "16.02"
element 1238 "Name" "Col0[451]"
element 1238 "Value" "17.01"
element 1239 "Name" "Col0[452]"
element 1239 "Value" "18.00"
element 1240 "Name" "Col0[453]"
element 1240 "Value" "19.02"
element 1241 "Name" "Col0[454]"
element 1241 "Value" "20.01"
element 1242 "Name" "Col0[455]"
element 1242 "Value" "21.00"
element 1243 "Name" "Col0[456]"
element 1243 "Value" "21.99"
element 1244 "Name" "Col0[457]"
element 1244 "Value" "23.01"
element 1245 "Name" "Col0[458]"
element 1245 "Value" "24.00"
element 1246 "Name" "Col0[459]"
element 1246 "Value" "25.01"
element 1247 "Name" "Col0[460]"
element 1247 "Value" "25.96"
element 1248 "Name" "Col0[461]"
element 1248 "Value" "26.96"
element 1249 "Name" "Col0[462]"
element 1249 "Value" "28.00"
element 1250 "Name" "Col0[463]"
element 1250 "Value" "28.99"
element 1251 "Name" "Col0[464]"
element 1251 "Value" "30.01"
element 1252 "Name" "Col0[465]"
element 1252 "Value" "-27.54m"
element 1253 "Name" "Col0[466]"
element 1253 "Value" "968.7m"
element 1254 "Name" "Col0[467]"
element 1254 "Value" "2.057"
element 1255 "Name" "Col0[468]"
element 1255 "Value" "3.026"
element 1256 "Name" "Col0[469]"
element 1256 "Value" "4.011"
element 1257 "Name" "Col0[470]"
element 1257 "Value" "4.955"
element 1258 "Name" "Col0[471]"
element 1258 "Value" "5.976"
element 1259 "Name" "Col0[472]"
element 1259 "Value" "6.972"
element 1260 "Name" "Col0[473]"
element 1260 "Value" "7.977"
element 1261 "Name" "Col0[474]"
element 1261 "Value" "8.976"
element 1262 "Name" "Col0[475]"
element 1262 "Value" "9.975"
element 1263 "Name" "Col0[476]"
element 1263 "Value" "10.98"
element 1264 "Name" "Col0[477]"
element 1264 "Value" "12.03"
element 1265 "Name" "Col0[478]"
element 1265 "Value" "12.99"
element 1266 "Name" "Col0[479]"
element 1266 "Value" "14.01"
element 1267 "Name" "Col0[480]"
element 1267 "Value" "14.99"
element 1268 "Name" "Col0[481]"
element 1268 "Value" "15.99"
element 1269 "Name" "Col0[482]"
element 1269 "Value" "17.01"
element 1270 "Name" "Col0[483]"
element 1270 "Value" "18.01"
element 1271 "Name" "Col0[484]"
element 1271 "Value" "19.02"
element 1272 "Name" "Col0[485]"
element 1272 "Value" "20.02"
element 1273 "Name" "Col0[486]"
element 1273 "Value" "21.01"
element 1274 "Name" "Col0[487]"
element 1274 "Value" "22.02"
element 1275 "Name" "Col0[488]"
element 1275 "Value" "22.99"
element 1276 "Name" "Col0[489]"
element 1276 "Value" "24.00"
element 1277 "Name" "Col0[490]"
element 1277 "Value" "24.98"
element 1278 "Name" "Col0[491]"
element 1278 "Value" "25.99"
element 1279 "Name" "Col0[492]"
element 1279 "Value" "26.98"
element 1280 "Name" "Col0[493]"
element 1280 "Value" "28.02"
element 1281 "Name" "Col0[494]"
element 1281 "Value" "28.98"
element 1282 "Name" "Col0[495]"
element 1282 "Value" "30.01"
element 1283 "Name" "Col0[496]"
element 1283 "Value" "-20.19m"
element 1284 "Name" "Col0[497]"
element 1284 "Value" "966.3m"
element 1285 "Name" "Col0[498]"
element 1285 "Value" "2.043"
element 1286 "Name" "Col0[499]"
element 1286 "Value" "3.051"
element 1287 "Name" "Col0[500]"
element 1287 "Value" "4.002"
element 1288 "Name" "Col0[501]"
element 1288 "Value" "4.938"
element 1289 "Name" "Col0[502]"
element 1289 "Value" "5.978"
element 1290 "Name" "Col0[503]"
element 1290 "Value" "6.974"
element 1291 "Name" "Col0[504]"
element 1291 "Value" "7.975"
element 1292 "Name" "Col0[505]"
element 1292 "Value" "8.983"
element 1293 "Name" "Col0[506]"
element 1293 "Value" "9.957"
element 1294 "Name" "Col0[507]"
element 1294 "Value" "11.00"
element 1295 "Name" "Col0[508]"
element 1295 "Value" "12.01"
element 1296 "Name" "Col0[509]"
element 1296 "Value" "13.00"
element 1297 "Name" "Col0[510]"
element 1297 "Value" "14.02"
element 1298 "Name" "Col0[511]"
element 1298 "Value" "14.99"
element 1299 "Name" "Col0[512]"
element 1299 "Value" "15.98"
element 1300 "Name" "Col0[513]"
element 1300 "Value" "17.00"
element 1301 "Name" "Col0[514]"
element 1301 "Value" "17.99"
element 1302 "Name" "Col0[515]"
element 1302 "Value" "19.01"
element 1303 "Name" "Col0[516]"
element 1303 "Value" "20.01"
element 1304 "Name" "Col0[517]"
element 1304 "Value" "21.00"
element 1305 "Name" "Col0[518]"
element 1305 "Value" "22.03"
element 1306 "Name" "Col0[519]"
element 1306 "Value" "22.99"
element 1307 "Name" "Col0[520]"
element 1307 "Value" "23.99"
element 1308 "Name" "Col0[521]"
element 1308 "Value" "24.98"
element 1309 "Name" "Col0[522]"
element 1309 "Value" "25.98"
element 1310 "Name" "Col0[523]"
element 1310 "Value" "27.01"
element 1311 "Name" "Col0[524]"
element 1311 "Value" "28.00"
element 1312 "Name" "Col0[525]"
element 1312 "Value" "29.00"
element 1313 "Name" "Col0[526]"
element 1313 "Value" "30.02"
element 1314 "Name" "Col0[527]"
element 1314 "Value" "-18.46m"
element 1315 "Name" "Col0[528]"
element 1315 "Value" "952.4m"
element 1316 "Name" "Col0[529]"
element 1316 "Value" "2.053"
element 1317 "Name" "Col0[530]"
element 1317 "Value" "3.048"
element 1318 "Name" "Col0[531]"
element 1318 "Value" "4.023"
element 1319 "Name" "Col0[532]"
element 1319 "Value" "4.915"
element 1320 "Name" "Col0[533]"
element 1320 "Value" "5.948"
element 1321 "Name" "Col0[534]"
element 1321 "Value" "6.973"
element 1322 "Name" "Col0[535]"
element 1322 "Value" "7.974"
element 1323 "Name" "Col0[536]"
element 1323 "Value" "8.999"
element 1324 "Name" "Col0[537]"
element 1324 "Value" "9.951"
element 1325 "Name" "Col0[538]"
element 1325 "Value" "10.99"
element 1326 "Name" "Col0[539]"
element 1326 "Value" "12.02"
element 1327 "Name" "Col0[540]"
element 1327 "Value" "13.00"
element 1328 "Name" "Col0[541]"
element 1328 "Value" "14.03"
element 1329 "Name" "Col0[542]"
element 1329 "Value" "14.99"
element 1330 "Name" "Col0[543]"
element 1330 "Value" "16.01"
element 1331 "Name" "Col0[544]"
element 1331 "Value" "17.01"
element 1332 "Name" "Col0[545]"
element 1332 "Value" "18.00"
element 1333 "Name" "Col0[546]"
element 1333 "Value" "19.03"
element 1334 "Name" "Col0[547]"
element 1334 "Value" "20.03"
element 1335 "Name" "Col0[548]"
element 1335 "Value" "21.00"
element 1336 "Name" "Col0[549]"
element 1336 "Value" "22.00"
element 1337 "Name" "Col0[550]"
element 1337 "Value" "23.01"
element 1338 "Name" "Col0[551]"
element 1338 "Value" "24.01"
element 1339 "Name" "Col0[552]"
element 1339 "Value" "25.00"
element 1340 "Name" "Col0[553]"
element 1340 "Value" "25.98"
element 1341 "Name" "Col0[554]"
element 1341 "Value" "26.98"
element 1342 "Name" "Col0[555]"
element 1342 "Value" "28.00"
element 1343 "Name" "Col0[556]"
element 1343 "Value" "29.00"
element 1344 "Name" "Col0[557]"
element 1344 "Value" "30.00"
element 1345 "Name" "Col0[558]"
element 1345 "Value" "-22.65m"
element 1346 "Name" "Col0[559]"
element 1346 "Value" "959.7m"
element 1347 "Name" "Col0[560]"
element 1347 "Value" "2.049"
element 1348 "Name" "Col0[561]"
element 1348 "Value" "3.028"
element 1349 "Name" "Col0[562]"
element 1349 "Value" "4.044"
element 1350 "Name" "Col0[563]"
element 1350 "Value" "5.011"
element 1351 "Name" "Col0[564]"
element 1351 "Value" "5.954"
element 1352 "Name" "Col0[565]"
element 1352 "Value" "6.973"
element 1353 "Name" "Col0[566]"
element 1353 "Value" "7.981"
element 1354 "Name" "Col0[567]"
element 1354 "Value" "8.975"
element 1355 "Name" "Col0[568]"
element 1355 "Value" "9.958"
element 1356 "Name" "Col0[569]"
element 1356 "Value" "11.00"
element 1357 "Name" "Col0[570]"
element 1357 "Value" "12.02"
element 1358 "Name" "Col0[571]"
element 1358 "Value" "13.01"
element 1359 "Name" "Col0[572]"
element 1359 "Value" "14.01"
element 1360 "Name" "Col0[573]"
element 1360 "Value" "15.01"
element 1361 "Name" "Col0[574]"
element 1361 "Value" "16.03"
element 1362 "Name" "Col0[575]"
element 1362 "Value" "17.00"
element 1363 "Name" "Col0[576]"
element 1363 "Value" "18.03"
element 1364 "Name" "Col0[577]"
element 1364 "Value" "19.03"
element 1365 "Name" "Col0[578]"
element 1365 "Value" "20.00"
element 1366 "Name" "Col0[579]"
element 1366 "Value" "21.02"
element 1367 "Name" "Col0[580]"
element 1367 "Value" "21.99"
element 1368 "Name" "Col0[581]"
element 1368 "Value" "22.99"
element 1369 "Name" "Col0[582]"
element 1369 "Value" "23.98"
element 1370 "Name" "Col0[583]"
element 1370 "Value" "25.01"
element 1371 "Name" "Col0[584]"
element 1371 "Value" "25.98"
element 1372 "Name" "Col0[585]"
element 1372 "Value" "26.99"
element 1373 "Name" "Col0[586]"
element 1373 "Value" "27.99"
element 1374 "Name" "Col0[587]"
element 1374 "Value" "29.02"
element 1375 "Name" "Col0[588]"
element 1375 "Value" "30.01"
element 1376 "Name" "Col0[589]"
element 1376 "Value" "-23.29m"
element 1377 "Name" "Col0[590]"
element 1377 "Value" "976.7m"
element 1378 "Name" "Col0[591]"
element 1378 "Value" "2.026"
element 1379 "Name" "Col0[592]"
element 1379 "Value" "3.027"
element 1380 "Name" "Col0[593]"
element 1380 "Value" "4.054"
element 1381 "Name" "Col0[594]"
element 1381 "Value" "5.006"
element 1382 "Name" "Col0[595]"
element 1382 "Value" "5.936"
element 1383 "Name" "Col0[596]"
element 1383 "Value" "6.948"
element 1384 "Name" "Col0[597]"
element 1384 "Value" "7.984"
element 1385 "Name" "Col0[598]"
element 1385 "Value" "9.002"
element 1386 "Name" "Col0[599]"
element 1386 "Value" "9.989"
element 1387 "Name" "Col0[600]"
element 1387 "Value" "11.01"
element 1388 "Name" "Col0[601]"
element 1388 "Value" "12.02"
element 1389 "Name" "Col0[602]"
element 1389 "Value" "13.02"
element 1390 "Name" "Col0[603]"
element 1390 "Value" "14.02"
element 1391 "Name" "Col0[604]"
element 1391 "Value" "15.02"
element 1392 "Name" "Col0[605]"
element 1392 "Value" "16.02"
element 1393 "Name" "Col0[606]"
element 1393 "Value" "16.99"
element 1394 "Name" "Col0[607]"
element 1394 "Value" "18.02"
element 1395 "Name" "Col0[608]"
element 1395 "Value" "19.02"
element 1396 "Name" "Col0[609]"
element 1396 "Value" "20.03"
element 1397 "Name" "Col0[610]"
element 1397 "Value" "21.02"
element 1398 "Name" "Col0[611]"
element 1398 "Value" "22.02"
element 1399 "Name" "Col0[612]"
element 1399 "Value" "22.98"
element 1400 "Name" "Col0[613]"
element 1400 "Value" "23.99"
element 1401 "Name" "Col0[614]"
element 1401 "Value" "25.01"
element 1402 "Name" "Col0[615]"
element 1402 "Value" "25.99"
element 1403 "Name" "Col0[616]"
element 1403 "Value" "27.00"
element 1404 "Name" "Col0[617]"
element 1404 "Value" "28.00"
element 1405 "Name" "Col0[618]"
element 1405 "Value" "29.00"
element 1406 "Name" "Col0[619]"
element 1406 "Value" "30.00"
element 1407 "Name" "Col0[620]"
element 1407 "Value" "-25.73m"
element 1408 "Name" "Col0[621]"
element 1408 "Value" "945.0m"
element 1409 "Name" "Col0[622]"
element 1409 "Value" "2.036"
element 1410 "Name" "Col0[623]"
element 1410 "Value" "3.035"
element 1411 "Name" "Col0[624]"
element 1411 "Value" "4.037"
element 1412 "Name" "Col0[625]"
element 1412 "Value" "5.033"
element 1413 "Name" "Col0[626]"
element 1413 "Value" "5.906"
element 1414 "Name" "Col0[627]"
element 1414 "Value" "6.959"
element 1415 "Name" "Col0[628]"
element 1415 "Value" "8.009"
element 1416 "Name" "Col0[629]"
element 1416 "Value" "8.986"
element 1417 "Name" "Col0[630]"
element 1417 "Value" "9.976"
element 1418 "Name" "Col0[631]"
element 1418 "Value" "10.99"
element 1419 "Name" "Col0[632]"
element 1419 "Value" "12.00"
element 1420 "Name" "Col0[633]"
element 1420 "Value" "13.04"
element 1421 "Name" "Col0[634]"
element 1421 "Value" "14.03"
element 1422 "Name" "Col0[635]"
element 1422 "Value" "15.01"
element 1423 "Name" "Col0[636]"
element 1423 "Value" "16.01"
element 1424 "Name" "Col0[637]"
element 1424 "Value" "17.01"
element 1425 "Name" "Col0[638]"
element 1425 "Value" "18.01"
element 1426 "Name" "Col0[639]"
element 1426 "Value" "19.04"
element 1427 "Name" "Col0[640]"
element 1427 "Value" "20.02"
element 1428 "Name" "Col0[641]"
element 1428 "Value" "21.02"
element 1429 "Name" "Col0[642]"
element 1429 "Value" "22.02"
element 1430 "Name" "Col0[643]"
element 1430 "Value" "23.01"
element 1431 "Name" "Col0[644]"
element 1431 "Value" "24.02"
element 1432 "Name" "Col0[645]"
element 1432 "Value" "25.02"
element 1433 "Name" "Col0[646]"
element 1433 "Value" "25.97"
element 1434 "Name" "Col0[647]"
element 1434 "Value" "26.98"
element 1435 "Name" "Col0[648]"
element 1435 "Value" "27.99"
element 1436 "Name" "Col0[649]"
element 1436 "Value" "28.99"
element 1437 "Name" "Col0[650]"
element 1437 "Value" "30.01"
element 1438 "Name" "Col0[651]"
element 1438 "Value" "-25.26m"
element 1439 "Name" "Col0[652]"
element 1439 "Value" "951.1m"
element 1440 "Name" "Col0[653]"
element 1440 "Value" "2.026"
element 1441 "Name" "Col0[654]"
element 1441 "Value" "3.038"
element 1442 "Name" "Col0[655]"
element 1442 "Value" "4.047"
element 1443 "Name" "Col0[656]"
element 1443 "Value" "5.056"
element 1444 "Name" "Col0[657]"
element 1444 "Value" "5.984"
element 1445 "Name" "Col0[658]"
element 1445 "Value" "6.920"
element 1446 "Name" "Col0[659]"
element 1446 "Value" "7.986"
element 1447 "Name" "Col0[660]"
element 1447 "Value" "8.993"
element 1448 "Name" "Col0[661]"
element 1448 "Value" "9.979"
element 1449 "Name" "Col0[662]"
element 1449 "Value" "11.02"
element 1450 "Name" "Col0[663]"
element 1450 "Value" "12.01"
element 1451 "Name" "Col0[664]"
element 1451 "Value" "13.02"
element 1452 "Name" "Col0[665]"
element 1452 "Value" "14.02"
element 1453 "Name" "Col0[666]"
element 1453 "Value" "15.02"
element 1454 "Name" "Col0[667]"
element 1454 "Value" "16.02"
element 1455 "Name" "Col0[668]"
element 1455 "Value" "17.02"
element 1456 "Name" "Col0[669]"
element 1456 "Value" "18.03"
element 1457 "Name" "Col0[670]"
element 1457 "Value" "19.03"
element 1458 "Name" "Col0[671]"
element 1458 "Value" "20.01"
element 1459 "Name" "Col0[672]"
element 1459 "Value" "21.01"
element 1460 "Name" "Col0[673]"
element 1460 "Value" "22.01"
element 1461 "Name" "Col0[674]"
element 1461 "Value" "23.01"
element 1462 "Name" "Col0[675]"
element 1462 "Value" "24.01"
element 1463 "Name" "Col0[676]"
element 1463 "Value" "25.02"
element 1464 "Name" "Col0[677]"
element 1464 "Value" "25.97"
element 1465 "Name" "Col0[678]"
element 1465 "Value" "27.01"
element 1466 "Name" "Col0[679]"
element 1466 "Value" "28.01"
element 1467 "Name" "Col0[680]"
element 1467 "Value" "29.01"
element 1468 "Name" "Col0[681]"
element 1468 "Value" "29.99"
element 1469 "Name" "Col0[682]"
element 1469 "Value" "-22.92m"
element 1470 "Name" "Col0[683]"
element 1470 "Value" "946.8m"
element 1471 "Name" "Col0[684]"
element 1471 "Value" "2.012"
element 1472 "Name" "Col0[685]"
element 1472 "Value" "3.044"
element 1473 "Name" "Col0[686]"
element 1473 "Value" "4.036"
element 1474 "Name" "Col0[687]"
element 1474 "Value" "5.030"
element 1475 "Name" "Col0[688]"
element 1475 "Value" "6.011"
element 1476 "Name" "Col0[689]"
element 1476 "Value" "7.025"
element 1477 "Name" "Col0[690]"
element 1477 "Value" "7.974"
element 1478 "Name" "Col0[691]"
element 1478 "Value" "8.976"
element 1479 "Name" "Col0[692]"
element 1479 "Value" "9.988"
element 1480 "Name" "Col0[693]"
element 1480 "Value" "11.02"
element 1481 "Name" "Col0[694]"
element 1481 "Value" "11.99"
element 1482 "Name" "Col0[695]"
element 1482 "Value" "13.01"
element 1483 "Name" "Col0[696]"
element 1483 "Value" "14.03"
element 1484 "Name" "Col0[697]"
element 1484 "Value" "15.02"
element 1485 "Name" "Col0[698]"
element 1485 "Value" "16.04"
element 1486 "Name" "Col0[699]"
element 1486 "Value" "17.03"
element 1487 "Name" "Col0[700]"
element 1487 "Value" "18.01"
element 1488 "Name" "Col0[701]"
element 1488 "Value" "19.02"
element 1489 "Name" "Col0[702]"
element 1489 "Value" "20.02"
element 1490 "Name" "Col0[703]"
element 1490 "Value" "21.00"
element 1491 "Name" "Col0[704]"
element 1491 "Value" "22.00"
element 1492 "Name" "Col0[705]"
element 1492 "Value" "23.01"
element 1493 "Name" "Col0[706]"
element 1493 "Value" "24.01"
element 1494 "Name" "Col0[707]"
element 1494 "Value" "25.02"
element 1495 "Name" "Col0[708]"
element 1495 "Value" "26.00"
element 1496 "Name" "Col0[709]"
element 1496 "Value" "27.02"
element 1497 "Name" "Col0[710]"
element 1497 "Value" "27.99"
element 1498 "Name" "Col0[711]"
element 1498 "Value" "-20.73m"
element 1499 "Name" "Col0[712]"
element 1499 "Value" "960.1m"
element 1500 "Name" "Col0[713]"
element 1500 "Value" "2.045"
element 1501 "Name" "Col0[714]"
element 1501 "Value" "3.041"
element 1502 "Name" "Col0[715]"
element 1502 "Value" "4.003"
element 1503 "Name" "Col0[716]"
element 1503 "Value" "5.038"
element 1504 "Name" "Col0[717]"
element 1504 "Value" "6.019"
element 1505 "Name" "Col0[718]"
element 1505 "Value" "7.004"
element 1506 "Name" "Col0[719]"
element 1506 "Value" "7.937"
element 1507 "Name" "Col0[720]"
element 1507 "Value" "8.986"
element 1508 "Name" "Col0[721]"
element 1508 "Value" "9.963"
element 1509 "Name" "Col0[722]"
element 1509 "Value" "10.99"
element 1510 "Name" "Col0[723]"
element 1510 "Value" "12.00"
element 1511 "Name" "Col0[724]"
element 1511 "Value" "13.02"
element 1512 "Name" "Col0[725]"
element 1512 "Value" "14.03"
element 1513 "Name" "Col0[726]"
element 1513 "Value" "15.03"
element 1514 "Name" "Col0[727]"
element 1514 "Value" "16.00"
element 1515 "Name" "Col0[728]"
element 1515 "Value" "17.01"
element 1516 "Name" "Col0[729]"
element 1516 "Value" "18.02"
element 1517 "Name" "Col0[730]"
element 1517 "Value" "19.00"
element 1518 "Name" "Col0[731]"
element 1518 "Value" "20.02"
element 1519 "Name" "Col0[732]"
element 1519 "Value" "21.03"
element 1520 "Name" "Col0[733]"
element 1520 "Value" "22.04"
element 1521 "Name" "Col0[734]"
element 1521 "Value" "23.02"
element 1522 "Name" "Col0[735]"
element 1522 "Value" "24.02"
element 1523 "Name" "Col0[736]"
element 1523 "Value" "25.03"
element 1524 "Name" "Col0[737]"
element 1524 "Value" "25.98"
element 1525 "Name" "Col0[738]"
element 1525 "Value" "-22.12m"
element 1526 "Name" "Col0[739]"
element 1526 "Value" "952.9m"
element 1527 "Name" "Col0[740]"
element 1527 "Value" "2.005"
element 1528 "Name" "Col0[741]"
element 1528 "Value" "3.041"
element 1529 "Name" "Col0[742]"
element 1529 "Value" "4.013"
element 1530 "Name" "Col0[743]"
element 1530 "Value" "5.024"
element 1531 "Name" "Col0[744]"
element 1531 "Value" "6.012"
element 1532 "Name" "Col0[745]"
element 1532 "Value" "6.997"
element 1533 "Name" "Col0[746]"
element 1533 "Value" "7.939"
element 1534 "Name" "Col0[747]"
element 1534 "Value" "8.972"
element 1535 "Name" "Col0[748]"
element 1535 "Value" "9.972"
element 1536 "Name" "Col0[749]"
element 1536 "Value" "11.00"
element 1537 "Name" "Col0[750]"
element 1537 "Value" "12.00"
element 1538 "Name" "Col0[751]"
element 1538 "Value" "13.00"
element 1539 "Name" "Col0[752]"
element 1539 "Value" "14.03"
element 1540 "Name" "Col0[753]"
element 1540 "Value" "15.00"
element 1541 "Name" "Col0[754]"
element 1541 "Value" "16.03"
element 1542 "Name" "Col0[755]"
element 1542 "Value" "17.01"
element 1543 "Name" "Col0[756]"
element 1543 "Value" "18.02"
element 1544 "Name" "Col0[757]"
element 1544 "Value" "19.03"
element 1545 "Name" "Col0[758]"
element 1545 "Value" "20.00"
element 1546 "Name" "Col0[759]"
element 1546 "Value" "21.03"
element 1547 "Name" "Col0[760]"
element 1547 "Value" "22.01"
element 1548 "Name" "Col0[761]"
element 1548 "Value" "23.02"
element 1549 "Name" "Col0[762]"
element 1549 "Value" "24.00"
element 1550 "Name" "Col0"
element 1550 "Value" "ICCAP_ARRAY[763]"
element 1551 "Name" "Col1[0]"
element 1551 "Value" "-4.959"
element 1552 "Name" "Col1[1]"
element 1552 "Value" "-4.959"
element 1553 "Name" "Col1[2]"
element 1553 "Value" "-4.960"
element 1554 "Name" "Col1[3]"
element 1554 "Value" "-4.959"
element 1555 "Name" "Col1[4]"
element 1555 "Value" "-4.960"
element 1556 "Name" "Col1[5]"
element 1556 "Value" "-4.960"
element 1557 "Name" "Col1[6]"
element 1557 "Value" "-4.960"
element 1558 "Name" "Col1[7]"
element 1558 "Value" "-4.961"
element 1559 "Name" "Col1[8]"
element 1559 "Value" "-4.961"
element 1560 "Name" "Col1[9]"
element 1560 "Value" "-4.960"
element 1561 "Name" "Col1[10]"
element 1561 "Value" "-4.959"
element 1562 "Name" "Col1[11]"
element 1562 "Value" "-4.960"
element 1563 "Name" "Col1[12]"
element 1563 "Value" "-4.960"
element 1564 "Name" "Col1[13]"
element 1564 "Value" "-4.960"
element 1565 "Name" "Col1[14]"
element 1565 "Value" "-4.960"
element 1566 "Name" "Col1[15]"
element 1566 "Value" "-4.959"
element 1567 "Name" "Col1[16]"
element 1567 "Value" "-4.963"
element 1568 "Name" "Col1[17]"
element 1568 "Value" "-4.959"
element 1569 "Name" "Col1[18]"
element 1569 "Value" "-4.960"
element 1570 "Name" "Col1[19]"
element 1570 "Value" "-4.962"
element 1571 "Name" "Col1[20]"
element 1571 "Value" "-4.959"
element 1572 "Name" "Col1[21]"
element 1572 "Value" "-4.960"
element 1573 "Name" "Col1[22]"
element 1573 "Value" "-4.959"
element 1574 "Name" "Col1[23]"
element 1574 "Value" "-4.960"
element 1575 "Name" "Col1[24]"
element 1575 "Value" "-4.959"
element 1576 "Name" "Col1[25]"
element 1576 "Value" "-4.960"
element 1577 "Name" "Col1[26]"
element 1577 "Value" "-4.960"
element 1578 "Name" "Col1[27]"
element 1578 "Value" "-4.960"
element 1579 "Name" "Col1[28]"
element 1579 "Value" "-4.959"
element 1580 "Name" "Col1[29]"
element 1580 "Value" "-4.959"
element 1581 "Name" "Col1[30]"
element 1581 "Value" "-4.962"
element 1582 "Name" "Col1[31]"
element 1582 "Value" "-4.748"
element 1583 "Name" "Col1[32]"
element 1583 "Value" "-4.748"
element 1584 "Name" "Col1[33]"
element 1584 "Value" "-4.748"
element 1585 "Name" "Col1[34]"
element 1585 "Value" "-4.749"
element 1586 "Name" "Col1[35]"
element 1586 "Value" "-4.751"
element 1587 "Name" "Col1[36]"
element 1587 "Value" "-4.748"
element 1588 "Name" "Col1[37]"
element 1588 "Value" "-4.750"
element 1589 "Name" "Col1[38]"
element 1589 "Value" "-4.747"
element 1590 "Name" "Col1[39]"
element 1590 "Value" "-4.747"
element 1591 "Name" "Col1[40]"
element 1591 "Value" "-4.748"
element 1592 "Name" "Col1[41]"
element 1592 "Value" "-4.747"
element 1593 "Name" "Col1[42]"
element 1593 "Value" "-4.748"
element 1594 "Name" "Col1[43]"
element 1594 "Value" "-4.747"
element 1595 "Name" "Col1[44]"
element 1595 "Value" "-4.747"
element 1596 "Name" "Col1[45]"
element 1596 "Value" "-4.749"
element 1597 "Name" "Col1[46]"
element 1597 "Value" "-4.749"
element 1598 "Name" "Col1[47]"
element 1598 "Value" "-4.749"
element 1599 "Name" "Col1[48]"
element 1599 "Value" "-4.749"
element 1600 "Name" "Col1[49]"
element 1600 "Value" "-4.749"
element 1601 "Name" "Col1[50]"
element 1601 "Value" "-4.748"
element 1602 "Name" "Col1[51]"
element 1602 "Value" "-4.749"
element 1603 "Name" "Col1[52]"
element 1603 "Value" "-4.748"
element 1604 "Name" "Col1[53]"
element 1604 "Value" "-4.750"
element 1605 "Name" "Col1[54]"
element 1605 "Value" "-4.749"
element 1606 "Name" "Col1[55]"
element 1606 "Value" "-4.748"
element 1607 "Name" "Col1[56]"
element 1607 "Value" "-4.748"
element 1608 "Name" "Col1[57]"
element 1608 "Value" "-4.749"
element 1609 "Name" "Col1[58]"
element 1609 "Value" "-4.748"
element 1610 "Name" "Col1[59]"
element 1610 "Value" "-4.748"
element 1611 "Name" "Col1[60]"
element 1611 "Value" "-4.748"
element 1612 "Name" "Col1[61]"
element 1612 "Value" "-4.747"
element 1613 "Name" "Col1[62]"
element 1613 "Value" "-4.495"
element 1614 "Name" "Col1[63]"
element 1614 "Value" "-4.500"
element 1615 "Name" "Col1[64]"
element 1615 "Value" "-4.496"
element 1616 "Name" "Col1[65]"
element 1616 "Value" "-4.496"
element 1617 "Name" "Col1[66]"
element 1617 "Value" "-4.496"
element 1618 "Name" "Col1[67]"
element 1618 "Value" "-4.496"
element 1619 "Name" "Col1[68]"
element 1619 "Value" "-4.497"
element 1620 "Name" "Col1[69]"
element 1620 "Value" "-4.495"
element 1621 "Name" "Col1[70]"
element 1621 "Value" "-4.495"
element 1622 "Name" "Col1[71]"
element 1622 "Value" "-4.498"
element 1623 "Name" "Col1[72]"
element 1623 "Value" "-4.496"
element 1624 "Name" "Col1[73]"
element 1624 "Value" "-4.499"
element 1625 "Name" "Col1[74]"
element 1625 "Value" "-4.496"
element 1626 "Name" "Col1[75]"
element 1626 "Value" "-4.496"
element 1627 "Name" "Col1[76]"
element 1627 "Value" "-4.496"
element 1628 "Name" "Col1[77]"
element 1628 "Value" "-4.497"
element 1629 "Name" "Col1[78]"
element 1629 "Value" "-4.496"
element 1630 "Name" "Col1[79]"
element 1630 "Value" "-4.496"
element 1631 "Name" "Col1[80]"
element 1631 "Value" "-4.495"
element 1632 "Name" "Col1[81]"
element 1632 "Value" "-4.497"
element 1633 "Name" "Col1[82]"
element 1633 "Value" "-4.496"
element 1634 "Name" "Col1[83]"
element 1634 "Value" "-4.496"
element 1635 "Name" "Col1[84]"
element 1635 "Value" "-4.496"
element 1636 "Name" "Col1[85]"
element 1636 "Value" "-4.496"
element 1637 "Name" "Col1[86]"
element 1637 "Value" "-4.496"
element 1638 "Name" "Col1[87]"
element 1638 "Value" "-4.495"
element 1639 "Name" "Col1[88]"
element 1639 "Value" "-4.496"
element 1640 "Name" "Col1[89]"
element 1640 "Value" "-4.496"
element 1641 "Name" "Col1[90]"
element 1641 "Value" "-4.496"
element 1642 "Name" "Col1[91]"
element 1642 "Value" "-4.497"
element 1643 "Name" "Col1[92]"
element 1643 "Value" "-4.496"
element 1644 "Name" "Col1[93]"
element 1644 "Value" "-4.249"
element 1645 "Name" "Col1[94]"
element 1645 "Value" "-4.247"
element 1646 "Name" "Col1[95]"
element 1646 "Value" "-4.250"
element 1647 "Name" "Col1[96]"
element 1647 "Value" "-4.249"
element 1648 "Name" "Col1[97]"
element 1648 "Value" "-4.249"
element 1649 "Name" "Col1[98]"
element 1649 "Value" "-4.248"
element 1650 "Name" "Col1[99]"
element 1650 "Value" "-4.247"
element 1651 "Name" "Col1[100]"
element 1651 "Value" "-4.249"
element 1652 "Name" "Col1[101]"
element 1652 "Value" "-4.248"
element 1653 "Name" "Col1[102]"
element 1653 "Value" "-4.247"
element 1654 "Name" "Col1[103]"
element 1654 "Value" "-4.250"
element 1655 "Name" "Col1[104]"
element 1655 "Value" "-4.248"
element 1656 "Name" "Col1[105]"
element 1656 "Value" "-4.250"
element 1657 "Name" "Col1[106]"
element 1657 "Value" "-4.250"
element 1658 "Name" "Col1[107]"
element 1658 "Value" "-4.247"
element 1659 "Name" "Col1[108]"
element 1659 "Value" "-4.248"
element 1660 "Name" "Col1[109]"
element 1660 "Value" "-4.248"
element 1661 "Name" "Col1[110]"
element 1661 "Value" "-4.248"
element 1662 "Name" "Col1[111]"
element 1662 "Value" "-4.248"
element 1663 "Name" "Col1[112]"
element 1663 "Value" "-4.247"
element 1664 "Name" "Col1[113]"
element 1664 "Value" "-4.248"
element 1665 "Name" "Col1[114]"
element 1665 "Value" "-4.248"
element 1666 "Name" "Col1[115]"
element 1666 "Value" "-4.247"
element 1667 "Name" "Col1[116]"
element 1667 "Value" "-4.249"
element 1668 "Name" "Col1[117]"
element 1668 "Value" "-4.248"
element 1669 "Name" "Col1[118]"
element 1669 "Value" "-4.248"
element 1670 "Name" "Col1[119]"
element 1670 "Value" "-4.249"
element 1671 "Name" "Col1[120]"
element 1671 "Value" "-4.248"
element 1672 "Name" "Col1[121]"
element 1672 "Value" "-4.248"
element 1673 "Name" "Col1[122]"
element 1673 "Value" "-4.248"
element 1674 "Name" "Col1[123]"
element 1674 "Value" "-4.248"
element 1675 "Name" "Col1[124]"
element 1675 "Value" "-4.005"
element 1676 "Name" "Col1[125]"
element 1676 "Value" "-4.005"
element 1677 "Name" "Col1[126]"
element 1677 "Value" "-4.007"
element 1678 "Name" "Col1[127]"
element 1678 "Value" "-4.006"
element 1679 "Name" "Col1[128]"
element 1679 "Value" "-4.007"
element 1680 "Name" "Col1[129]"
element 1680 "Value" "-4.006"
element 1681 "Name" "Col1[130]"
element 1681 "Value" "-4.006"
element 1682 "Name" "Col1[131]"
element 1682 "Value" "-4.005"
element 1683 "Name" "Col1[132]"
element 1683 "Value" "-4.006"
element 1684 "Name" "Col1[133]"
element 1684 "Value" "-4.007"
element 1685 "Name" "Col1[134]"
element 1685 "Value" "-4.006"
element 1686 "Name" "Col1[135]"
element 1686 "Value" "-4.007"
element 1687 "Name" "Col1[136]"
element 1687 "Value" "-4.007"
element 1688 "Name" "Col1[137]"
element 1688 "Value" "-4.007"
element 1689 "Name" "Col1[138]"
element 1689 "Value" "-4.006"
element 1690 "Name" "Col1[139]"
element 1690 "Value" "-4.006"
element 1691 "Name" "Col1[140]"
element 1691 "Value" "-4.006"
element 1692 "Name" "Col1[141]"
element 1692 "Value" "-4.006"
element 1693 "Name" "Col1[142]"
element 1693 "Value" "-4.006"
element 1694 "Name" "Col1[143]"
element 1694 "Value" "-4.007"
element 1695 "Name" "Col1[144]"
element 1695 "Value" "-4.006"
element 1696 "Name" "Col1[145]"
element 1696 "Value" "-4.007"
element 1697 "Name" "Col1[146]"
element 1697 "Value" "-4.005"
element 1698 "Name" "Col1[147]"
element 1698 "Value" "-4.006"
element 1699 "Name" "Col1[148]"
element 1699 "Value" "-4.008"
element 1700 "Name" "Col1[149]"
element 1700 "Value" "-4.007"
element 1701 "Name" "Col1[150]"
element 1701 "Value" "-4.006"
element 1702 "Name" "Col1[151]"
element 1702 "Value" "-4.005"
element 1703 "Name" "Col1[152]"
element 1703 "Value" "-4.006"
element 1704 "Name" "Col1[153]"
element 1704 "Value" "-4.006"
element 1705 "Name" "Col1[154]"
element 1705 "Value" "-4.005"
element 1706 "Name" "Col1[155]"
element 1706 "Value" "-3.747"
element 1707 "Name" "Col1[156]"
element 1707 "Value" "-3.748"
element 1708 "Name" "Col1[157]"
element 1708 "Value" "-3.748"
element 1709 "Name" "Col1[158]"
element 1709 "Value" "-3.748"
element 1710 "Name" "Col1[159]"
element 1710 "Value" "-3.748"
element 1711 "Name" "Col1[160]"
element 1711 "Value" "-3.750"
element 1712 "Name" "Col1[161]"
element 1712 "Value" "-3.748"
element 1713 "Name" "Col1[162]"
element 1713 "Value" "-3.749"
element 1714 "Name" "Col1[163]"
element 1714 "Value" "-3.748"
element 1715 "Name" "Col1[164]"
element 1715 "Value" "-3.749"
element 1716 "Name" "Col1[165]"
element 1716 "Value" "-3.749"
element 1717 "Name" "Col1[166]"
element 1717 "Value" "-3.748"
element 1718 "Name" "Col1[167]"
element 1718 "Value" "-3.748"
element 1719 "Name" "Col1[168]"
element 1719 "Value" "-3.750"
element 1720 "Name" "Col1[169]"
element 1720 "Value" "-3.749"
element 1721 "Name" "Col1[170]"
element 1721 "Value" "-3.748"
element 1722 "Name" "Col1[171]"
element 1722 "Value" "-3.749"
element 1723 "Name" "Col1[172]"
element 1723 "Value" "-3.750"
element 1724 "Name" "Col1[173]"
element 1724 "Value" "-3.749"
element 1725 "Name" "Col1[174]"
element 1725 "Value" "-3.748"
element 1726 "Name" "Col1[175]"
element 1726 "Value" "-3.749"
element 1727 "Name" "Col1[176]"
element 1727 "Value" "-3.749"
element 1728 "Name" "Col1[177]"
element 1728 "Value" "-3.748"
element 1729 "Name" "Col1[178]"
element 1729 "Value" "-3.749"
element 1730 "Name" "Col1[179]"
element 1730 "Value" "-3.748"
element 1731 "Name" "Col1[180]"
element 1731 "Value" "-3.748"
element 1732 "Name" "Col1[181]"
element 1732 "Value" "-3.749"
element 1733 "Name" "Col1[182]"
element 1733 "Value" "-3.747"
element 1734 "Name" "Col1[183]"
element 1734 "Value" "-3.748"
element 1735 "Name" "Col1[184]"
element 1735 "Value" "-3.748"
element 1736 "Name" "Col1[185]"
element 1736 "Value" "-3.748"
element 1737 "Name" "Col1[186]"
element 1737 "Value" "-3.487"
element 1738 "Name" "Col1[187]"
element 1738 "Value" "-3.488"
element 1739 "Name" "Col1[188]"
element 1739 "Value" "-3.488"
element 1740 "Name" "Col1[189]"
element 1740 "Value" "-3.488"
element 1741 "Name" "Col1[190]"
element 1741 "Value" "-3.488"
element 1742 "Name" "Col1[191]"
element 1742 "Value" "-3.487"
element 1743 "Name" "Col1[192]"
element 1743 "Value" "-3.487"
element 1744 "Name" "Col1[193]"
element 1744 "Value" "-3.487"
element 1745 "Name" "Col1[194]"
element 1745 "Value" "-3.487"
element 1746 "Name" "Col1[195]"
element 1746 "Value" "-3.489"
element 1747 "Name" "Col1[196]"
element 1747 "Value" "-3.487"
element 1748 "Name" "Col1[197]"
element 1748 "Value" "-3.487"
element 1749 "Name" "Col1[198]"
element 1749 "Value" "-3.487"
element 1750 "Name" "Col1[199]"
element 1750 "Value" "-3.489"
element 1751 "Name" "Col1[200]"
element 1751 "Value" "-3.488"
element 1752 "Name" "Col1[201]"
element 1752 "Value" "-3.489"
element 1753 "Name" "Col1[202]"
element 1753 "Value" "-3.488"
element 1754 "Name" "Col1[203]"
element 1754 "Value" "-3.487"
element 1755 "Name" "Col1[204]"
element 1755 "Value" "-3.488"
element 1756 "Name" "Col1[205]"
element 1756 "Value" "-3.488"
element 1757 "Name" "Col1[206]"
element 1757 "Value" "-3.488"
element 1758 "Name" "Col1[207]"
element 1758 "Value" "-3.488"
element 1759 "Name" "Col1[208]"
element 1759 "Value" "-3.488"
element 1760 "Name" "Col1[209]"
element 1760 "Value" "-3.488"
element 1761 "Name" "Col1[210]"
element 1761 "Value" "-3.488"
element 1762 "Name" "Col1[211]"
element 1762 "Value" "-3.487"
element 1763 "Name" "Col1[212]"
element 1763 "Value" "-3.487"
element 1764 "Name" "Col1[213]"
element 1764 "Value" "-3.487"
element 1765 "Name" "Col1[214]"
element 1765 "Value" "-3.488"
element 1766 "Name" "Col1[215]"
element 1766 "Value" "-3.487"
element 1767 "Name" "Col1[216]"
element 1767 "Value" "-3.489"
element 1768 "Name" "Col1[217]"
element 1768 "Value" "-3.234"
element 1769 "Name" "Col1[218]"
element 1769 "Value" "-3.236"
element 1770 "Name" "Col1[219]"
element 1770 "Value" "-3.237"
element 1771 "Name" "Col1[220]"
element 1771 "Value" "-3.237"
element 1772 "Name" "Col1[221]"
element 1772 "Value" "-3.236"
element 1773 "Name" "Col1[222]"
element 1773 "Value" "-3.236"
element 1774 "Name" "Col1[223]"
element 1774 "Value" "-3.235"
element 1775 "Name" "Col1[224]"
element 1775 "Value" "-3.235"
element 1776 "Name" "Col1[225]"
element 1776 "Value" "-3.236"
element 1777 "Name" "Col1[226]"
element 1777 "Value" "-3.236"
element 1778 "Name" "Col1[227]"
element 1778 "Value" "-3.236"
element 1779 "Name" "Col1[228]"
element 1779 "Value" "-3.235"
element 1780 "Name" "Col1[229]"
element 1780 "Value" "-3.235"
element 1781 "Name" "Col1[230]"
element 1781 "Value" "-3.235"
element 1782 "Name" "Col1[231]"
element 1782 "Value" "-3.236"
element 1783 "Name" "Col1[232]"
element 1783 "Value" "-3.236"
element 1784 "Name" "Col1[233]"
element 1784 "Value" "-3.235"
element 1785 "Name" "Col1[234]"
element 1785 "Value" "-3.234"
element 1786 "Name" "Col1[235]"
element 1786 "Value" "-3.236"
element 1787 "Name" "Col1[236]"
element 1787 "Value" "-3.236"
element 1788 "Name" "Col1[237]"
element 1788 "Value" "-3.235"
element 1789 "Name" "Col1[238]"
element 1789 "Value" "-3.238"
element 1790 "Name" "Col1[239]"
element 1790 "Value" "-3.236"
element 1791 "Name" "Col1[240]"
element 1791 "Value" "-3.236"
element 1792 "Name" "Col1[241]"
element 1792 "Value" "-3.236"
element 1793 "Name" "Col1[242]"
element 1793 "Value" "-3.235"
element 1794 "Name" "Col1[243]"
element 1794 "Value" "-3.236"
element 1795 "Name" "Col1[244]"
element 1795 "Value" "-3.236"
element 1796 "Name" "Col1[245]"
element 1796 "Value" "-3.238"
element 1797 "Name" "Col1[246]"
element 1797 "Value" "-3.237"
element 1798 "Name" "Col1[247]"
element 1798 "Value" "-3.236"
element 1799 "Name" "Col1[248]"
element 1799 "Value" "-2.984"
element 1800 "Name" "Col1[249]"
element 1800 "Value" "-2.984"
element 1801 "Name" "Col1[250]"
element 1801 "Value" "-2.984"
element 1802 "Name" "Col1[251]"
element 1802 "Value" "-2.984"
element 1803 "Name" "Col1[252]"
element 1803 "Value" "-2.985"
element 1804 "Name" "Col1[253]"
element 1804 "Value" "-2.984"
element 1805 "Name" "Col1[254]"
element 1805 "Value" "-2.985"
element 1806 "Name" "Col1[255]"
element 1806 "Value" "-2.983"
element 1807 "Name" "Col1[256]"
element 1807 "Value" "-2.984"
element 1808 "Name" "Col1[257]"
element 1808 "Value" "-2.984"
element 1809 "Name" "Col1[258]"
element 1809 "Value" "-2.984"
element 1810 "Name" "Col1[259]"
element 1810 "Value" "-2.985"
element 1811 "Name" "Col1[260]"
element 1811 "Value" "-2.986"
element 1812 "Name" "Col1[261]"
element 1812 "Value" "-2.985"
element 1813 "Name" "Col1[262]"
element 1813 "Value" "-2.985"
element 1814 "Name" "Col1[263]"
element 1814 "Value" "-2.985"
element 1815 "Name" "Col1[264]"
element 1815 "Value" "-2.984"
element 1816 "Name" "Col1[265]"
element 1816 "Value" "-2.984"
element 1817 "Name" "Col1[266]"
element 1817 "Value" "-2.985"
element 1818 "Name" "Col1[267]"
element 1818 "Value" "-2.984"
element 1819 "Name" "Col1[268]"
element 1819 "Value" "-2.985"
element 1820 "Name" "Col1[269]"
element 1820 "Value" "-2.985"
element 1821 "Name" "Col1[270]"
element 1821 "Value" "-2.984"
element 1822 "Name" "Col1[271]"
element 1822 "Value" "-2.984"
element 1823 "Name" "Col1[272]"
element 1823 "Value" "-2.985"
element 1824 "Name" "Col1[273]"
element 1824 "Value" "-2.985"
element 1825 "Name" "Col1[274]"
element 1825 "Value" "-2.986"
element 1826 "Name" "Col1[275]"
element 1826 "Value" "-2.985"
element 1827 "Name" "Col1[276]"
element 1827 "Value" "-2.986"
element 1828 "Name" "Col1[277]"
element 1828 "Value" "-2.985"
element 1829 "Name" "Col1[278]"
element 1829 "Value" "-2.985"
element 1830 "Name" "Col1[279]"
element 1830 "Value" "-2.743"
element 1831 "Name" "Col1[280]"
element 1831 "Value" "-2.744"
element 1832 "Name" "Col1[281]"
element 1832 "Value" "-2.743"
element 1833 "Name" "Col1[282]"
element 1833 "Value" "-2.743"
element 1834 "Name" "Col1[283]"
element 1834 "Value" "-2.744"
element 1835 "Name" "Col1[284]"
element 1835 "Value" "-2.743"
element 1836 "Name" "Col1[285]"
element 1836 "Value" "-2.743"
element 1837 "Name" "Col1[286]"
element 1837 "Value" "-2.743"
element 1838 "Name" "Col1[287]"
element 1838 "Value" "-2.743"
element 1839 "Name" "Col1[288]"
element 1839 "Value" "-2.745"
element 1840 "Name" "Col1[289]"
element 1840 "Value" "-2.743"
element 1841 "Name" "Col1[290]"
element 1841 "Value" "-2.743"
element 1842 "Name" "Col1[291]"
element 1842 "Value" "-2.743"
element 1843 "Name" "Col1[292]"
element 1843 "Value" "-2.744"
element 1844 "Name" "Col1[293]"
element 1844 "Value" "-2.744"
element 1845 "Name" "Col1[294]"
element 1845 "Value" "-2.744"
element 1846 "Name" "Col1[295]"
element 1846 "Value" "-2.744"
element 1847 "Name" "Col1[296]"
element 1847 "Value" "-2.743"
element 1848 "Name" "Col1[297]"
element 1848 "Value" "-2.743"
element 1849 "Name" "Col1[298]"
element 1849 "Value" "-2.743"
element 1850 "Name" "Col1[299]"
element 1850 "Value" "-2.743"
element 1851 "Name" "Col1[300]"
element 1851 "Value" "-2.744"
element 1852 "Name" "Col1[301]"
element 1852 "Value" "-2.743"
element 1853 "Name" "Col1[302]"
element 1853 "Value" "-2.743"
element 1854 "Name" "Col1[303]"
element 1854 "Value" "-2.743"
element 1855 "Name" "Col1[304]"
element 1855 "Value" "-2.743"
element 1856 "Name" "Col1[305]"
element 1856 "Value" "-2.743"
element 1857 "Name" "Col1[306]"
element 1857 "Value" "-2.743"
element 1858 "Name" "Col1[307]"
element 1858 "Value" "-2.744"
element 1859 "Name" "Col1[308]"
element 1859 "Value" "-2.743"
element 1860 "Name" "Col1[309]"
element 1860 "Value" "-2.744"
element 1861 "Name" "Col1[310]"
element 1861 "Value" "-2.490"
element 1862 "Name" "Col1[311]"
element 1862 "Value" "-2.492"
element 1863 "Name" "Col1[312]"
element 1863 "Value" "-2.492"
element 1864 "Name" "Col1[313]"
element 1864 "Value" "-2.492"
element 1865 "Name" "Col1[314]"
element 1865 "Value" "-2.492"
element 1866 "Name" "Col1[315]"
element 1866 "Value" "-2.492"
element 1867 "Name" "Col1[316]"
element 1867 "Value" "-2.494"
element 1868 "Name" "Col1[317]"
element 1868 "Value" "-2.491"
element 1869 "Name" "Col1[318]"
element 1869 "Value" "-2.492"
element 1870 "Name" "Col1[319]"
element 1870 "Value" "-2.492"
element 1871 "Name" "Col1[320]"
element 1871 "Value" "-2.492"
element 1872 "Name" "Col1[321]"
element 1872 "Value" "-2.491"
element 1873 "Name" "Col1[322]"
element 1873 "Value" "-2.492"
element 1874 "Name" "Col1[323]"
element 1874 "Value" "-2.491"
element 1875 "Name" "Col1[324]"
element 1875 "Value" "-2.492"
element 1876 "Name" "Col1[325]"
element 1876 "Value" "-2.491"
element 1877 "Name" "Col1[326]"
element 1877 "Value" "-2.492"
element 1878 "Name" "Col1[327]"
element 1878 "Value" "-2.492"
element 1879 "Name" "Col1[328]"
element 1879 "Value" "-2.491"
element 1880 "Name" "Col1[329]"
element 1880 "Value" "-2.492"
element 1881 "Name" "Col1[330]"
element 1881 "Value" "-2.491"
element 1882 "Name" "Col1[331]"
element 1882 "Value" "-2.492"
element 1883 "Name" "Col1[332]"
element 1883 "Value" "-2.494"
element 1884 "Name" "Col1[333]"
element 1884 "Value" "-2.492"
element 1885 "Name" "Col1[334]"
element 1885 "Value" "-2.491"
element 1886 "Name" "Col1[335]"
element 1886 "Value" "-2.491"
element 1887 "Name" "Col1[336]"
element 1887 "Value" "-2.492"
element 1888 "Name" "Col1[337]"
element 1888 "Value" "-2.491"
element 1889 "Name" "Col1[338]"
element 1889 "Value" "-2.490"
element 1890 "Name" "Col1[339]"
element 1890 "Value" "-2.491"
element 1891 "Name" "Col1[340]"
element 1891 "Value" "-2.491"
element 1892 "Name" "Col1[341]"
element 1892 "Value" "-2.242"
element 1893 "Name" "Col1[342]"
element 1893 "Value" "-2.243"
element 1894 "Name" "Col1[343]"
element 1894 "Value" "-2.243"
element 1895 "Name" "Col1[344]"
element 1895 "Value" "-2.243"
element 1896 "Name" "Col1[345]"
element 1896 "Value" "-2.243"
element 1897 "Name" "Col1[346]"
element 1897 "Value" "-2.242"
element 1898 "Name" "Col1[347]"
element 1898 "Value" "-2.242"
element 1899 "Name" "Col1[348]"
element 1899 "Value" "-2.243"
element 1900 "Name" "Col1[349]"
element 1900 "Value" "-2.243"
element 1901 "Name" "Col1[350]"
element 1901 "Value" "-2.243"
element 1902 "Name" "Col1[351]"
element 1902 "Value" "-2.243"
element 1903 "Name" "Col1[352]"
element 1903 "Value" "-2.242"
element 1904 "Name" "Col1[353]"
element 1904 "Value" "-2.243"
element 1905 "Name" "Col1[354]"
element 1905 "Value" "-2.242"
element 1906 "Name" "Col1[355]"
element 1906 "Value" "-2.243"
element 1907 "Name" "Col1[356]"
element 1907 "Value" "-2.243"
element 1908 "Name" "Col1[357]"
element 1908 "Value" "-2.243"
element 1909 "Name" "Col1[358]"
element 1909 "Value" "-2.242"
element 1910 "Name" "Col1[359]"
element 1910 "Value" "-2.242"
element 1911 "Name" "Col1[360]"
element 1911 "Value" "-2.242"
element 1912 "Name" "Col1[361]"
element 1912 "Value" "-2.242"
element 1913 "Name" "Col1[362]"
element 1913 "Value" "-2.242"
element 1914 "Name" "Col1[363]"
element 1914 "Value" "-2.243"
element 1915 "Name" "Col1[364]"
element 1915 "Value" "-2.245"
element 1916 "Name" "Col1[365]"
element 1916 "Value" "-2.242"
element 1917 "Name" "Col1[366]"
element 1917 "Value" "-2.242"
element 1918 "Name" "Col1[367]"
element 1918 "Value" "-2.243"
element 1919 "Name" "Col1[368]"
element 1919 "Value" "-2.242"
element 1920 "Name" "Col1[369]"
element 1920 "Value" "-2.243"
element 1921 "Name" "Col1[370]"
element 1921 "Value" "-2.243"
element 1922 "Name" "Col1[371]"
element 1922 "Value" "-2.243"
element 1923 "Name" "Col1[372]"
element 1923 "Value" "-1.991"
element 1924 "Name" "Col1[373]"
element 1924 "Value" "-1.991"
element 1925 "Name" "Col1[374]"
element 1925 "Value" "-1.991"
element 1926 "Name" "Col1[375]"
element 1926 "Value" "-1.992"
element 1927 "Name" "Col1[376]"
element 1927 "Value" "-1.991"
element 1928 "Name" "Col1[377]"
element 1928 "Value" "-1.992"
element 1929 "Name" "Col1[378]"
element 1929 "Value" "-1.991"
element 1930 "Name" "Col1[379]"
element 1930 "Value" "-1.993"
element 1931 "Name" "Col1[380]"
element 1931 "Value" "-1.991"
element 1932 "Name" "Col1[381]"
element 1932 "Value" "-1.991"
element 1933 "Name" "Col1[382]"
element 1933 "Value" "-1.991"
element 1934 "Name" "Col1[383]"
element 1934 "Value" "-1.991"
element 1935 "Name" "Col1[384]"
element 1935 "Value" "-1.992"
element 1936 "Name" "Col1[385]"
element 1936 "Value" "-1.992"
element 1937 "Name" "Col1[386]"
element 1937 "Value" "-1.993"
element 1938 "Name" "Col1[387]"
element 1938 "Value" "-1.992"
element 1939 "Name" "Col1[388]"
element 1939 "Value" "-1.991"
element 1940 "Name" "Col1[389]"
element 1940 "Value" "-1.992"
element 1941 "Name" "Col1[390]"
element 1941 "Value" "-1.992"
element 1942 "Name" "Col1[391]"
element 1942 "Value" "-1.993"
element 1943 "Name" "Col1[392]"
element 1943 "Value" "-1.992"
element 1944 "Name" "Col1[393]"
element 1944 "Value" "-1.993"
element 1945 "Name" "Col1[394]"
element 1945 "Value" "-1.993"
element 1946 "Name" "Col1[395]"
element 1946 "Value" "-1.991"
element 1947 "Name" "Col1[396]"
element 1947 "Value" "-1.990"
element 1948 "Name" "Col1[397]"
element 1948 "Value" "-1.994"
element 1949 "Name" "Col1[398]"
element 1949 "Value" "-1.993"
element 1950 "Name" "Col1[399]"
element 1950 "Value" "-1.992"
element 1951 "Name" "Col1[400]"
element 1951 "Value" "-1.993"
element 1952 "Name" "Col1[401]"
element 1952 "Value" "-1.992"
element 1953 "Name" "Col1[402]"
element 1953 "Value" "-1.992"
element 1954 "Name" "Col1[403]"
element 1954 "Value" "-1.743"
element 1955 "Name" "Col1[404]"
element 1955 "Value" "-1.743"
element 1956 "Name" "Col1[405]"
element 1956 "Value" "-1.742"
element 1957 "Name" "Col1[406]"
element 1957 "Value" "-1.742"
element 1958 "Name" "Col1[407]"
element 1958 "Value" "-1.742"
element 1959 "Name" "Col1[408]"
element 1959 "Value" "-1.742"
element 1960 "Name" "Col1[409]"
element 1960 "Value" "-1.742"
element 1961 "Name" "Col1[410]"
element 1961 "Value" "-1.743"
element 1962 "Name" "Col1[411]"
element 1962 "Value" "-1.743"
element 1963 "Name" "Col1[412]"
element 1963 "Value" "-1.742"
element 1964 "Name" "Col1[413]"
element 1964 "Value" "-1.742"
element 1965 "Name" "Col1[414]"
element 1965 "Value" "-1.742"
element 1966 "Name" "Col1[415]"
element 1966 "Value" "-1.742"
element 1967 "Name" "Col1[416]"
element 1967 "Value" "-1.741"
element 1968 "Name" "Col1[417]"
element 1968 "Value" "-1.742"
element 1969 "Name" "Col1[418]"
element 1969 "Value" "-1.743"
element 1970 "Name" "Col1[419]"
element 1970 "Value" "-1.744"
element 1971 "Name" "Col1[420]"
element 1971 "Value" "-1.743"
element 1972 "Name" "Col1[421]"
element 1972 "Value" "-1.742"
element 1973 "Name" "Col1[422]"
element 1973 "Value" "-1.743"
element 1974 "Name" "Col1[423]"
element 1974 "Value" "-1.742"
element 1975 "Name" "Col1[424]"
element 1975 "Value" "-1.742"
element 1976 "Name" "Col1[425]"
element 1976 "Value" "-1.742"
element 1977 "Name" "Col1[426]"
element 1977 "Value" "-1.742"
element 1978 "Name" "Col1[427]"
element 1978 "Value" "-1.742"
element 1979 "Name" "Col1[428]"
element 1979 "Value" "-1.742"
element 1980 "Name" "Col1[429]"
element 1980 "Value" "-1.743"
element 1981 "Name" "Col1[430]"
element 1981 "Value" "-1.742"
element 1982 "Name" "Col1[431]"
element 1982 "Value" "-1.742"
element 1983 "Name" "Col1[432]"
element 1983 "Value" "-1.742"
element 1984 "Name" "Col1[433]"
element 1984 "Value" "-1.742"
element 1985 "Name" "Col1[434]"
element 1985 "Value" "-1.490"
element 1986 "Name" "Col1[435]"
element 1986 "Value" "-1.493"
element 1987 "Name" "Col1[436]"
element 1987 "Value" "-1.491"
element 1988 "Name" "Col1[437]"
element 1988 "Value" "-1.491"
element 1989 "Name" "Col1[438]"
element 1989 "Value" "-1.491"
element 1990 "Name" "Col1[439]"
element 1990 "Value" "-1.491"
element 1991 "Name" "Col1[440]"
element 1991 "Value" "-1.492"
element 1992 "Name" "Col1[441]"
element 1992 "Value" "-1.492"
element 1993 "Name" "Col1[442]"
element 1993 "Value" "-1.491"
element 1994 "Name" "Col1[443]"
element 1994 "Value" "-1.496"
element 1995 "Name" "Col1[444]"
element 1995 "Value" "-1.491"
element 1996 "Name" "Col1[445]"
element 1996 "Value" "-1.491"
element 1997 "Name" "Col1[446]"
element 1997 "Value" "-1.491"
element 1998 "Name" "Col1[447]"
element 1998 "Value" "-1.492"
element 1999 "Name" "Col1[448]"
element 1999 "Value" "-1.491"
element 2000 "Name" "Col1[449]"
element 2000 "Value" "-1.491"
element 2001 "Name" "Col1[450]"
element 2001 "Value" "-1.491"
element 2002 "Name" "Col1[451]"
element 2002 "Value" "-1.491"
element 2003 "Name" "Col1[452]"
element 2003 "Value" "-1.491"
element 2004 "Name" "Col1[453]"
element 2004 "Value" "-1.491"
element 2005 "Name" "Col1[454]"
element 2005 "Value" "-1.491"
element 2006 "Name" "Col1[455]"
element 2006 "Value" "-1.491"
element 2007 "Name" "Col1[456]"
element 2007 "Value" "-1.490"
element 2008 "Name" "Col1[457]"
element 2008 "Value" "-1.491"
element 2009 "Name" "Col1[458]"
element 2009 "Value" "-1.491"
element 2010 "Name" "Col1[459]"
element 2010 "Value" "-1.491"
element 2011 "Name" "Col1[460]"
element 2011 "Value" "-1.492"
element 2012 "Name" "Col1[461]"
element 2012 "Value" "-1.492"
element 2013 "Name" "Col1[462]"
element 2013 "Value" "-1.491"
element 2014 "Name" "Col1[463]"
element 2014 "Value" "-1.490"
element 2015 "Name" "Col1[464]"
element 2015 "Value" "-1.490"
element 2016 "Name" "Col1[465]"
element 2016 "Value" "-1.239"
element 2017 "Name" "Col1[466]"
element 2017 "Value" "-1.241"
element 2018 "Name" "Col1[467]"
element 2018 "Value" "-1.240"
element 2019 "Name" "Col1[468]"
element 2019 "Value" "-1.240"
element 2020 "Name" "Col1[469]"
element 2020 "Value" "-1.238"
element 2021 "Name" "Col1[470]"
element 2021 "Value" "-1.239"
element 2022 "Name" "Col1[471]"
element 2022 "Value" "-1.240"
element 2023 "Name" "Col1[472]"
element 2023 "Value" "-1.239"
element 2024 "Name" "Col1[473]"
element 2024 "Value" "-1.240"
element 2025 "Name" "Col1[474]"
element 2025 "Value" "-1.239"
element 2026 "Name" "Col1[475]"
element 2026 "Value" "-1.240"
element 2027 "Name" "Col1[476]"
element 2027 "Value" "-1.241"
element 2028 "Name" "Col1[477]"
element 2028 "Value" "-1.240"
element 2029 "Name" "Col1[478]"
element 2029 "Value" "-1.240"
element 2030 "Name" "Col1[479]"
element 2030 "Value" "-1.240"
element 2031 "Name" "Col1[480]"
element 2031 "Value" "-1.239"
element 2032 "Name" "Col1[481]"
element 2032 "Value" "-1.239"
element 2033 "Name" "Col1[482]"
element 2033 "Value" "-1.239"
element 2034 "Name" "Col1[483]"
element 2034 "Value" "-1.240"
element 2035 "Name" "Col1[484]"
element 2035 "Value" "-1.239"
element 2036 "Name" "Col1[485]"
element 2036 "Value" "-1.239"
element 2037 "Name" "Col1[486]"
element 2037 "Value" "-1.239"
element 2038 "Name" "Col1[487]"
element 2038 "Value" "-1.239"
element 2039 "Name" "Col1[488]"
element 2039 "Value" "-1.239"
element 2040 "Name" "Col1[489]"
element 2040 "Value" "-1.239"
element 2041 "Name" "Col1[490]"
element 2041 "Value" "-1.239"
element 2042 "Name" "Col1[491]"
element 2042 "Value" "-1.240"
element 2043 "Name" "Col1[492]"
element 2043 "Value" "-1.240"
element 2044 "Name" "Col1[493]"
element 2044 "Value" "-1.239"
element 2045 "Name" "Col1[494]"
element 2045 "Value" "-1.240"
element 2046 "Name" "Col1[495]"
element 2046 "Value" "-1.240"
element 2047 "Name" "Col1[496]"
element 2047 "Value" "-997.2m"
element 2048 "Name" "Col1[497]"
element 2048 "Value" "-997.6m"
element 2049 "Name" "Col1[498]"
element 2049 "Value" "-997.8m"
element 2050 "Name" "Col1[499]"
element 2050 "Value" "-1.001"
element 2051 "Name" "Col1[500]"
element 2051 "Value" "-997.3m"
element 2052 "Name" "Col1[501]"
element 2052 "Value" "-998.5m"
element 2053 "Name" "Col1[502]"
element 2053 "Value" "-1.001"
element 2054 "Name" "Col1[503]"
element 2054 "Value" "-998.6m"
element 2055 "Name" "Col1[504]"
element 2055 "Value" "-998.1m"
element 2056 "Name" "Col1[505]"
element 2056 "Value" "-999.2m"
element 2057 "Name" "Col1[506]"
element 2057 "Value" "-999.0m"
element 2058 "Name" "Col1[507]"
element 2058 "Value" "-998.6m"
element 2059 "Name" "Col1[508]"
element 2059 "Value" "-998.8m"
element 2060 "Name" "Col1[509]"
element 2060 "Value" "-997.9m"
element 2061 "Name" "Col1[510]"
element 2061 "Value" "-998.7m"
element 2062 "Name" "Col1[511]"
element 2062 "Value" "-1.000"
element 2063 "Name" "Col1[512]"
element 2063 "Value" "-998.8m"
element 2064 "Name" "Col1[513]"
element 2064 "Value" "-997.8m"
element 2065 "Name" "Col1[514]"
element 2065 "Value" "-998.0m"
element 2066 "Name" "Col1[515]"
element 2066 "Value" "-997.5m"
element 2067 "Name" "Col1[516]"
element 2067 "Value" "-998.2m"
element 2068 "Name" "Col1[517]"
element 2068 "Value" "-999.1m"
element 2069 "Name" "Col1[518]"
element 2069 "Value" "-1.000"
element 2070 "Name" "Col1[519]"
element 2070 "Value" "-998.1m"
element 2071 "Name" "Col1[520]"
element 2071 "Value" "-999.3m"
element 2072 "Name" "Col1[521]"
element 2072 "Value" "-998.7m"
element 2073 "Name" "Col1[522]"
element 2073 "Value" "-1.000"
element 2074 "Name" "Col1[523]"
element 2074 "Value" "-998.2m"
element 2075 "Name" "Col1[524]"
element 2075 "Value" "-998.5m"
element 2076 "Name" "Col1[525]"
element 2076 "Value" "-997.8m"
element 2077 "Name" "Col1[526]"
element 2077 "Value" "-998.6m"
element 2078 "Name" "Col1[527]"
element 2078 "Value" "-748.4m"
element 2079 "Name" "Col1[528]"
element 2079 "Value" "-750.1m"
element 2080 "Name" "Col1[529]"
element 2080 "Value" "-748.4m"
element 2081 "Name" "Col1[530]"
element 2081 "Value" "-748.9m"
element 2082 "Name" "Col1[531]"
element 2082 "Value" "-748.9m"
element 2083 "Name" "Col1[532]"
element 2083 "Value" "-749.4m"
element 2084 "Name" "Col1[533]"
element 2084 "Value" "-748.8m"
element 2085 "Name" "Col1[534]"
element 2085 "Value" "-749.5m"
element 2086 "Name" "Col1[535]"
element 2086 "Value" "-748.7m"
element 2087 "Name" "Col1[536]"
element 2087 "Value" "-749.9m"
element 2088 "Name" "Col1[537]"
element 2088 "Value" "-749.3m"
element 2089 "Name" "Col1[538]"
element 2089 "Value" "-749.0m"
element 2090 "Name" "Col1[539]"
element 2090 "Value" "-749.4m"
element 2091 "Name" "Col1[540]"
element 2091 "Value" "-748.9m"
element 2092 "Name" "Col1[541]"
element 2092 "Value" "-748.3m"
element 2093 "Name" "Col1[542]"
element 2093 "Value" "-748.5m"
element 2094 "Name" "Col1[543]"
element 2094 "Value" "-748.9m"
element 2095 "Name" "Col1[544]"
element 2095 "Value" "-749.2m"
element 2096 "Name" "Col1[545]"
element 2096 "Value" "-749.7m"
element 2097 "Name" "Col1[546]"
element 2097 "Value" "-749.0m"
element 2098 "Name" "Col1[547]"
element 2098 "Value" "-749.3m"
element 2099 "Name" "Col1[548]"
element 2099 "Value" "-747.6m"
element 2100 "Name" "Col1[549]"
element 2100 "Value" "-749.2m"
element 2101 "Name" "Col1[550]"
element 2101 "Value" "-748.5m"
element 2102 "Name" "Col1[551]"
element 2102 "Value" "-748.6m"
element 2103 "Name" "Col1[552]"
element 2103 "Value" "-749.2m"
element 2104 "Name" "Col1[553]"
element 2104 "Value" "-749.1m"
element 2105 "Name" "Col1[554]"
element 2105 "Value" "-749.1m"
element 2106 "Name" "Col1[555]"
element 2106 "Value" "-748.7m"
element 2107 "Name" "Col1[556]"
element 2107 "Value" "-748.5m"
element 2108 "Name" "Col1[557]"
element 2108 "Value" "-748.4m"
element 2109 "Name" "Col1[558]"
element 2109 "Value" "-498.5m"
element 2110 "Name" "Col1[559]"
element 2110 "Value" "-501.3m"
element 2111 "Name" "Col1[560]"
element 2111 "Value" "-499.4m"
element 2112 "Name" "Col1[561]"
element 2112 "Value" "-500.0m"
element 2113 "Name" "Col1[562]"
element 2113 "Value" "-499.3m"
element 2114 "Name" "Col1[563]"
element 2114 "Value" "-498.6m"
element 2115 "Name" "Col1[564]"
element 2115 "Value" "-499.2m"
element 2116 "Name" "Col1[565]"
element 2116 "Value" "-499.7m"
element 2117 "Name" "Col1[566]"
element 2117 "Value" "-500.0m"
element 2118 "Name" "Col1[567]"
element 2118 "Value" "-500.7m"
element 2119 "Name" "Col1[568]"
element 2119 "Value" "-499.4m"
element 2120 "Name" "Col1[569]"
element 2120 "Value" "-499.4m"
element 2121 "Name" "Col1[570]"
element 2121 "Value" "-499.1m"
element 2122 "Name" "Col1[571]"
element 2122 "Value" "-499.8m"
element 2123 "Name" "Col1[572]"
element 2123 "Value" "-499.5m"
element 2124 "Name" "Col1[573]"
element 2124 "Value" "-499.5m"
element 2125 "Name" "Col1[574]"
element 2125 "Value" "-499.6m"
element 2126 "Name" "Col1[575]"
element 2126 "Value" "-498.7m"
element 2127 "Name" "Col1[576]"
element 2127 "Value" "-499.8m"
element 2128 "Name" "Col1[577]"
element 2128 "Value" "-499.9m"
element 2129 "Name" "Col1[578]"
element 2129 "Value" "-499.5m"
element 2130 "Name" "Col1[579]"
element 2130 "Value" "-499.4m"
element 2131 "Name" "Col1[580]"
element 2131 "Value" "-499.4m"
element 2132 "Name" "Col1[581]"
element 2132 "Value" "-499.3m"
element 2133 "Name" "Col1[582]"
element 2133 "Value" "-499.0m"
element 2134 "Name" "Col1[583]"
element 2134 "Value" "-499.1m"
element 2135 "Name" "Col1[584]"
element 2135 "Value" "-499.4m"
element 2136 "Name" "Col1[585]"
element 2136 "Value" "-500.3m"
element 2137 "Name" "Col1[586]"
element 2137 "Value" "-499.1m"
element 2138 "Name" "Col1[587]"
element 2138 "Value" "-499.9m"
element 2139 "Name" "Col1[588]"
element 2139 "Value" "-498.8m"
element 2140 "Name" "Col1[589]"
element 2140 "Value" "-238.4m"
element 2141 "Name" "Col1[590]"
element 2141 "Value" "-239.6m"
element 2142 "Name" "Col1[591]"
element 2142 "Value" "-239.3m"
element 2143 "Name" "Col1[592]"
element 2143 "Value" "-238.4m"
element 2144 "Name" "Col1[593]"
element 2144 "Value" "-239.2m"
element 2145 "Name" "Col1[594]"
element 2145 "Value" "-238.8m"
element 2146 "Name" "Col1[595]"
element 2146 "Value" "-239.4m"
element 2147 "Name" "Col1[596]"
element 2147 "Value" "-239.0m"
element 2148 "Name" "Col1[597]"
element 2148 "Value" "-238.6m"
element 2149 "Name" "Col1[598]"
element 2149 "Value" "-238.3m"
element 2150 "Name" "Col1[599]"
element 2150 "Value" "-238.6m"
element 2151 "Name" "Col1[600]"
element 2151 "Value" "-238.4m"
element 2152 "Name" "Col1[601]"
element 2152 "Value" "-238.6m"
element 2153 "Name" "Col1[602]"
element 2153 "Value" "-239.4m"
element 2154 "Name" "Col1[603]"
element 2154 "Value" "-238.7m"
element 2155 "Name" "Col1[604]"
element 2155 "Value" "-239.1m"
element 2156 "Name" "Col1[605]"
element 2156 "Value" "-239.1m"
element 2157 "Name" "Col1[606]"
element 2157 "Value" "-238.9m"
element 2158 "Name" "Col1[607]"
element 2158 "Value" "-240.2m"
element 2159 "Name" "Col1[608]"
element 2159 "Value" "-238.8m"
element 2160 "Name" "Col1[609]"
element 2160 "Value" "-238.5m"
element 2161 "Name" "Col1[610]"
element 2161 "Value" "-238.7m"
element 2162 "Name" "Col1[611]"
element 2162 "Value" "-238.3m"
element 2163 "Name" "Col1[612]"
element 2163 "Value" "-238.5m"
element 2164 "Name" "Col1[613]"
element 2164 "Value" "-240.1m"
element 2165 "Name" "Col1[614]"
element 2165 "Value" "-238.5m"
element 2166 "Name" "Col1[615]"
element 2166 "Value" "-238.5m"
element 2167 "Name" "Col1[616]"
element 2167 "Value" "-238.6m"
element 2168 "Name" "Col1[617]"
element 2168 "Value" "-238.0m"
element 2169 "Name" "Col1[618]"
element 2169 "Value" "-238.8m"
element 2170 "Name" "Col1[619]"
element 2170 "Value" "-238.9m"
element 2171 "Name" "Col1[620]"
element 2171 "Value" "-672.5u"
element 2172 "Name" "Col1[621]"
element 2172 "Value" "2.260m"
element 2173 "Name" "Col1[622]"
element 2173 "Value" "5.097m"
element 2174 "Name" "Col1[623]"
element 2174 "Value" "5.143m"
element 2175 "Name" "Col1[624]"
element 2175 "Value" "4.770m"
element 2176 "Name" "Col1[625]"
element 2176 "Value" "5.281m"
element 2177 "Name" "Col1[626]"
element 2177 "Value" "5.328m"
element 2178 "Name" "Col1[627]"
element 2178 "Value" "4.741m"
element 2179 "Name" "Col1[628]"
element 2179 "Value" "5.157m"
element 2180 "Name" "Col1[629]"
element 2180 "Value" "5.389m"
element 2181 "Name" "Col1[630]"
element 2181 "Value" "4.999m"
element 2182 "Name" "Col1[631]"
element 2182 "Value" "5.557m"
element 2183 "Name" "Col1[632]"
element 2183 "Value" "4.806m"
element 2184 "Name" "Col1[633]"
element 2184 "Value" "4.817m"
element 2185 "Name" "Col1[634]"
element 2185 "Value" "1.492m"
element 2186 "Name" "Col1[635]"
element 2186 "Value" "3.662m"
element 2187 "Name" "Col1[636]"
element 2187 "Value" "4.120m"
element 2188 "Name" "Col1[637]"
element 2188 "Value" "5.514m"
element 2189 "Name" "Col1[638]"
element 2189 "Value" "5.252m"
element 2190 "Name" "Col1[639]"
element 2190 "Value" "5.430m"
element 2191 "Name" "Col1[640]"
element 2191 "Value" "6.288m"
element 2192 "Name" "Col1[641]"
element 2192 "Value" "3.224m"
element 2193 "Name" "Col1[642]"
element 2193 "Value" "5.283m"
element 2194 "Name" "Col1[643]"
element 2194 "Value" "4.582m"
element 2195 "Name" "Col1[644]"
element 2195 "Value" "5.053m"
element 2196 "Name" "Col1[645]"
element 2196 "Value" "5.518m"
element 2197 "Name" "Col1[646]"
element 2197 "Value" "4.869m"
element 2198 "Name" "Col1[647]"
element 2198 "Value" "5.047m"
element 2199 "Name" "Col1[648]"
element 2199 "Value" "3.760m"
element 2200 "Name" "Col1[649]"
element 2200 "Value" "5.983m"
element 2201 "Name" "Col1[650]"
element 2201 "Value" "3.725m"
element 2202 "Name" "Col1[651]"
element 2202 "Value" "218.1m"
element 2203 "Name" "Col1[652]"
element 2203 "Value" "216.6m"
element 2204 "Name" "Col1[653]"
element 2204 "Value" "216.6m"
element 2205 "Name" "Col1[654]"
element 2205 "Value" "216.3m"
element 2206 "Name" "Col1[655]"
element 2206 "Value" "217.9m"
element 2207 "Name" "Col1[656]"
element 2207 "Value" "217.8m"
element 2208 "Name" "Col1[657]"
element 2208 "Value" "218.1m"
element 2209 "Name" "Col1[658]"
element 2209 "Value" "217.8m"
element 2210 "Name" "Col1[659]"
element 2210 "Value" "217.0m"
element 2211 "Name" "Col1[660]"
element 2211 "Value" "217.7m"
element 2212 "Name" "Col1[661]"
element 2212 "Value" "216.9m"
element 2213 "Name" "Col1[662]"
element 2213 "Value" "215.7m"
element 2214 "Name" "Col1[663]"
element 2214 "Value" "218.0m"
element 2215 "Name" "Col1[664]"
element 2215 "Value" "217.3m"
element 2216 "Name" "Col1[665]"
element 2216 "Value" "218.4m"
element 2217 "Name" "Col1[666]"
element 2217 "Value" "217.4m"
element 2218 "Name" "Col1[667]"
element 2218 "Value" "217.4m"
element 2219 "Name" "Col1[668]"
element 2219 "Value" "217.3m"
element 2220 "Name" "Col1[669]"
element 2220 "Value" "218.1m"
element 2221 "Name" "Col1[670]"
element 2221 "Value" "218.8m"
element 2222 "Name" "Col1[671]"
element 2222 "Value" "217.5m"
element 2223 "Name" "Col1[672]"
element 2223 "Value" "218.0m"
element 2224 "Name" "Col1[673]"
element 2224 "Value" "217.8m"
element 2225 "Name" "Col1[674]"
element 2225 "Value" "216.8m"
element 2226 "Name" "Col1[675]"
element 2226 "Value" "218.6m"
element 2227 "Name" "Col1[676]"
element 2227 "Value" "218.4m"
element 2228 "Name" "Col1[677]"
element 2228 "Value" "217.9m"
element 2229 "Name" "Col1[678]"
element 2229 "Value" "217.4m"
element 2230 "Name" "Col1[679]"
element 2230 "Value" "215.4m"
element 2231 "Name" "Col1[680]"
element 2231 "Value" "217.2m"
element 2232 "Name" "Col1[681]"
element 2232 "Value" "217.6m"
element 2233 "Name" "Col1[682]"
element 2233 "Value" "509.1m"
element 2234 "Name" "Col1[683]"
element 2234 "Value" "508.1m"
element 2235 "Name" "Col1[684]"
element 2235 "Value" "508.6m"
element 2236 "Name" "Col1[685]"
element 2236 "Value" "508.9m"
element 2237 "Name" "Col1[686]"
element 2237 "Value" "507.8m"
element 2238 "Name" "Col1[687]"
element 2238 "Value" "506.9m"
element 2239 "Name" "Col1[688]"
element 2239 "Value" "506.5m"
element 2240 "Name" "Col1[689]"
element 2240 "Value" "507.4m"
element 2241 "Name" "Col1[690]"
element 2241 "Value" "508.8m"
element 2242 "Name" "Col1[691]"
element 2242 "Value" "505.9m"
element 2243 "Name" "Col1[692]"
element 2243 "Value" "508.6m"
element 2244 "Name" "Col1[693]"
element 2244 "Value" "508.7m"
element 2245 "Name" "Col1[694]"
element 2245 "Value" "508.7m"
element 2246 "Name" "Col1[695]"
element 2246 "Value" "507.8m"
element 2247 "Name" "Col1[696]"
element 2247 "Value" "508.2m"
element 2248 "Name" "Col1[697]"
element 2248 "Value" "508.3m"
element 2249 "Name" "Col1[698]"
element 2249 "Value" "508.8m"
element 2250 "Name" "Col1[699]"
element 2250 "Value" "509.1m"
element 2251 "Name" "Col1[700]"
element 2251 "Value" "509.1m"
element 2252 "Name" "Col1[701]"
element 2252 "Value" "508.0m"
element 2253 "Name" "Col1[702]"
element 2253 "Value" "507.9m"
element 2254 "Name" "Col1[703]"
element 2254 "Value" "508.9m"
element 2255 "Name" "Col1[704]"
element 2255 "Value" "508.2m"
element 2256 "Name" "Col1[705]"
element 2256 "Value" "509.2m"
element 2257 "Name" "Col1[706]"
element 2257 "Value" "507.9m"
element 2258 "Name" "Col1[707]"
element 2258 "Value" "508.7m"
element 2259 "Name" "Col1[708]"
element 2259 "Value" "508.7m"
element 2260 "Name" "Col1[709]"
element 2260 "Value" "508.7m"
element 2261 "Name" "Col1[710]"
element 2261 "Value" "509.1m"
element 2262 "Name" "Col1[711]"
element 2262 "Value" "750.4m"
element 2263 "Name" "Col1[712]"
element 2263 "Value" "750.0m"
element 2264 "Name" "Col1[713]"
element 2264 "Value" "749.9m"
element 2265 "Name" "Col1[714]"
element 2265 "Value" "749.6m"
element 2266 "Name" "Col1[715]"
element 2266 "Value" "748.8m"
element 2267 "Name" "Col1[716]"
element 2267 "Value" "748.8m"
element 2268 "Name" "Col1[717]"
element 2268 "Value" "749.9m"
element 2269 "Name" "Col1[718]"
element 2269 "Value" "749.9m"
element 2270 "Name" "Col1[719]"
element 2270 "Value" "748.0m"
element 2271 "Name" "Col1[720]"
element 2271 "Value" "747.6m"
element 2272 "Name" "Col1[721]"
element 2272 "Value" "750.0m"
element 2273 "Name" "Col1[722]"
element 2273 "Value" "749.9m"
element 2274 "Name" "Col1[723]"
element 2274 "Value" "750.5m"
element 2275 "Name" "Col1[724]"
element 2275 "Value" "750.0m"
element 2276 "Name" "Col1[725]"
element 2276 "Value" "749.9m"
element 2277 "Name" "Col1[726]"
element 2277 "Value" "749.3m"
element 2278 "Name" "Col1[727]"
element 2278 "Value" "749.3m"
element 2279 "Name" "Col1[728]"
element 2279 "Value" "750.7m"
element 2280 "Name" "Col1[729]"
element 2280 "Value" "750.6m"
element 2281 "Name" "Col1[730]"
element 2281 "Value" "750.1m"
element 2282 "Name" "Col1[731]"
element 2282 "Value" "750.2m"
element 2283 "Name" "Col1[732]"
element 2283 "Value" "749.1m"
element 2284 "Name" "Col1[733]"
element 2284 "Value" "750.2m"
element 2285 "Name" "Col1[734]"
element 2285 "Value" "749.8m"
element 2286 "Name" "Col1[735]"
element 2286 "Value" "750.2m"
element 2287 "Name" "Col1[736]"
element 2287 "Value" "749.4m"
element 2288 "Name" "Col1[737]"
element 2288 "Value" "750.5m"
element 2289 "Name" "Col1[738]"
element 2289 "Value" "997.3m"
element 2290 "Name" "Col1[739]"
element 2290 "Value" "998.7m"
element 2291 "Name" "Col1[740]"
element 2291 "Value" "998.3m"
element 2292 "Name" "Col1[741]"
element 2292 "Value" "998.0m"
element 2293 "Name" "Col1[742]"
element 2293 "Value" "997.2m"
element 2294 "Name" "Col1[743]"
element 2294 "Value" "998.8m"
element 2295 "Name" "Col1[744]"
element 2295 "Value" "998.2m"
element 2296 "Name" "Col1[745]"
element 2296 "Value" "998.1m"
element 2297 "Name" "Col1[746]"
element 2297 "Value" "997.8m"
element 2298 "Name" "Col1[747]"
element 2298 "Value" "998.3m"
element 2299 "Name" "Col1[748]"
element 2299 "Value" "999.5m"
element 2300 "Name" "Col1[749]"
element 2300 "Value" "998.2m"
element 2301 "Name" "Col1[750]"
element 2301 "Value" "998.8m"
element 2302 "Name" "Col1[751]"
element 2302 "Value" "998.4m"
element 2303 "Name" "Col1[752]"
element 2303 "Value" "997.3m"
element 2304 "Name" "Col1[753]"
element 2304 "Value" "998.1m"
element 2305 "Name" "Col1[754]"
element 2305 "Value" "998.4m"
element 2306 "Name" "Col1[755]"
element 2306 "Value" "998.6m"
element 2307 "Name" "Col1[756]"
element 2307 "Value" "999.3m"
element 2308 "Name" "Col1[757]"
element 2308 "Value" "998.3m"
element 2309 "Name" "Col1[758]"
element 2309 "Value" "998.3m"
element 2310 "Name" "Col1[759]"
element 2310 "Value" "997.7m"
element 2311 "Name" "Col1[760]"
element 2311 "Value" "998.2m"
element 2312 "Name" "Col1[761]"
element 2312 "Value" "998.7m"
element 2313 "Name" "Col1[762]"
element 2313 "Value" "999.3m"
element 2314 "Name" "Col1"
element 2314 "Value" "ICCAP_ARRAY[763]"
element 2315 "Name" ""
element 2315 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "GUI_ShowLSYNCs"
element 0 "Value" "TL|OR=VE|<none>|#16TL_top:#213TL_ShowLSYNCs|1|0"
element 1 "Name" "GUI_ShowLSYNCs.TL_top"
element 1 "Value" "TL|OR=HO|<none>|#213TL_EnterIndex:#13sep:#15space:#15BT_ok|1"
element 2 "Name" "GUI_ShowLSYNCs.TL_top.BT_ok"
element 2 "Value" "PB|CA=#18OK, Done:TO=FW&FH&TR|AC=#18gui_Done&#17Execute|<none>|0"
element 3 "Name" "GUI_ShowLSYNCs.TL_top.sep"
element 3 "Value" "SE|OR=VE:TO=FW&dummy|<none>|<none>|0"
element 4 "Name" "GUI_ShowLSYNCs.TL_top.space"
element 4 "Value" "TL|<none>|<none>|<none>|0"
element 5 "Name" "GUI_ShowLSYNCs.TL_top.TL_EnterIndex.LA_hits"
element 5 "Value" "LA|CA=#3175\075> SHOW LSYNC STIMULI VALUES <\075\012Enter the Plot Data Index (left-clicked mouse on data point)\012to highlight below the LSYNC values belonging to that Plot data point.|<none>|<none>|0"
element 6 "Name" "GUI_ShowLSYNCs.TL_top.TL_EnterIndex"
element 6 "Value" "TL|<none>|<none>|#17LA_hits:#214TL_enter_index|1"
element 7 "Name" "GUI_ShowLSYNCs.TL_top.TL_EnterIndex.TL_enter_index.ED_PlotIndex"
element 7 "Value" "ED|CO=5:VA=%#19PlotIndex:TO=FW&FH|EP=#216gui_IdentifyData&#17Execute|<none>|0"
element 8 "Name" "GUI_ShowLSYNCs.TL_top.TL_EnterIndex.TL_enter_index"
element 8 "Value" "TL|OR=HO|<none>|#212ED_PlotIndex:#18PB_Apply:#15space:#223CB_ShowMasterSweepIndex|1"
element 9 "Name" "GUI_ShowLSYNCs.TL_top.TL_EnterIndex.TL_enter_index.PB_Apply"
element 9 "Value" "PB|CA=#15Apply:TO=FW&FH|AC=#216gui_IdentifyData&#17Execute|<none>|0"
element 10 "Name" "GUI_ShowLSYNCs.TL_top.TL_EnterIndex.TL_enter_index.space"
element 10 "Value" "SE|OR=VE|<none>|<none>|0"
element 11 "Name" "GUI_ShowLSYNCs.TL_top.TL_EnterIndex.TL_enter_index.CB_ShowMasterSweepIndex"
element 11 "Value" "CB|CA=#240Show Value#  of 'MASTER Sweep' Input GUI:TO=FW&dummy:TS=%ShowMasterSweepIndex|<none>|<none>|0"
element 12 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs"
element 12 "Value" "TS|OR=HO|<none>|#216TL_PlotDataIndex:#17TL_Col0:#17TL_Col1|0"
element 13 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_PlotDataIndex"
element 13 "Value" "TL|CA=#15LSYNC:MF=%ShowMasterSweepIndex:OR=VE|<none>|#14LA_0:#212LI_DataIndex|0"
element 14 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_PlotDataIndex.LA_0"
element 14 "Value" "LA|CA=#213Value# in GUI:TO=FH&dummy|<none>|<none>|0"
element 15 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_PlotDataIndex.LI_DataIndex"
element 15 "Value" "LI|FG=C6:IT=%#19DataIndex:SX=%#16IndSel:VO=3:VI=%#212LsyncColSize|<none>|<none>|0"
element 16 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_Col0"
element 16 "Value" "TL|CA=#19 MASTER  :OR=VE|<none>|#210LA_ColName:#212LI_Instances|0"
element 17 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_Col0.LA_ColName"
element 17 "Value" "LA|CA=#19vd_pulsed:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 18 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_Col0.LI_Instances"
element 18 "Value" "LI|IT=%#14Col0:SX=%#16IndSel:VI=%#212LsyncColSize|<none>|<none>|0"
element 19 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_Col1"
element 19 "Value" "TL|CA=#18LSYNC #1:OR=VE|<none>|#210LA_ColName:#212LI_Instances|0"
element 20 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_Col1.LA_ColName"
element 20 "Value" "LA|CA=#19vg_pulsed:FG=C6:TO=FH&dummy|<none>|<none>|0"
element 21 "Name" "GUI_ShowLSYNCs.TL_ShowLSYNCs.TL_Col1.LI_Instances"
element 21 "Value" "LI|IT=%#14Col1:SX=%#16IndSel:VI=%#212LsyncColSize|<none>|<none>|0"
element 22 "Name" ""
element 22 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 
 ! This demo GUI assists in identifying Plot data 
 ! referring to multiple LSYNC Inputs.
 
 ! Typically idvd or idvg measurement data, 
 ! but also PCM data (Process Control Monitoring).
 
 
 ! When requested by the user, the index (starting with 1)
 ! of the MASTER Sweep Input is displayed.
 
 ! >>>NOTE <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 ! In the GUI of this Setup, the shown index refers 
 ! to the indexing of the LIST in the MASTER Sweep Input, 
 ! which starts with 1,
 ! while all other indexings in IC-CAP start with 0 !!!!!!
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! In your remote Modelfile, create a PEL program
 ! with the following line:
 
 
 
 Path2Setup = WHOIS(".", "Parent Setup")		!returns full path to calling, local SetupName
 ICCAP_FUNC("/UTILITIES/PLOT_UTILITIES/PLOT_SHOW_LSYNC_VALUES/PLOT_SHOW_LSYNC_VALUES", "Execute", VAL$(Path2Setup))
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "________________________0" "711.501"
{
}
LINK XFORM "PLOT_SHOW_LSYNC_VALUES" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 
 
 GET_STRING "Path to Setup", Path2Setup, Path2Setup
 
 !---reset all
 ErrMsg = ""
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 !---prepare GUI Settings
 ICCAP_FUNC("PrepareGuiSettings", "Execute")
 IF VAL$(ErrMsg)<>"" THEN RETURN_VALUE 0
 
 
 !---create GUI by PEL
 ICCAP_FUNC("CreateGui", "Execute")
 
 
 !---show GUI
 ICCAP_FUNC("./GUI_ShowLSYNCs", "Display Modeless GUI", "SHOW LSYNC VALUES")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "PrepareGuiSettings" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ErrMsg=""
 
 !---identify all Inputs
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", InputNames
 
 
 !---identify those Inputs which are of SweepType LSYNC or TLSYNC, incl. the LSYNC/TLSYNC MasterSweep
 LsyncColNames="ICCAP_ARRAY[0]"
 N=0
 i=0
 WHILE i < SIZEOF(InputNames)
   Path2Input=VAL$(Path2Setup)&"/"&VAL$(InputNames[i])
   IF (LOOKUP_TABLE_VAL(VAL$(Path2Input), "Sweep Type") == "LSYNC") OR (LOOKUP_TABLE_VAL(VAL$(Path2Input), "Sweep Type") == "TLSYNC") THEN
     IF N==0 THEN
       !---first find the MasterSweep
       LsyncColNames = "ICCAP_ARRAY["&VAL$(N+1)&"]"
       LsyncColNames[0] = LOOKUP_TABLE_VAL(VAL$(Path2Input), "Master Sweep")
       !---identify Nr.Points
       LsyncColSize=LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/"&VAL$(LsyncColNames[0]), "# of Values")
       MasterSweepIndex=LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/"&VAL$(LsyncColNames[0]), "Sweep Order")
       N = 1
     END IF
     !---add this Input to LsyncColNames
     LsyncColNames = "ICCAP_ARRAY["&VAL$(N+1)&"]"
     LsyncColNames[N] = InputNames[i]
     N = N + 1
   END IF
   i = i + 1
 END WHILE
 
 
 !---exit if no LSYNCs have been found
 IF SIZEOF(LsyncColNames)==0 THEN
   ErrMsg="ERROR: No Inputs of type 'LSYNC' found"
   GET_STRING "No Inputs of type 'LSYNC' found,
 	you should be able to read the stimuli values
 	directly from the Plot !  [OK]", dummy
   RETURN_VALUE 2
 END IF
 
 
 !---delete possibly existing old Colx arrays 
 ErrStr=""
 iCol=0
 WHILE ErrStr==""
   VarName="Col"&VAL$(iCol)
   dummy=LOOKUP_VAR(VAL$(VarName), ErrStr)
   IF VAL$(ErrStr)=="" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
     iCol = iCol + 1
   END IF
 END WHILE
 
 
 !now create the new Colx arrays and fill them with data of the LSYNC Inputs
 iCol=0
 WHILE iCol < SIZEOF(LsyncColNames)
   VarName="Col"&VAL$(iCol)
   ICCAP_FUNC(".", "CreateVariableTableVariable", VAL$(VarName))
   ICCAP_FUNC(".", "SetVariableTableValue", VAL$(VarName), "ICCAP_ARRAY["&VAL$(LsyncColSize)&"]")
   i=0
   WHILE i<LsyncColSize
     TmpVal = LOOKUP_TABLE_VAL(VAL$(Path2Setup)&"/"&VAL$(LsyncColNames[iCol]), "Value "&VAL$(i+1))		!LIST and thus LSYNC indexing starts with '1'
     ICCAP_FUNC(".", "SetVariableTableValue", "Col"&VAL$(iCol)&"["&VAL$(i)&"]",VAL$(TmpVal))
     i = i+ 1
   END WHILE
   iCol = iCol + 1
 END WHILE
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "CreateGui" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !First specify some useful local variables
 ParentName="./GUI_ShowLSYNCs"
 ChildName="TL_ShowLSYNCs"
 Path2MainGui=VAL$(ParentName)&"."&VAL$(ChildName)
 
 
 !---remove existing child GUI
 ICCAP_FUNC("./"&VAL$(Path2MainGui),"Delete")
 
 !---create a new child GUI (a scroll table)
 ChildObject="TS"	!###>ScrollTable
 ICCAP_FUNC(ParentName, "Add GUI", ChildName, ChildObject)
 !  Specify Orientation
 ICCAP_FUNC(Path2MainGui, "Set GUI Options", "OR=HO", "")
 
 !---Add incrementing data index for identifying Plot-left-clicked data with their LSYNC values in the GUI list
 DataIndex="ICCAP_ARRAY["&VAL$(LsyncColSize)&"]"
 i=0
 WHILE i < SIZEOF(DataIndex)
   DataIndex[i]=i+1	!LSYNC indexing starts with '1' !!!
   i = i + 1
 END WHILE
 !###add Table
 ChildObject ="TL"
 ChildName   ="TL_PlotDataIndex"
 ICCAP_FUNC(Path2MainGui, "Add GUI", ChildName, ChildObject)
 Path2Gui=VAL$(Path2MainGui)&"."&VAL$(ChildName)
 !  Specify Caption and Orientation
 ICCAP_FUNC(Path2Gui, "Set GUI Options", "CA=LSYNC", "OR=VE", "")
 !  Specify Visibility
 ICCAP_FUNC(Path2Gui, "Set GUI Options", "MF=%ShowMasterSweepIndex", "")
 !###Add Labels
 ICCAP_FUNC(Path2Gui, "Add GUI", "LA_0", "LA")
 ICCAP_FUNC(VAL$(Path2Gui)&".LA_0", "Set GUI Options", "CA=Value# in GUI", "TO=FH", "")
 !###add Data index List
 ChildObject ="LI"
 ChildName   ="LI_DataIndex"
 ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
 !  Specify Items, Sel.Indices, Sel.Policy, Vis.Items Count, Vis.Columns, Foreground Color blue (C6)
 Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
 ICCAP_FUNC(Path2Child, "Set GUI Options", "IT=DataIndex", "SX=%IndSel", "VI=%LsyncColSize", "VO=3", "FG=C6", "")
 
 
 
 !---Add Gui items for each LSYNC data column
 i=0
 WHILE i < SIZEOF(LsyncColNames)
   !###add Table
   ChildObject ="TL"
   ChildName   ="TL_Col"&VAL$(i)
   ICCAP_FUNC(Path2MainGui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Gui=VAL$(Path2MainGui)&"."&VAL$(ChildName)
   Caption="LSYNC #"&VAL$(i)
   IF i==0 THEN Caption=" MASTER  "
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "CA="&VAL$(Caption), "")
   !  Specify Orientation 
   ICCAP_FUNC(Path2Gui, "Set GUI Options", "OR=VE","")
 
   !###add Label ColumnName
   ChildObject ="LA"
   ChildName   ="LA_ColName"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Caption 
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA="&VAL$(LsyncColNames[i]), "FG=C6", "TO=FH", "")
 
 
   !###add List
   ChildObject ="LI"
   ChildName   ="LI_Instances"
   ICCAP_FUNC(Path2Gui, "Add GUI", ChildName, ChildObject)
   !  Specify Items, Sel.Indices, Sel.Policy, Vis.Items Count
   Path2Child=VAL$(Path2Gui)&"."&VAL$(ChildName)
   ICCAP_FUNC(Path2Child, "Set GUI Options", "IT=Col"&VAL$(i), "SX=%IndSel", "VI=%LsyncColSize", "")
 
 
   i = i + 1
 END WHILE
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_IdentifyData" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !This program identifies the LSYNC values related to a left-mouse-clicked PlotIndex data point
 
 !===The task is simple if LSYNC is associated with 1st order sweep
 IF MasterSweepIndex==1 THEN
   IF Debug<>0 THEN PRINT "LSYNC is 1st sweep"
   Swp1Pts=USERC_num_of_points(1, VAL$(Path2Setup))
   IndSel=PlotIndex-FLOOR(PlotIndex//Swp1Pts)*Swp1Pts	! for the formula, see Xfm 'test_DataindexGenerator'
   IF Debug<>0 THEN
     PRINT "Index to be marked (starting with 0) = ";IndSel
   END IF
 
   RETURN
 END IF
 
 
 
 !---Identify nr. of swept Inputs
 NrSweeps=1
 WHILE USERC_num_of_points(NrSweeps, VAL$(Path2Setup)) <> -1
   NrSweeps = NrSweeps + 1
 END WHILE
 NrSweeps = NrSweeps - 1
 IF Debug<>0 THEN PRINT "Data contains ";NrSweeps;" sweeps"
 
 
 !---Identify NrPts of every Sweep
 COMPLEX NrPts[NrSweeps]
 i=0
 WHILE i <NrSweeps
   NrPts[i]=USERC_num_of_points(i+1, VAL$(Path2Setup))
   IF Debug<>0 THEN PRINT "Sweep Nr.";i+1;" has ";NrPts[i];" data pts"
   i = i + 1
 END WHILE
 
 
 !===If LSYNC is associated with last sweep, apply the other special formula (see Xfm 'test_DataIndexGenerator')
 IF MasterSweepIndex==NrSweeps THEN
   IF Debug<>0 THEN PRINT "LSYNC is last sweep"
   NrPtsBelowLast=NrPts[0]
   i=1
   WHILE i < NrSweeps-1
     NrPtsBelowLast=NrPtsBelowLast*NrPts[i]
     i = i + 1
   END WHILE
   IndSel=FLOOR(PlotIndex//NrPtsBelowLast)
   IF Debug<>0 THEN
     PRINT "NrPtsBelowLast = ";NrPtsBelowLast
     PRINT "Index to be marked (starting with 0) = ";IndSel
   END IF
   RETURN
 END IF
 
 
 !===If LSYNC is neither first nor last sweep, we apply the complex formula (see Xfm 'test_DataindexGenerator')
 IF Debug<>0 THEN PRINT "LSYNC is neither first, nor last sweep, but ";MasterSweepIndex;".sweep"
 NrPtsBeforeLsync=NrPts[0]
 i=1
 WHILE i < MasterSweepIndex-1
   NrPtsBeforeLsync=NrPtsBeforeLsync*NrPts[i]
   i = i + 1
 END WHILE
 
 IndSel=FLOOR(PlotIndex//(NrPtsBeforeLsync))-FLOOR(PlotIndex//(NrPtsBeforeLsync*NrPts[MasterSweepIndex-1]))*NrPts[MasterSweepIndex-1]
 
 IF Debug<>0 THEN
   PRINT "NrPtsBeforeLsync = ";NrPtsBeforeLsync
   PRINT "NrPts(LsyncSweepIndex) = ";NrPts[MasterSweepIndex-1]
   PRINT "Index to be marked (starting with 0) = ";IndSel
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "gui_Done" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 ICCAP_FUNC("./GUI_ShowLSYNCs", "Destroy GUI", "SHOW LSYNC VALUES")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---besides resetting Variables, 
 !   this Program closes all ICCAP_ARRAYs 
 !   so that the Setup Variable List 
 !   becomes 'readable-by-a-human' again
 
 !---reset Variables
 PlotIndex=""
 IndSel=-1
 ShowMasterSweepIndex = 0
 
 
 !---delete all Colx arrays (were used to keep the Instance Parameters of the added MASTER and the LSYNC sweeps
 ErrStr=""
 i=0
 WHILE ErrStr==""
   VarName="Col"&VAL$(i)
   dummy=LOOKUP_VAR(VAL$(VarName), ErrStr)
   IF VAL$(ErrStr)=="" THEN
     ICCAP_FUNC(".", "SetTableFieldValue", "Name["&VAL$(VarName)&"]", "") 
     i = i + 1
   END IF
 END WHILE
 
 
 !---clean up ICCAP_ARRAYs
 LsyncColNames= "ICCAP_ARRAY[0]"		!Input names of Master and LSYNC
 Index        = "ICCAP_ARRAY[0]"		!used for sorting
 DataIndex    = "ICCAP_ARRAY[0]"		!incrementing data index for identifying Plot left-clicked data with their LSYNC values in the GUI list
 
 
 !---clean up Input icons
 ICCAP_FUNC(".","Import Delete")
 InputNames = "ICCAP_ARRAY[0]"
 
 ICCAP_FUNC(".", "New Input", "See_under_ExtractOptimize")
 ICCAP_FUNC("See_under_ExtractOptimize", "STFV", "Sweep Type", "CON")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "test_DataIndexGenerator" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 
 
 ! This tutorial Program calculates the index of each sweep out
 ! of the total data index.
 ! Usage: Image, you have a Setup with e.g. 4 swept Inputs.
 ! And you created ICCAP_ARRAYs for the indiv. values of each sweep.
 ! Then, this program gives you the data index of each such ICCAP_ARRAY.
 ! This Program is not used by the other Programs of this Setup, it's a tutorial for interested users.
 
 ! Specify here how many points each sweep has.
 ! Below, we emulate 4 sweep orders:
 NrPts1=37
 NrPts2=6	!NOTE: NrPtsx>1   !!!
 NrPts3=2
 NrPts4=3
 ! NOTE: when you add more sweeps, you need to add a new line with the corresponding formula below in the WHILE loop
 
 ICCAP_FUNC("/","Clear Status Output")
 
 
 i=0
 WHILE i < NrPts1*NrPts2*NrPts3*NrPts4
   IF i<10 THEN PRINT " ";
   IF i<100 THEN PRINT " ";
   IF i<1000 THEN PRINT " ";
   PRINT i;"-> ";
 
   !first the special case of sweep1
   IndexColSwp1=i-FLOOR(i//NrPts1)*NrPts1
   PRINT IndexColSwp1;" ";
 
   ! now the general formula for all sweeps between sweep1 and sweepN
   IndexColSwp2=FLOOR(i//NrPts1)-FLOOR(i//(NrPts1*NrPts2))*NrPts2
   PRINT IndexColSwp2;" ";
 
   IndexColSwp3=FLOOR(i//(NrPts1*NrPts2))-FLOOR(i//(NrPts1*NrPts2*NrPts3))*NrPts3
   PRINT IndexColSwp3;" ";
 
   !finaly the special case of the last sweepN
   IndexLastSwp=FLOOR(i//(NrPts1*NrPts2*NrPts3))
   PRINT IndexLastSwp
 
   i = i + 1
 END WHILE
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "ACTIONS_4_PLOTS" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "3.5590475107979 16069 12146"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 C15 C42 C10"
element 0 "Name" "ModelName"
element 0 "Value" "/RLC_TEE_or_PI_MASTER"
element 1 "Name" "DutNames[0]"
element 1 "Value" "RLC_Mdlg__Sel_Schematic"
element 2 "Name" "DutNames"
element 2 "Value" "ICCAP_ARRAY[1]"
element 3 "Name" "SetupNames[0]"
element 3 "Value" "do_it"
element 4 "Name" "SetupNames"
element 4 "Value" "ICCAP_ARRAY[1]"
element 5 "Name" "PlotNames[0]"
element 5 "Value" "_MP_Spar_"
element 6 "Name" "PlotNames[1]"
element 6 "Value" "S11"
element 7 "Name" "PlotNames[2]"
element 7 "Value" "S12"
element 8 "Name" "PlotNames[3]"
element 8 "Value" "S21"
element 9 "Name" "PlotNames[4]"
element 9 "Value" "S22"
element 10 "Name" "PlotNames[5]"
element 10 "Value" "_MP_S2PI_"
element 11 "Name" "PlotNames[6]"
element 11 "Value" "Z10"
element 12 "Name" "PlotNames[7]"
element 12 "Value" "Z12"
element 13 "Name" "PlotNames[8]"
element 13 "Value" "Z20"
element 14 "Name" "PlotNames[9]"
element 14 "Value" "_MP_PI2CLR_"
element 15 "Name" "PlotNames[10]"
element 15 "Value" "C10"
element 16 "Name" "PlotNames[11]"
element 16 "Value" "R10"
element 17 "Name" "PlotNames[12]"
element 17 "Value" "L12"
element 18 "Name" "PlotNames[13]"
element 18 "Value" "R12"
element 19 "Name" "PlotNames[14]"
element 19 "Value" "C12"
element 20 "Name" "PlotNames[15]"
element 20 "Value" "C20"
element 21 "Name" "PlotNames[16]"
element 21 "Value" "R20"
element 22 "Name" "PlotNames[17]"
element 22 "Value" "_MP_1Port_"
element 23 "Name" "PlotNames[18]"
element 23 "Value" "S_1Port"
element 24 "Name" "PlotNames[19]"
element 24 "Value" "Z_1Port"
element 25 "Name" "PlotNames[20]"
element 25 "Value" "R_1Port"
element 26 "Name" "PlotNames[21]"
element 26 "Value" "L_1Port"
element 27 "Name" "PlotNames[22]"
element 27 "Value" "C_1Port"
element 28 "Name" "PlotNames[23]"
element 28 "Value" "_MP_S2TEE_"
element 29 "Name" "PlotNames[24]"
element 29 "Value" "Z1"
element 30 "Name" "PlotNames[25]"
element 30 "Value" "Z12Gnd"
element 31 "Name" "PlotNames[26]"
element 31 "Value" "Z2"
element 32 "Name" "PlotNames[27]"
element 32 "Value" "_MP_TEE2CLR_"
element 33 "Name" "PlotNames[28]"
element 33 "Value" "R1"
element 34 "Name" "PlotNames[29]"
element 34 "Value" "C1"
element 35 "Name" "PlotNames[30]"
element 35 "Value" "L1"
element 36 "Name" "PlotNames[31]"
element 36 "Value" "C12Gnd"
element 37 "Name" "PlotNames[32]"
element 37 "Value" "R12Gnd"
element 38 "Name" "PlotNames[33]"
element 38 "Value" "R2"
element 39 "Name" "PlotNames[34]"
element 39 "Value" "C2"
element 40 "Name" "PlotNames[35]"
element 40 "Value" "L2"
element 41 "Name" "PlotNames"
element 41 "Value" "ICCAP_ARRAY[36]"
element 42 "Name" ""
element 42 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "ADD_HEADER_2_ALL_PLOTS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 !  Version April 2014   -Si-
 
 
 !  This PEL utility enters the Setup/Plot Name into the Plot Header
 !  If the Dut name includes the keyword 'TEMP', the prefix 'TEMP_' is adder to the Plot Header
 
 
 GLOBAL_VAR  ModelName
 GLOBAL_VAR  DutNames
 GLOBAL_VAR  SetupNames
 GLOBAL_VAR  PlotNames
 
 
 
 ModelName = TRIM$(VAL$(ModelName), "/")
 GET_STRING "enter Model name" , ModelName, ModelName
 
 GET_INT "Enter your choice: add headers (1) or remove headers (-1)", "1", Action
 
 GET_INT "Plot Header Style:  
      [0] for Setup-Plot (adding prefix 'TEMP_' if DutName includes keyword 'TEMP')
      [1] for Dut-Setup-Plot", 0, PlotHeaderStyle
 
 GET_STRING "Adding/Removing Headers also to MultiPlots ?   [y], [n]", "y", DoIt4MultiPlots
 
 !~~~~~~~~~~~~~~~~~~~~Start of Program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ModelName = "/"&VAL$(ModelName)
 ICCAP_FIND_CHILDREN VAL$(ModelName), "DUT", DutNames
 
 iDut=0
 WHILE iDut < SIZEOF(DutNames)
   Path2Dut =  VAL$(ModelName)&"/"&VAL$(DutNames[iDut])
   ICCAP_FIND_CHILDREN VAL$(Path2Dut), "Setup", SetupNames
   IF VAL$(SetupNames)<>"" THEN
     iSetup=0
     WHILE iSetup<SIZEOF(SetupNames)
       Path2Setup = VAL$(Path2Dut)&"/"&VAL$(SetupNames[iSetup])
       ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Plot", PlotNames
       IF VAL$(PlotNames)<>"" THEN	!plots are available
         iPlot=0
         WHILE iPlot<SIZEOF(PlotNames)
           ! Specify the prefix "Plot " to avoid confusion with possibly existing Transforms named identically to a Plot in the Setup
           Path2Plot="Plot "&VAL$(Path2Setup)&"/"&VAL$(PlotNames[iPlot])
 
           PlotType = LOOKUP_TABLE_VAL(Path2Plot, "Report Type")
           IF (VAL$(PlotType)=="MULTI PLOT") ANDALSO VAL$(DoIt4MultiPlots)<>"y" THEN CONTINUE
 
           !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
           IF VAL(Action)==1 THEN
             !---add Plot Header
             PlotHeader = VAL$(SetupNames[iSetup])&": "&VAL$(PlotNames[iPlot])
             IF VAL(PlotHeaderStyle)==1 THEN
               PlotHeader = VAL$(DutNames[iDut])&"/"&VAL$(PlotHeader)
             ELSE
               IF STRPOS(VAL$(DutNames[iDut]), "TEMP") > 0 THEN
                 PlotHeader = "TEMP_"&VAL$(PlotHeader)
               END IF
             END IF
             ICCAP_FUNC("Plot "&VAL$(Path2Plot), "SetTableFieldValue", "Header", VAL$(PlotHeader))
           ELSE
             !---remove Plot Header
             ICCAP_FUNC("Plot "&VAL$(Path2Plot), "SetTableFieldValue", "Header", "")
           END IF
           !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
           iPlot = iPlot + 1
         END WHILE
       END IF
       iSetup = iSetup + 1
     END WHILE
   END IF
   iDut = iDut + 1
 END WHILE
 
 GET_STRING "Done !  [OK]", dummy
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "SET_PLOT_TRACES" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 !  Version April 2014   -Si-
 
 
 !  This PEL utility sets the Plot Trace Styles in all Plots of a Model
 !  MultiPlots are ignored.
 
 
 GLOBAL_VAR  ModelName
 GLOBAL_VAR  DutNames
 GLOBAL_VAR  SetupNames
 GLOBAL_VAR  PlotNames
 
 
 
 GET_STRING "Have you already comment-out your choice in the middle of the program loop ?  [OK], [Cancel]", dummy
 ModelName = TRIM$(VAL$(ModelName), "/")
 GET_STRING "enter Model name" , ModelName, ModelName
 
 
 !~~~~~~~~~~~~~~~~~~~~Start of Program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ModelName = "/"&VAL$(ModelName)
 ICCAP_FIND_CHILDREN VAL$(ModelName), "DUT", DutNames
 
 iDut=0
 WHILE iDut < SIZEOF(DutNames)
   Path2Dut =  VAL$(ModelName)&"/"&VAL$(DutNames[iDut])
   ICCAP_FIND_CHILDREN VAL$(Path2Dut), "Setup", SetupNames
   IF VAL$(SetupNames)<>"" THEN
     iSetup=0
     WHILE iSetup<SIZEOF(SetupNames)
       Path2Setup = VAL$(Path2Dut)&"/"&VAL$(SetupNames[iSetup])
       ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Plot", PlotNames
       IF VAL$(PlotNames)<>"" THEN	!plots are available
         iPlot=0
         WHILE iPlot<SIZEOF(PlotNames)
           ! Specify the prefix "Plot " to avoid confusion with possibly existing Transforms named identically to a Plot in the Setup
           Path2Plot="Plot "&VAL$(Path2Setup)&"/"&VAL$(PlotNames[iPlot])
           plottype = LOOKUP_TABLE_VAL(Path2Plot, "Report Type")
           IF VAL$(plottype)<>"MULTI PLOT" THEN
             !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
             !--- CURVE COLORING
             !    uncomment your choice
             CurveColoring = "Display all curves with the configured trace color"
             !CurveColoring = "Change color with each 2nd order curve"
             !CurveColoring = "Change color with each highest order curve"
             !CurveColoring = "Change color with every curve"
             ICCAP_FUNC(VAL$(Path2Plot)&"/PlotOptions", "STFV", "Multicolor", VAL$(CurveColoring))
 
 
             !--- CURVE TRACE STYLE
             !    choices:
             !    "Symbols Only" or "Solid Line" or "Dashed Line" or "Solid Line with Symbols"
             ICCAP_FUNC(VAL$(Path2Plot)&"/PlotOptions", "STFV", "Measured Trace",   "Solid Line with Symbols")
             ICCAP_FUNC(VAL$(Path2Plot)&"/PlotOptions", "STFV", "Simulated Trace",  "Solid Line")
             ICCAP_FUNC(VAL$(Path2Plot)&"/PlotOptions", "STFV", "Transform Result", "Solid Line with Symbols")
 
             !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
           END IF
           iPlot = iPlot + 1
         END WHILE
       END IF
       iSetup = iSetup + 1
     END WHILE
   END IF
   iDut = iDut + 1
 END WHILE
 
 GET_STRING "Done !  [OK]", dummy
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "AUTOSCALE_4_ALL_PLOTS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 !  Version April 2015   -Si-
 
 
 !  This PEL utility sets all Plots of a ModelFile to Autoscale
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! WARNING: if the ModelFile contains more than ~100 Plots,
 ! the performance will become slower and slower ...
 !
 ! In this case, load the ModelFile to an external editor, 
 ! and exchange for the Plots
 !  {MAN     ->     {Auto
 ! and for the MultiPlots
 !  :MAN     ->     :Auto
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 ! required (Setup)Variables:
 GLOBAL_VAR  ModelName
 GLOBAL_VAR  DutNames
 GLOBAL_VAR  SetupNames
 GLOBAL_VAR  PlotNames
 
 
 
 
 ModelName = TRIM$(VAL$(ModelName), "/")
 GET_STRING "enter Model name" , ModelName, ModelName
 
 GET_STRING "Enter your choice: [Autoscale On],  [Autoscale Off]", "Autoscale On", Action
 GET_STRING "Apply your Autoscale Choice also to MultiPlots ?   [y], [n]", "y", DoIt4MultiPlots
 
 
 
 
 !~~~~~~~~~~~~~~~~~~~~Start of Program~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ModelName = "/"&VAL$(ModelName)
 ICCAP_FIND_CHILDREN VAL$(ModelName), "DUT", DutNames
 
 iDut=0
 WHILE iDut < SIZEOF(DutNames)
   Path2Dut =  VAL$(ModelName)&"/"&VAL$(DutNames[iDut])
   ICCAP_FIND_CHILDREN VAL$(Path2Dut), "Setup", SetupNames
   IF VAL$(SetupNames)<>"" THEN
     iSetup=0
     WHILE iSetup<SIZEOF(SetupNames)
       Path2Setup = VAL$(Path2Dut)&"/"&VAL$(SetupNames[iSetup])
       ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Plot", PlotNames
       IF VAL$(PlotNames)<>"" THEN	!plots are available
         iPlot=0
         WHILE iPlot<SIZEOF(PlotNames)
           ! Specify the prefix "Plot " to avoid confusion with possibly existing Transforms named identically to a Plot in the Setup
           Path2Plot="Plot "&VAL$(Path2Setup)&"/"&VAL$(PlotNames[iPlot])
 
           PlotType = LOOKUP_TABLE_VAL(Path2Plot, "Report Type")
           IF (VAL$(PlotType)=="MULTI PLOT") ANDALSO VAL$(DoIt4MultiPlots)<>"y" THEN CONTINUE
 
           !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
             ICCAP_FUNC(VAL$(Path2Plot), "Display Plot")
             ICCAP_FUNC(VAL$(Path2Plot), VAL$(Action))
             ICCAP_FUNC(VAL$(Path2Plot), "Close")
           !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
           iPlot = iPlot + 1
         END WHILE
       END IF
       iSetup = iSetup + 1
     END WHILE
   END IF
   iDut = iDut + 1
 END WHILE
 
 GET_STRING "Done !  [OK]", dummy
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "ADJUST_ZERO_VALUES" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug
 
 
 !---This Program adjusts zero-valued data (measured or simulated)
 !   so that they don't provide bad y-axis scalings in Plots
 
 GET_DATASET "tmp_data", tmp_data
 GET_STRING  "Data Type to be adjusted   [M], [S]", DataType
 GET_STRING  "Force to Value [0], [1] etc. or Automatic [AUTO]", Adjustment
 
 
 IF VAL$(DataType)=="M" ANDALSO IS_CONSTANT(tmp_data.M)==1 THEN
   IF VAL(Debug)==1 THEN PRINT "adjusting M data ..."
   IF UPC$(VAL$(Adjustment))=="AUTO" THEN
     MeasAdjusted = MIN(tmp_data.S)
     IF MeasAdjusted == 0 THEN RETURN tmp_data
     !---round down to lower decade
     MeasAdjusted = LOG10(MAG(MeasAdjusted))
     MeasAdjusted = FLOOR(MeasAdjusted)
     !---get new pseudo-zero value
     MeasAdjusted = 10^MeasAdjusted
   ELSE
     MeasAdjusted=VAL(Adjustment)
   END IF
   !---fill data array
   FOR i=0 TO SIZEOF(tmp_data)-1
     tmp_data.M[i] = MeasAdjusted
   NEXT i
 END IF
 
 
 IF VAL$(DataType)=="S" ANDALSO IS_CONSTANT(tmp_data.S)==1 THEN
   IF VAL(Debug)==1 THEN PRINT "adjusting S data ..."
   IF UPC$(VAL$(Adjustment))=="AUTO" THEN
     SimulAdjusted = MIN(tmp_data.M)
     IF SimulAdjusted == 0 THEN RETURN tmp_data
     !---round down to lower decade
     SimulAdjusted = LOG10(MAG(SimulAdjusted))
     SimulAdjusted = FLOOR(SimulAdjusted)
     !---get new pseudo-zero value
     SimulAdjusted = 10^SimulAdjusted
   ELSE
     SimulAdjusted=VAL(Adjustment)
   END IF
   !---fill data array
   FOR i=0 TO SIZEOF(tmp_data)-1
     tmp_data.M[i] = SimulAdjusted
   NEXT i
 END IF
 
 
 RETURN tmp_data
 
}
dataset
{
datasize BOTH 1280 1 1
type MEAS
type SIMU
}
}
}
data "711.501"
{
}
}
LINK DAT "SPLIT_2ndORDER_SWEEPS" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.9458597506082 8785 6641"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 !---in your local Model, apply the following PEL lines to call
 !   the central splitting routine in UTILITIES
 
 
 Path2Setup = WHOIS(".", "Parent Setup")		!returns full path to SetupName
 
 Data1stSweep = va
 Data2ndSweep = TEMP_swp
 AllData      = ia.B
 
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PLOT_UTILITIES/SPLIT_2ndORDER_SWEEPS/SPLIT_2ndORDER_SWEEPS", VAL$(Path2Setup), Data1stSweep, Data2ndSweep, AllData) 
 
 ! Data Format of SPLIT_2ndORDER_SWEEPS:
 ! SplitData.11:	x-axis			+j* fourth  2nd order sweep
 ! SplitData.12:	first  2nd order sweep	+j* fifth   2nd order sweep
 ! SplitData.21:	second 2nd order sweep	+j* sixth   2nd order sweep
 ! SplitData.22:	third  2nd order sweep	+j* seventh 2nd order sweep
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "SPLIT_2ndORDER_SWEEPS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 ! This Program splits the 2nd order sweeps of a Setup into individual 
 ! data sets for being plotted individually.
 !
 ! NOTE:
 ! the splitting is currently only programmed for max. 7  2nd-order-sweep values
 ! and it is programmed for 2 sweep orders only
 
 
 GET_STRING  "Path2Setup", Path2Setup
 GET_DATASET "Data1stSweep", Data1stSweep
 GET_DATASET "Data2ndSweep", Data2ndSweep
 GET_DATASET "AllData",    AllData
 
 
 !---get nr. of values of 1st sweep stimulus 
 Sweep1Pts= USERC_num_of_points(1, Path2Setup)
 
 !---get nr. of values of 2nd sweep stimulus
 Sweep2Pts= USERC_num_of_points(2, Path2Setup)
 IF SIZEOF(Sweep2Pts)>7 THEN
   GET_STRING "ERROR: the splitting is currently only programmed for max. 7  2nd-order-sweeps !!  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 !--create return dataset       (as a pseudo 2x2 S-Parameter DataSet)
 COMPLEX SplitData.B.22[Sweep1Pts]
 
 N=0
 FOR i=0 TO SIZEOF(AllData)-1
 
   !---handle loop indexing
   IF i>0 ANDALSO VAL(Data2ndSweep[i])<>VAL(Data2ndSweep[i-1]) THEN 
     N = N + 1
     EXIT IF N>Sweep2Pts
   END IF
 
   !---separate the data
   IF N==0 THEN 
     SplitData.M.11[i]=REAL(Data1stSweep[i])		!x-axis for the Plots
     SplitData.M.12[i-N*Sweep1Pts]=REAL(AllData.M[i])	!separate the first 2nd order sweep
     SplitData.S.12[i-N*Sweep1Pts]=REAL(AllData.S[i])
   ELSEIF N==1 THEN
     SplitData.M.21[i-N*Sweep1Pts]=REAL(AllData.M[i])	!separate the second 2nd order sweep
     SplitData.S.21[i-N*Sweep1Pts]=REAL(AllData.S[i])
   ELSEIF N==2 THEN
     SplitData.M.22[i-N*Sweep1Pts]=REAL(AllData.M[i])	!separate the third 2nd order sweep
     SplitData.S.22[i-N*Sweep1Pts]=REAL(AllData.S[i])
   ELSEIF N==3 THEN
     SplitData.M.11[i-N*Sweep1Pts]=REAL(SplitData.M.11[i-N*Sweep1Pts]) +j*REAL(AllData.M[i])	!separate the fourth 2nd order sweep
     SplitData.S.11[i-N*Sweep1Pts]=REAL(SplitData.S.11[i-N*Sweep1Pts]) +j*REAL(AllData.S[i])
   ELSEIF N==4 THEN
     SplitData.M.12[i-N*Sweep1Pts]=REAL(SplitData.M.12[i-N*Sweep1Pts]) +j*REAL(AllData.M[i])	!separate the fourth 2nd order sweep
     SplitData.S.12[i-N*Sweep1Pts]=REAL(SplitData.S.12[i-N*Sweep1Pts]) +j*REAL(AllData.S[i])
   ELSEIF N==5 THEN
     SplitData.M.21[i-N*Sweep1Pts]=REAL(SplitData.M.21[i-N*Sweep1Pts]) +j*REAL(AllData.M[i])	!separate the fourth 2nd order sweep
     SplitData.S.21[i-N*Sweep1Pts]=REAL(SplitData.S.21[i-N*Sweep1Pts]) +j*REAL(AllData.S[i])
   ELSEIF N==6 THEN
     SplitData.M.22[i-N*Sweep1Pts]=REAL(SplitData.M.22[i-N*Sweep1Pts]) +j*REAL(AllData.M[i])	!separate the fourth 2nd order sweep
     SplitData.S.22[i-N*Sweep1Pts]=REAL(SplitData.S.22[i-N*Sweep1Pts]) +j*REAL(AllData.S[i])
   END IF
 NEXT i
 
 
 
 RETURN SplitData
 
 ! Data Format of DataSet 'SplitData':
 ! SplitData.11:	x-axis			+j* fourth  2nd order sweep
 ! SplitData.12:	first  2nd order sweep	+j* fifth   2nd order sweep
 ! SplitData.21:	second 2nd order sweep	+j* sixth   2nd order sweep
 ! SplitData.22:	third  2nd order sweep	+j* seventh 2nd order sweep
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
}
LINK DUT "_____________________________________5" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "_____________________________________6" "711.501"
{
View tree_dut 0 "1"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "___GENERAL_MODELING_UTILITIES______" "711.501"
{
View tree_dut 0 "0"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "Readme" "711.501"
{
View in_out 0 "1.8 2000 2000"
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "see_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,1925,2224"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! The DUTs below this Setup 'Readme' are MASTER DUTs
 ! for specific device modeling tasks.
 ! They will be copy-pasted from here into a parallel loaded
 ! Device Modeling ModelFile, by that parallel loaded ModelFile.
 
 
 ! Note:
 ! Different to the PEL/GUIs in the other Setups of this UTILITIES.mdl,
 ! which always stay in this UTILITIES.mdl file, and are just called by the
 ! parallel ModelFile's PEL/GUIs, 
 ! a call from the parallel ModelFile into the PEL/GUIs of the DUTs below 
 ! is not practical, due to applying the PlotOptimizer to Plots 
 ! specified *here* in UTILITIES.mdl.
 ! If the PELs of the DUTs below would be called from the parallel ModelFile 
 ! (with the DUT not copy-pasted into the parallel ModelFile!!), 
 ! the PlotOptimizer would *not refer to the parallel ModelFile*, 
 ! but rather to *this very UTILITIES.mdl*, and you had no access to
 ! the ModelParameters of the parallel ModelFile !!!
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
}
LINK DUT "TRANSISTOR_SPAR_MDLG" "711.501"
{
View tree_dut 0 "0"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 P103 P60 P321"
element 0 "Name" "GUI_xPos"
element 0 "Value" "0"
element 0 "Comment" "x Pos. of selection GUI on Monitor"
element 1 "Name" "GUI_yPos"
element 1 "Value" "0"
element 1 "Comment" "y Pos. of selection GUI on Monitor"
element 2 "Name" "Debug"
element 2 "Value" "0"
element 3 "Name" "TEMP"
element 3 "Value" ""
element 4 "Name" ""
element 4 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P15 P100 P100 P100 P100 P100 P100 C13"
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "DO_ALL" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "0.9944188518781 4490 3294"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P227 P282 C10"
element 0 "Name" "MDM_FILE_PATH"
element 0 "Value" ""
element 1 "Name" "MDM_FILE_NAME"
element 1 "Value" "tmp.mdm"
element 2 "Name" "MDM_EXPORT_XFORM_DATA"
element 2 "Value" "0"
element 3 "Name" "ErrMsg"
element 3 "Value" ""
element 4 "Name" "__________________________1"
element 4 "Value" ""
element 5 "Name" "___Vars_below_stem"
element 5 "Value" "_from_imported_mdm_files, you may delete them from time to time"
element 6 "Name" ""
element 6 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "vg" "711.501"
{
View draw_ds 0 "B,1182,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIN"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
element "Unit" "SMU1"
element "Compliance" " 40.00m"
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "Start" "-800.0m"
element "Stop" " 100.0m"
element "# of Points" "10"
element "Step Size" " 100.0m"
}
}
}
LINK SWEEP "vd" "711.501"
{
View draw_ds 0 "B,-5708,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIN"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
element "Unit" "SMU2"
element "Compliance" " 160.0m"
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "Start" " 1.000 "
element "Stop" " 6.000 "
element "# of Points" "6"
element "Step Size" " 1.000 "
}
}
list PLOT "id_vd"
list PLOT "ig_vd"
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,-5542,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "# of Values" "26"
}
HYPTABLE "List Table"
{
element "Value 1" " 500.0MEG"
element "Value 2" " 1.500G"
element "Value 3" " 2.500G"
element "Value 4" " 3.500G"
element "Value 5" " 4.500G"
element "Value 6" " 5.500G"
element "Value 7" " 6.500G"
element "Value 8" " 7.500G"
element "Value 9" " 8.500G"
element "Value 10" " 9.500G"
element "Value 11" " 10.50G"
element "Value 12" " 11.50G"
element "Value 13" " 12.50G"
element "Value 14" " 13.50G"
element "Value 15" " 14.50G"
element "Value 16" " 15.50G"
element "Value 17" " 16.50G"
element "Value 18" " 17.50G"
element "Value 19" " 18.50G"
element "Value 20" " 19.50G"
element "Value 21" " 20.50G"
element "Value 22" " 21.50G"
element "Value 23" " 22.50G"
element "Value 24" " 23.50G"
element "Value 25" " 24.50G"
element "Value 26" " 25.50G"
}
}
list PLOT "Sxx"
list PLOT "Sxy"
}
LINK OUT "id" "711.501"
{
View draw_ds 0 "B,-5376,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" "SMU2"
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "GROUND"
}
dataset
{
datasize BOTH 1560 1 1
type MEAS
type SIMU
}
}
list PLOT "id_vd"
}
LINK OUT "ig" "711.501"
{
View draw_ds 0 "B,-5210,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" "SMU1"
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "GROUND"
}
dataset
{
datasize BOTH 1560 1 1
type MEAS
type SIMU
}
}
list PLOT "ig_vd"
}
LINK OUT "S_deemb" "711.501"
{
View draw_ds 0 "B,-5044,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "S"
element "Unit" "NWA"
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "Port 1" "P1"
element "Port 2" "P2"
element "AC Ground" "GROUND"
}
dataset
{
datasize BOTH 1560 2 2
type MEAS
type SIMU
}
}
list XFORM "DO_ALL"
list XFORM "S2Y_Mdlg_GUI/adjust_Plot_entries"
list PLOT "Sxx"
list PLOT "Sxy"
}
LINK XFORM "README" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! ==========================================================================
 ! THIS IS A CENTRAL PEL DEPOT FOR S-PARAMETER TRANSISTOR MODELING,
 ! INDEPENDENT OF THE APPLIED TYPE OF MODEL.
 ! IT WILL BE COPY-PASTED INTO THE CALLING, PARALLEL LOADED IC-CAP MODEL,
 ! AND WILL BE EXECUTED THERE.
 ! The IC-CAP PlotOptimizer will then be applied to tune/optimize 
 ! any model parameters.
 ! ==========================================================================
 
 
 ! Why this modeling utilitiy is located in UTILITIES.mdl:
 ! ------------------------------------------------------
 ! For consistency and easy maintenance, the original Transforms/GUIs
 ! for the this general transistor Spar modeling are located in a DUT of the
 ! UTILITIES.mdl file. This ensures that only *one* version
 ! of this feature exists, for all modeling tasks in all ModelFiles,
 ! what eases your program maintenance a lot.
 ! This DUT is then copy-pasted into the parallel loaded
 ! very ModelFile, and will be executed there.
 !
 ! IMPORTANT NOTE:
 ! When you make changes/modifications in that parallel ModelFile,
 ! don't forget to copy-paste your updated version back into UTILITIES.mdl.
 
 ! For important details about this DUT 'TRANSISTOR_SPAR_MDLG',
 ! see the README in Setup 'S2Y_Mdlg_GUI', and the notes in 
 ! Transform 'Imped2Schematic'.
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1560 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 !NOTE: please read also the Transform 'README'.
 
 ! In your own ModelFile, which hosts a DUT 'aux_TRANSISTOR_SPAR_MDLG'
 ! (the DUT 'aux_TRANSISTOR_SPAR_MDLG' needs to exist, but it can be empty !!)
 ! add a Transform to the S-Parameter Setup with the following PEL syntax:
 !
 !~~~~~~~~~~~~~~~~cut here~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 UPDATE_EXPLICIT
 
 !---delete a (possibly) older version and load the current one from UTILITIES.mdl
 ICCAP_FUNC("../../aux_TRANSISTOR_SPAR_MDLG", "Delete")
 ICCAP_FUNC("/UTILITIES/TRANSISTOR_SPAR_MDLG", "Copy", "../../aux_TRANSISTOR_SPAR_MDLG")
 
 
 !---start the global Spar mdlg GUI
 C_par_R    = 0	! Bipolar Transistor or MOS/MESFET/HEMT Flag:
 		! i.e. C_parallel_R or C_series_R in PI Schematic Port1->Ground 
 		! [bip=1], [MOS/MESFET/HEMT=0]
 FlagSimul  = 1	! 0: show only Measurements | 1: Simulate (to enable modeling)]
 DoStripOff = 0	! 0: no off-stripping of external parasitics (speeds-up performance)
 		! 1: apply off-stripping
 !---If DoStripOff==1, then define below the outer parasitics 
 !   (to be stripped-off before the S2PI conversion of the inner transistor)
 !
 !                     ---------||---------
 !               __   |        C12         |   __    
 ! P1 o---/\/\--|__|--o---O            O---o--|__|--/\/\---o P2
 !         L1    R1   |   Gate     Drain   |   R2    L2
 !                    |                    |
 !                   ---     Source       ---
 !                   ---C10     O         ---C20
 !                    |         |          |
 !                     ---------o----------
 !                              |   __          |
 !                               --|__|--/\/\---| GND
 !                                  R3    L3    |
 
 L1=0	!default for all: 0  (no off-stripping)
 R1=0
 L2=0
 R2=0
 L3=0
 R3=0
 C10=0
 C12=0
 C20=0
 Path2Setup = WHOIS(".")
 
 !---call Transform 'DO_ALL' in the DUT which has been loaded from UTILITIES
 ICCAP_FUNC("../../aux_TRANSISTOR_SPAR_MDLG/DO_ALL/DO_ALL", "Execute", VAL$(Path2Setup), VAL(C_par_R), VAL(FlagSimul), VAL(L1), VAL(R1), VAL(L2), VAL(R2), VAL(L3), VAL(R3), VAL(C10), VAL(C12), VAL(C20), VAL(DoStripOff))
 
 
 RETURN_VALUE 1
 !~~~~~~~~~~~~~~~~cut here~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
}
dataset
{
datasize COMMON 1560 1 1
type COMMON
}
}
}
LINK XFORM "_________________1" "711.501"
{
}
LINK XFORM "DO_ALL" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  ErrMsg
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! the following will be answered by the calling Program
 GET_STRING "Path to calling Setup and its loaded (de-embedded) Spar data", Path2Setup
 GET_STRING "Bipolar Transistor or MOS/MESFET
 	i.e. C//R or C_series_R in PI Schematic Port1->Ground [bip=1], [MOS=0]", ../S2Y_Mdlg_GUI/C_par_R, ../S2Y_Mdlg_GUI/C_par_R
 GET_STRING "FlagSimul  [0: only show Measurements | 1: simulate (to enable modeling)]", ../S2Y_Mdlg_GUI/FlagSimul, ../S2Y_Mdlg_GUI/FlagSimul
 GET_REAL "optional ex. parasitic (to be subtracted before S2PI conversion)
           L1", L1
 GET_REAL "R1", R1
 GET_REAL "L2", L2
 GET_REAL "R2", R2
 GET_REAL "L3", L3
 GET_REAL "R3", R3
 GET_REAL "C10", C10
 GET_REAL "C12", C12
 GET_REAL "C20", C20
 GET_INT  "Strip-Off ext. parasitics ?    [0], [1]", DoStripOff
 
 
 ErrMsg = ""
 
 !---copy the measurement data
 !   remember orig. MDM_FILE_NAME in remote Setup
 MDM_FILE_NAME_orig = VAL$(LOOKUP_VAR(VAL$(Path2Setup)&"/MDM_FILE_NAME", ErrMsg))
 ICCAP_FUNC(VAL$(Path2Setup), "Export Data Measured", "tmp")
 ICCAP_FUNC(".", "Import Create", "tmp")
 !   reset orig. MDM_FILE_NAME in remote Setup
 IF VAL$(ErrMsg)=="" THEN ICCAP_FUNC(VAL$(Path2Setup), "SetVariableTableValue", "MDM_FILE_NAME", VAL$(MDM_FILE_NAME_orig))
 
 
 !---copy TestCircut
 ICCAP_FUNC(VAL$(Path2Setup)&"/../TestCircuit", "Copy", "../TestCircuit")
 
 
 !---copy TestCircuit Parameters
 ICCAP_FUNC(VAL$(Path2Setup)&"/../DeviceParameterSet", "Copy", "../DeviceParameterSet")
 
 
 !---simulate this Setup, in case of no meas. data available, but requested simulations
 !   Background: show all traces in autoscaled Plots
 IF MEAN(S_deemb.M.11)== 0 ANDALSO VAL(../S2Y_Mdlg_GUI/FlagSimul)==1 THEN 
   ICCAP_FUNC(".", "Simulate")
 END IF
 
 !---start the global Spar mdlg GUI in the parallel Setup 'S2Y_Mdlg_GUI'.
 ICCAP_FUNC("../S2Y_Mdlg_GUI/RUN_ALL", "Execute", WHOIS("."), VAL(L1), VAL(R1), VAL(L2), VAL(R2), VAL(L3), VAL(R3), VAL(C10), VAL(C12), VAL(C20), VAL(DoStripOff))
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member OUT "S_deemb"
}
LINK XFORM "_________________2" "711.501"
{
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---clean up Inputs/Outputs
 ICCAP_FUNC(".", "Import Delete")
 
 
 !add Input 'See_under_ExtractOptimize'
 ICCAP_FUNC(".", "New Input", "See_under_ExtractOptimize") 
 ICCAP_FUNC("See_under_ExtractOptimize", "SetTableFieldValue", "Sweep Type", "CON")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK PLOT "Sxx" "711.501"
{
View plot_window 0 "599,380,9000,9000,{AUTO|RI|RI: 0.000 , 0.000 , 1.100 ,6,5,3,5}"
View draw_ds 0 "B,1018,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "Smith Data 0" "S_deemb.m.11"
element "Smith Data 1" "S_deemb.s.11"
element "Smith Data 2" "S_deemb.m.22"
element "Smith Data 3" "S_deemb.s.22"
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "S_deemb"
member SWEEP "freq"
}
LINK PLOT "Sxy" "711.501"
{
View plot_window 0 "425,418,9000,9000"
View draw_ds 0 "B,1018,2964"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "Polar Data 0" "S_deemb.m.12"
element "Polar Data 1" "S_deemb.s.12"
element "Polar Data 2" "S_deemb.m.21"
element "Polar Data 3" "S_deemb.s.21"
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "S_deemb"
member SWEEP "freq"
}
LINK PLOT "id_vd" "711.501"
{
View plot_window 0 "130,496,7575,7000,{AUTO|XY| 900.0m, 1.400 ,5,5:-50.00m, 200.0m,5,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,1018,5928"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Symbols Only" "N"
element 0 "Simulated Trace" "Symbols Only" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "vd"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "id.m"
element "Y Data 1" "id.s"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "id"
member SWEEP "vd"
}
LINK PLOT "ig_vd" "711.501"
{
View plot_window 0 "548,623,7581,6985,{AUTO|XY| 900.0m, 1.400 ,5,5: 50.00m, 200.0m,5,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,1018,9708"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Symbols Only" "N"
element 0 "Simulated Trace" "Symbols Only" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "vd"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" ""
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LOG10"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "ig.m"
element "Y Data 1" "ig.s"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "ig"
member SWEEP "vd"
}
data "711.501"
{
TABLE "AgilentE5270.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "No"
element 0 "Range Manager Mode" "1"
element 0 "Range Manager Setting" "90"
element 0 "Enable HRSMU1 Range Manager" "No"
element 0 "HRSMU1 A/D converter" "R"
element 0 "HRSMU1 In/Out Range" "0/11"
element 0 "Enable MPSMU2 Range Manager" "No"
element 0 "MPSMU2 A/D converter" "R"
element 0 "MPSMU2 In/Out Range" "0/11"
element 0 "Enable MPSMU3 Range Manager" "No"
element 0 "MPSMU3 A/D converter" "R"
element 0 "MPSMU3 In/Out Range" "0/11"
element 0 "Enable MPSMU4 Range Manager" "No"
element 0 "MPSMU4 A/D converter" "R"
element 0 "MPSMU4 In/Out Range" "0/11"
element 0 "Enable MPSMU5 Range Manager" "No"
element 0 "MPSMU5 A/D converter" "R"
element 0 "MPSMU5 In/Out Range" "0/11"
element 0 "Enable MPSMU6 Range Manager" "No"
element 0 "MPSMU6 A/D converter" "R"
element 0 "MPSMU6 In/Out Range" "0/11"
element 0 "Enable MPSMU7 Range Manager" "No"
element 0 "MPSMU7 A/D converter" "R"
element 0 "MPSMU7 In/Out Range" "0/11"
element 0 "Enable MPSMU8 Range Manager" "No"
element 0 "MPSMU8 A/D converter" "R"
element 0 "MPSMU8 In/Out Range" "0/11"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Disable Self-cal" "No"
element 0 "Output I/O Port (ERC Command)" ""
element 0 "Output I/O Port (ERM Command)" ""
element 0 "Format Parameter (FMT Command)" "4"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentPNA.4000.20" "711.501"
{
element 0 "Use User Sweep [Yes/No]" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Sweep Type[Step/Analog]" "S"
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port Src Power (dBm)" "-20.00 "
element 0 "Port 2 Src Power (dBm)" "-20.00 "
element 0 "Port Atten Auto [Y/N]" "No"
element 0 "Port Src Atten (dB)" " 0.000 "
element 0 "Port 2 Src Atten (dB)" " 0.000 "
element 0 "Power Slope (dB/GHz)" " 0.000 "
element 0 "Dwell Time (sec) [0=auto]" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor [1-1024]" "1"
element 0 "Ports Mapping" ""
element 0 "Cal Type [Hardware/None]" "H"
element 0 "Cal/State File Name [.csa|.cst only]" ""
element 0 "Use PNA Calibration Settings" "No"
element 0 "Use PNA Receiver Leveling" "No"
element 0 "Delay for timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
TABLE "HP4142.4000.24" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Range" "0"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "Yes"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Module Control" ""
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
}
}
LINK DAT "S2Y_Mdlg_GUI" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "0.75279057406095 3005 2570"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P196 P177 C10"
element 0 "Name" "ICCAP_DEFAULT_SETUP_PAGE"
element 0 "Value" "Extract / Optimize"
element 1 "Name" "GUI_xPos"
element 1 "Value" "0"
element 2 "Name" "GUI_yPos"
element 2 "Value" "0"
element 3 "Name" "MDM_FILE_PATH"
element 3 "Value" ""
element 4 "Name" "MDM_FILE_NAME"
element 4 "Value" "tmp.mdm"
element 5 "Name" "MDM_EXPORT_XFORM_DATA"
element 5 "Value" "0"
element 6 "Name" "ErrMsg"
element 6 "Value" "LOOKUP_TABLE_VAL: Unable to locate 'freq'."
element 7 "Name" "NrDataPts"
element 7 "Value" "1560"
element 8 "Name" "__________________"
element 8 "Value" ""
element 9 "Name" "ROUT"
element 9 "Value" "50k"
element 10 "Name" "ROUT_stripoff"
element 10 "Value" "0"
element 11 "Name" "C_par_R"
element 11 "Value" "0"
element 12 "Name" "FlagSimul"
element 12 "Value" "0"
element 13 "Name" "DoStripOff"
element 13 "Value" "0"
element 14 "Name" "R1"
element 14 "Value" ""
element 15 "Name" "L1"
element 15 "Value" ""
element 16 "Name" "R2"
element 16 "Value" ""
element 17 "Name" "L2"
element 17 "Value" ""
element 18 "Name" "R3"
element 18 "Value" ""
element 19 "Name" "L3"
element 19 "Value" ""
element 20 "Name" "C10"
element 20 "Value" ""
element 21 "Name" "C12"
element 21 "Value" ""
element 22 "Name" "C20"
element 22 "Value" ""
element 23 "Name" "txt_GUI_HELP"
element 23 "Value" ""
element 24 "Name" "cancel_all"
element 24 "Value" "0"
element 25 "Name" "start_up_flag"
element 25 "Value" "0"
element 26 "Name" "xfm_autoexe"
element 26 "Value" "0"
element 27 "Name" "______________"
element 27 "Value" ""
element 28 "Name" "path2data"
element 28 "Value" "/XTOR_SPAR_CHECKTOOL/aux_TRANSISTOR_SPAR_MDLG/DO_ALL"
element 29 "Name" "nr_sweeps"
element 29 "Value" "3"
element 30 "Name" "index"
element 30 "Value" "ICCAP_ARRAY[0]"
element 31 "Name" "sweep1name"
element 31 "Value" "freq"
element 32 "Name" "sweep2name"
element 32 "Value" "vd"
element 33 "Name" "sweep3name"
element 33 "Value" "vg"
element 34 "Name" "sweep4name"
element 34 "Value" "n/a"
element 35 "Name" "swp2"
element 35 "Value" "ICCAP_ARRAY[0]"
element 36 "Name" "swp2_selected"
element 36 "Value" "ICCAP_ARRAY[0]"
element 37 "Name" "swp3"
element 37 "Value" "ICCAP_ARRAY[0]"
element 38 "Name" "swp3_selected"
element 38 "Value" "ICCAP_ARRAY[0]"
element 39 "Name" "swp4"
element 39 "Value" "ICCAP_ARRAY[0]"
element 40 "Name" "swp4_selected"
element 40 "Value" "ICCAP_ARRAY[0]"
element 41 "Name" "show_tbl_sweeps"
element 41 "Value" "1"
element 42 "Name" "________vars_to_adjust_Plot_entries_____"
element 42 "Value" ""
element 43 "Name" "plots_avail"
element 43 "Value" ""
element 44 "Name" "_________vars_for_bt_reorder_sweeps_______"
element 44 "Value" ""
element 45 "Name" "sweep_order"
element 45 "Value" "ICCAP_ARRAY[0]"
element 46 "Name" "sweep_index_selected"
element 46 "Value" "1"
element 47 "Name" "aux"
element 47 "Value" "vg"
element 48 "Name" "_________vars_for_bt_exit_GUI________"
element 48 "Value" ""
element 49 "Name" "sweep1name_orig"
element 49 "Value" "freq"
element 50 "Name" "sweep2name_orig"
element 50 "Value" "vd"
element 51 "Name" "sweep3name_orig"
element 51 "Value" "vg"
element 52 "Name" "sweep4name_orig"
element 52 "Value" "n/a"
element 53 "Name" "inputnames"
element 53 "Value" "ICCAP_ARRAY[0]"
element 54 "Name" "outputnames"
element 54 "Value" "ICCAP_ARRAY[0]"
element 55 "Name" "________________________"
element 55 "Value" ""
element 56 "Name" "___Vars_below_stem"
element 56 "Value" "_from_imported_mdm_files, you may delete them from time to time"
element 57 "Name" ""
element 57 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "tbl_sel_sweeps_n_model"
element 0 "Value" "TL|CA=#224Inner PI Schematic Plots:OR=HO:LX=%#18GUI_xPos:LY=%#18GUI_yPos|CA=#230bt_exit_GUI_sel_sweeps_n_model&#19Execute,0|#210tbl_sweeps:#217tbl_actionbuttons:#211tbl_S_Plots:#210separator1:#210separator2:#219tbl_schematic_plots|1|1"
element 1 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots"
element 1 "Value" "TL|CA=#252PI Schematic Plots, with off-stripped series L and R:OR=VE|<none>|#17tbl_top:#213tbl_schematic:#210tbl_bottom|1"
element 2 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic"
element 2 "Value" "TL|OR=HO|<none>|#16tbl_10:#16tbl_12:#16tbl_gm:#18tbl_ROUT:#16tbl_20|1"
element 3 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_10"
element 3 "Value" "TL|OR=VE|<none>|#15lbl_1:#214checkbox_CparR:#16bt_Z10:#16bt_C10:#16bt_R10:#16lbl_11|0"
element 4 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_10.lbl_1"
element 4 "Value" "LA|CA=#224o-----o---\012Port1 \174:FI=FF|<none>|<none>|0"
element 5 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_10.bt_C10"
element 5 "Value" "PB|CA=#18Plot C10:TO=FH&dummy|AC=#215bt_Display_Plot&#213Execute,_C10_|<none>|0"
element 6 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_10.bt_R10"
element 6 "Value" "PB|CA=#18Plot R10:TO=FH&dummy|AC=#215bt_Display_Plot&#213Execute,_R10_|<none>|0"
element 7 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_10.lbl_11"
element 7 "Value" "LA|CA=#222      \174\012     ---:FI=FF|<none>|<none>|0"
element 8 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_10.bt_Z10"
element 8 "Value" "PB|CA=#18Plot Z10:TO=FH&dummy|AC=#15_Z10_&#212Display Plot|<none>|0"
element 9 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_12"
element 9 "Value" "TL|OR=VE|<none>|#14tbl1|0"
element 10 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_12.tbl1"
element 10 "Value" "TL|OR=VE:TO=FH&MH&TT|<none>|#16bt_Z12:#16bt_C12:#16bt_R12:#210lbl_space1|1"
element 11 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_12.tbl1.bt_C12"
element 11 "Value" "PB|CA=#18Plot C12:TO=FW&FH&MW&MH|AC=#215bt_Display_Plot&#213Execute,_C12_|<none>|0"
element 12 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_12.tbl1.bt_R12"
element 12 "Value" "PB|CA=#18Plot R12:TO=FW&FH&MW&MH|AC=#215bt_Display_Plot&#213Execute,_R12_|<none>|0"
element 13 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_12.tbl1.bt_Z12"
element 13 "Value" "PB|CA=#18Plot Z12:TO=FW&FH&MW&MH|AC=#15_Z12_&#212Display Plot|<none>|0"
element 14 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_gm"
element 14 "Value" "TL|OR=VE|<none>|#15lbl_1:#15bt_GM:#16bt_TAU:#16lbl_11:#15Space|0"
element 15 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_gm.lbl_1"
element 15 "Value" "LA|CA=#251---o---\012   \174\012   \174\012   \174\012   \174:FI=FF|<none>|<none>|0"
element 16 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_gm.bt_GM"
element 16 "Value" "PB|CA=#18Plot GM :TO=FH&dummy|AC=#215bt_Display_Plot&#212Execute,_GM_|<none>|0"
element 17 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_gm.bt_TAU"
element 17 "Value" "PB|CA=#18Plot TAU:TO=FH&dummy|AC=#215bt_Display_Plot&#213Execute,_TAU_|<none>|0"
element 18 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_gm.lbl_11"
element 18 "Value" "LA|CA=#216   \174\012  ---:FI=FF|<none>|<none>|0"
element 19 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_20"
element 19 "Value" "TL|OR=VE|<none>|#15lbl_1:#16bt_Z20:#16bt_C20:#16bt_R20:#16lbl_11|0"
element 20 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_20.lbl_1"
element 20 "Value" "LA|CA=#236---o---o\012   \174 Port2\012   \174:FI=FF|<none>|<none>|0"
element 21 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_20.bt_C20"
element 21 "Value" "PB|CA=#18Plot C20:TO=FH&dummy|AC=#215bt_Display_Plot&#213Execute,_C20_|<none>|0"
element 22 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_20.bt_R20"
element 22 "Value" "PB|CA=#18Plot R20:TO=FH&dummy|AC=#215bt_Display_Plot&#213Execute,_R20_|<none>|0"
element 23 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_20.lbl_11"
element 23 "Value" "LA|CA=#216   \174\012  ---:FI=FF|<none>|<none>|0"
element 24 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_20.bt_Z20"
element 24 "Value" "PB|CA=#18Plot Z20:TO=FH&dummy|AC=#15_Z20_&#212Display Plot|<none>|0"
element 25 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_ROUT"
element 25 "Value" "TL|OR=VE|<none>|#15lbl_1:#16lbl_11:#213checkbox_Rout:#17ed_ROUT:#17lbl_111|0"
element 26 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_ROUT.ed_ROUT"
element 26 "Value" "ED|CO=5:VA=%#14ROUT:SF=%ROUT_stripoff:TO=FW&FH&LW&LH|EP=#215Imped2Schematic&#17Execute:FL=#215Imped2Schematic&#17Execute|<none>|0"
element 27 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_ROUT.lbl_1"
element 27 "Value" "LA|CA=#17---o---:FI=FF|<none>|<none>|1"
element 28 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_ROUT.lbl_111"
element 28 "Value" "LA|CA=#216   \174\012  ---:FI=FF:SF=%ROUT_stripoff|<none>|<none>|0"
element 29 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_ROUT.checkbox_Rout"
element 29 "Value" "CB|CA=#14ROUT:SC=3:TS=%ROUT_stripoff|TC=#215Imped2Schematic&#17Execute|<none>|0"
element 30 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_10.checkbox_CparR"
element 30 "Value" "CB|CA=#210C//R (bip):SC=3:TS=%C_par_R|TC=#215Imped2Schematic&#17Execute|<none>|0"
element 31 "Name" "tbl_sweep_orders.tbl_bottom.tbl_sel_sweep_order"
element 31 "Value" "TL|OR=VE:TO=MW&dummy|<none>|#216list_sweep_order:#210bt_move_up:#19bt_cancel:#15bt_ok|1|3"
element 32 "Name" "tbl_sweep_orders.tbl_bottom.tbl_sel_sweep_order.list_sweep_order"
element 32 "Value" "LI|CA=#213sweep\012name:IT=%#211sweep_order:SX=%#220sweep_index_selected:SF=T:VI=5|<none>|<none>|0"
element 33 "Name" "tbl_sweep_orders"
element 33 "Value" "TL|CA=#219adjust sweep orders:OR=VE|<none>|#210tbl_bottom|1|0"
element 34 "Name" "tbl_sweep_orders.tbl_bottom.tbl_sel_sweep_order.bt_move_up"
element 34 "Value" "PB|CA=#17Move Up:TO=MH&LH|AC=#214bt_sort_sweeps&#17Execute|<none>|0"
element 35 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_2nd_n_higher_order_sweeps"
element 35 "Value" "TL|MF=%show_tbl_sweeps:OR=HO:TO=FW&MW&TL|<none>|#220list_2nd_order_sweep:#220list_3rd_order_sweep:#220list_4th_order_sweep|1"
element 36 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_2nd_n_higher_order_sweeps.list_2nd_order_sweep"
element 36 "Value" "LI|CA=#2232nd sweep\072\012vd pts:IT=%#14swp2:MF=T:SI=%#213swp2_selected:SY=ES|LS=#215load_2nd_sweeps&#17Execute|<none>|1"
element 37 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_2nd_n_higher_order_sweeps.list_3rd_order_sweep"
element 37 "Value" "LI|CA=#2233rd sweep\072\012vg pts:IT=%#14swp3:MF=T:SI=%#213swp3_selected:SY=ES|LS=#215load_3rd_sweeps&#17Execute|<none>|0"
element 38 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_top.bt_close_all"
element 38 "Value" "PB|CA=#215Close all Plots:TO=FH&LH|AC=#11.&#19Close All|<none>|1"
element 39 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_top"
element 39 "Value" "TL|OR=HO|<none>|#211bt_simulate:#210PB_Open_PO:#212bt_close_all:#17bt_Help:#17bt_Exit|1"
element 40 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_top.bt_Help"
element 40 "Value" "PB|CA=#14HELP:TO=FH&LH|AC=#210./tbl_HELP&#226Display Modeless GUI, HELP|<none>|0"
element 41 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_top.bt_Exit"
element 41 "Value" "PB|CA=#14Exit:TO=FH&LH|AC=#230bt_exit_GUI_sel_sweeps_n_model&#19Execute,1|<none>|0"
element 42 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_top.bt_simulate"
element 42 "Value" "PB|CA=#212Simulate All:SF=%FlagSimul:TO=FH&LH|AC=#11.&#18Simulate|<none>|0"
element 43 "Name" "tbl_sweep_orders.tbl_bottom.tbl_sel_sweep_order.bt_cancel"
element 43 "Value" "PB|CA=#16Cancel:TO=MH&LH|AC=#225bt_cancel_GUI_sweeporders&#17Execute|<none>|0"
element 44 "Name" "tbl_sweep_orders.tbl_bottom"
element 44 "Value" "TL|OR=HO|<none>|#19tbl_space:#19tbl_index:#219tbl_sel_sweep_order|1|3"
element 45 "Name" "tbl_sweep_orders.tbl_bottom.tbl_index"
element 45 "Value" "TL|TO=MW&dummy|<none>|#224list_sweeporder_sequence:#13sep:#17bt_Help|1"
element 46 "Name" "tbl_sweep_orders.tbl_bottom.tbl_index.bt_Help"
element 46 "Value" "PB|CA=#14HELP:TO=FH&LH|AC=#16README&#17Execute|<none>|0"
element 47 "Name" "tbl_sweep_orders.tbl_bottom.tbl_index.sep"
element 47 "Value" "LA|<none>|<none>|<none>|0"
element 48 "Name" "tbl_sweep_orders.tbl_bottom.tbl_sel_sweep_order.bt_ok"
element 48 "Value" "PB|CA=#212OK, Continue:TO=MH&LH|AC=#223bt_exit_GUI_sweeporders&#17Execute|<none>|0"
element 49 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_2nd_n_higher_order_sweeps.list_4th_order_sweep"
element 49 "Value" "LI|CA=#2254th sweep\072\012temp pts:IT=%#14swp4:MF=F:SI=%#213swp4_selected:SY=ES|LS=#215load_4th_sweeps&#17Execute|<none>|0"
element 50 "Name" "tbl_sweep_orders.tbl_bottom.tbl_space"
element 50 "Value" "TL|<none>|<none>|<none>|0"
element 51 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps"
element 51 "Value" "TL|CA=#217Select the Sweeps:MF=%show_tbl_sweeps|<none>|#215tbl_sweep1_info:#229tbl_2nd_n_higher_order_sweeps|0"
element 52 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_sweep1_info"
element 52 "Value" "TL|OR=HO:TO=MH&dummy|<none>|#215lbl_sweep1_info:#216lbl_sweep1_info1:#19lbl_space|1"
element 53 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_sweep1_info.lbl_sweep1_info"
element 53 "Value" "LA|CA=#227NOTE\072   1st sweep is\072:TO=MW&dummy|<none>|<none>|0"
element 54 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_sweep1_info.lbl_sweep1_info1"
element 54 "Value" "LA|CA=%#210sweep1name:TO=MW&dummy|<none>|<none>|0"
element 55 "Name" "tbl_sel_sweeps_n_model.tbl_sweeps.tbl_sweep1_info.lbl_space"
element 55 "Value" "LA|<none>|<none>|<none>|0"
element 56 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons"
element 56 "Value" "TL|MF=%show_tbl_sweeps:OR=VE|<none>|#18lbl_HELP:#211bt_load_all:#212bt_load_none:#18LA_NrPts:#13sep:#217bt_reorder_sweeps:#17bt_Exit|0"
element 57 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons.bt_load_all"
element 57 "Value" "PB|CA=#213Load All     :TO=FW&FH&MW&MH&TL|AC=#211bt_load_all&#17Execute|<none>|0"
element 58 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons.bt_load_none"
element 58 "Value" "PB|CA=#19Load None:TO=FW&FH&MW&MH&TL|AC=#212bt_load_none&#17Execute|<none>|0"
element 59 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons.bt_Exit"
element 59 "Value" "PB|CA=#14Exit:TO=FH&LH|AC=#230bt_exit_GUI_sel_sweeps_n_model&#19Execute,1|<none>|0"
element 60 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons.bt_reorder_sweeps"
element 60 "Value" "PB|CA=#214Reorder Sweeps:TO=FH&MH&TL|AC=#217bt_reorder_sweeps&#17Execute|<none>|0"
element 61 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots"
element 61 "Value" "TL|FV=F:OR=VE|<none>|#19SparPlots:#19separator:#211bt_simulate|1"
element 62 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.SparPlots"
element 62 "Value" "TL|CA=#210Spar Plots:OR=VE:TO=FH&MH&LH|<none>|#214bt_open_Splots:#211bt_open_S11:#211bt_open_S12:#211bt_open_S21:#211bt_open_S22|1"
element 63 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.bt_simulate"
element 63 "Value" "PB|CA=#18Simulate:SF=%FlagSimul:TO=FH&MH&TL|AC=#11.&#18Simulate|<none>|0"
element 64 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_12.tbl1.lbl_space1"
element 64 "Value" "LA|<none>|<none>|<none>|0"
element 65 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.separator"
element 65 "Value" "SE|OR=HO|<none>|<none>|0"
element 66 "Name" "tbl_sel_sweeps_n_model.separator1"
element 66 "Value" "SE|OR=VE|<none>|<none>|0"
element 67 "Name" "tbl_sel_sweeps_n_model.separator2"
element 67 "Value" "SE|OR=VE|<none>|<none>|0"
element 68 "Name" "tbl_HELP.lbl_HELP"
element 68 "Value" "LA|CA=%#212txt_GUI_HELP:FI=FF:FG=C6|<none>|<none>|1|3"
element 69 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.SparPlots.bt_open_Splots"
element 69 "Value" "PB|CA=#214All Spar-Plots:TO=LH&FH&FW|AC=#212MP_sel_sweep&#212Display Plot|<none>|0"
element 70 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.SparPlots.bt_open_S11"
element 70 "Value" "PB|CA=#18Plot S11:TO=FW&FH&LH|AC=#218S11_selected_sweep&#212Display Plot|<none>|0"
element 71 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.SparPlots.bt_open_S12"
element 71 "Value" "PB|CA=#18Plot S12:TO=FW&FH&LH|AC=#218S12_selected_sweep&#212Display Plot|<none>|0"
element 72 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.SparPlots.bt_open_S21"
element 72 "Value" "PB|CA=#18Plot S21:TO=FW&FH&LH|AC=#218S21_selected_sweep&#212Display Plot|<none>|0"
element 73 "Name" "tbl_sel_sweeps_n_model.tbl_S_Plots.SparPlots.bt_open_S22"
element 73 "Value" "PB|CA=#18Plot S22:TO=FW&FH&LH|AC=#218S22_selected_sweep&#212Display Plot|<none>|0"
element 74 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons.sep"
element 74 "Value" "TL|<none>|<none>|<none>|0"
element 75 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons.lbl_HELP"
element 75 "Value" "LA|CA=#3122HELP\072\012Follow the steps\0121. -> 2. -> 3.\012Push the HELP\012button for help\012on the schematic \012interpretation.:FG=C6|<none>|<none>|0"
element 76 "Name" "tbl_HELP"
element 76 "Value" "TS|HT=700:WD=800|<none>|#18lbl_HELP|0|2"
element 77 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_top.PB_Open_PO"
element 77 "Value" "PB|CA=#212Open PlotOpt:SF=%FlagSimul:TO=FH&dummy|AC=#210bt_open_PO&#17Execute|<none>|0|3"
element 78 "Name" "tbl_sel_sweeps_n_model.tbl_actionbuttons.LA_NrPts"
element 78 "Value" "ED|BG=C8:CA=#211Nr.Data Pts:CO=11:ED=F:VA=%#19NrDataPts:TO=FW&FH&TL|<none>|<none>|0"
element 79 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_bottom"
element 79 "Value" "TL|OR=HO|<none>|#16bt_h21:#15bt_ft:#212bt_PowerGain:#217bt_fmax_PowerGain:#223bt_Unilateral_PowerGain:#222bt_fmax_UnilateralGain|0"
element 80 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_bottom.bt_h21"
element 80 "Value" "PB|CA=#18Plot H21:TO=FH&dummy|AC=#215bt_Display_Plot&#213Execute,_H21_|<none>|0"
element 81 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_bottom.bt_PowerGain"
element 81 "Value" "PB|CA=#214Plot PowerGain:TO=FH&dummy|AC=#215bt_Display_Plot&#219Execute,_PowerGain_|<none>|0"
element 82 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_bottom.bt_ft"
element 82 "Value" "PB|CA=#17Plot FT:TO=FH&dummy|AC=#215bt_Display_Plot&#212Execute,_ft_|<none>|0"
element 83 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_bottom.bt_fmax_PowerGain"
element 83 "Value" "PB|CA=#221Plot FMAX (PowerGain):TO=FH&dummy|AC=#215bt_Display_Plot&#229Execute,_fmax_from_PowerGain_|<none>|0"
element 84 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_gm.Space"
element 84 "Value" "TL|<none>|<none>|<none>|0"
element 85 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_schematic.tbl_ROUT.lbl_11"
element 85 "Value" "LA|CA=#229   \174\012   \174\012   \174:FI=FF:SF=%ROUT_stripoff|<none>|<none>|0"
element 86 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_bottom.bt_fmax_UnilateralGain"
element 86 "Value" "PB|CA=#223Plot FMAX (Unilat.Gain):TO=FH&dummy|AC=#215bt_Display_Plot&#234Execute,_fmax_from_UnilateralGain_|<none>|0"
element 87 "Name" "tbl_sel_sweeps_n_model.tbl_schematic_plots.tbl_bottom.bt_Unilateral_PowerGain"
element 87 "Value" "PB|CA=#221Plot Unilat.PowerGain:TO=FH&dummy|AC=#215bt_Display_Plot&#229Execute,_UnilateralPowerGain_|<none>|0"
element 88 "Name" "tbl_sweep_orders.tbl_bottom.tbl_index.list_sweeporder_sequence"
element 88 "Value" "LI|CA=#214sweep\012order:IT=%#15index:TO=FH&LH:VI=5|<none>|<none>|1"
element 89 "Name" ""
element 89 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,-170,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !NOTE: you can execute this README Transform and you will 
 !get a separate, easy-2-read HELP GUI.
 
 txt_GUI_HELP="This GUI and its underlaying Transforms convert the S-parameters of any kind 
 of transistors (bipolar, MOSFET, MESFET) into Y-parameters and then assume 
 a small-signal PI schematic for the transistor. This schematic serves to 
 inspect the meas. data, but also to tune/optimize the model parameters when
 calling the PlotOptimizer from the Plots of the schematic component plots.
 
 In other words, the GUI and the Transforms of this Setup have been written
 to be transistor-type independent and model-independent.
 
 Preface: the Inputs/Outputs in this Setup are auto-created by the Transforms 
 of this Setup, depending on the Inputs/Outputs of the parallel Setup 'DO_ALL'
 (specified by the Setup Variable 'path2data') 
 and your GUI-based choice of bias/freq data. 
 You have nothing to do with the Inputs/Outputs of this Setup!!!    
 The same applies to the Transforms and the GUIs. Just execute 'RUN_ALL'.  
 -> That's all !!
 
 Note: if external parasistics are defined by the user, they will be subtracted 
   before S2PI conversion.
   If their values are not correct, the converted inner-PI components
   (e.g. C10, the cap. between Port1 and Ground, i.e. CBE or CGS) will be 
   frequ. dependent. However, since both, meas. and simul. curves may 
   be freq. dependent in this case, modeling/fitting can be performed nevertheless.
 
 HOW TO USE THIS SETUP:
 1. Execute 'DO_ALL' in the parallel Setup 'DO_ALL'.
    - a 1st GUI will pop up which allows to change the sweep order of the data.
    - a 2nd GUI will finally pop up, which permits to select certain sweep conditions.
      > the sweep-selected S-parameters will be converted to Y-parameters, 
        what allows to inspect individual components of the underlying schematic
    Note: the 1st GUI will not pop up for fixed, constant DC biased S-parameters
 
 2. Select your DC bias points, your freq. points for your current modeling task
    Your total available data sweeps will be displayed in the Plots as grey curves,
    while your selection will be red (meas.) and blue (simul.).
    NOTE: the grey data are those from Setup 'DO_ALL' !
 
 3. Call the PlotOptimizer from any Plot of the Y-par schematic
    and perform a manual parameter tuning or an automatic optimization.
 
 > when finished with modeling, hit the 'Exit' button in the GUI
   This will re-establish the original sweep order in the original
   meas. data Setup.
 
 SOME MORE DETAILS ABOUT THIS SETUP:
 - The Transforms/GUIs in this Setup are written for up to 4 sweep orders, 
    but they can also be enhanced for more sweep orders.
 - The Transforms and GUIs are written model-independent. 
    ->>This permits to copy-paste this Setup to any other Model file!
     Examples: MOS, GaAs, Bipolar Model files.
 - The GUIs/Transforms support up to 4 sweep orders, 
    i.e. they permit to also do thermal modeling (Input TEMP) or scaling.
 
 IMPORTANT NOTE:- There is no convention or restriction with the Input names 
    of the remote meas.data Setup.
    However, the S-parameter Output should be called 'S_deemb'.
 
 NOTE:  the Transforms below '___data_convers___'  convert the Spars 
 to the schematic parameters. 
 This is followed by a group of Transforms belonging to the GUI
 'tbl_sweep_orders', and a group of Transforms belonging 
 to GUI 'tbl_sel_sweeps_n_model'.
 
 NOTE: For important details about this DUT 'TRANSISTOR_SPAR_MDLG',
 see also the README in Setup 'S2Y_Mdlg_GUI', and the notes in 
 Transform 'Imped2Schematic'."
 
 !---open the README GUI
 ICCAP_FUNC("./tbl_HELP", "Display Modeless GUI", "README")
 
 
 !----------------------------------------------------------------
 ! Explanations for some important Setup variables:
 !
 !   swp2		2nd order sweep
 !   swp2_selected
 !   swp3		3rd order sweep
 !   swp3_selected
 !   swp4		4th order sweep
 !   swp4_selected
 !   index	  	helps identifying the sweep index in the GUI
 !   xfm_autoexe    	if set =0, the Transform referring to that variable will immediately stop execution
 !   path2data	path to the Setup with the original S-parameter data
 !   sweepXname	name of sweepX in this current Setup; used in the Transforms and also for GUI annotation
 !   sweepXname_orig     original sweep order in the data Setup. To be restored when the Exit button
 !   		   was hit in the GUI
 !   ROUT	   	for off-stripping the DC ROUT before calculating the R20 and C20 traces
 !   ROUT_stripoff	flag for considering or not ROUT. Set by the check box in the GUI
 !   C_par_R	flag for interpretation of Y11 like R_series_C(MOS) or R_parallel_C(bip)
 !   txt_GUI_HELP	help text for this Setup and GUI. Displayed by GUI 'tbl_HELP'
 !   data_index	a data index identified with a right-mouse-click (middle-mouse for unix)
 !   identified_data  sweep data corresponding to [data_index]
 !   plots_avail	used by Transform adjust_Plot_entries
 !   sweep_order	array of available sweeps
 !   sweep_index_selected
 !   nr_sweeps	nr.of sweeps in orig. data set
 !   show_tbl_sweeps   manages GUI 'tbl_2nd_3rd_order_sweeps'
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "RUN_ALL" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GET_STRING "Enter the path to the Setup with the all-biases Spar meas.data", path2data, path2data
 GET_REAL "optional ex. parasitic (to be subtracted before S2PI conversion)
           L1", L1
 GET_REAL "R1", R1
 GET_REAL "L2", L2
 GET_REAL "R2", R2
 GET_REAL "L3", L3
 GET_REAL "R3", R3
 GET_REAL "C10", C10
 GET_REAL "C12", C12
 GET_REAL "C20", C20
 GET_INT  "Strip-Off ext. parasitics ?    [0], [1]", DoStripOff
 
 
 !initialize some variables
 xfm_autoexe=0
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 
 
 
 !---set sweep-name-remember-variables for proper restoring after exit
 sweep1name_orig=""
 sweep2name_orig=""
 sweep3name_orig=""
 sweep4name_orig=""
 dummy= USERC_sweep_name(1,VAL$(path2data),sweep1name_orig)
 dummy= USERC_sweep_name(2,VAL$(path2data),sweep2name_orig)
 dummy= USERC_sweep_name(3,VAL$(path2data),sweep3name_orig)
 dummy= USERC_sweep_name(4,VAL$(path2data),sweep4name_orig)
 
 nr_sweeps=4
 IF VAL$(sweep4name_orig)=="" THEN 
   sweep4name_orig="n/a"
   nr_sweeps=3
 END IF
 nr_sweeps=3
 IF VAL$(sweep3name_orig)=="" THEN 
   sweep3name_orig="n/a"
   nr_sweeps=2
 END IF
 IF VAL$(sweep2name_orig)=="" THEN 
   sweep2name_orig="n/a"
   nr_sweeps=1
 END IF
 
 
 cancel_all=0
 ICCAP_FUNC("open_GUI_sweeporders", "Execute")
 IF cancel_all==1 THEN RETURN_VALUE 0
 
 
 !---make sure the auto-execution functions of the Transforms are working
 ICCAP_FUNC("Reactivate_AutoExec", "Execute")
 
 !ICCAP_FUNC(".", "Simulate")
 
 !---open the Spar modeling GUI
 Path2GUI="./tbl_sel_sweeps_n_model.tbl_schematic_plots"
 IF VAL(DoStripOff)==1 THEN
   ICCAP_FUNC(Path2GUI, "Set GUI Options", "CA=Inner PI Schematic Plots, with off-stripped series L and R", "")
 ELSE
   ICCAP_FUNC(Path2GUI, "Set GUI Options", "CA=Inner PI Schematic Plots, no series L and R off-stripped", "")
 END IF
 ICCAP_FUNC("open_GUI_sel_sweeps_n_model", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____data_convers___________" "711.501"
{
}
LINK XFORM "strip_off_paras" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !--off-stripping of parasitics external to the inner PI schematic
 
 
 
 GLOBAL_VAR  DoStripOff
 GLOBAL_VAR  L1
 GLOBAL_VAR  R1
 GLOBAL_VAR  L2
 GLOBAL_VAR  R2
 GLOBAL_VAR  L3
 GLOBAL_VAR  R3
 GLOBAL_VAR  L1
 GLOBAL_VAR  C10
 GLOBAL_VAR  C12
 GLOBAL_VAR  C20
 
 
 
 IF VAL(DoStripOff)==0 THEN RETURN_VALUE 1
 
 
 !                     ---------||---------
 !               __   |        C12         |   __    
 ! P1 o---/\/\--|__|--o---O            O---o--|__|--/\/\---o P2
 !         L1    R1   |   Gate     Drain   |   R2    L2
 !                    |                    |
 !                   ---     Source       ---
 !                   ---C10     O         ---C20
 !                    |         |          |
 !                     ---------o----------
 !                              |   __          |
 !                               --|__|--/\/\---| GND
 !                                  R3    L3    |
 
 
 tmp_Z=TWOPORT(S_deemb.B, "S", "Z")
 
 FOR i=0 TO SIZEOF(tmp_Z)-1
   tmp_Z.M.11[i]=tmp_Z.M.11[i]-((R1+R3)+j*2*PI*freq[i]*(L1+L3))
   tmp_Z.S.11[i]=tmp_Z.S.11[i]-((R1+R3)+j*2*PI*freq[i]*(L1+L3))
   tmp_Z.M.12[i]=tmp_Z.M.12[i]-(R3+j*2*PI*freq[i]*L3)
   tmp_Z.S.12[i]=tmp_Z.S.12[i]-(R3+j*2*PI*freq[i]*L3)
   tmp_Z.M.21[i]=tmp_Z.M.21[i]-(R3+j*2*PI*freq[i]*L3)
   tmp_Z.S.21[i]=tmp_Z.S.21[i]-(R3+j*2*PI*freq[i]*L3)
   tmp_Z.M.22[i]=tmp_Z.M.22[i]-((R2+R3)+j*2*PI*freq[i]*(L2+L3))
   tmp_Z.S.22[i]=tmp_Z.S.22[i]-((R2+R3)+j*2*PI*freq[i]*(L2+L3))
 NEXT i
 
 
 tmp_Y=TWOPORT(tmp_Z.B, "Z", "Y")
 
 FOR i=0 TO SIZEOF(tmp_Y)-1
   tmp_Y.M.11[i]=tmp_Y.M.11[i]-j*2*PI*freq[i]*(C10+C12)
   tmp_Y.S.11[i]=tmp_Y.S.11[i]-j*2*PI*freq[i]*(C10+C12)
   tmp_Y.M.12[i]=tmp_Y.M.12[i]+j*2*PI*freq[i]*C12
   tmp_Y.S.12[i]=tmp_Y.S.12[i]+j*2*PI*freq[i]*C12
   tmp_Y.M.21[i]=tmp_Y.M.21[i]+j*2*PI*freq[i]*C12
   tmp_Y.S.21[i]=tmp_Y.S.21[i]+j*2*PI*freq[i]*C12
   tmp_Y.M.22[i]=tmp_Y.M.22[i]-j*2*PI*freq[i]*(C20+C12)
   tmp_Y.S.22[i]=tmp_Y.S.22[i]-j*2*PI*freq[i]*(C20+C12)
 NEXT i
 
 tmp_S = TWOPORT(tmp_Y.B, "Y", "S")
 
 RETURN tmp_S
}
dataset
{
datasize COMMON 1560 1 1
type COMMON
}
}
list XFORM "S2Imped"
}
LINK XFORM "S2Imped" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! NOTE: due to auto-execution, this Xfm may be auto-executed more than 1 time by IC-CAP (because the other PELs of ___data_convers___ depend on S2Imped)
 IF VAL(xfm_autoexe)==0 THEN 	!RETURN_VALUE 0  is not possible here, because Plots might be open which refer to the 2x2 data behind this Transform
   !  first check if Input 'freq' is present
   ErrMsg=""
   dummy = LOOKUP_TABLE_VAL("freq", "Sweep Type", ErrMsg)
   IF VAL$(ErrMsg)=="" THEN  
     COMPLEX tmp.22[SIZEOF(freq)]
     RETURN tmp
   ELSE
     RETURN_VALUE 0		!Inputs are about to change, 'freq' is not (yet) present , etc.etc.
   END IF
 END IF
 
 
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !calculate complex impedances from S_deemb
 !1. Transform the S parameters to Y
 
 !2. calculate the complex impedances and the complex GM
 !                 ___
 ! P1 o-------o---|___|---o------o--o P2
 !            |   Z_12    |       |
 !            -           -       -
 !      Z_10 | |        / | \    | | Z_20
 !            -         \ v /Gm   -
 !            |           -       |
 !            |           |       |
 !           ---         ---     ---
 !
 !             Z_10 = (Y11+Y12)^-1
 !             Z_20 = (Y22+Y12)^-1
 !             Z_12 = -Y12^-1
 !             Gm   = Y21 - Y12  = gm * exp(-j*2PI*TAU)
 
 !--- link to data
 IF VAL(DoStripOff)==0 THEN
   y=TWOPORT(S_deemb.B, "S", "Y")
 ELSE					!strip-off of external parasitics
   ICCAP_FUNC("strip_off_paras", "Execute")
   y=TWOPORT(strip_off_paras.B, "S", "Y")
 END IF
 
 
 Z_10 = (y.11+y.12)^-1
 Z_12 = (-y.12)^-1
 Gm   = y.21 - y.12
 Z_20 = (y.22+y.12)^-1
 
 ! return the data
 COMPLEX tmp.B.22[SIZEOF(S_deemb)]
 IF MEAN(S_deemb.M.11)<> 0 THEN
   FOR i=0 TO SIZEOF(tmp) -1
     tmp.M.11[i] = Z_10.M[i]
     tmp.M.12[i] = Z_12.M[i]
     tmp.M.21[i] = Gm.M[i]
     tmp.M.22[i] = Z_20.M[i]
   NEXT i
 END IF
 IF MEAN(S_deemb.S.11)<> 0 THEN
   FOR i=0 TO SIZEOF(tmp) -1
     tmp.S.11[i] = Z_10.S[i]
     tmp.S.12[i] = Z_12.S[i]
     tmp.S.21[i] = Gm.S[i]
     tmp.S.22[i] = Z_20.S[i]
   NEXT i
 END IF
 RETURN tmp
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list XFORM "Imped2Schematic"
list XFORM "h21"
list PLOT "_Z10_"
list PLOT "_Z12_"
list PLOT "_Z20_"
member XFORM "strip_off_paras"
}
LINK XFORM "Imped2Schematic" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! NOTE: due to auto-execution, this Xfm may be auto-executed more than 1 time by IC-CAP (don't worry)
 IF ROWSOF(S2Imped)==1 THEN RETURN_VALUE 0	!stop if S2Imped is no 2x2 matrix
 
 
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 txt_GUI_HELP="The S-par will be interpreted after this PI schematic:
 
 Two models for each, the input and output impedance, are selectable
 by SetupVariables 'C_par_R' and 'ROUT_stripoff':
 
  C_par_R=1     C_par_R=0 ___           ROUT_stripoff=1  ROUT_stripoff=0
 o---o---o-> or o-o--><--|___|--||-o--><---o----o--o  or <--o---o--o
     |   |        |       R12  C12 |       |    |           |   |   
     |   |       ---               |       |   ---          |   |   
     |   -       ---               |       |   ---          |   -   
 C10--- | |       |C10            / \      -    |C20    C20--- | |  
    ---  -R10     -              |GM |    | |   -          ---  -R20
     |   |       | |R10           \ /      -   | |R20       |   |   
     |   |        -                |   ROUT|    -           |   |   
     |   |        |                |       |    |           |   |   
    --- ---      ---              ---     ---  ---         --- ---  
 
 NOTE: select C_par_R=1 for bipolar and HBT transistors (ib<>0 !!)
 and C_par_R=0 for MOSFET and MESFET transistors (ig_DC=0 !!) 
 
 NOTE: activate the ROUT checkbox (ROUT_stripoff=1) if the
 traces in the impedance plot Z20 tend towards an x-axis
 end point >0. Deactivate if the end point tends towards 0.
 (This basically models an Early effect).
 
 The parameter values for the above schematic are then obtained as follows:
 --------------------------------------------------------------------------
 1. Transform 'S2Imped' (calculate complex impedances from S_deemb):
  -> Transform the de-embedded S parameters to Y
  -> Calculate the complex impedances and the complex GM
              Z_10 = (Y11+Y12)^-1
              Z_20 = (Y22+Y12)^-1
              Z_12 = -Y12^-1
              Gm   = Y21 - Y12  = gm * exp(-j*2PI*TAU)
 
 2. Transform 'Imped2Schematic':
  IF C_par_R=0
    R10 = REAL(Z_10)          C10 = -(IMAG(Z_10))^-1 // (2PI*f)
  IF C_par_R=1
    R10 = (REAL(Z_10^-1)^-1)  C10 = IMAG(Z_10^-1) // (2PI*f)
 
    R12 = REAL(Z_12)          C12 = -(IMAG(Z_12))^-1 // (2PI*f)
 
    GM  = MAG(Gm)             TAU = PH(Gm) / (2PI*f)
 
  IF ROUT_stripoff=1:    ZOUT_strippedoff=((Z20)^-1 - ROUT^-1)^-1
    R20 = REAL(ZOUT_strippedoff)  C20 = -(IMAG(ZOUT_strippedoff)^-1) // (2PI*freq)
 
  IF ROUT_stripoff=0:
    R20 = (REAL(Z_20^-1)^-1)      C20 = IMAG(Z_20^-1) // (2PI*f)  
 "
 
 
 
 !---here starts the Program--------------------
 ! solve for R=1/G ,  C , GM  and TAU
 IF C_par_R==0 THEN
   R10_ = REAL(S2Imped.11)
   C10_ = -(IMAG(S2Imped.11)^-1) // (2PI*freq)
 ELSE
   R10_ = (REAL(S2Imped.11^-1))^-1
   C10_ = IMAG(S2Imped.11^-1) // (2PI*freq)
 END IF
 
 R12_ = REAL(S2Imped.12)
 C12_ = -(IMAG(S2Imped.12)^-1) // (2PI*freq)
 
 GM_  = MAG(S2Imped.21)
 TAU_ = -PH(S2Imped.21)//(2PI*freq)
 
 Z20 = S2Imped.22	! impedance  Port2->GND
 IF ROUT_stripoff==1 THEN
   Z20_ROUTstrippedoff=Z20 - ROUT
   Y20_ROUTstrippedoff = Z20_ROUTstrippedoff^-1
   R20_ = (REAL(Y20_ROUTstrippedoff))^-1
   C20_ = IMAG(Y20_ROUTstrippedoff) // (2PI*freq)
 ELSE
   Y20 = Z20^-1
   R20_ = REAL(REAL(Y20))^-1		! we need to take the REAL(math conversion) because of rounding problems in PEL, which could add small IMAG parts, which affect the REAL part after e.g. calculating the inverse 
   C20_ = IMAG(Y20) // (2PI*freq)
 END IF
 
 
 ! return the data
 COMPLEX tmp.B.22[SIZEOF(S_deemb)]
 i=0
 WHILE i < SIZEOF(tmp)
   tmp.M.11[i] = REAL(R10_.M[i]) + j*REAL(C10_.M[i])
   IF VAL(FlagSimul)==1 THEN tmp.S.11[i] = REAL(R10_.S[i]) + j*REAL(C10_.S[i])
   tmp.M.12[i] = REAL(R12_.M[i]) + j*REAL(C12_.M[i])
   IF VAL(FlagSimul)==1 THEN tmp.S.12[i] = REAL(R12_.S[i]) + j*REAL(C12_.S[i])
   tmp.M.21[i] =  REAL(GM_.M[i]) + j*REAL(TAU_.M[i])
   IF VAL(FlagSimul)==1 THEN tmp.S.21[i] =  REAL(GM_.S[i]) + j*REAL(TAU_.S[i])
   tmp.M.22[i] = REAL(R20_.M[i]) + j*REAL(C20_.M[i])
   IF VAL(FlagSimul)==1 THEN tmp.S.22[i] = REAL(R20_.S[i]) + j*REAL(C20_.S[i])
   i = i + 1
 END WHILE
 
 
 RETURN tmp
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list PLOT "_R10_"
list PLOT "_C10_"
list PLOT "_C12_"
list PLOT "_R12_"
list PLOT "_GM_"
list PLOT "_TAU_"
list PLOT "_C20_"
list PLOT "_R20_"
member XFORM "S2Imped"
}
LINK XFORM "h21" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! NOTE: due to auto-execution, this Xfm may be auto-executed more than 1 time by IC-CAP (don't worry)
 IF ROWSOF(S2Imped)==1 THEN RETURN_VALUE 0	!stop if S2Imped is no 2x2 matrix
 
 
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 h=TWOPORT(S_deemb.B, "S", "H")
 
 
 RETURN MAG(h.21)
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list XFORM "ft"
list PLOT "_H21_"
member XFORM "S2Imped"
}
LINK XFORM "ft" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! NOTE: due to auto-execution, this Xfm may be auto-executed more than 1 time by IC-CAP (don't worry)
 IF VAL(xfm_autoexe)==0 THEN RETURN_VALUE 0
 
 
 
 PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 RETURN MAG(h21)*freq
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list PLOT "_ft_"
member XFORM "h21"
}
LINK XFORM "PowerGain" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 IF VAL(xfm_autoexe)==0 THEN RETURN_VALUE 0
 
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !---calculate Mason's Power Gain
 !   which -different to the Unilateral Gain-
 !   considers power transmission Port1->Port2 and also Port2->Port1.
 RETURN  EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/PowerGain", S_deemb)
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list XFORM "fmax_from_PowerGain"
list PLOT "_PowerGain_"
}
LINK XFORM "fmax_from_PowerGain" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 IF VAL(xfm_autoexe)==0 THEN RETURN_VALUE 0
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! NOTE: due to auto-execution, this Xfm may be auto-executed more than 1 time by IC-CAP (don't worry)
 
 
 ! The 'fmax' calculation is after the formula given in the Modeling Handbook in chapter
 ! 2_MEASUREMENTS\2_4_NetworkAnalyzer\1_TwoPort\3_SPAR\7a_Amplifier_Characteristics_from_Spar_MHB_doc.pdf  (March 2008)
 
 
 !Since Transform 'PowerGain' returned dB, we need
 !to calculate the Power Gain w/o dB
 COMPLEX tmp.B[SIZEOF(PowerGain)]
 i=0
 WHILE i < SIZEOF(tmp)
   IF MEAN(S_deemb.M.11)<>0 THEN tmp.M[i] = 10^(PowerGain.M[i]//10)
   IF MEAN(S_deemb.S.11)<>0 THEN tmp.S[i] = 10^(PowerGain.S[i]//10)
   i = i + 1
 END WHILE
 
 
 RETURN SQRT(tmp)*freq
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list PLOT "_fmax_from_PowerGain_"
member XFORM "PowerGain"
}
LINK XFORM "Unilateral_PowerGain" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 IF VAL(xfm_autoexe)==0 THEN RETURN_VALUE 0
 
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! Mason's Unilateral Power Gain (U) for a linear two-port device.
 ! Power Transmission from Port1->Port2 only.
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/U", S_deemb)
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list PLOT "_UnilateralPowerGain_"
}
LINK XFORM "fmax_from_UnilateralGain" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 IF VAL(xfm_autoexe)==0 THEN RETURN_VALUE 0
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---calc. fmax from Unilateral Gain
 RETURN EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/SPAR_KEYFIGURES/fmax", freq, S_deemb)
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
list PLOT "_fmax_from_UnilateralGain_"
}
LINK XFORM "___________________1" "711.501"
{
}
LINK XFORM "open_GUI_sweeporders" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---check how many sweeps are present in the data set
 nr_sweeps=4
 IF VAL$(sweep4name_orig)=="n/a" THEN nr_sweeps=3
 IF VAL$(sweep3name_orig)=="n/a" THEN nr_sweeps=2
 IF VAL$(sweep2name_orig)=="n/a" THEN nr_sweeps=1
 
 
 
 !---create and fill 'index' array
 DIMENSION_ARRAY(index, nr_sweeps)
 FOR i=0 TO nr_sweeps-1
   index[i]=i+1
 NEXT i
 
 !---create and fill 'sweep_order' array
 DIMENSION_ARRAY(sweep_order, nr_sweeps)
 FOR i=0 to nr_sweeps-1
   dummy= USERC_sweep_name(i+1, VAL$(path2data), aux)
   sweep_order[i]=aux
 NEXT i
 
 !---initialize selection index
 sweep_index_selected=1
 
 !---open the GUI
 IF nr_sweeps>1 THEN ICCAP_FUNC("./tbl_sweep_orders", "Display Modal GUI", "Sweep Orders")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_sort_sweeps" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 IF sweep_index_selected==0 THEN RETURN_VALUE 0
 
 !---handle the GUI
 tmp=VAL$(sweep_order[sweep_index_selected-1])
 sweep_order[sweep_index_selected-1] = sweep_order[sweep_index_selected]
 sweep_order[sweep_index_selected]   = tmp
 
 sweep_index_selected=sweep_index_selected-1
 
 
 !---update the sweep order in the all-biases Setup and reload the data
 ICCAP_FUNC(VAL$(path2data), "Export Data Measured", "tmp")
 i=0
 WHILE i < SIZEOF(sweep_order)
   ICCAP_FUNC(VAL$(path2data)&"/"&VAL$(sweep_order[i]), "SetTableFieldValue", "Sweep Order", VAL$(i+1))
   i = i + 1
 END WHILE
 ICCAP_FUNC(VAL$(path2data), "Import Measured Data", "tmp")
 
 
 !---make sure the auto-execution functions of the Transforms are working
 ICCAP_FUNC("Reactivate_AutoExec", "Execute")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_exit_GUI_sweeporders" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---destroy the GUI
 ICCAP_FUNC("./tbl_sweep_orders", "Destroy GUI", "Sweep Orders")
 
 
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_cancel_GUI_sweeporders" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 cancel_all=1
 
 ICCAP_FUNC("./tbl_sweep_orders", "Destroy GUI", "Sweep Orders")
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________2" "711.501"
{
}
LINK XFORM "open_GUI_sel_sweeps_n_model" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 xfm_autoexe=0		!stop auto-execution in other PEL Programs
 
 ICCAP_FUNC(".", "Close All")
 
 !---get measured data from Setup 'DO_ALL'
 ICCAP_FUNC(VAL$(path2data), "Export Data Measured", "tmp")
 ICCAP_FUNC(".", "Import Create", "tmp")
 ICCAP_FUNC("S_deemb", "SetTableFieldValue", "Type", "B")
 
 ICCAP_FUNC(".", "cleardata/simulated")
 
 !---re-establish auto-execution after ImportCreate
 xfm_autoexe=1
 ICCAP_FUNC("Reactivate_AutoExec", "Execute")
 
 
 !---set sweep name variables correctly
 sweep1name="n/a"
 sweep2name="n/a"
 sweep3name="n/a"
 sweep4name="n/a"
 dummy= USERC_sweep_name(1,".",sweep1name)
 IF nr_sweeps>1 THEN dummy= USERC_sweep_name(2, ".", sweep2name)
 IF nr_sweeps>2 THEN dummy= USERC_sweep_name(3, ".", sweep3name)
 IF nr_sweeps>3 THEN dummy= USERC_sweep_name(4, ".", sweep4name)
 
 
 !---update plot X-axis entries
 ICCAP_FUNC("adjust_Plot_entries", "Execute")
 
 
 !---initialize the selection GUI
 ICCAP_FUNC("prepare_GUI_variables", "Execute")
 !ICCAP_FUNC("bt_load_none", "Execute")
 
 !suppress the sweep_selection GUI if there is only 1  sweep
 show_tbl_sweeps=1
 IF nr_sweeps==1 THEN show_tbl_sweeps=0
 
 !---activate/deactivate the sweep values sel. GUIS
 !   and change the GUI Captions of the sweep names
 Path2Childraw="./tbl_sel_sweeps_n_model.tbl_sweeps.tbl_2nd_n_higher_order_sweeps"
 Path2Child=VAL$(Path2Childraw)&".list_2nd_order_sweep"
 IF nr_sweeps > 1 THEN
   ICCAP_FUNC(Path2Child, "Set GUI Options", "MF=T", "")	!show the GUI: Managed=TRUE
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA=2nd sweep:
 "&VAL$(sweep2name)&" pts", "")
 ELSE
   ICCAP_FUNC(Path2Child, "Set GUI Options", "MF=F", "")
 END IF
 
 Path2Child=VAL$(Path2Childraw)&".list_3rd_order_sweep"
 IF nr_sweeps > 2 THEN
   ICCAP_FUNC(Path2Child, "Set GUI Options", "MF=T", "")	!show the GUI: Managed=TRUE
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA=3rd sweep:
 "&VAL$(sweep3name)&" pts", "")
 ELSE
   ICCAP_FUNC(Path2Child,"Set GUI Options", "MF=F", "")
 END IF
 
 Path2Child=VAL$(Path2Childraw)&".list_4th_order_sweep"
 IF nr_sweeps > 3 THEN
   ICCAP_FUNC(Path2Child, "Set GUI Options", "MF=T", "")	!show the GUI: Managed=TRUE
   ICCAP_FUNC(Path2Child, "Set GUI Options", "CA=4th sweep:
 "&VAL$(sweep4name)&" pts", "")
 ELSE
   ICCAP_FUNC(Path2Child, "Set GUI Options", "MF=F", "")
 END IF
 
 
 
 
 
 !---show the Spar plots
 ICCAP_FUNC("MP_sel_sweep", "Display Plot")
 
 !---simulate
 IF VAL(FlagSimul)==1 THEN ICCAP_FUNC(".", "Simulate")
 
 
 !---open the GUI
 ICCAP_FUNC("./tbl_sel_sweeps_n_model", "Display Modeless GUI", "Select Sweep Values and Model PI Schematic")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "adjust_Plot_entries" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---enter the sweep1 name into the plots
 plots_avail=""
 ICCAP_FIND_CHILDREN ".", "Plot", plots_avail
 i=0
 WHILE i < SIZEOF(plots_avail)
   ! handle XY Plot
   X_Data_entry = LOOKUP_TABLE_VAL(VAL$(plots_avail[i]), "X Data" ,errstr)
   IF VAL$(errstr)=="" THEN
     ICCAP_FUNC(VAL$(plots_avail[i]), "SetTableFieldValue", "X Data", VAL$(sweep1name))
     ! if 1st sweep is freq, set x-axis to LOG, else to LIN
     IF VAL$(sweep1name)=="freq" THEN 
       ICCAP_FUNC(VAL$(plots_avail[i]), "SetTableFieldValue", "X Axis Type", "LOG10")
     ELSE
       ICCAP_FUNC(VAL$(plots_avail[i]), "SetTableFieldValue", "X Axis Type", "LINEAR")
     END IF
   END IF
   ! handle Smith, Polar or RI plot
   X_Data_entry = LOOKUP_TABLE_VAL(VAL$(plots_avail[i]), "Sweep Data" ,errstr)
   IF VAL$(errstr)=="" THEN
     ICCAP_FUNC(VAL$(plots_avail[i]), "SetTableFieldValue", "Sweep Data", VAL$(sweep1name))
   END IF
   i= i + 1
 END WHILE
 plots_avail=""
 
 !---adjust the link to the Setup of 'all-bias-Spar-data' in the Spar-selection plots
 IF MEAN(../DO_ALL/S_deemb.M.11)<>0 THEN
   ICCAP_FUNC("S11_selected_sweep", "SetTableFieldValue", "Smith Data 0", "../DO_ALL/S_deemb.M.11!!All Data")
   ICCAP_FUNC("S12_selected_sweep", "SetTableFieldValue", "Polar Data 0", "../DO_ALL/S_deemb.M.12!!All Data")
   ICCAP_FUNC("S21_selected_sweep", "SetTableFieldValue", "Polar Data 0", "../DO_ALL/S_deemb.M.21!!All Data")
   ICCAP_FUNC("S22_selected_sweep", "SetTableFieldValue", "Smith Data 0", "../DO_ALL/S_deemb.M.22!!All Data")
 ELSE
   IF VAL(FlagSimul)==1 THEN
     ICCAP_FUNC("S11_selected_sweep", "SetTableFieldValue", "Smith Data 0", "../DO_ALL/S_deemb.S.11!!All Data")
     ICCAP_FUNC("S12_selected_sweep", "SetTableFieldValue", "Polar Data 0", "../DO_ALL/S_deemb.S.12!!All Data")
     ICCAP_FUNC("S21_selected_sweep", "SetTableFieldValue", "Polar Data 0", "../DO_ALL/S_deemb.S.21!!All Data")
     ICCAP_FUNC("S22_selected_sweep", "SetTableFieldValue", "Smith Data 0", "../DO_ALL/S_deemb.S.22!!All Data")
   END IF
 END IF
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member OUT "DO_ALL/S_deemb"
}
LINK XFORM "prepare_GUI_variables" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---get nr. points of each sweep 
 vpts1 = USERC_num_of_points(1, ".")				!get nr. pts of 1st order sweep
 vpts2 = 0
 IF nr_sweeps>1 THEN vpts2  = USERC_num_of_points(2, ".")		!get nr. pts of 2nd order sweep
 vpts3 = 0
 IF nr_sweeps>2 THEN vpts3  = USERC_num_of_points(3, ".")		!get nr. pts of 3rd order sweep
 vpts4 = 0
 IF nr_sweeps>3 THEN vpts4  = USERC_num_of_points(4, ".")		!get nr. pts of 4th order sweep
 
 !---create and fill up array swp2 (2nd order sweep values)
 swp2=""
 IF nr_sweeps>1 THEN
   swp2="ICCAP_ARRAY["&VAL$(vpts2)&"]"		!specify Setup Variables array of nr of 2nd order sweep pts
   swp2_selected="ICCAP_ARRAY["&VAL$(vpts2)&"]"
   sweep2=DATASET("quiet "&VAL$(sweep2name))	!set local sweep2 data array to Input array of sweep2
   i=0
   WHILE i < vpts2
     swp2[i]=sweep2[i*vpts1]
     swp2_selected[i]=i
     i = i + 1
   END WHILE
 END IF
 
 !---create and fill up array swp3 (3rd order sweep values)
 swp3=""
 IF nr_sweeps>2 THEN
   swp3="ICCAP_ARRAY["&VAL$(vpts3)&"]"		!specify Setup Variables array of nr of 3rd order sweep pts
   swp3_selected="ICCAP_ARRAY["&VAL$(vpts3)&"]"
   sweep3=DATASET("quiet "&VAL$(sweep3name))	!set local sweep3 data array to Input array of sweep3
   i=0
   WHILE i < vpts3
     swp3[i]=sweep3[i*vpts1*vpts2]
     swp3_selected[i]=i
     i = i + 1
   END WHILE
 END IF
 
 !---create and fill up array swp4 (4th order sweep values)
 swp4=""
 IF nr_sweeps>3 THEN
   swp4="ICCAP_ARRAY["&VAL$(vpts4)&"]"		!specify Setup Variables array of nr of 4th order sweep pts
   swp4_selected="ICCAP_ARRAY["&VAL$(vpts4)&"]"
   sweep4=DATASET("quiet "&VAL$(sweep4name))	!set local sweep4 data array to Input array of sweep4
   i=0
   WHILE i < vpts4
     swp4[i]=sweep4[i*vpts1*vpts2*vpts3]
     swp4_selected[i]=i
     i = i + 1
   END WHILE
 END IF
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "load_2nd_sweeps" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 IF nr_sweeps<2 THEN RETURN_VALUE 0
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 xfm_autoexe=0
 
 
 !check if nothing was selected
 IF VAL$(swp2_selected)=="" THEN RETURN_VALUE 0
 
 !ICCAP_FUNC(".", "Close All")
 
 ICCAP_FUNC(VAL$(sweep2name), "SetTableFieldValue", "Sweep Type", "LIST")
 ICCAP_FUNC(VAL$(sweep2name), "SetTableFieldValue", "# of Values", VAL$(SIZEOF(swp2_selected)))
 i=0
 WHILE i < SIZEOF(swp2_selected)
   ICCAP_FUNC(VAL$(sweep2name), "SetTableFieldValue", "Value "&VAL$(i+1), VAL$(swp2[swp2_selected[i]]))
   i = i + 1
 END WHILE
 
 xfm_autoexe=1
 ICCAP_FUNC(".", "Import Measured Data", "tmp")
 
 !---make sure the auto-execution functions of the Transforms are working
 ICCAP_FUNC("Reactivate_AutoExec", "Execute")
 
 IF VAL(FlagSimul)==1 THEN ICCAP_FUNC(".", "Simulate")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "load_3rd_sweeps" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 IF nr_sweeps<3 THEN RETURN_VALUE 0
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 xfm_autoexe=0
 
 
 !check if nothing was selected
 IF VAL$(swp3_selected)=="" THEN RETURN_VALUE 0
 
 !ICCAP_FUNC(".", "Close All")
 
 ICCAP_FUNC(VAL$(sweep3name), "SetTableFieldValue", "Sweep Type", "LIST")
 ICCAP_FUNC(VAL$(sweep3name), "SetTableFieldValue", "# of Values", VAL$(SIZEOF(swp3_selected)))
 i=0
 WHILE i < SIZEOF(swp3_selected)
   ICCAP_FUNC(VAL$(sweep3name), "SetTableFieldValue", "Value "&VAL$(i+1), VAL$(swp3[swp3_selected[i]]))
   i = i + 1
 END WHILE
 
 xfm_autoexe=1
 ICCAP_FUNC(".", "Import Measured Data", "tmp")
 
 !---make sure the auto-execution functions of the Transforms are working
 ICCAP_FUNC("Reactivate_AutoExec", "Execute")
 
 IF VAL(FlagSimul)==1 THEN ICCAP_FUNC(".", "Simulate")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "load_4th_sweeps" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 IF nr_sweeps<4 THEN RETURN_VALUE 0
 
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 xfm_autoexe=0
 
 
 !check if nothing was selected
 IF VAL$(swp4_selected)=="" THEN RETURN_VALUE 0
 
 !ICCAP_FUNC(".", "Close All")
 
 ICCAP_FUNC(VAL$(sweep4name), "SetTableFieldValue", "Sweep Type", "LIST")
 ICCAP_FUNC(VAL$(sweep4name), "SetTableFieldValue", "# of Values", VAL$(SIZEOF(swp4_selected)))
 i=0
 WHILE i < SIZEOF(swp4_selected)
   ICCAP_FUNC(VAL$(sweep4name), "SetTableFieldValue", "Value "&VAL$(i+1), VAL$(swp4[swp4_selected[i]]))
   i = i + 1
 END WHILE
 
 xfm_autoexe=1
 ICCAP_FUNC(".", "Import Measured Data", "tmp")
 
 !---make sure the auto-execution functions of the Transforms are working
 ICCAP_FUNC("Reactivate_AutoExec", "Execute")
 
 IF VAL(FlagSimul)==1 THEN ICCAP_FUNC(".", "Simulate")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_load_all" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !activate all 2nd order biases
 swp2_selected=""
 IF nr_sweeps>1 THEN
   swp2_selected="ICCAP_ARRAY["&VAL$(SIZEOF(swp2))&"]"
   i=0
   WHILE i < SIZEOF(swp2)
     swp2_selected[i]=i
     i = i + 1
   END WHILE
 END IF
 
 !activate all 3rd order biases
 swp3_selected=""
 IF nr_sweeps>2 THEN
   swp3_selected="ICCAP_ARRAY["&VAL$(SIZEOF(swp3))&"]"
   i=0
   WHILE i < SIZEOF(swp3)
     swp3_selected[i]=i
     i = i + 1
   END WHILE
 END IF
 
 !activate all 4th order biases
 swp4_selected=""
 IF nr_sweeps>3 THEN
   swp4_selected="ICCAP_ARRAY["&VAL$(SIZEOF(swp4))&"]"
   i=0
   WHILE i < SIZEOF(swp4)
     swp4_selected[i]=i
     i = i + 1
   END WHILE
 END IF
 
 
 ICCAP_FUNC("load_2nd_sweeps", "Execute")
 ICCAP_FUNC("load_3rd_sweeps", "Execute")
 ICCAP_FUNC("load_4th_sweeps", "Execute")
 
 !load DC bias data from S-parameter measurement  with correct DC sweep orders   
 ICCAP_FUNC(".", "Import Data", "tmp")
 
 !---make sure the auto-execution functions of the Transforms are working
 ICCAP_FUNC("Reactivate_AutoExec", "Execute")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_load_none" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !deactivate all trans biases
 swp2_selected=""
 swp3_selected=""
 swp4_selected=""
 
 
 ICCAP_FUNC(".", "cleardata/both")
 
 NrDataPts=0
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_Display_Plot" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GET_STRING "PlotName", PlotName
 
 ICCAP_FUNC(VAL$(PlotName), "Display Plot")
 
 !---set the Plot to the settings defined by its window tile in the tab 'Plots'
 ICCAP_FUNC(VAL$(PlotName), "Reset to Saved Options")
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_open_PO" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 GET_INT "Enter your choice:
   [1] open the IC-CAP PlotOptimizer
   [2] open the Modeling GUI", 2, Answer
 
 
 IF VAL(Answer)== 1 THEN
   !---set PlotOptimizer options
   Path2PO="../../PlotOptimizer"
   ICCAP_FUNC(VAL$(Path2PO), "Clear PlotOptimizer")
   ICCAP_FUNC(VAL$(Path2PO), "STFV", "Max Evals", "25")
   ICCAP_FUNC(VAL$(Path2PO), "STFV", "Param Delta", "10m")
 
   !---open PlotOptimizer window
   Path2Model = WHOIS(".", "Parent Model")
   ICCAP_FUNC(VAL$(Path2Model), "Open PlotOptimizer")
 
 ELSEIF VAL(Answer)== 2 THEN
   !======================================================================================================================================================================================================================================================
   !---define here which individual Plots (*no* MultiPlots!) and which Parameters you want to use for this modeling step (a comma or comma-blank separated list)
   Plots      = "S11_selected_sweep, S12_selected_sweep, S21_selected_sweep, S22_selected_sweep, !_Z10_, !_Z12_, !_Z20_, !_C10_, !_R10_, !_C12_, !_R12_, !_GM_, !_TAU_, !_C20, !R20, !_H21_, !_ft_, !_PowerGain_, !_fmax_"
 			! Choices: Enter a comma-blanc separated list of Plots
 			!          -you can also include Plots of other Setups, using ../../Setup/Plot
 			!          -you can preceed plot names with a ! to enter them to the Plot list of the GUI as candidates, 
 			!            but not as currently active targets for the PO, e.g. !idvg
 			!          -setting Plots="" will open a GUI to manually select from all Plots of the current ModelFile
   Parameters = ""
 			! Choices: Enter a comma-blanc separated list of ModelParameters or Model Variables
 			!          You can preceed parameter names with a ! to enter them as candidates, e.g. !VTH
 			!          When linking to DutParameters: define Dutname.ParameterName
 			!          When linking to Variables: ModelVariables w/o any path, Dut and Setup by Dutname/Setupname/Variablename
 			!          -Parameters = "":    open the GUI without any Parameters predefined.
 			!                         User can select parameters from the GUI by himself.
 			!          -Parameters = "n/a": show only MultiPlot incl. Comment, no PlotSelect or ParamSelect GUI. No PlotOptimizer opened in the background: -> no simul/optim/tuning available
 			!                         Useful when just displaying current extraction results, without Tuning/Optimization.
 			!	 -Parameters = "Compare": show only MultiPlot incl. Comment, no ParamSelect GUI, but have the PlotOptimizer activated in the background to allow simulations  (e.g. when called by 'Compare_with_Previous')
   Comment    = "Select Plot(s) and Model Parameter(s)"
 			! The Comment will be displayed on top left of the MultiPlot. Enter "" for 'no comment'.
 			! If the Comment starts with 'FF: ', it will be displayed with Fixed Font (Couriel). Useful for pseudo-graphics.
   PO_Error   = "Relative"
 			! Preset of PlotOptimizer error. Choices: "Relative", "Absolute", "" (keeps last selection)
   !---call the starting Transform in UTILITIES:                                                        WHOAMI() = path to this Transform
   ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/START_MDLG_GUI", "Execute", Plots, Parameters, WHOAMI(), Comment, PO_Error)
   !======================================================================================================================================================================================================================================================
   !
   !---optional: activate Plot Legend for 1st Plot  (useful for TEMP mdlg etc.)
   !ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/_MP_", "Legend On", "0")
 
 ELSE
   GET_STRING "ERROR: enter either '1' or '2' !!!  [OK]", dummy
   RETURN_VALUE -1
 END IF
 
 
 RETURN_VALUE 1
 
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_reorder_sweeps" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 xfm_autoexe=0
 
 !---destroy GUI and close all Plots
 ICCAP_FUNC("./tbl_sel_sweeps_n_model", "Destroy GUI", "Select Sweep Values and Model Ypar Schematic")
 ICCAP_FUNC(".", "Close All")
 
 cancel_all=0
 ICCAP_FUNC("open_GUI_sweeporders", "Execute")
 IF cancel_all==1 THEN RETURN_VALUE 0
 
 ICCAP_FUNC("open_GUI_sel_sweeps_n_model", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "bt_exit_GUI_sel_sweeps_n_model" "711.501"
{
View block_edit 0 "0,-1"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---destroy the GUI if the Exit buttons from within the GUI were pressed
 !   don't kill it if it was already killed by hitting the X botton on the upper right frame (the window killer of the operating system !!)
 GET_INT "kill the GUI ?  [1], [0]", KillGUI	!this question is answered by the calling GUI section
 IF KillGUI==1 THEN ICCAP_FUNC("./tbl_sel_sweeps_n_model", "Destroy GUI", "Select Sweep Values and Model PI Schematic")
 
 ICCAP_FUNC(".", "Close All")
 
 
 
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Reactivate_AutoExec" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ! After an ImportCreate, execute this Program
 ! to re-establish the auto-execution links of the Transforms
 
 
 ICCAP_FUNC("S2Imped"  , "Execute")
 ICCAP_FUNC("h21"      , "Execute")
 ICCAP_FUNC("ft"       , "Execute")
 ICCAP_FUNC("PowerGain",                "Execute")
 ICCAP_FUNC("Unilateral_PowerGain",     "Execute")
 ICCAP_FUNC("fmax_from_PowerGain",      "Execute")
 ICCAP_FUNC("fmax_from_UnilateralGain", "Execute")
 
 
 !---calc. nr. of loaded data pts for GUI
 !  first check if Input 'freq' is present
 ErrMsg=""
 dummy = LOOKUP_TABLE_VAL("freq", "Sweep Type", ErrMsg)
 !  now calc. nr. pts
 IF VAL$(ErrMsg)=="" THEN  NrDataPts=SIZEOF(freq)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---clean up Inputs/Outputs
 ICCAP_FUNC(".", "Import Delete")
 
 
 !add Input 'See_under_ExtractOptimize'
 ICCAP_FUNC(".", "New Input", "See_under_ExtractOptimize") 
 ICCAP_FUNC("See_under_ExtractOptimize", "SetTableFieldValue", "Sweep Type", "CON")
 
 
 !--- clean up Setup Variables
 inputnames    = "ICCAP_ARRAY[0]"
 outputnames   = "ICCAP_ARRAY[0]"
 swp2          = "ICCAP_ARRAY[0]"
 swp2_selected = "ICCAP_ARRAY[0]"
 swp3          = "ICCAP_ARRAY[0]"
 swp3_selected = "ICCAP_ARRAY[0]"
 swp4          = "ICCAP_ARRAY[0]"
 swp4_selected = "ICCAP_ARRAY[0]"
 sweep_order   = "ICCAP_ARRAY[0]"
 index         = "ICCAP_ARRAY[0]"
 txt_GUI_HELP  = ""
 data_index    =""
 identified_data=""
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK PLOT "MP_sel_sweep" "711.501"
{
View plot_window 0 "36,406,33145,8996"
View draw_ds 0 "B,0,0"
TABLE "Plot Options" "711.501"
{
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "0"
element "Orientation" "H"
element "Plots Per Row" "4"
element "Header" "S-Parameters of Selected DC Biasings"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "S11_selected_sweep"
element "Plot 1" "S12_selected_sweep"
element "Plot 2" "S21_selected_sweep"
element "Plot 3" "S22_selected_sweep"
}
HYPTABLE "Multi GUI Table"
{
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S11_selected_sweep" "711.501"
{
View plot_window 0 "3,385,9915,8998"
View draw_ds 0 "B,0,2736"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "12" "N"
element 0 "On Black" "104" "N"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "1" "N"
element 1 "On Black" "1" "N"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "20" "N"
element 2 "On Black" "20" "N"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S11"
element "Footer" ""
element "Smith Data 0" "/XTOR_SPAR_CHECKTOOL/aux_TRANSISTOR_SPAR_MDLG/DO_ALL/S_deemb.M.11!!All Data"
element "Smith Data 1" "S_deemb.M.11"
element "Smith Data 2" "S_deemb.S.11"
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 1
}
}
LINK PLOT "S22_selected_sweep" "711.501"
{
View plot_window 0 "695,385,9915,8998"
View draw_ds 0 "B,0,6078"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "12" "N"
element 0 "On Black" "104" "N"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "1" "N"
element 1 "On Black" "1" "N"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "20" "N"
element 2 "On Black" "20" "N"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S22"
element "Footer" ""
element "Smith Data 0" "/XTOR_SPAR_CHECKTOOL/aux_TRANSISTOR_SPAR_MDLG/DO_ALL/S_deemb.M.22!!All Data"
element "Smith Data 1" "S_deemb.M.22"
element "Smith Data 2" "S_deemb.S.22"
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S21_selected_sweep" "711.501"
{
View plot_window 0 "248,382,9915,8998"
View draw_ds 0 "B,0,9420"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "12" "N"
element 0 "On Black" "104" "N"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "1" "N"
element 1 "On Black" "1" "N"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "20" "N"
element 2 "On Black" "20" "N"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S21"
element "Footer" ""
element "Polar Data 0" "/XTOR_SPAR_CHECKTOOL/aux_TRANSISTOR_SPAR_MDLG/DO_ALL/S_deemb.M.21!!All Data"
element "Polar Data 1" "S_deemb.M.21"
element "Polar Data 2" "S_deemb.S.21"
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "S12_selected_sweep" "711.501"
{
View plot_window 0 "421,383,9915,8998"
View draw_ds 0 "B,0,12762"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "12" "N"
element 0 "On Black" "104" "N"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "1" "N"
element 1 "On Black" "1" "N"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "20" "N"
element 2 "On Black" "20" "N"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S12"
element "Footer" ""
element "Polar Data 0" "/XTOR_SPAR_CHECKTOOL/aux_TRANSISTOR_SPAR_MDLG/DO_ALL/S_deemb.M.12!!All Data"
element "Polar Data 1" "S_deemb.M.12"
element "Polar Data 2" "S_deemb.S.12"
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_Z10_" "711.501"
{
View plot_window 0 "229,468,9908,8996"
View draw_ds 0 "B,0,16104"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z10"
element "Footer" ""
element "RI Data 0" "S2Imped.M.11!!Z10.M"
element "RI Data 1" "S2Imped.S.11!!Z10.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S2Imped"
}
LINK PLOT "_Z12_" "711.501"
{
View plot_window 0 "489,398,9915,8998"
View draw_ds 0 "B,0,19446"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z12"
element "Footer" ""
element "RI Data 0" "S2Imped.M.12!!Z12.M"
element "RI Data 1" "S2Imped.S.12!!Z12.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S2Imped"
}
LINK PLOT "_Z20_" "711.501"
{
View plot_window 0 "716,468,9915,8998"
View draw_ds 0 "B,0,22788"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line with Symbols" "N"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "RI GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Z20"
element "Footer" ""
element "RI Data 0" "S2Imped.M.22!!Z20.M"
element "RI Data 1" "S2Imped.S.22!!Z20.S"
element "RI Data 2" ""
element "RI Data 3" ""
element "RI Data 4" ""
element "RI Data 5" ""
element "RI Data 6" ""
element "RI Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S2Imped"
}
LINK PLOT "_R10_" "711.501"
{
View plot_window 0 "689,50,9915,8998"
View draw_ds 0 "B,0,26130"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Imped2Schematic.M.11)!!R10.M"
element "Y Data 1" "REAL(Imped2Schematic.S.11)!!R10.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
PlotOptimizerTraceSet "Y Data 0" "T" "Y Data 1"
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_C10_" "711.501"
{
View plot_window 0 "856,21,9915,8998"
View draw_ds 0 "B,0,30280"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C10"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(Imped2Schematic.M.11)!!C10.M"
element "Y Data 1" "IMAG(Imped2Schematic.S.11)!!C10.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
PlotOptimizerTraceSet "Y Data 0" "T" "Y Data 1"
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_C12_" "711.501"
{
View plot_window 0 "431,253,9915,8998"
View draw_ds 0 "B,0,34430"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(Imped2Schematic.M.12)!!C12.M"
element "Y Data 1" "IMAG(Imped2Schematic.S.12)!!C12.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
PlotOptimizerTraceSet "Y Data 0" "T" "Y Data 1"
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_R12_" "711.501"
{
View plot_window 0 "48,389,9915,8998"
View draw_ds 0 "B,0,38580"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R12"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Imped2Schematic.M.12)!!R12.M"
element "Y Data 1" "REAL(Imped2Schematic.S.12)!!R12.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
PlotOptimizerTraceSet "Y Data 0" "T" "Y Data 1"
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_GM_" "711.501"
{
View plot_window 0 "271,333,9908,8996"
View draw_ds 0 "B,0,42730"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "GM"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Imped2Schematic.M.21)!!GM.M"
element "Y Data 1" "REAL(Imped2Schematic.S.21)!!GM.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
PlotOptimizerTraceSet "Y Data 0" "T" "Y Data 1"
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_TAU_" "711.501"
{
View plot_window 0 "136,468,9908,8996"
View draw_ds 0 "B,0,46880"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "TAU"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(Imped2Schematic.M.21)!!TAU.M"
element "Y Data 1" "IMAG(Imped2Schematic.S.21)!!TAU.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_C20_" "711.501"
{
View plot_window 0 "480,373,9915,8998"
View draw_ds 0 "B,0,51030"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "C20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(Imped2Schematic.M.22)!!C20.M"
element "Y Data 1" "IMAG(Imped2Schematic.S.22)!!C20.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
PlotOptimizerTraceSet "Y Data 0" "T" "Y Data 1"
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_R20_" "711.501"
{
View plot_window 0 "689,0,9915,8998"
View draw_ds 0 "B,0,55180"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R20"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Imped2Schematic.M.22)!!R20.M"
element "Y Data 1" "REAL(Imped2Schematic.S.22)!!R20.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
PlotOptimizerTraceSet "Y Data 0" "T" "Y Data 1"
}
member XFORM "Imped2Schematic"
}
LINK PLOT "_H21_" "711.501"
{
View draw_ds 0 "B,0,59330"
View plot_window 0 "291,468,9915,8998"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "H21"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "h21.M"
element "Y Data 1" "h21.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "h21"
}
LINK PLOT "_ft_" "711.501"
{
View draw_ds 0 "B,0,63480"
View plot_window 0 "711,468,9915,8998"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "FT"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "ft.M"
element "Y Data 1" "ft.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "ft"
}
LINK PLOT "_PowerGain_" "711.501"
{
View draw_ds 0 "B,0,67630"
View plot_window 0 "245,468,9915,8998"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Mason's Power Gain (in dB - for LIN y-Axis !)"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "PowerGain.M!!PowerGain.M [dB]"
element "Y Data 1" "PowerGain.S!!PowerGain.S [dB]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PowerGain"
}
LINK PLOT "_fmax_from_UnilateralGain_" "711.501"
{
View draw_ds 0 "B,0,71780"
View plot_window 0 "434,399,9915,8998"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "FMAX from Unilateral Power Gain"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "fmax_from_UnilateralGain.M"
element "Y Data 1" "fmax_from_UnilateralGain.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "fmax_from_UnilateralGain"
}
LINK PLOT "_fmax_from_PowerGain_" "711.501"
{
View draw_ds 0 "B,0,75930"
View plot_window 0 "86,374,9915,8998"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "FMAX from Mason's Power Gain"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "fmax_from_PowerGain.M"
element "Y Data 1" "fmax_from_PowerGain.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "fmax_from_PowerGain"
}
LINK PLOT "_UnilateralPowerGain_" "711.501"
{
View draw_ds 0 "B,0,80080"
View plot_window 0 "245,468,9915,8998"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "freq"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Unilateral Power Gain (in dB - for LIN y-Axis !)"
element "Footer" ""
element "X Axis Type" "LOG10"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "10*LOG10(Unilateral_PowerGain.M)!!Unilateral PowerGain.M [dB]"
element "Y Data 1" "10*LOG10(Unilateral_PowerGain.S)!!Unilateral PowerGain.S [dB]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "Unilateral_PowerGain"
}
data "711.501"
{
TABLE "AgilentE5270.4000.17" "711.501"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "No"
element 0 "Range Manager Mode" "1"
element 0 "Range Manager Setting" "90"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Period" " 10.00m"
element 0 "Disable Self-cal" "No"
element 0 "Output I/O Port (ERC Command)" ""
element 0 "Output I/O Port (ERM Command)" ""
element 0 "Format Parameter (FMT Command)" "4"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
TABLE "AgilentPNA.4000.20" "711.501"
{
element 0 "Use User Sweep [Yes/No]" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Sweep Type[Step/Analog]" "S"
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port Src Power (dBm)" "-20.00 "
element 0 "Port 2 Src Power (dBm)" "-20.00 "
element 0 "Port Atten Auto [Y/N]" "No"
element 0 "Port Src Atten (dB)" " 0.000 "
element 0 "Port 2 Src Atten (dB)" " 0.000 "
element 0 "Power Slope (dB/GHz)" " 0.000 "
element 0 "Dwell Time (sec) [0=auto]" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor [1-1024]" "1"
element 0 "Ports Mapping" ""
element 0 "Cal Type [Hardware/None]" "H"
element 0 "Cal/State File Name [.csa|.cst only]" ""
element 0 "Use PNA Calibration Settings" "No"
element 0 "Use PNA Receiver Leveling" "No"
element 0 "Delay for timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
}
}
}
LINK DUT "NONLIN_RF_MDLG" "711.501"
{
View tree_dut 0 "0"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P239 P217 C23"
element 0 "Name" "Debug"
element 0 "Value" "0"
element 0 "Comment" "set to '1' to print names of executed Transforms"
element 1 "Name" "MDM_FILE_PATH"
element 1 "Value" ""
element 2 "Name" "MDM_FILE_NAME"
element 2 "Value" "tmp.mdm"
element 3 "Name" "MDM_EXPORT_XFORM_DATA"
element 3 "Value" "0"
element 4 "Name" "TEMP"
element 4 "Value" ""
element 5 "Name" "mdm_DirFileName"
element 5 "Value" "tmp"
element 5 "Comment" "name of temp. meas.data .mdm file, saved by DO_ALL/DO_ALL, and used later by the Programs of this DUT"
element 6 "Name" "_________________________1"
element 6 "Value" ""
element 7 "Name" "SHOW_INPUT_OUTPUT_FINDER"
element 7 "Value" "yes"
element 8 "Name" "SimulFlag"
element 8 "Value" "1"
element 9 "Name" "!SIMULATOR"
element 9 "Value" ""
element 9 "Comment" "apply rather the ModelVariable!!  - possible values: hpeesofsim, spmodeads, hspicemodeads"
element 10 "Name" "ErrMsg"
element 10 "Value" "ERROR: seems you have not defined a Variable 'FUNDFREQ' in your DUT TestCircuit."
element 11 "Name" "StopExec"
element 11 "Value" "1"
element 12 "Name" "tmpVar"
element 12 "Value" ""
element 13 "Name" "_________________________2"
element 13 "Value" ""
element 14 "Name" "txt_HELP"
element 14 "Value" "Domain Nonlin_i_v"
element 15 "Name" "______________GUI___________3"
element 15 "Value" ""
element 16 "Name" "GuiSensitivityDC"
element 16 "Value" "1"
element 17 "Name" "GuiSensitivityPin"
element 17 "Value" "0"
element 18 "Name" "GuiSensitivityXaxis"
element 18 "Value" "1"
element 19 "Name" "Domains"
element 19 "Value" "ICCAP_ARRAY[0]"
element 20 "Name" "DomainSel"
element 20 "Value" "0"
element 21 "Name" "xAxisChoices[0]"
element 21 "Value" "pin"
element 22 "Name" "xAxisChoices[1]"
element 22 "Value" "harmonics"
element 23 "Name" "xAxisChoices"
element 23 "Value" "ICCAP_ARRAY[2]"
element 24 "Name" "xAxisChoicesSel"
element 24 "Value" "0"
element 25 "Name" "VDC1_ValuesAvail"
element 25 "Value" "ICCAP_ARRAY[0]"
element 26 "Name" "VDC1_ValuesAvailSel"
element 26 "Value" "ICCAP_ARRAY[0]"
element 27 "Name" "VDC2_ValuesAvail"
element 27 "Value" "ICCAP_ARRAY[0]"
element 28 "Name" "VDC2_ValuesAvailSel"
element 28 "Value" "ICCAP_ARRAY[0]"
element 29 "Name" "pin_ValuesAvail"
element 29 "Value" "ICCAP_ARRAY[0]"
element 30 "Name" "pin_ValuesAvailSel"
element 30 "Value" "ICCAP_ARRAY[0]"
element 31 "Name" "NrHarmonics"
element 31 "Value" "ICCAP_ARRAY[0]"
element 32 "Name" "NrHarmonicsSel"
element 32 "Value" "0"
element 33 "Name" "!FUNDFREQ"
element 33 "Value" "this is a DUT Parameter !!"
element 33 "Comment" "used for handling LoadPull in netlist and PEL, also shown in the GUI"
element 34 "Name" "NrPts"
element 34 "Value" "0"
element 35 "Name" "_________________________4"
element 35 "Value" ""
element 36 "Name" ""
element 36 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "LA_Help"
element 0 "Value" "LA|CA=%#18txt_HELP:FG=C6|<none>|<none>|0|0"
element 1 "Name" "TL_Settings"
element 1 "Value" "TL|OR=VE|CA=#216DO_ALL/GUI_PB_OK&#17Execute|#15PB_OK:#17TL_Help:#215TL_SelectDomain:#213PB_Fit_Params:#215TL_ParamHistory:#220TL_Select_Plot_xAxis:#216TL_SelectStimuli|1|1"
element 2 "Name" "TL_Settings.TL_SelectDomain"
element 2 "Value" "TL|FV=T:TO=FH&dummy|<none>|#215LI_SelectDomain|1"
element 3 "Name" "TL_Settings.TL_SelectStimuli.PB_ApplySettings"
element 3 "Value" "PB|CA=#235\075\075> Apply Selection <\075\075:TO=FH&dummy|AC=#224DO_ALL/GUI_ValuesChanged&#221Execute,BiasesChanged|<none>|0"
element 4 "Name" "TL_Settings.TL_Help.PB_Help_RF_Mdlg"
element 4 "Value" "PB|CA=#214Help 'RF Mdlg':TO=FH&dummy|AC=#219DO_ALL/HELP_RF_Mdlg&#17Execute|<none>|0"
element 5 "Name" "TL_Settings.PB_OK"
element 5 "Value" "PB|CA=#224\075>  OK, Done !  <\075:TO=FW&FH|AC=#221DO_ALL/GUI_PB_OK_Done&#17Execute|<none>|0"
element 6 "Name" "TL_Settings.TL_Help"
element 6 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#17PB_Help:#215PB_Help_RF_Mdlg|1"
element 7 "Name" "TL_Settings.TL_Help.PB_Help"
element 7 "Value" "PB|CA=#213Help 'Domain':TO=FH&dummy|AC=#226DO_ALL/GUI_PB_Help_Domains&#17Execute|<none>|0"
element 8 "Name" "TL_Settings.TL_SelectDomain.LI_SelectDomain"
element 8 "Value" "LI|CA=#213SELECT DOMAIN:IT=%#17Domains:SX=%#19DomainSel:SY=SS:TO=FH&dummy:VI=7|LS=#224DO_ALL/GUI_DomainChanged&#17Execute|<none>|0"
element 9 "Name" "TL_Settings.TL_SelectStimuli"
element 9 "Value" "TL|FV=T:OR=VE|<none>|#16LI_pin:#17LI_VDC1:#17LI_VDC2:#216TL_HarmonicsInfo:#216PB_ApplySettings|1"
element 10 "Name" "TL_Settings.TL_SelectStimuli.LI_pin"
element 10 "Value" "LI|CA=#228Select pin (RF Power) Values:IT=%#215pin_ValuesAvail:MF=%GuiSensitivityPin:SI=%#218pin_ValuesAvailSel:SY=ES|<none>|<none>|0"
element 11 "Name" "TL_Settings.TL_SelectStimuli.LI_VDC1"
element 11 "Value" "LI|CA=#226Select VDC1 (Port1) Values:IT=%#216VDC1_ValuesAvail:MF=%GuiSensitivityDC:SI=%#219VDC1_ValuesAvailSel:SY=ES|<none>|<none>|0"
element 12 "Name" "TL_Settings.TL_SelectStimuli.LI_VDC2"
element 12 "Value" "LI|CA=#226Select VDC2 (Port2) Values:IT=%#216VDC2_ValuesAvail:MF=%GuiSensitivityDC:SI=%#219VDC2_ValuesAvailSel:SY=ES|<none>|<none>|0"
element 13 "Name" "TL_Settings.TL_SelectStimuli.TL_HarmonicsInfo.ED_freq"
element 13 "Value" "ED|BG=C8:CA=#17Fundam.:CO=5:ED=F:VA=%#18FUNDFREQ:TO=FH&dummy|<none>|<none>|0"
element 14 "Name" "TL_Settings.TL_SelectStimuli.TL_HarmonicsInfo"
element 14 "Value" "TL|OR=HO:TO=FH&dummy|<none>|#17ED_freq:#212SB_harmonics:#18LA_NrPts|1"
element 15 "Name" "TL_Settings.TL_SelectStimuli.TL_HarmonicsInfo.SB_harmonics"
element 15 "Value" "SB|CA=#18Nr. Harm:CO=5:IT=%#211NrHarmonics:TO=FH&dummy:SW=F:SS=%#214NrHarmonicsSel:ST=TS|<none>|<none>|0"
element 16 "Name" "TL_Settings.TL_SelectStimuli.TL_HarmonicsInfo.LA_NrPts"
element 16 "Value" "ED|BG=C8:CA=#16Nr.Pts:CO=5:ED=F:VA=%#15NrPts:TO=FH&dummy|<none>|<none>|0"
element 17 "Name" "TL_Settings.TL_Select_Plot_xAxis.DC_Select_xAxis"
element 17 "Value" "DC|IT=%#212xAxisChoices:SX=%#215xAxisChoicesSel|LS=#224DO_ALL/GUI_ValuesChanged&#220Execute,xAxisChanged|<none>|0"
element 18 "Name" "TL_Settings.TL_Select_Plot_xAxis"
element 18 "Value" "TL|CA=#218Select Plot x-Axis:FV=T:MF=%GuiSensitivityXaxis:OR=VE:TO=FH&dummy|<none>|#215DC_Select_xAxis|1"
element 19 "Name" "TL_Settings.PB_Fit_Params"
element 19 "Value" "PB|CA=#226\075> Fit Parameters <\075:MF=%SimulFlag:TO=FH&dummy|AC=#224DO_ALL/GUI_PB_Fit_Params&#17Execute|<none>|0"
element 20 "Name" "TL_Settings.TL_ParamHistory"
element 20 "Value" "TL|CA=#223Save/Recall Model Param:MF=%SimulFlag:OR=HO:TO=FH&dummy|<none>|#212PB_SaveParam:#216PB_CompareParams|1"
element 21 "Name" "TL_Settings.TL_ParamHistory.PB_SaveParam"
element 21 "Value" "PB|CA=#14Save:TO=FW&FH|AC=#221DO_ALL/GUI_SaveParams&#17Execute|<none>|0"
element 22 "Name" "TL_Settings.TL_ParamHistory.PB_CompareParams"
element 22 "Value" "PB|CA=#17Compare:TO=FH&dummy|AC=#224DO_ALL/GUI_CompareParams&#17Execute:VD=#223DO_ALL/GUI_ParamHistory&#215Execute,History:VI=#223DO_ALL/GUI_ParamHistory&#215Execute,History:EP=#223DO_ALL/GUI_ParamHistory&#17Execute|<none>|1"
element 23 "Name" ""
element 23 "Value" ""
}
LINK TCIRC "Test Circuit" "711.501"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "711.501"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P15 P100 P100 P100 P100 P100 P100 C13"
}
}
}
LINK CONN "Connection" "711.501"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "DO_ALL" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.6604489022078 7034 5667"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P22 P201 P178 P146"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" "!mdm_DirFileName"
element 2 "Value" "a DUT Variable"
element 3 "Name" "!ErrMsg"
element 3 "Value" "a DUT Variable"
element 4 "Name" "Path2DataSetup"
element 4 "Value" "/BSIM3_single_DC_Spar_Extract/NONLIN_RF_MDLG/Nonlin_RF_Mdlg"
element 4 "Comment" "Path to calling Setup (with the meas. data loaded)"
element 5 "Name" "___________________1"
element 5 "Value" ""
element 6 "Name" "PlotIndex"
element 6 "Value" "0"
element 6 "Comment" "Data Index shown by left mouse click into Plot"
element 7 "Name" "pinValue"
element 7 "Value" "-35"
element 7 "Comment" "used in Xfm GUI_ShowStimuli"
element 8 "Name" "freqValue"
element 8 "Value" "2E+009"
element 8 "Comment" "used in Xfm GUI_ShowStimuli"
element 9 "Name" "VDC1Value"
element 9 "Value" "0.8"
element 9 "Comment" "used in Xfm GUI_ShowStimuli"
element 10 "Name" "VDC2Value"
element 10 "Value" "2"
element 10 "Comment" "used in Xfm GUI_ShowStimuli"
element 11 "Name" "___________________2"
element 11 "Value" ""
element 12 "Name" "ModelingStepKeyword"
element 12 "Value" "myNMOS~EEHEMT~Mdlg_Result__6_NonlinRF~"
element 13 "Name" "mps_DirName"
element 13 "Value" "."
element 14 "Name" "___________________3"
element 14 "Value" ""
element 15 "Name" ""
element 15 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" "TL_Re_Open_NonlinRF_GUI"
element 0 "Value" "TL|<none>|<none>|#222PB_ReOpen_nonlinRF_GUI|0|2"
element 1 "Name" "TL_Re_Open_NonlinRF_GUI.PB_ReOpen_nonlinRF_GUI"
element 1 "Value" "PB|CA=#251\012\075\075>  Re-Open Nonlin RF GUI  <\075\075\012|AC=#222GUI_PB_ReOpen_nonlinRF&#17Execute|<none>|0"
element 2 "Name" "GUI_PortImpedances.GUI_Port_Impedances"
element 2 "Value" "TL|OR=HO|<none>|#15TL_P1:#210TL_RSOURCE:#211TL_CTERM_P1:#211TL_LTERM_P1:#16TL_DUT:#211TL_LTERM_P2:#18TL_ZLOAD:#211TL_CTERM_P2|1"
element 3 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_RSOURCE.ED_L1"
element 3 "Value" "ED|CA=#212\012R_SOURCE:CO=7:VA=%#18R_SOURCE:TO=FW&FH|<none>|<none>|0"
element 4 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P1"
element 4 "Value" "TL|OR=VE|<none>|#14LA_1:#211ED_CTERM_P1:#14LA_2|1"
element 5 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P1.ED_CTERM_P1"
element 5 "Value" "ED|CA=#18CTERM_P1:CO=7:VA=%#18CTERM_P1:TO=FW&dummy|<none>|<none>|0"
element 6 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_LTERM_P1.ED_LTERM_P1"
element 6 "Value" "ED|CA=#212\012LTERM_P1:CO=7:VA=%#18LTERM_P1:TO=FW&FH|<none>|<none>|0"
element 7 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P1.LA_1"
element 7 "Value" "LA|CA=#237\012\012---o---\012   \174\012   \174:FI=FF|<none>|<none>|0"
element 8 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P1.LA_2"
element 8 "Value" "LA|CA=#216   \174\012  ---:FI=FF|<none>|<none>|0"
element 9 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_RSOURCE"
element 9 "Value" "TL|OR=VE|<none>|#15ED_L1:#15Space|1"
element 10 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_RSOURCE.Space"
element 10 "Value" "TL|<none>|<none>|<none>|0"
element 11 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_LTERM_P1"
element 11 "Value" "TL|OR=VE|<none>|#211ED_LTERM_P1:#15Space|1"
element 12 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_LTERM_P1.Space"
element 12 "Value" "TL|<none>|<none>|<none>|0"
element 13 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_P1"
element 13 "Value" "TL|OR=VE|<none>|#14LA_1:#15Space|1"
element 14 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_P1.LA_1"
element 14 "Value" "LA|CA=#289\012\012  ----\012 \174\012 \174\012/ \134\012\134 /Pin\012 \174\012 \174\012 \174\012---:FI=FF|<none>|<none>|0"
element 15 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_P1.Space"
element 15 "Value" "TL|<none>|<none>|<none>|0"
element 16 "Name" "GUI_PortImpedances"
element 16 "Value" "TL|OR=VE|<none>|#15PB_OK:#18LA_Notes:#219GUI_Port_Impedances:#218LA_Notes_TypValues|0|1"
element 17 "Name" "GUI_PortImpedances.LA_Notes"
element 17 "Value" "LA|CA=#236Current NVNA Port Impedance settings:FG=C6|<none>|<none>|0"
element 18 "Name" "GUI_PortImpedances.LA_Notes_TypValues"
element 18 "Value" "TL|OR=HO|<none>|#15Space:#18PB_Reset:#18LA_Notes|1"
element 19 "Name" "GUI_PortImpedances.LA_Notes_TypValues.PB_Reset"
element 19 "Value" "PB|CA=#216Reset to Default:TO=FW&FH|AC=#225GUI_Reset_Port_Impedances&#17Execute|<none>|0"
element 20 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_DUT"
element 20 "Value" "TL|OR=VE|<none>|#14LA_1|1"
element 21 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_DUT.LA_1"
element 21 "Value" "LA|CA=#3134     _______\012    \174  DUT  \174\012--o-\174\046 Pads \174-o--\012    \174_______\174\012        \174\012        \174\012       ---:FI=FF|<none>|<none>|0"
element 22 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_LTERM_P2.ED_LTERM_P2"
element 22 "Value" "ED|CA=#212\012LTERM_P2:CO=7:VA=%#18LTERM_P2:TO=FW&FH|<none>|<none>|0"
element 23 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_LTERM_P2"
element 23 "Value" "TL|OR=VE|<none>|#211ED_LTERM_P2:#15Space|1"
element 24 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_LTERM_P2.Space"
element 24 "Value" "TL|<none>|<none>|<none>|0"
element 25 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_ZLOAD"
element 25 "Value" "TL|OR=VE|<none>|#14LA_1:#18ED_RLOAD:#14LA_2|1"
element 26 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_ZLOAD.ED_RLOAD"
element 26 "Value" "ED|CA=#16R_LOAD:CO=7:VA=%#16R_LOAD:TO=FW&dummy|<none>|<none>|0"
element 27 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_ZLOAD.LA_1"
element 27 "Value" "LA|CA=#237\012\012---o---\012   \174\012   \174:FI=FF|<none>|<none>|0"
element 28 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_ZLOAD.LA_2"
element 28 "Value" "LA|CA=#216   \174\012  ---:FI=FF|<none>|<none>|0"
element 29 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P2"
element 29 "Value" "TL|OR=VE|<none>|#14LA_1:#211ED_CTERM_P2:#14LA_2|1"
element 30 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P2.ED_CTERM_P2"
element 30 "Value" "ED|CA=#18CTERM_P2:CO=7:VA=%#18CTERM_P2:TO=FW&dummy|<none>|<none>|0"
element 31 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P2.LA_1"
element 31 "Value" "LA|CA=#233\012\012---\012   \174\012   \174:FI=FF|<none>|<none>|0"
element 32 "Name" "GUI_PortImpedances.GUI_Port_Impedances.TL_CTERM_P2.LA_2"
element 32 "Value" "LA|CA=#216   \174\012  ---:FI=FF|<none>|<none>|0"
element 33 "Name" "GUI_PadParasitics.GUI_PadParasitics"
element 33 "Value" "TL|OR=HO|<none>|#15TL_P1:#15TL_L1:#16TL_C10:#16TL_C12:#16TL_C20:#15TL_L2:#15TL_P2|0"
element 34 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L1.ED_L1"
element 34 "Value" "ED|CA=#12L1:CO=7:VA=%#17Lpad1.L:TO=FW&FH|<none>|<none>|0"
element 35 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C10"
element 35 "Value" "TL|OR=VE|<none>|#14LA_1:#16ED_C10:#14LA_2|1"
element 36 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C10.ED_C10"
element 36 "Value" "ED|CA=#13C10:CO=7:VA=%#18Cpad10.C:TO=FW&dummy|<none>|<none>|0"
element 37 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C12.ED_C12"
element 37 "Value" "ED|CA=#13C12:CO=7:VA=%#18Cpad12.C:TO=FW&FH|<none>|<none>|0"
element 38 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L2.ED_L2"
element 38 "Value" "ED|CA=#12L2:CO=7:VA=%#17Lpad2.L:TO=FW&FH|<none>|<none>|0"
element 39 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C10.LA_1"
element 39 "Value" "LA|CA=#250    --------\012   \174\012---o-o P1int\012   \174:FI=FF|<none>|<none>|0"
element 40 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C10.LA_2"
element 40 "Value" "LA|CA=#216   \174\012  ---:FI=FF|<none>|<none>|0"
element 41 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C20"
element 41 "Value" "TL|OR=VE|<none>|#14LA_1:#16ED_C20:#14LA_2|1"
element 42 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C20.ED_C20"
element 42 "Value" "ED|CA=#13C20:CO=7:VA=%#18Cpad20.C:TO=FW&dummy|<none>|<none>|0"
element 43 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C20.LA_1"
element 43 "Value" "LA|CA=#256--------\012        \174\012P2int o-o---\012        \174:FI=FF|<none>|<none>|0"
element 44 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C20.LA_2"
element 44 "Value" "LA|CA=#226        \174\012       ---:FI=FF|<none>|<none>|0"
element 45 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L1"
element 45 "Value" "TL|OR=VE|<none>|#211LA_TopSpace:#15ED_L1:#15Space|1"
element 46 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L1.Space"
element 46 "Value" "TL|<none>|<none>|<none>|0"
element 47 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C12"
element 47 "Value" "TL|OR=VE|<none>|#16ED_C12:#15Space|1"
element 48 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_C12.Space"
element 48 "Value" "TL|<none>|<none>|<none>|0"
element 49 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L2"
element 49 "Value" "TL|<none>|<none>|#211LA_TopSpace:#15ED_L2:#15Space|1"
element 50 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L2.Space"
element 50 "Value" "TL|<none>|<none>|<none>|0"
element 51 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P1"
element 51 "Value" "TL|OR=VE|<none>|#211LA_TopSpace:#14LA_1:#15Space|1"
element 52 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P1.LA_1"
element 52 "Value" "LA|CA=#16P1 o--:FI=FF|<none>|<none>|0"
element 53 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P1.Space"
element 53 "Value" "TL|<none>|<none>|<none>|0"
element 54 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P2"
element 54 "Value" "TL|OR=VE|<none>|#211LA_TopSpace:#14LA_1:#15Space|1"
element 55 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P2.LA_1"
element 55 "Value" "LA|CA=#16--o P2:FI=FF|<none>|<none>|0"
element 56 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P2.Space"
element 56 "Value" "TL|<none>|<none>|<none>|0"
element 57 "Name" "GUI_PadParasitics"
element 57 "Value" "TL|OR=VE|<none>|#15PB_OK:#18LA_Notes:#217GUI_PadParasitics:#218LA_Notes_TypValues|1|0"
element 58 "Name" "GUI_PadParasitics.LA_Notes"
element 58 "Value" "LA|CA=#3170OPEN and SHORT pad parasitics,\012to ensure that the transistor (nodes P1int and P2int)\012is embedded for the HB simulation identically to the measurement situation.\012:FG=C6|<none>|<none>|0"
element 59 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P1.LA_TopSpace"
element 59 "Value" "LA|CA=#14\012:TO=FH&dummy|<none>|<none>|0"
element 60 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L1.LA_TopSpace"
element 60 "Value" "LA|TO=FH&dummy|<none>|<none>|0"
element 61 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_P2.LA_TopSpace"
element 61 "Value" "LA|CA=#14\012:TO=FH&dummy|<none>|<none>|0"
element 62 "Name" "GUI_PadParasitics.GUI_PadParasitics.TL_L2.LA_TopSpace"
element 62 "Value" "LA|TO=FH&dummy|<none>|<none>|0"
element 63 "Name" "GUI_PadParasitics.LA_Notes_TypValues"
element 63 "Value" "TL|OR=HO|<none>|#211TL_DontKnow:#216TL_PadParasitics:#15Space:#18LA_Notes|0"
element 64 "Name" "GUI_PadParasitics.LA_Notes_TypValues.TL_DontKnow.PB_Set_to_typ_values"
element 64 "Value" "PB|CA=#233I  Don't  Know, Apply Typ. Values:TO=FW&FH|AC=#218GUI_Pad_Parasitics&#215Execute,Typical|<none>|0"
element 65 "Name" "GUI_PadParasitics.LA_Notes_TypValues.TL_PadParasitics.PB_Switch_off"
element 65 "Value" "PB|CA=#225Switch Off Pad Parasitics:TO=FW&FH|AC=#218GUI_Pad_Parasitics&#213Execute,Reset|<none>|0"
element 66 "Name" "GUI_PortImpedances.LA_Notes_TypValues.LA_Notes"
element 66 "Value" "LA|CA=#256     Note\072 all harmonics will be terminated by 50 Ohm:FG=C6|<none>|<none>|0"
element 67 "Name" "GUI_PortImpedances.LA_Notes_TypValues.Space"
element 67 "Value" "TL|<none>|<none>|<none>|0"
element 68 "Name" "GUI_PadParasitics.LA_Notes_TypValues.LA_Notes"
element 68 "Value" "LA|CA=#3124Note\072 P1int and P2int\012are the nodes of the\012device-under-test (DUT),\012while P1 and P2 are the\012GSG contact nodes:FG=C6:TO=FW&FH|<none>|<none>|0"
element 69 "Name" "GUI_PadParasitics.LA_Notes_TypValues.Space"
element 69 "Value" "TL|<none>|<none>|<none>|0"
element 70 "Name" "GUI_PortImpedances.PB_OK"
element 70 "Value" "PB|CA=#212OK, Continue:TO=FW&FH&TR|AC=#220./GUI_PortImpedances&#218Destroy Single GUI|<none>|0"
element 71 "Name" "GUI_PadParasitics.PB_OK"
element 71 "Value" "PB|CA=#212OK, Continue:TO=FW&FH&TR|AC=#219./GUI_PadParasitics&#218Destroy Single GUI|<none>|0"
element 72 "Name" "GUI_PadParasitics.LA_Notes_TypValues.TL_PadParasitics"
element 72 "Value" "TL|OR=VE|<none>|#213PB_Switch_off:#18LA_Notes|1"
element 73 "Name" "GUI_PadParasitics.LA_Notes_TypValues.TL_PadParasitics.LA_Notes"
element 73 "Value" "LA|CA=#265apply if NVNA meas. data don't \012include contact pad parasitics:FG=C6|<none>|<none>|0"
element 74 "Name" "GUI_PadParasitics.LA_Notes_TypValues.TL_DontKnow"
element 74 "Value" "TL|OR=VE|<none>|#220PB_Set_to_typ_values:#15Space|1"
element 75 "Name" "GUI_PadParasitics.LA_Notes_TypValues.TL_DontKnow.Space"
element 75 "Value" "LA|CA=#14\012|<none>|<none>|0"
element 76 "Name" ""
element 76 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! Important Note:
 !    the Outputs 'v1', 'i1', 'v2', 'i2' in the Setups of this DUT
 !    are *peak* values (as returned from ADS)
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 ! ==========================================================================
 ! THIS IS A CENTRAL PEL DEPOT FOR NON-LINEAR RF TRANSISTOR MODELING,
 ! INDEPENDENT OF THE APPLIED TYPE OF MODEL.
 ! IT WILL BE COPY-PASTED ITSELF INTO THE CALLING IC-CAP MODEL,
 ! AND BE EXECUTED THERE.
 !
 ! The DUT TestCircuit of this 'NONLIN_RF_MDLG' DUT will be filled
 ! with the one of the local nonlinRF DUT TestCircuit.
 ! Because the Inputs/Outputs of the Setups of this DUT
 ! refer to standardized simulation node names, make sure that you name 
 ! your nodes after this convention:
 ! ->  define HB_circuitry (P1_DC   P1_Pin   P1aux   P1  P2_DC  P2_AC   P2aux   P2)
 ! See the sub-circuit header in Transform 'Example_DutCkt_ADS' or 'Example_DutCkt_SpModeADS'.
 !
 ! Also, make sure to have defined in the nonlinRF 'TestCircuit' an auxiliary Parameter
 ! ->  FUNDFREQ		required for source/load pulling of fundamental only in DUT TestCircuit
 ! and in tab 'Circuit' the auxiliary Parameters
 ! ->  R_SOURCE                applied for tuning the simulation of the non-ideal terminations of the NVNA.
 ! ->  R_LOAD                  and best placed in tab 'Circuit' so that they appear
 ! ->  X_LOAD                  together with the model parameters in tab 'Model Parameters', and therefore,
 ! -> CTERM_P1                 will be saved together with them (to enable continuing with
 ! -> LTERM_P1                 modeling at a later date)
 ! -> CTERM_P2
 ! -> LTERM_P2
 ! For a practical example, see 
 ! Best_Practice_ICCAP\9_Modeling_Examples\1_Diode\5_Diode_DC_CV_Spar_NonlinRF_Time\Diode__DC_Spar_NonlinRF_Time__Util.mdl
 ! (get a copy by eMailing to  franz.sischka@SisConsult.de)
 !
 ! =================================================================================
 ! IMPORTANT NOTE: This utility calls also /UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI
 ! =================================================================================
 
 
 ! Why this modeling utility is located in UTILITIES.mdl:
 ! -------------------------------------------------------------------
 ! For consistency and easy maintenance, the original Transforms/GUIs
 ! for the this general transistor Spar modeling are located in a DUT of the
 ! UTILITIES.mdl file. This ensures that only *one* version
 ! of this feature exists, for all modeling tasks in all ModelFiles,
 ! what eases your program maintenance a lot.
 ! This DUT is then copy-pasted into the parallel loaded
 ! very ModelFile, and will be executed there.
 !
 ! IMPORTANT NOTE:
 ! When you make changes/modifications in that parallel ModelFile,
 ! don't forget to copy-paste your updated version back into UTILITIES.mdl.
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! A few words about the organization of this DUT
 ! Setup 'DO_ALL' is the main managing Setup.
 ! It handles the DUT-level GUI 'TL_Settings', and this GUI
 ! is linked by the MultiPlots in the Setups 'DC_Currents_vs_Pin', 'Time_Domain' etc.
 ! The Variables referred to in GUI 'TL_Settings' are defined in the tab DUT-Variables.
 ! Setup 'aux' holds central PEL programs, i.e. it handles the user-selected, 
 ! partial data loading into the Setups 'DC_Bias', 'Time_Domain' etc.
 
 ! The sequence of the Setups is the sequence shown later in the GUI.
 ! Therefore, this sequence represents a commonly used mdlg sequence, top->down.
 
 !---------------------------------------------------
 ! NOTES:
 ! supported .mdm sweep hierarchy for the original nonlin-RF data file
 ! (as imported from NVNA .mdf file):
 ! 1st sweep:  'pin'
 ! 2nd sweep:  'freq'  (HB)
 ! 3rd sweep:  'VDC1'
 ! 4th sweep:  'VDC2'
 ! NOTE: the Input names shown above are mandatory 
 !       for the Transforms in this DUT 'NONLIN_RF_MDLG'.
 !       When your names are different, please make the according changes.
 
 ! = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 
 
 ! How to add another Setup:
 !====================================
 ! In your local ModelFile (into which this DUT had been copy-pasted),
 ! copy-paste an existing Setup, e.g. DC_Operating_Points,
 ! and give it any name you want. (It will be auto-detected during 'DO_ALL'.)
 !
 ! Your added Setup needs
 ! > a Transform called 'README' in the style of the 'README' in 'DC_Operating_Points'.
 ! > a Transform, called 'Load_mdm_MeasData' in the style 
 !    of the example in Setup 'DC_Operating_Points'.
 !    When you have copied from an example Setup, adjust the contents of this file accordingly
 !     e.g. the ICCAP_FUNC() etc.
 !
 ! > a MultiPlot (with a link to the (DUT-)GUI).
 ! This MultiPlot *has* to be named
 ! - "MP_GUI_SetupName"
 !    with the appropriate Setup Name  
 !    e.g. SetupName = i_v_vs_Pin   -> PlotName = MP_GUI_i_v_vs_Pin
 !    See the example in Setup 'DC_Operating_Points'.
 
 ! Again, don't forget to adjust the Transform 'README' in your new Setup.
 
 ! That's all ;-)
 
 
 ! Once the above described steps have been performed, 
 ! copy-paste this DUT 'aux_NONLIN_RF_MDLG'
 ! back into UTILITIES, overwriting the existing DUT 'NONLIN_RF_MDLG',
 ! and re-lauch the nonlinear RF modeling from the corresponding 
 ! Transform in your corresponding Model.
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HELP_RF_Mdlg" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 
 txt_HELP="General RF Modeling Help
 ====================================================
 
 Always start nonlin. RF modeling with the very important 1st step:
 adjust the simulated Port2 impedance (and possibly also the Port1 impedance).
 Therefore, in Domain 'Wave_Spar_Load_vs_Pin', first fit the
 -> trace of Plot 'MAG_A2' for a single, centered DC bias setting: 
    - For Port2: tune/optimize the DUT Parameters (!)
       R_LOAD (fundamental), Lterm_P2.L and Cterm_P2.C (harmonics).
    - And for Port1: tune/optimize the DUT Parameters (!)
       Lterm_P1.L and Cterm_P1.C   [Note: the influence of R_SOURCE<>50 Ohm is negligible in practice]
 
 The 2nd important step, before any nonlinRF modeling, is to check data consistency:
 -> still in domain 'Wave_Spar_Load_vs_Pin', verify if the Spar calculated form the nonlin RF,
    at lowest applied RF signal power, match those of the NWA Spar measurements
    (at the fundamental freq).
 
 Note: in the GUI, when you reduce the number of harmonics-to-be-modeled from default 5 to e.g. 3,
 the selected max. nr. of harmonics will load only the requested nr.harmonics meas.data.
 
 
 
 A possible RF mdlg sequence:
 ----------------------------------------------------
 -> DC_Operating_Points: check if the HB simulation at low power 
    gives the same results as DC Output Plot
    (but now as a function of applied RF power)
    Don't forget to simultaneously monitor the DC forward output Plot !
 
 -> DC_Currents_vs_Pin: for any DC bias point, 
    for a selected output bias voltage, 
    model the trace of the DC currents vs. applied RF power
 
 -> AM_PM_vs_Pin: check how S21 is affected by large RF signal power
    Don't forget to simultaneously monitor the S21 Spar Plot, for all freq, all bias !
 
 -> Pout_Gain_vs_Pin:
 
 -> Time_Domain: 
 
 
 Note: you can apply the PlotOptimizer directly from this MultiPlot,
 or hit '=> Fit Parameters <=' to get a pre-configured Tuning/Optimization GUI
 
 Note: the Outputs 'v1', 'i1', 'v2', 'i2' are *peak* values"
 
 
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "HOW2USE" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !##########################################################
 !IMPORTANT NOTE: please check also the Transform 'README'.
 !##########################################################
 
 
 ! In your remote ModelFile, 
 ! which hosts a (empty or not) DUT called 'aux_NONLIN_RF_MDLG',
 ! and in the Setup for which you want to apply the NONLIN_RF_MDLG features,
 ! have a Transform with the following PEL syntax:
 !
 !~~~~~~~~~~~~~~~~cut here~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm '"&VAL$(WHOAMI(""))&"'..."
 
 GLOBAL_VAR  DataDir
 GLOBAL_VAR  DeviceName
 
 
 ICCAP_FUNC("../../aux_NONLIN_RF_MDLG", "Delete")
 ICCAP_FUNC("/UTILITIES/NONLIN_RF_MDLG", "Copy", "../../aux_NONLIN_RF_MDLG")
 
 
 !--------------------------------------------------------------------------------
 Path2Setup  = WHOIS(".")				!used to tell the copy-pasted 'nonlin-RF DUT' from UTILITIES.mdl the location of the parent Setup with the meas.data etc.
 mps_Keyword = VAL$(DeviceName)&"~Mdlg_Result__6_NonlinRF~"	!used for save/compare of currently used Netlist and ModelParameters
 mps_Dir     = VAL$(DataDir)				!used for save/compare of currently used Netlist and ModelParameters
 Do_Simul    = 1             ! choices: 0 (analyze only meas. data)
                             !          1 (meas. & simul.data; perform simulations)
 !--------------------------------------------------------------------------------
 ICCAP_FUNC("../../aux_NONLIN_RF_MDLG/DO_ALL/DO_ALL", "Execute", VAL$(Path2Setup), VAL$(mps_FileName), VAL$(mps_DirName), VAL(Do_Simul))
 
 !~~~~~~~~~~~~~~~~cut here~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !
 !
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________1" "711.501"
{
}
LINK XFORM "DO_ALL" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  Domains		! DUT ICCAP_ARRAY: avail. nonlin-RF Setups
 GLOBAL_VAR  DomainSel	! DUT Variable:  GUI-selected Domains[i]
 GLOBAL_VAR  SimulFlag	! 0: no simulation, only meas. data analysis  |  1: do simulation
 GLOBAL_VAR  mdm_DirFileName	! DUT Variable: name of temp. meas.data .mdm file, saved by this Program, and used later by the Programs of this DUT
 GLOBAL_VAR  Path2DataSetup	! Path to calling Setup (with the meas. data loaded)
 GLOBAL_VAR  ModelingStepKeyword	! Setup Variable: for comparing ModelParameters
 GLOBAL_VAR  mps_DirName	! Setup Variable: for comparing ModelParameters
 GLOBAL_VAR  StopExec
 GLOBAL_VAR  SIMULATOR 
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 StopExec=1
 ErrMsg=""
 
 
 !---the following GET_xxx  will be answered by the calling Program
 GET_STRING "Path to calling Setup (with the meas. data loaded)", Path2DataSetup
 
 !  for later use in Programs 'GUI_SaveParams' and 'GUI_Compare_Params'
 GET_STRING "ModelingStep (for .mps file filtering of ModelParam Save/Recall)", ModelingStepKeyword
 GET_STRING "mps_DirName     (for Save/Recall of ModelParam .mps file)", mps_DirName
 
 
 GET_INT "Do you only want to analyze the meas.data [0],
 	or do you also want to simulate [1] ?", 1, SimulFlag
 !--------------------------------------------------------------------------------------
 
 
 !---perform some first pre-checks
 ErrMsg=""
 ICCAP_FUNC("Prechecks_1", "Execute")
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING VAL$(ErrMsg)&"      [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !==INITIALIZE==========================================================================
 
 !---update ICCAP_ARRAY 'Domains'  (in case if a new nonlin-RF_Mdlg-Setup has been added)
 ICCAP_FIND_CHILDREN "..", "Setup", Domains
 FOR i=0 TO SIZEOF(Domains)-1
   IF STRPOS(VAL$(Domains[i]), "DO_ALL")  > 0 THEN dummy=ARRAY_REMOVE_AT(Domains, i)
   IF STRPOS(VAL$(Domains[i]), "_______") > 0 THEN dummy=ARRAY_REMOVE_AT(Domains, i)
   IF STRPOS(VAL$(Domains[i]), "aux")     > 0 THEN dummy=ARRAY_REMOVE_AT(Domains, i)
 NEXT i
 
 
 !---import the Inputs/Outputs from the original Setup
 !   remember orig. MDM_FILE_NAME
 MDM_FILE_NAME_orig = VAL$(LOOKUP_VAR(VAL$(Path2DataSetup)&"/MDM_FILE_NAME", ErrMsg))
 mdm_DirFileName="tmp"	!name of temp. meas.data .mdm file, saved by this Program, and used later by the Programs of this DUT
 ICCAP_FUNC(VAL$(Path2DataSetup), "Export Data Measured", VAL$(mdm_DirFileName))
 ICCAP_FUNC(".", "Import Create", VAL$(mdm_DirFileName))
 !   reset orig. MDM_FILE_NAME
 IF VAL$(ErrMsg)=="" THEN ICCAP_FUNC(VAL$(Path2DataSetup), "SetVariableTableValue", "MDM_FILE_NAME", VAL$(MDM_FILE_NAME_orig))
 
 
 
 !---copy DUT TestCircut
 ICCAP_FUNC(VAL$(Path2DataSetup)&"/../TestCircuit", "Copy", "../TestCircuit")
 !---copy TestCircuit Parameters
 ICCAP_FUNC(VAL$(Path2DataSetup)&"/../DeviceParameterSet", "Copy", "../DeviceParameterSet")
 
 
 !---perform some final pre-checks
 ErrMsg=""
 ICCAP_FUNC("Prechecks_2", "Execute")
 IF VAL$(ErrMsg)<>"" THEN
   GET_STRING VAL$(ErrMsg)&"    [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 !===================================================================================
 
 IF SimulFlag==0 THEN ICCAP_FUNC("..", "Clear Data/Simulated")
 
 
 !---initialize data arrays (sweep conditions to be displayed in the GUI)
 ICCAP_FUNC("Init_Arrays", "Execute")
 
 
 !---let user define port impedances
 ICCAP_FUNC("./GUI_PortImpedances", "Display Single Modal GUI")
 
 
 !---let user define pad parasitics
 ICCAP_FUNC("./GUI_PadParasitics",  "Display Single Modal GUI")
 
 
 !-----------------------------------------------------
 StopExec=0
 
 GET_STRING "Note:
   the nonlinear-RF user interface will be opened next,
   with the lowest DC biases preselected automatically.
 
   ==>  pls. select your own preferred DC bias points !
        -----------------------------------------------   [OK]", dummy
 
 
 !---start GUI with first Domain selected
 DomainSel = 0
 ICCAP_FUNC("GUI_DomainChanged", "Execute")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "_" "711.501"
{
}
LINK XFORM "xxxxxxxxxxxxxxxxxxx" "711.501"
{
}
LINK XFORM "____________________2" "711.501"
{
}
LINK XFORM "Prechecks_1" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 GLOBAL_VAR  SIMULATOR
 GLOBAL_VAR  Path2DataSetup
 GLOBAL_VAR  tmpVar
 GLOBAL_VAR  ErrMsg
 
 
 ErrMsg = ""
 
 
 !---exit if ADS is not simulator
 IF (VAL$(SIMULATOR)<>"hpeesofsim") THEN 
   IF (VAL$(SIMULATOR)<>"spmodeads") THEN
     ErrMsg = "ERROR: Nonlin-RF is only supported for ADS or for ADS-SpectreNetlist-Mode!"
     RETURN_VALUE -1
   END IF
 END IF
 
 
 !---exit if LSYNC sweeps are present in this Setup
 ICCAP_FIND_CHILDREN ".", "Input", tmpVar
 FOR i=0 TO SIZEOF(tmpVar)-1
   ErrMsg=""
   dummy = LOOKUP_TABLE_VAL(VAL$(tmpVar[i]), "Master Sweep", ErrMsg)
   IF VAL$(ErrMsg)=="" THEN 
     ErrMsg = "ERROR: The Programs are not prepared for handling LSYNC sweeps"
     RETURN_VALUE 0
   END IF
 NEXT i
 tmpVar=""
 
 
 !---exit if 'Saved Order' in Input 'freq' is not 5
 SavedOrder = LOOKUP_TABLE_VAL(VAL$(Path2DataSetup)&"/freq", "Saved Order", ErrMsg)
 IF VAL$(ErrMsg)<>"" THEN
   ErrMsg = "ERROR: "&VAL$(ErrMsg)
   RETURN_VALUE -2
 END IF
 IF VAL(SavedOrder)<>5 THEN
   ErrMsg = "ERROR: Input 'freq' hosts "&VAL$(SavedOrder)&" harmonics, 
     but the Programs currently only support 5 harmonics !!!"
   RETURN_VALUE -3
 END IF
 
 
 !---give a warning if 'Order' in Input 'freq' is not 7 or higher
 Order = LOOKUP_TABLE_VAL(VAL$(Path2DataSetup)&"/freq", "Order", ErrMsg)
 IF VAL(Order)<7 THEN
   ErrMsg = "ERROR: The Number of ADS Harmonics in Input 'freq' is less than 7 harmonics. 
     It is recommended to set it to 7 or higher !!!
     Please correct the entry to field 'Order'."
   RETURN_VALUE -4
 END IF
 
 
 !---verify that all Outputs are of Type B
 ICCAP_FIND_CHILDREN VAL$(Path2DataSetup), "Output",    tmpVar
 All_are_B=1
 FOR i=0 TO SIZEOF(tmpVar)-1
   Type = LOOKUP_TABLE_VAL(VAL$(Path2DataSetup)&"/"&VAL$(tmpVar[i]), "Type", ErrMsg)
   IF VAL$(Type)<>"B" THEN All_are_B=0
 NEXT i
 IF All_are_B<>1 THEN
   ErrMsg = "ERROR: The Outputs are not all of Type 'B' !!!
    Please correct this."
   RETURN_VALUE -4
 END IF
 tmpVar = ""
 
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Prechecks_2" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg		!a DUT Variable
 
 
 ErrMsg = ""
 
 
 
 !---give a warning if nonlinRF-measurement-related variables do not exist in Tab 'Model Parameters'
 NonlinRF_Meas_Var_Failure = 0
 FOR i=1 TO 6
   IF i==1 THEN ParamName="R_SOURCE"
   IF i==2 THEN ParamName="R_LOAD"
   IF i==3 THEN ParamName="CTERM_P1"
   IF i==4 THEN ParamName="LTERM_P1"
   IF i==5 THEN ParamName="CTERM_P2"
   IF i==6 THEN ParamName="LTERM_P2"
   ! look in Model Parameters
   ModelName = WHOIS(".", "Parent Model PartName")
   ErrMdlParam = ""
   dummy = LOOKUP_PAR("/"&VAL$(ModelName)&"."&VAL$(ParamName), ErrMdlParam)
   ! look in Variables Hierarchy
   ErrMdlVar = ""
   dummy = LOOKUP_VAR("/"&VAL$(ModelName)&"/"&VAL$(ParamName), ErrMdlVar)
   IF VAL$(ErrMdlParam)<>"" ANDALSO VAL$(ErrMdlVar)<>"" THEN NonlinRF_Meas_Var_Failure = 1
 NEXT i
 IF NonlinRF_Meas_Var_Failure==1 THEN
   GET_STRING "WARNING: nonlinRF-measurement-related variables 
      (R_SOURCE, R_LOAD, X_LOAD, CTERM_P1, LTERM_P1,  CTERM_P2, LTERM_P2)
      are not completely available in Tab 'Model Parameters' !
      This is not a must, but recommended, when modeling is continued at a later time,
      and the Model Parameter set is loaded back into this model file.
      See /UTILITIES/NONLIN_RF_MDLG/DO_ALL/README for details !  
      Hit  [OK] to continue and ignore this message
      or   [Cancel]", dummy
 END IF
 
 
 !---in Input 'freq', set field 'Value' to 'FUNDFREQ'
 !  but first of all, verify if the DUT Parameter FUNDFREQ exists
 ErrMsg=""
 FUNDFREQ_exist=0
 N=0
 WHILE VAL$(ErrMsg)==""
   ErrMsg_freq = ""
   ParamName=LOOKUP_TABLE_VAL("../DeviceParameterSet", "Param Name["&VAL$(N)&"]", ErrMsg_freq)
   IF VAL$(ErrMsg_freq)=="" THEN
     IF VAL$(ParamName)== "FUNDFREQ" THEN 
       FUNDFREQ_exist=1
       BREAK
     END IF
   END IF
   N = N + 1
 END WHILE
 IF FUNDFREQ_exist<>1 THEN
   ErrMsg = "ERROR: seems you have not defined a Variable 'FUNDFREQ' in your DUT TestCircuit.
   ->  See /UTILITIES/NONLIN_RF_MDLG/DO_ALL/README for details !"
   RETURN_VALUE -1
 END IF
 ICCAP_FUNC("freq", "STFV", "Value", "FUNDFREQ")
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Init_Arrays" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---link to (DUT-)Variables
 GLOBAL_VAR  mdm_DirFileName
 GLOBAL_VAR  VDC1_ValuesAvail		! DUT ICCAP_ARRAY: avail. port1 DC bias voltages
 GLOBAL_VAR  VDC1_ValuesAvailSel	! DUT Variable:  GUI-selection
 GLOBAL_VAR  VDC2_ValuesAvail		! DUT ICCAP_ARRAY: avail. port2 DC bias voltages
 GLOBAL_VAR  VDC2_ValuesAvailSel	! DUT Variable:  GUI-selection
 GLOBAL_VAR  pin_ValuesAvail		! DUT ICCAP_ARRAY: avail. InputPower Pin values
 GLOBAL_VAR  pin_ValuesAvailSel	! DUT Variable:  GUI-selection
 GLOBAL_VAR  NrPts			! DUT Variable:  show nr. of currently loaded data points in GUI
 GLOBAL_VAR  NrHarmonics		! DUT Array:  to be displayed in the GUI
 GLOBAL_VAR  NrHarmonicsSel		! DUT Variable
 GLOBAL_VAR  xAxisChoicesSel		! DUT Variable
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---load the .mdm file, in order to find out the data values
 ICCAP_FUNC(".", "ImportCreate", VAL$(mdm_DirFileName))
 
 
 !---copy 'VDC1' values to DutVariable VDC1_ValuesAvail
 !   get nr.pts
 SweepType = LOOKUP_TABLE_VAL("VDC1", "Sweep Type")
 VDC1_NrPts = -1
 IF SweepType == "CON"  THEN VDC1_NrPts = 1
 IF SweepType == "LIST" THEN VDC1_NrPts = VAL(LOOKUP_TABLE_VAL("VDC1", "# of Values"))
 IF SweepType == "LIN"  THEN VDC1_NrPts = VAL(LOOKUP_TABLE_VAL("VDC1", "# of Points"))
 IF VDC1_NrPts == -1 THEN 
   ErrMsg = "ERROR: Input 'VDC1' is not of 'CON', 'LIN' or 'LIST' !" 
   RETURN_VALUE 0
 END IF
 
 
 !   copy
 VDC1_ValuesAvail=""
 DIMENSION_ARRAY("VDC1_ValuesAvail", VDC1_NrPts)
 
 tmp = DATASET("quiet "&"VDC1")
 VDC1_ValuesAvail[0] = tmp[0]
 N=0
 i=1
 WHILE i < SIZEOF(tmp)
   IF tmp[i] <> tmp[i-1] THEN 
     N = N + 1
     VDC1_ValuesAvail[N] = tmp[i]
     IF N == SIZEOF(VDC1_ValuesAvail)-1 THEN i = SIZEOF(tmp)
   END IF
   i = i + 1
 END WHILE
 !  init selection
 VDC1_ValuesAvailSel=""
 DIMENSION_ARRAY("VDC1_ValuesAvailSel", 1)
 VDC1_ValuesAvailSel[0] = 0
 
 
 !------------------------------------------------------------------------------------------
 !---copy 'VDC2' values to DutVariable VDC2_ValuesAvail
 !   get nr.pts
 SweepType = LOOKUP_TABLE_VAL("VDC2", "Sweep Type")
 VDC2_NrPts = -1
 IF SweepType == "CON"  THEN VDC2_NrPts = 1
 IF SweepType == "LIST" THEN VDC2_NrPts = VAL(LOOKUP_TABLE_VAL("VDC2", "# of Values"))
 IF SweepType == "LIN"  THEN VDC2_NrPts = VAL(LOOKUP_TABLE_VAL("VDC2", "# of Points"))
 IF VDC2_NrPts == -1 THEN 
   ErrMsg = "ERROR: Input 'VDC2' is not of 'CON', 'LIN' or 'LIST' !" 
   RETURN_VALUE 0
 END IF
 
 
 !   copy
 VDC2_ValuesAvail=""
 DIMENSION_ARRAY(VDC2_ValuesAvail, VDC2_NrPts)
 
 tmp = DATASET("quiet "&"VDC2")
 VDC2_ValuesAvail[0] = tmp[0]
 N=0
 i=1
 WHILE i < SIZEOF(tmp)
   IF tmp[i] <> tmp[i-1] THEN 
     N = N + 1
     VDC2_ValuesAvail[N] = tmp[i]
     IF N == SIZEOF(VDC2_ValuesAvail)-1 THEN i = SIZEOF(tmp)
   END IF
   i = i + 1
 END WHILE
 !  init selection
 VDC2_ValuesAvailSel=""
 DIMENSION_ARRAY("VDC2_ValuesAvailSel", 1)
 VDC2_ValuesAvailSel[0]=0
 
 
 !------------------------------------------------------------------------------------------
 !---copy 'pin' values to DutVariable pin_ValuesAvail
 !   get nr.pts
 SweepType = LOOKUP_TABLE_VAL("pin", "Sweep Type")
 pin_NrPts = -1
 IF SweepType == "LIST" THEN pin_NrPts = VAL(LOOKUP_TABLE_VAL("pin", "# of Values"))
 IF SweepType == "LIN"  THEN pin_NrPts = VAL(LOOKUP_TABLE_VAL("pin", "# of Points"))
 IF pin_NrPts == -1 THEN 
   ErrMsg = "ERROR: Input 'pin' is not of 'LIN' or 'LIST' !" 
   RETURN_VALUE 0
 END IF
 
 pin_ValuesAvail=""
 DIMENSION_ARRAY(pin_ValuesAvail, pin_NrPts)
 
 tmp = DATASET("quiet "&"pin")
 pin_ValuesAvail[0] = tmp[0]
 N=0
 i=1
 WHILE i < SIZEOF(tmp)
   IF tmp[i] <> tmp[i-1] THEN 
     N = N + 1
     pin_ValuesAvail[N] = tmp[i]
     IF N == SIZEOF(pin_ValuesAvail)-1 THEN i = SIZEOF(tmp)
   END IF
   i = i + 1
 END WHILE
 
 
 !---init selection
 pin_ValuesAvailSel=""
 DIMENSION_ARRAY("pin_ValuesAvailSel", 1)
 pin_ValuesAvailSel[0] = 0
 xAxisChoicesSel=0
 
 
 !------------------------------------------------------------------------------------------
 !---update info for GUI
 NrPts       = SIZEOF(freq)
 AvailNrHarmonics = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 DIMENSION_ARRAY("NrHarmonics", AvailNrHarmonics)
 FOR i=0 TO SIZEOF(NrHarmonics)-1
   NrHarmonics[i]=i+1
 NEXT i
 !  pre-select max nr. of avail. harmonics
 NrHarmonicsSel=AvailNrHarmonics-1
 
 
 !------------------------------------------------------------------------------------------
 !---clean up Inputs/Outputs
 ICCAP_FUNC(".", "Import Delete")
 ICCAP_FUNC(".", "New Input", "See_under_ExtractOptimize")
 ICCAP_FUNC("See_under_ExtractOptimize", "STFV", "Sweep Type", "CON")
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Pad_Parasitics" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !  NOTE: keep Function 'Program' (don't change to 'Program2') 
 !        to enable support of Model Parameters and also Model Variables !!!
 
 
 !---this is answered from the calling Program or GUI
 
 GET_STRING "Action ?  [Reset], [Typical]", Action
 
 IF VAL$(Action)=="Typical" THEN
   Lpad1.L  = 50p
   Cpad10.C = 50f
 
   Cpad12.C =  5f
 
   Cpad20.C = 50f
   Lpad2.L  = 50p
 END IF
 
 IF VAL$(Action)=="Reset" THEN
   Lpad1.L  = 1f
   Cpad10.C = 1a
 
   Cpad12.C = 1a
 
   Cpad20.C = 1a
   Lpad2.L  = 1f
 END IF
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_Reset_Port_Impedances" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---this Program is executed from the GUI
 
 ! NOTES:
 !  although the NVNA Port IMpedances are defined in the DUT TestCircuit
 !  and their values in DUT Parameters,
 !  the Variables below should be present in ModelParameters,
 !  and linked to the DUT Parameters.
 !  REASON:
 !  this enables the fine-tuning of model parameters,
 !  to save the current nonlinear-RF modeling state 
 !  (Transforms 'GUI_Save Params' and 'GUI_CompareParams'),
 !  and to load it into the DC or S-Parameter Setups of the ModelFile,
 !  without loosing the tuned Port Impedance values.
 
 
 !---Port 1
 R_SOURCE  = 50	
 LTERM_P1  = 1f
 CTERM_P1  = 1a
 
 !---Port 2
 R_LOAD    = 50
 X_LOAD    = 0
 LTERM_P2  = 1f
 CTERM_P2  = 1a
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_DomainChanged" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Domains		! DUT ICCAP_ARRAY: avail. nonlin-RF_Setups
 GLOBAL_VAR  DomainSel	! DUT Variable:  GUI-selected Domains[i]
 GLOBAL_VAR  SimulFlag
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 IF DomainSel < 0 THEN RETURN_VALUE 2
 
 
 
 !---close MultiPlot
 ICCAP_FUNC("..", "Close All")
 
 
 !---stop simulator (because we change the HB simul), but keep the ADS status window open
 ICCAP_FUNC("/", "Stop Multisim")	
 
 
 !---load data (to synchronize with currently selected pin and DC bias values
 Path2Domain = "../"&VAL$(Domains[DomainSel])
 ICCAP_FUNC(VAL$(Path2Domain)&"/Load_mdm_MeasData", "Execute")
 
 
 !---for selected x-Axis, activate all available data points
 xAxis=VAL$(xAxisChoices[xAxisChoicesSel])
 IF VAL$(xAxis)<>"harmonics" THEN
   NrDataPts=VAL(LOOKUP_VAR("../"&VAL$(xAxis)&"_ValuesAvail"))
   ICCAP_FUNC("..", "SetVariableTableValue", VAL$(xAxis)&"_ValuesAvailSel", "ICCAP_ARRAY["&VAL$(NrDataPts)&"]")
   FOR i=0 TO NrDataPts-1
     ICCAP_FUNC("..", "SetVariableTableValue", VAL$(xAxis)&"_ValuesAvailSel["&VAL$(i)&"]", i)
   NEXT i
 END IF
 
 
 !---simulate Setup
 IF SimulFlag ==1 THEN ICCAP_FUNC("Simul_Sel_Domain", "Execute")
 
 
 !---open selected MultiPlot incl. its GUI
 SetupName = VAL$(Domains[DomainSel])
 Path2MP    = "../" & SetupName&"/MP_GUI_" & SetupName
 ICCAP_FUNC(VAL$(Path2MP), "Display Plot")
 ICCAP_FUNC(VAL$(Path2MP), "Autoscale On")
 
 
 !---reset PlotOptimizer at DomainChange
 Path2PO="../../PlotOptimizer"
 ICCAP_FUNC(VAL$(Path2PO), "Clear PlotOptimizer")
 
 
 
 RETURN_VALUE 1
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Simul_Sel_Domain" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 GLOBAL_VAR  Domains		! DUT ICCAP_ARRAY: avail. nonlin-RF_Setups
 GLOBAL_VAR  DomainSel	! DUT Variable:  GUI-selected Domains[i]
 GLOBAL_VAR  SimulFlag	! 0: no simulation, only meas. data analysis  |  1: do simulation
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 IF SimulFlag == 0 THEN RETURN_VALUE 2
 
 
 IF VAL(Debug)==1 THEN 
   PRINT SYSTEM$("date +%H:%M:%S")&": exec.Xfm "&WHOAMI()&", simul. Setup '" & VAL$(Domains[DomainSel]) & "' ..."
 END IF
 
 
 !---simulate selected Domain
 SimulStartTime = VAL(ICCAP_TIME("ICMSECS"))    ! time in msec since 1970
 
 ICCAP_FUNC("../"&VAL$(Domains[DomainSel]), "Simulate")
 
 SimulStopTime  = VAL(ICCAP_TIME("ICMSECS"))    ! time in msec since 1970
 PRINT "Simul.Time incl. auto-exec. Transforms: ";SimulStopTime-SimulStartTime;"sec."
 
 
 
 RETURN_VALUE 1
 
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_ValuesChanged" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Domains
 GLOBAL_VAR  DomainSel
 GLOBAL_VAR  VDC1_ValuesAvailSel
 GLOBAL_VAR  VDC2_ValuesAvailSel
 GLOBAL_VAR  pin_ValuesAvailSel
 GLOBAL_VAR  SimulFlag
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ! This Program performs the actions for changed DC bias, changed RF source etc.
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 !--- do nothing if nothing is selected
 IF VDC1_ValuesAvailSel < 0 THEN RETURN_VALUE 2
 IF VDC2_ValuesAvailSel < 0 THEN RETURN_VALUE 2
 IF pin_ValuesAvailSel  < 0 THEN RETURN_VALUE 2
 
 
 !---this is answered by the calling GUI
 GET_STRING "GUI action  [xAxisChanged], [BiasesChanged]", Action
 
 
 IF VAL$(Action)=="xAxisChanged" THEN
   !---for selected x-Axis, except 'harmonics', activate all available data points
   xAxis=VAL$(xAxisChoices[xAxisChoicesSel])
   IF VAL$(xAxis)<>"harmonics" THEN
     GET_STRING "NOTE: independent of your current selection,
         all available stimulus points will be activated for the selected x-axis '"&VAL$(xAxis)&"'    [OK]", dummy
     NrDataPts=VAL(LOOKUP_VAR("../"&VAL$(xAxis)&"_ValuesAvail"))
     ICCAP_FUNC("..", "SetVariableTableValue", VAL$(xAxis)&"_ValuesAvailSel", "ICCAP_ARRAY["&VAL$(NrDataPts)&"]")
     FOR i=0 TO NrDataPts-1
       ICCAP_FUNC("..", "SetVariableTableValue", VAL$(xAxis)&"_ValuesAvailSel["&VAL$(i)&"]", i)
     NEXT i
   END IF
 END IF
 
 
 !---load meas. data
 Path2Domain = "../"&VAL$(Domains[DomainSel])
 ICCAP_FUNC(VAL$(Path2Domain)&"/Load_mdm_MeasData", "Execute")
 
 
 !---simulate
 IF SimulFlag ==1 THEN ICCAP_FUNC("Simul_Sel_Domain", "Execute")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_SaveParams" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---this Transform saves the current ModelParameter set
 
 
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  ModelingStepKeyword
 
 TimeStamp=SYSTEM$("date +%Y%m%d_%H_%M_%S")
 mps_FileName = VAL$(ModelingStepKeyword)&"~"&VAL$(TimeStamp)&".mps"
 
 
 Path2Dut =  WHOIS(".", "Parent DUT")	!we transfer the DUT name since this includes both, the path to TestCircuitParam and to the ModelParam
 SaveTestCkt = "no"
 !
 !---call the central ModelParameter saving utility
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/COMPARE_PARAMS/SAVE_PARAMS", "Execute", VAL$(mps_FileName), VAL$(mps_DirName), VAL$(Path2Dut), VAL$(SaveTestCkt))
 
 
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_CompareParams" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !---this Program compares the current Parameters 
 !   with existing (older) extractions, saved in .mps files by Xfm 'GUI_SaveParams'
 
 
 GLOBAL_VAR  mps_DirName
 GLOBAL_VAR  ModelingStepKeyword
 GLOBAL_VAR  Domains
 GLOBAL_VAR  DomainSel
 
 
 Path2Dut = WHOIS(".", "Parent DUT")
 
 !---identify active Domain Setup
 act_DomainSetup = VAL$(Domains[DomainSel])
 
 
 
 !=====================================================================================
 !---define here the details asked by central Transform 'COMPARE_PARAMS' in UTILITIES
 DataDir = VAL$(mps_DirName)
 mps_Keyword = VAL$(ModelingStepKeyword)
 Plots = ""		! keep the currently opened nonlin-RF Plot
 FullPath2Xfm = VAL$(Path2Dut)&"/"&VAL$(act_DomainSetup)&"/dummy"
 !=====================================================================================
 !
 ICCAP_FUNC("/UTILITIES/PEL_UTILITIES/COMPARE_PARAMS/COMPARE_PARAMS", "Execute", VAL$(DataDir), VAL$(mps_Keyword), VAL$(Plots), VAL$(FullPath2Xfm))
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PB_Fit_Params" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Domains
 GLOBAL_VAR  DomainSel
 GLOBAL_VAR  VDC1_ValuesAvail		! for visualization of bias conditions for act. param.fitting
 GLOBAL_VAR  VDC1_ValuesAvailSel
 GLOBAL_VAR  VDC2_ValuesAvail
 GLOBAL_VAR  VDC2_ValuesAvailSel
 GLOBAL_VAR  pin_ValuesAvail
 GLOBAL_VAR  pin_ValuesAvailSel
 
 
 !====================================================================================================================
 ! THIS PROGRAM CLOSES THE NONLIN-RF GUI, 
 ! AND OPENS THE STANDARD GUI OF SETUP  MDLG_GUI/GENERAL_MDLG_GUI
 ! FOR MODELING / PARAMETER FITTING
 !====================================================================================================================
 
 !---close current nonlin-RF MultiPlot
 ICCAP_FUNC("..", "Close All")
 
 !---display a recover PushButton to re-open the current nonlin-RF MultiPlot after param. fitting
 ICCAP_FUNC("./TL_Re_Open_NonlinRF_GUI", "Display Modeless GUI", "Re-Open Nonlin-RF GUI")
 
 !--------------------------------------------------------------------------
 
 !---for being shown in the modeling GUI, identify the current bias conditions, but limit to max 80 characters
 act_VDC1_bias=""
 FOR i=0 TO SIZEOF(VDC1_ValuesAvailSel)-1
   act_VDC1_bias=VAL$(act_VDC1_bias)&VAL$(VDC1_ValuesAvail[VDC1_ValuesAvailSel[i]])&"|"
 NEXT i
 act_VDC1_bias=TRIM$(VAL$(act_VDC1_bias), "|")
 IF STRLEN(act_VDC1_bias)>80 THEN
   act_VDC1_bias=SUBSTR$(act_VDC1_bias, 1, 40)&" ... "&SUBSTR$(act_VDC1_bias, STRLEN(act_VDC1_bias)-35)
 END IF
 
 act_VDC2_bias=""
 FOR i=0 TO SIZEOF(VDC2_ValuesAvailSel)-1
   act_VDC2_bias=VAL$(act_VDC2_bias)&VAL$(VDC2_ValuesAvail[VDC2_ValuesAvailSel[i]])&"|"
 NEXT i
 act_VDC2_bias=TRIM$(VAL$(act_VDC2_bias), "|")
 IF STRLEN(act_VDC2_bias)>80 THEN
   act_VDC1_bias=SUBSTR$(act_VDC2_bias, 1, 40)&" ... "&SUBSTR$(act_VDC2_bias, STRLEN(act_VDC2_bias)-35)
 END IF
 
 act_pin=""
 FOR i=0 TO SIZEOF(pin_ValuesAvailSel)-1
   act_pin=VAL$(act_pin)&VAL$(pin_ValuesAvail[pin_ValuesAvailSel[i]])&"|"
 NEXT i
 act_pin=TRIM$(VAL$(act_pin), "|")
 IF STRLEN(act_pin)>80 THEN
   act_pin=SUBSTR$(act_pin, 1, 40)&" ... "&SUBSTR$(act_pin, STRLEN(act_pin)-35)
 END IF
 
 BiasInfo = "   -> VDC1_bias = "&VAL$(act_VDC1_bias)&"
      -> VDC2_bias = "&VAL$(act_VDC2_bias)&"
      -> RF power pin = "&VAL$(act_pin)
 
 !---
 
 !---Prepare and call UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI
 !   Refer to /UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI for details
 !=====================================================================================
 !---Define here which individual Plots (*no* MultiPlots!) and which Parameters you want to use for this modeling step (a comma or comma-blank separated list)
 SetupName  = VAL$(Domains[DomainSel])
 Path2Setup = "../" & VAL$(SetupName)
 Path2Plot  = VAL$(Path2Setup)&"/MP_GUI_"&VAL$(SetupName)
 NrPlots = VAL(LOOKUP_TABLE_VAL(VAL$(Path2Plot), "# of Plots"))
 Plots = ""
 FOR i=0 TO NrPlots -1
   IF i==0 THEN 
     Plots = VAL$(LOOKUP_TABLE_VAL(VAL$(Path2Plot), "Plot "&VAL$(i)))
   ELSE
     Plots = VAL$(Plots) & ", " & VAL$(LOOKUP_TABLE_VAL(VAL$(Path2Plot), "Plot "&VAL$(i)))
   END IF
 NEXT i
 
 !---
 Parameters = ""		! user will select the *Model*Parameters by himself
 !---handle the special case (1st step in nonlin-RF modeling) to adjust the simulation source and load impedance to the measurement situation
 IF VAL$(SetupName)=="Wave_Spar_Load_vs_Pin" THEN	
   !   Setup "Wave_Spar_Load_vs_Pin" is used to adjust the real-world NVNA non-50-Ohm source and load impedances.
   !   Note: in your local model file's tab 'Circuit', these parameters need to exist !!
   Parameters = "!R_SOURCE, !LTERM_P1, CTERM_P1, R_LOAD , !X_LOAD , LTERM_P2, !CTERM_P2"
 END IF
 
 !---
 Comment = "The currently active nonlin RF Setup is   => "&VAL$(SetupName)&" <=   with these Bias Conditions: 
   "&VAL$(BiasInfo)
 IF VAL$(SetupName)=="Wave_Spar_Load_vs_Pin" THEN	!this Setup is used to adjust the real-world NVNA non-50 Ohm source and load impedances
   Comment = VAL$(Comment)&"
     Tune the Port2 Load Impedance to reflect the real.world non-50-Ohm impedance of the NVNA:
       -> fit the MAG(A2) fundamental freq. (by tuning R_LOAD) and the harmonics (by tuning Lterm_P2.L)
       -> tune the Port1 Source Impedance by fitting the MAG(B1) with Cterm_P2.C
     Notice: it may be necessary to have the Simulation Debugger opened when tuning these parameters !"
 ELSE
   Comment = VAL$(Comment)&"
   Manually add the corresponding ModelParameters, and tune/optimize"
 END IF
 
 !---
 PO_Error   = "Relative"
 FullPath2Xfm = VAL$(WHOIS(".", "Parent Setup"))&"/"&VAL$(Path2Setup)&"/dummy"
 ICCAP_FUNC("/UTILITIES/MDLG_GUI/GENERAL_MDLG_GUI/START_MDLG_GUI", "Execute", Plots, Parameters,  VAL$(FullPath2Xfm), Comment, PO_Error)
 !=====================================================================================
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PB_ReOpen_nonlinRF" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR Domains
 GLOBAL_VAR DomainSel
 
 
 !====================================================================================================================
 ! AFTER PARAMETER FITTING by Xfm 'GUI_PB_Fit_Params',
 ! THIS PROGRAM RE-OPENS THE NONLIN-RF GUI
 ! OF THE LAST SELECTED NONLIN-RF SETUP
 !====================================================================================================================
 
 SetupName  = VAL$(Domains[DomainSel])
 Path2Setup = "../" & VAL$(SetupName)
 Path2Plot  = VAL$(Path2Setup)&"/MP_GUI_"&VAL$(SetupName)
 
 ICCAP_FUNC(VAL$(Path2Plot), "Display Plot")
 
 
 !---destroy the re-open GUI
 ICCAP_FUNC("./TL_Re_Open_NonlinRF_GUI", "Destroy GUI", "Re-Open Nonlin-RF GUI")
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PB_Help_Domains" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Domains
 GLOBAL_VAR  DomainSel
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
 !---update the Help text for the GUI and open the GUI
 Path2Domain = "../"&VAL$(Domains[DomainSel])
 ICCAP_FUNC(VAL$(Path2Domain)&"/README", "Execute")
 
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "GUI_PB_OK_Done" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  Path2DataSetup
 GLOBAL_VAR  Domains
 GLOBAL_VAR  DomainSel
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 ! When the nonlin-RF-GUI is closed, the (DUT) parameters need to be copied
 ! back from this temporarily added DUT, to the original nonlin-DUT (with the meas. data).
 
 !---copy current TestCircuit Parameters back into original DUT (with the meas. data)
 ICCAP_FUNC("../DeviceParameterSet", "Copy", VAL$(Path2DataSetup)&"/../DeviceParameterSet")
 
 
 !---close current MultiPlot incl. its GUI
 IF SIZEOF(Domains)>0 ANDALSO DomainSel>=0 THEN
   SetupName = VAL$(Domains[DomainSel])
   Path2MP    = "../" & SetupName&"/MP_GUI_" & SetupName
   ICCAP_FUNC(Path2MP, "Close")
 END IF
 
 
 !---clean up
 ICCAP_FUNC("Clean_Up", "Execute")
 
 
 
 RETURN_VALUE 1
 
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________3" "711.501"
{
}
LINK XFORM "Example_DutCkt_ADS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 define HB_circuitry (P1_DC   P1_Pin   P1aux   P1  P2_DC  P2_AC   P2aux   P2 )
 
 ;############# This TestCircuit is ONLY for LIST/LIN sweeps of vd, vg ##################
 ;##################### It is (currently) not supporting LSYNC bias sweeps ##############
 
 ; The netlist details (node names and components) shown here are mandatory 
 ; for using the central NONLIN_RF_MDLG utility from UTILITIES.mdl
 ; You may add more details (see the netlist section further down), 
 ; but you should not delete the mandatory ones.
 
 
 ; define HB circuit around DUT                                    _ P2_DCi __
 ; ============================                                  -|X|--o---|__|-o P2_DC
 ;                                                              |DCFEED_P2 Rbias2
 ;                                                              |      _
 ;                                                        P2aux o-----|X|------o P2_AC
 ;                                                              |   DCBLOCK_P2 |
 ;                                                         i2| /A\             |   
 ;                                                           V \_/ current meter, defined as 0V dummy voltage Input in the Setups
 ;                                                        ___   |              |
 ;                                      ___         P2int|   |  |P2            |
 ;           __ P1_DCi _  P1aux /\  P1 |   |P1int|==--o--|Pad|--o              -
 ; P1_DC o--|__|--o---|X|---o--| A|--o-|Pad|--o==|Device |___|  |             |X| Load impedance and 
 ;         Rbias1  DCFEED_P1|   \/   | |___|     |==       |    |              -  Port2 nonidealities
 ;                          |   -->  |   |          |      |    |              |  Lterm_P2, Cterm_P2
 ;               __P1_Pini  |   i1   |   |          |      |    |              |
 ; P1_Pin o-----|XX|-o--|X|-         |v1 |          |      |    |v2            |       
 ;             Port1    DCBLOCK_P1   V   |          |      |    V              |   
 ;          Source impedance        --- ---        ---    ---  ---            ---
 ;          and nonidealities
 ;          Lterm_P1, Cterm_P1
 ;
 ; NOTE: The Ampere meters 'i1' and 'i2' are realized by 0V dummy voltges in the Inputs of the Setups.
 ;       For the sketched current directions (aux -> int), these voltages need to be defined from 'int' to 'aux'.
 ; NOTE: The Port1 feed impedance (node 'P1_Pin') is automatically added by IC-CAP's Input 'pin' (Entry field 'Resistance').
 ;       The applied source impedance is then realized by emulating a Source-Pull measurement, 
 ;       i.e. component 'S_Port:ImpConversion' plus induct. and capac. non-idealities (nodes 'P1_Pin' -> 'P1_Pini')
 
 ;---emulation of Bias TEEs
 R:Rbias1          P1_DC      P1_DCi    R=0.1
 Short:DCFEED_P1   P1_DCi     P1aux     Mode = (-1)
 Short:DCBLOCK_P1  P1_Pini    P1aux     Mode =  (1)
 
 
 R:Rbias2          P2_DC      P2_DCi    R=0.1
 Short:DCFEED_P2   P2_DCi     P2aux     Mode = (-1)
 Short:DCBLOCK_P2  P2_AC      P2aux     Mode =  (1)
 
 
 ;---(real) Source and (complex) Load impedances
 FundFreq =   2G
 R_Source_ =  50
 R_Load_   =  50
 X_Load_   =   0
 
 
 ;---non-ideal Port1 source impedance (to be modeled by fitting the A1 wave, or the i1-v1 loadline)
 #echo S_Port:ImpConversionP1   P1_Pin     0         P1_Pin1     0     S[1,1]=0 S[1,2]=1 S[2,1]=1 S[2,2]=0 Z[1]=50     Z[2]=(if (freq==FundFreq) then (R_Source_) else 50 endif)   Recip=no 
 C:Cterm_P1      P1_Pin1    0         C=1a
 L:Lterm_P1      P1_Pin1    P1_Pini   L=1f
 
 
 ;---non-ideal Port2 load impedance (to be modeled by fitting the A2 wave, or the i2-v2 loadline)
 L:Lterm_P2      P2_AC      P2_AC1    L=1f
 Port:TermLoad   P2_AC1     0         Num=(2)   Z=(if (freq==FundFreq) then (R_Load_ + j*X_Load_) else 50 endif)  Noise=yes 
 C:Cterm_P2      P2_AC1     0         C=1a
 
 
 ;---contact pads (at least, a minimalistic model is required, because non-de-embedded measured harmonics are loaded)
 L:Lpad1         P1         P1int     L=1f
 C:Cpad10        P1int      0         C=1a
 C:Cpad12        P1int      P2int     C=1a
 C:Cpad20        P2int      0         C=1a
 L:Lpad2         P2         P2int     L=1f
 
 
 
 
 ; link to subcircuit: the 'Circuit' deck of model '<ModelName in the IC-CAP/Main window>'
 ; i.e. call the subcircuit description of the transistor, 
 ;      as defined in Tab 'Circuit' of this model file
 ;                Anode
 ;                  |      Cathode
 ;                  |      |
 Diode_Modeling:X1  P1int  P2int
 ;   connect model to inside of contact pads
 
 
 end HB_circuitry
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Example_ADS_ComplexImpedances" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ! To apply complex impedances for the input and output load, 
 ! apply this syntax:
 
 
 Z_Load_f0  =  50 + j*0.001   ; define your values directly here, and not in the tab 'Parameters'
 Z_Load_2f0 = 100 + j*10
 Z_Load_3f0 = 200 + j*20
 
 
 
 ;---complex Port2 load impedance
 Port:TermLoad   P2_AC1     0         Num=(2)   Z=(if (freq<=1.5*FundFreq) then (Z_Load_f0) elseif (freq<=2.5*FundFreq) then (Z_Load_2f0) elseif (freq<=3.5*FundFreq) then (Z_Load_3f0) else 50 endif)  Noise=yes 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Example_DutCkt_SpModeADS" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 
 subckt HB_circuitry (P1_DC   P1_Pin   P1aux   P1  P2_DC  P2_AC   P2aux   P2)
 
 *############# This TestCircuit is ONLY for LIST/LIN sweeps of vd, vg ##################
 *##################### It is (currently) not supporting LSYNC bias sweeps ##############
 
 * The netlist details (node names and components) shown here are mandatory 
 * for using the central NONLIN_RF_MDLG utility from UTILITIES.mdl
 * You may add more details (see the netlist section further down), 
 * but you should not delete the mandatory ones.
 
 
 * define HB circuit around DUT                                     _ P2_DCi __
 * ============================                                  --|X|--o---|__|-o P2_DC
 *                                                              |LDCFEED_P2 Rbias2
 *                                                              |      _
 *                                                        P2aux o-----|X|------o P2_AC
 *                                                              |  CDCBLOCK_P2 |
 *                                                         i2| /A\             |   
 *                                                           V \_/ current meter, defined as 0V dummy voltage Input in the Setups
 *                                                        ___   |              |
 *                                      ___         P2int|   |  |P2            |
 *           __ P1_DCi _  P1aux /\  P1 |   |P1int|==--o--|Pad|--o              -
 * P1_DC o--|__|--o---|X|---o--| A|--o-|Pad|--o==|Device |___|  |             |X| Load inpedance
 *         Rbias1 LDCFEED_P1|   \/   | |___|     |==       |    |              -  
 *                          |   -->  |   |          |      |    |              |  
 *               __P1_Pini  |   i1   |   |          |      |    |              |
 * P1_Pin o-----|XX|-o--|X|-         |v1 |          |      |    |v2            |       
 *             Port1   CDCBLOCK_P1   V   |          |      |    V              |   
 *          Source inpedance        --- ---        ---    ---  ---            ---
 
 *
 * NOTE: The Ampere meters 'i1' and 'i2' are realized by 0V dummy voltages in the Inputs of the Setups.
 *       For the sketched current directions (aux -> int), these voltages need to be defined from 'int' to 'aux'.
 * NOTE: The Port1 feed impedance (node 'P1_Pin') is automatically added by IC-CAP's Input 'pin' (Entry field 'Resistance').
 *       The applied source impedance is then realized by emulating a Source-Pull measurement, 
 *       i.e. component 'S_Port:ImpConversion' plus induct. and capac. non-idealities (nodes 'P1_Pin' -> 'P1_Pini')
 
 
 parameters  FUNDFREQ = 1G  R_SOURCE_ = 50  R_LOAD_ = 50
 
 
 *---emulation of Bias TEEs
 Rbias1           (P1_DC      P1_DCi)  resistor  r=0.1
 LDCFEED_P1       (P1_DCi     P1aux)   inductor  l=1m
 CDCBLOCK_P1      (P1_Pini    P1aux)   capacitor c=1m
 
 
 Rbias2           (P2_DC      P2_DCi)  resistor  r=0.1
 LDCFEED_P2       (P2_DCi     P2aux)   inductor  l=1m
 CDCBLOCK_P2      (P2_AC      P2aux)   capacitor c=1m
 
 
 *---(real) Source and (real) Load impedances
 R_Source         (P1_Pin     P1_Pin1) resistor  r=R_SOURCE_
 R_Load           (P2_AC      0)       resistor  r=R_LOAD_
 
 *---non-ideal Port1 source impedance (to be modeled by fitting the A1 wave, or the i1-v1 loadline)
 Cterm_P1      (P1_Pin1    0)        capacitor  c=1a
 Lterm_P1      (P1_Pin1    P1_Pini)  inductor   l=1f
 Cterm_P2      (P2_AC1     0)        capacitor  c=1a
 Lterm_P2      (P2_AC      P2_AC1)   inductor   l=1f
 
 
 
 *---contact pads (at least, a minimalistic model is required, because non-de-embedded measured harmonics are loaded)
 Lpad1         (P1         P1int)  inductor   l=1f
 Cpad10        (P1int      0    )  capacitor  c=1a
 Cpad12        (P1int      P2int)  capacitor  c=1a
 Cpad20        (P2int      0    )  capacitor  c=1a
 Lpad2         (P2         P2int)  inductor   l=1f
 
 
 *====if required, add here your additional netlist components==========================
 
 
 
 *======================================================================================
 
 
 
 *Here comes the call to the very modeling circuit
 *i.e. link to the 'Circuit' deck of this Modelfile
 *subckt call
 *  Anode
 *  |      Cathode
 *  |      |
 *  v      v
 X1 P1int  P2int   Diode_Modeling
 *   connect model to inside of contact pads
 
 ends HB_circuitry
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "____________________4" "711.501"
{
}
LINK XFORM "Clean_Up" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !------------------------------------------------------------------------------------------
 !---clean up arrays
 DIMENSION_ARRAY("Domains",             0)
 DIMENSION_ARRAY("VDC1_ValuesAvail",    0)
 DIMENSION_ARRAY("VDC1_ValuesAvailSel", 0)
 DIMENSION_ARRAY("VDC2_ValuesAvail",    0)
 DIMENSION_ARRAY("VDC2_ValuesAvailSel", 0)
 DIMENSION_ARRAY("pin_ValuesAvail",     0)
 DIMENSION_ARRAY("pin_ValuesAvailSel",  0)
 DIMENSION_ARRAY("NrHarmonics",         0)
 DomainSel=0
 NrHarmonicsSel=0
 NrPts=0
 
 
 !---clean up Inputs/Outputs
 ICCAP_FUNC(".", "Import Delete")
 ICCAP_FUNC(".", "New Input", "See_under_ExtractOptimize")
 ICCAP_FUNC("See_under_ExtractOptimize", "STFV", "Sweep Type", "CON")
 
 
 
 RETURN_VALUE 1
 
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
data "711.501"
{
}
}
LINK DAT "_______________________" "711.501"
{
TABLE "Variable Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
data "711.501"
{
}
}
LINK DAT "Wave_Spar_Load_vs_Pin" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.3052208835341 5694 4324"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 C18 P195 C10"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" "____________________1"
element 2 "Value" ""
element 3 "Name" "MINLOG"
element 3 "Value" "1E-9"
element 4 "Name" ""
element 4 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "pin" "711.501"
{
View draw_ds 0 "B,8400,-4712"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "W"
element "Sweep Type" "LIN"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_Pin"
element "- Node" "GROUND"
element "dBm(d)/Watts(W)" "d"
element "Resistance" " 50.00 "
element "Fund" "1"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "Start" "-30.00 "
element "Stop" " 2.000 "
element "# of Points" "9"
element "Step Size" " 4.000 "
}
}
list XFORM "S11calc_pin"
list XFORM "S21calc_pin"
list PLOT "MAG_A1"
list PLOT "PH_A1"
list PLOT "MAG_B1"
list PLOT "PH_B1"
list PLOT "MAG_A2"
list PLOT "PH_A2"
list PLOT "MAG_B2"
list PLOT "PH_B2"
list PLOT "R_Load"
list PLOT "X_Load"
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,-1008,0"
View block_edit 0 "590,4"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "HB"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "Value" " 1.000G"
element "Order" "7"
element "Saved Order" "5"
}
}
list XFORM "Load_mdm_MeasData"
list XFORM "A1rms_squared"
list XFORM "B1rms_squared"
list XFORM "A2rms_squared"
list XFORM "B2rms_squared"
list XFORM "S11calc_pin"
list XFORM "S21calc_pin"
list XFORM "ZLoad"
list XFORM "IndexRelations"
}
LINK SWEEP "VDC1" "711.501"
{
View draw_ds 0 "B,-1008,1712"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "VDC2" "711.501"
{
View draw_ds 0 "B,-1008,4824"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "4"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "v_current_meter2" "711.501"
{
View draw_ds 0 "B,-1008,7936"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "P2aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK SWEEP "v_current_meter1" "711.501"
{
View draw_ds 0 "B,-1008,9848"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "P1aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK OUT "v1" "711.501"
{
View draw_ds 0 "B,-1008,11760"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "A1rms_squared"
list XFORM "B1rms_squared"
list XFORM "S11calc_pin"
list XFORM "S21calc_pin"
}
LINK OUT "i1" "711.501"
{
View draw_ds 0 "B,-1008,13272"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "P1aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "A1rms_squared"
list XFORM "B1rms_squared"
list XFORM "S11calc_pin"
list XFORM "S21calc_pin"
}
LINK OUT "v2" "711.501"
{
View draw_ds 0 "B,-1008,14784"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "A2rms_squared"
list XFORM "B2rms_squared"
list XFORM "S21calc_pin"
list XFORM "ZLoad"
}
LINK OUT "i2" "711.501"
{
View draw_ds 0 "B,-1008,16296"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "P2aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "A2rms_squared"
list XFORM "B2rms_squared"
list XFORM "S21calc_pin"
list XFORM "ZLoad"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 txt_HELP="Domain "&VAL$(WHOIS(".", "Parent Setup PartName"))&"
 ====================================================
 This Setup shows the waves A1, B1, A2 and B2 
 (calculated from the nonlinear voltages and currents v1, i1, v2 and i2) 
 vs. RF power.
 It represents the basic NVNA measurement and simulation results.
 
 => Always start your nonlinRF modeling with fitting the MAG(A1) and MAG(A2) fundamental freq. curves.
    Note: They represent the measurement non-idealities at Port1 and Port2
    Theoretically: A2=0 (no back-reflection from Port2, ideal 50 Ohm load termination).
 
 -> How to adjust the simulated Port impedances:
    Select a single, centered DC bias setting, and adjust the Port2 Load Impedance:
    - watch the trace of Plot MAG(A2), or the trace of Plot R_LOAD, fundamental freq.,
      and tune/optimize the Parameters R_LOAD (fundamental),
      Lterm_P2.L and Cterm_P2.C (harmonics).
      For Lterm_P2.L and Cterm_P2.C, see also Plot X_LOAD)
 -> adjust in the same way also the Port1 impedance:
    - watch the trace of Plot 'MAG_A1'
      and tune/optimize the Parameters R_SOURCE (fundamental),
      Lterm_P1.L and Cterm_P1.C (harmonics)
      Note: in most cases, keep R_SOURCE = 50 Ohm
 
 NOTES: 
 Besides this port impedance matching, the waves representation of the nonlin-RF
 measurement are typically the least sensitive to *model parameter variations* !
 Reason: the waves are basically the multiplication of voltage*current,
   typically plotted on a log scale. Therefore, it may be smarter to fit the *Model*Parameters
   in the other 'non-multiplied', 'non-logarithmic' domains, like Domain 'Nonlin_i_v'.
 
 NOTES:
 The generalized power waves in the NVNA (and in the HW measurements in general) 
 are always calculated from the voltages and currents with respect to 50 Ohm, 
 regardless of what load/source impedance is actually shown to the DUT (Load/Source pulling). 
 This is because the measurement is always done with respect to the 
 characteristic impedance of the physical coaxial transmission lines, 
 which are typically made to be broadband 50 Ohm structures.
 
 The formula are
  [ai and bi are in SQRT(Watt); vi and i2 are *rms* values]
 a1 = 1 / (2*SQRT(Z0)) * (v1 + i1*Z0)
 b2 = 1 / (2*SQRT(Z0)) * (v2 - i2*Z0)
 a2 = 1 / (2*SQRT(Z0)) * (v2 + i2*Z0)
 b1 = 1 / (2*SQRT(Z0)) * (v1 - i1*Z0)
 
 Into the .mdf data file, the NVNA writes the ai and bi in SQRT(Watt),
 but it displays the waves in Power, i.e. in Watt:
 a1_square = 1 / (2*SQRT(Z0))^2 * (v1 + v1)^2 = 1 / (4*Z0) * 4v1^2 = v1^2 / Z0
 etc.
 
 "
 
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_mdm_MeasData" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  GuiSensitivityDC			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityPin			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityXaxis		! show GUI item or not
 GLOBAL_VAR  NrPts				! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---activate/deactivate GUI selection items
 GuiSensitivityDC    = 1		! activate   DC selection GUI
 GuiSensitivityPin   = 0		! deactivate pin selection GUI
 GuiSensitivityXaxis = 0		! deactivate x-axis selection GUI
 
 !---call central .mdm loading program and anticipate its GET_STRING
 Sweep1Name="pin"
 ICCAP_FUNC("../aux/Load_Data", "Execute", VAL$(WHOIS(".", "Parent Setup PartName")), VAL$(Sweep1Name))
 IF VAL$(ErrMsg) <> "" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---execute the dependent Xfms to re-establish the auto-execution link (may have been broken during ImportCreate)
 ICCAP_FUNC("A1rms_squared", "Execute")
 ICCAP_FUNC("B1rms_squared", "Execute")
 ICCAP_FUNC("A2rms_squared", "Execute")
 ICCAP_FUNC("B2rms_squared", "Execute")
 ICCAP_FUNC("S11calc_pin", "Execute")
 ICCAP_FUNC("S21calc_pin", "Execute")
 ICCAP_FUNC("ZLoad",       "Execute")
 
 
 !---update nr.simul.pts info for GUI
 NrPts       = SIZEOF(freq)
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK XFORM "___________________1" "711.501"
{
}
LINK XFORM "A1rms_squared" "711.501"
{
View block_edit 0 "0,1519"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B[SIZEOF(freq)]		!to satisfy the Plot
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! The generalized power waves in the NVNA (and in the HW measurements in general) 
 ! are always calculated from the voltages and currents with respect to 50 Ohm, 
 ! regardless of what load/source impedance is actually shown to the DUT (Load/Source pulling). 
 ! This is because the measurement is always done with respect to the 
 ! characteristic impedance of the physical coaxial transmission lines, 
 ! which are typically made to be broadband 50 Ohm structures.
 
 Z0 = 50    
 
 !---calculate A1rms_squared (to get the same plot like on the NVNA)
 !  A1_rms    = 1 / (2*SQRT(Z0)) * (v1_rms + i1_rms*Z0)
 !  A1_square = 1 / (4*Z0)       * (v1_rms + i1_rms*Z0)^2
 RETURN 1 / (4*Z0)  * (v1//SQRT(2) + i1//SQRT(2)*Z0)^2
 
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "MAG_A1"
list PLOT "PH_A1"
member OUT "i1"
member OUT "v1"
member SWEEP "freq"
}
LINK XFORM "B1rms_squared" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B[SIZEOF(freq)]		!to satisfy the Plot
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! see the notes in Transform 'A1rms_squared' !!!
 
 Z0 = 50    
 
 !---calculate B1rms_squared (to get the same plot like on the NVNA)
 RETURN 1 / (4*Z0)  * (v1//SQRT(2) - i1//SQRT(2)*Z0)^2
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "MAG_B1"
list PLOT "PH_B1"
member OUT "i1"
member OUT "v1"
member SWEEP "freq"
}
LINK XFORM "A2rms_squared" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B[SIZEOF(freq)]		!to satisfy the Plot
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! see the notes in Transform 'A1rms_squared' !!!
 
 Z0 = 50
 
 !---calculate A2rms_squared (to get the same plot like on the NVNA)
 RETURN 1 / (4*Z0)  * (v2//SQRT(2) + i2//SQRT(2)*Z0)^2
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "MAG_A2"
list PLOT "PH_A2"
member OUT "i2"
member OUT "v2"
member SWEEP "freq"
}
LINK XFORM "B2rms_squared" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B[SIZEOF(freq)]		!to satisfy the Plot
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! see the notes in Transform 'A1rms_squared' !!!
 
 Z0 = 50    
 
 !---calculate B2rms_squared (to get the same plot like on the NVNA)
 RETURN 1 / (4*Z0)  * (v2//SQRT(2) - i2//SQRT(2)*Z0)^2
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "MAG_B2"
list PLOT "PH_B2"
member OUT "i2"
member OUT "v2"
member SWEEP "freq"
}
LINK XFORM "S11calc_pin" "711.501"
{
View block_edit 0 "6208,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B.22[1]	!return an empty 2x2 data set to satisfy the Plot entries
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Transforms calculates S11 out of transmitted//injected power waves
 ! For low input power 'pin', assuming a linear device behavior, this calculation
 ! should match a linear S11 measurements
 
 
 !---calculate A1 and B1
 ! The generalized power waves in the NVNA (and in the HW measurements in general) 
 ! are always calculated from the voltages and currents with respect to 50 Ohm, 
 ! regardless of what load/source impedance is actually shown to the DUT (Load/Source pulling). 
 ! This is because the measurement is always done with respect to the 
 ! characteristic impedance of the physical coaxial transmission lines, 
 ! which are typically made to be broadband 50 Ohm structures.
 Z0 = 50    
 A1_peak = (v1+i1*Z0)//(2*SQRT(Z0))
 B1_peak = (v1-i1*Z0)//(2*SQRT(Z0))
 
 
 !---get sweep info
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 
 
 !---calc S11 of fundamental
 COMPLEX tmp_S11.B.22[TotalDataSize//(NrHarmonics+1)]	!size: sweep1(=pin)*nr_overlaying_DC_biases
 N=0
 FOR i = 0 TO TotalDataSize-1
   IF freq[i] == FUNDFREQ THEN 
     IF MAG(A1_peak.M[i]) <> 0 THEN tmp_S11.M.11[N] = B1_peak.M[i] // A1_peak.M[i]
     IF MAG(A1_peak.S[i]) <> 0 THEN tmp_S11.S.11[N] = B1_peak.S[i] // A1_peak.S[i]
     tmp_S11.12[N]=pin[i]
     N = N + 1
   END IF
 NEXT i
 
 RETURN tmp_S11		! S11  = index  .11
 			! pin  = index  .12
 
}
dataset
{
datasize BOTH 9 2 2
type MEAS
type SIMU
}
}
list PLOT "S11"
member OUT "i1"
member OUT "v1"
member SWEEP "freq"
member SWEEP "pin"
}
LINK XFORM "S21calc_pin" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B.22[1]	!return an empty 2x2 data set to satisfy the Plot entries
   RETURN tmp
 END IF
 
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 ! This Transforms calculates S21 out of transmitted//injected power waves
 ! For low input power 'pin', assuming a linear device behavior, this calculation
 ! should match a linear S21 measurements
 
 
 !---calculate A1 and B2
 ! The generalized power waves in the NVNA (and in the HW measurements in general) 
 ! are always calculated from the voltages and currents with respect to 50 Ohm, 
 ! regardless of what load/source impedance is actually shown to the DUT (Load/Source pulling). 
 ! This is because the measurement is always done with respect to the 
 ! characteristic impedance of the physical coaxial transmission lines, 
 ! which are typically made to be broadband 50 Ohm structures.
 Z0 = 50    
 A1_peak = (v1+i1*Z0)//(2*SQRT(Z0))
 B2_peak = (v2-i2*Z0)//(2*SQRT(Z0))
 
 
 !---get sweep info
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 
 
 !---calc S21 of fundamental
 COMPLEX tmp_S21.B.22[TotalDataSize//(NrHarmonics+1)]	!size: sweep1(=pin)*nr_overlaying_DC_biases
 N=0
 FOR i = 0 TO TotalDataSize-1
   IF freq[i] == FUNDFREQ THEN 
     IF MAG(A1_peak.M[i]) <> 0 THEN tmp_S21.M.21[N] = B2_peak.M[i] // A1_peak.M[i]
     IF MAG(A1_peak.S[i]) <> 0 THEN tmp_S21.S.21[N] = B2_peak.S[i] // A1_peak.S[i]
     tmp_S21.11[N]=pin[i]
     N = N + 1
   END IF
 NEXT i
 
 RETURN tmp_S21		! S21  = index  .21
 			! pin  = index  .11
 
}
dataset
{
datasize BOTH 9 2 2
type MEAS
type SIMU
}
}
list PLOT "S21"
member OUT "i1"
member OUT "i2"
member OUT "v1"
member OUT "v2"
member SWEEP "freq"
member SWEEP "pin"
}
LINK XFORM "ZLoad" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B[SIZEOF(freq)]		!to satisfy the Plot
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 tmp_Zload = v2*(-i2)^-1
 
 !---correct sign of DC bias current (flows into device)
 FOR i=0 TO SIZEOF(tmp_Zload)-1
   IF freq[i]==0 THEN 
     tmp_Zload.M[i] = -tmp_Zload.M[i]
     tmp_Zload.S[i] = -tmp_Zload.S[i]
   END IF
 NEXT i
 
 RETURN tmp_Zload
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "R_Load"
list PLOT "X_Load"
member OUT "i2"
member OUT "v2"
member SWEEP "freq"
}
LINK XFORM "___________________2" "711.501"
{
}
LINK XFORM "IndexRelations" "711.501"
{
View block_edit 0 "0,238"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------------------------------
 ! This Program links the data index shown in the Plot
 ! with the index of the stimuli (Inputs)
 !--------------------------------------------------------
 
 
 !---apply the same data picking as above in the Programs for the Plots
 
 MP_PlotIndex=LOOKUP_OBJ_ATTRIBUTE("MP_GUI_Wave_Spar_Load_vs_Pin", "SelectedPlot")
 
 IF MP_PlotIndex<4 THEN
   ! it is not a Spar Plot
   COMPLEX tmp_IndexRelations[SIZEOF(freq)]
   FOR i=0 TO SIZEOF(tmp_IndexRelations)-1
     tmp_IndexRelations[i] = i
   NEXT i
 ELSE
   ! it is a Spar Plot
   TotalDataSize = SIZEOF(freq)
   NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
   COMPLEX tmp_IndexRelations[TotalDataSize//(NrHarmonics+1)]	!size: sweep1(=pin)*nr_overlaying_DC_biases
   N=0
   FOR i = 0 TO TotalDataSize-1
     IF freq[i] == FUNDFREQ THEN 
       tmp_IndexRelations[N] = i
       N = N + 1
     END IF
   NEXT i
 END IF
 
 
 RETURN tmp_IndexRelations
}
dataset
{
datasize COMMON 20 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK PLOT "MP_GUI_Wave_Spar_Load_vs_Pin" "711.501"
{
View plot_window 0 "__iccapDataBlock"
TABLE "ICVIEWDATA"
{
4,23,43399,25947,{MAG_A1:AUTO|XY| 0.000 , 25.00G,5,5: 29.35 , 29.36 ,27,9: 0.000 , 1.000 ,4,5&MAG_B1:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&PH_B1:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&MAG_A2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&MAG_B2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&PH_B2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&R_Load:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&X_Load:AUTO|XY|AUTOMATIC:AUTOMATIC:AUT
OMATIC&MAN|XY|AUTOMATIC::&S11:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5&S21:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5}
__iccapDataBlockEnd
}
View draw_ds 0 "B,20,-8944"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "10"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "3"
element "Header" "Waves (peak), S-param. & Load Impedance"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "MAG_A1"
element "Plot 1" "MAG_B1"
element "Plot 2" "PH_B1"
element "Plot 3" "MAG_A2"
element "Plot 4" "MAG_B2"
element "Plot 5" "PH_B2"
element "Plot 6" "R_Load"
element "Plot 7" "X_Load"
element "Plot 8" "S11"
element "Plot 9" "S21"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "../TL_Settings"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "MAG_A1" "711.501"
{
View draw_ds 0 "B,11,-4264"
View plot_window 0 "4,23,9005,8990,{AUTO|XY| 0.000 , 25.00G,5,5: 29.35 , 29.36 ,27,9: 0.000 , 1.000 ,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "MAG(A1rms^2)  [dBm]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "10*LOG10(MAG(A1rms_squared.M))+30!!MAG(A1rms.M)^2  [dBm]"
element "Y Data 1" "10*LOG10(MAG(A1rms_squared.S))+30!!MAG(A1rms.S)^2  [dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "A1rms_squared"
member SWEEP "pin"
}
LINK PLOT "PH_A1" "711.501"
{
View draw_ds 0 "B,20,0"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "PH(A1rms^2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "PH(A1rms_squared.M)//(2*PI)*360!!PH(A1rms_squared.M)"
element "Y Data 1" "PH(A1rms_squared.S)//(2*PI)*360!!PH(A1rms_squared.S)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "A1rms_squared"
member SWEEP "pin"
}
LINK PLOT "MAG_B1" "711.501"
{
View draw_ds 0 "B,20,4256"
View plot_window 0 "368,1,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "MAG(B1rms^2)  [dBm]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "10*LOG10(MAG(B1rms_squared.M))+30!!MAG(B1rms.M)^2  [dBm]"
element "Y Data 1" "10*LOG10(MAG(B1rms_squared.S))+30!!MAG(B1rms.S)^2  [dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "B1rms_squared"
member SWEEP "pin"
}
LINK PLOT "PH_B1" "711.501"
{
View draw_ds 0 "B,-21,8528"
View plot_window 0 "368,1,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "PH(B1rms^2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "PH(B1rms_squared.M)//(2*PI)*360!!PH(B1rms_squared.M)"
element "Y Data 1" "PH(B1rms_squared.S)//(2*PI)*360!!PH(B1rms_squared.S)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "B1rms_squared"
member SWEEP "pin"
}
LINK PLOT "MAG_A2" "711.501"
{
View draw_ds 0 "B,12,12792"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "MAG(A2rms^2)  [dBm]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "10*LOG10(MAG(A2rms_squared.M))+30!!MAG(A2rms.M)^2  [dBm]"
element "Y Data 1" "10*LOG10(MAG(A2rms_squared.S))+30!!MAG(A2rms.S)^2  [dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "A2rms_squared"
member SWEEP "pin"
}
LINK PLOT "PH_A2" "711.501"
{
View draw_ds 0 "B,20,17056"
View plot_window 0 "80,85,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "PH(A2rms^2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "PH(A2rms_squared.M)//(2*PI)*360!!PH(A2rms_squared.M)"
element "Y Data 1" "PH(A2rms_squared.S)//(2*PI)*360!!PH(A2rms_squared.S)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "A2rms_squared"
member SWEEP "pin"
}
LINK PLOT "MAG_B2" "711.501"
{
View draw_ds 0 "B,28,21320"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "MAG(B2rms^2)  [dBm]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "10*LOG10(MAG(B2rms_squared.M))+30!!MAG(B2rms.M)^2  [dBm]"
element "Y Data 1" "10*LOG10(MAG(B2rms_squared.S))+30!!MAG(B2rms.S)^2  [dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "B2rms_squared"
member SWEEP "pin"
}
LINK PLOT "PH_B2" "711.501"
{
View draw_ds 0 "B,3,25584"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "PH(B2rms^2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "PH(B2rms_squared.M)//(2*PI)*360!!PH(B2rms_squared.M)"
element "Y Data 1" "PH(B2rms_squared.S)//(2*PI)*360!!PH(B2rms_squared.S)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "B2rms_squared"
member SWEEP "pin"
}
LINK PLOT "S21" "711.501"
{
View draw_ds 0 "B,-17,29836"
View plot_window 0 "45,371,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "REAL(S21calc_pin.M.11)!!pin"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S21 @ fund.freq"
element "Footer" ""
element "Polar Data 0" "S21calc_pin.M.21!!S21.M"
element "Polar Data 1" "S21calc_pin.S.21!!S21.S"
element "Polar Data 2" ""
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S21calc_pin"
}
LINK PLOT "S11" "711.501"
{
View draw_ds 0 "B,20,33280"
View plot_window 0 "45,371,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "SMITH PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "REAL(S11calc_pin.M.12)!!pin"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "S11 @ fund.freq"
element "Footer" ""
element "Smith Data 0" "S11calc_pin.M.11!!S11.M"
element "Smith Data 1" "S11calc_pin.S.11!!S11.S"
element "Smith Data 2" ""
element "Smith Data 3" ""
element "Smith Data 4" ""
element "Smith Data 5" ""
element "Smith Data 6" ""
element "Smith Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "S11calc_pin"
}
LINK PLOT "R_Load" "711.501"
{
View draw_ds 0 "B,20,36712"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "R_Load (DC, fund and harmonics)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(ZLoad.M)!!R_Load.M"
element "Y Data 1" "REAL(ZLoad.S)!!R_Load.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "ZLoad"
member SWEEP "pin"
}
LINK PLOT "X_Load" "711.501"
{
View draw_ds 0 "B,20,40976"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "X_Load (DC, fund and harmonics)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(ZLoad.M)!!X_Load.M"
element "Y Data 1" "IMAG(ZLoad.S)!!X_Load.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "ZLoad"
member SWEEP "pin"
}
data "711.501"
{
}
}
LINK DAT "DC_Currents" "711.501"
{
View in_out 0 "0.44954932172468 1902 1546"
View plot 0 "0.8422661233168 3803 2874"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 C23 P165"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "pin" "711.501"
{
View draw_ds 0 "B,3297,-164"
View block_edit 0 "5084,109"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "W"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_Pin"
element "- Node" "GROUND"
element "dBm(d)/Watts(W)" "d"
element "Resistance" " 50.00 "
element "Fund" "1"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "# of Values" "9"
}
HYPTABLE "List Table"
{
element "Value 1" "-30.00 "
element "Value 2" "-26.00 "
element "Value 3" "-22.00 "
element "Value 4" "-18.00 "
element "Value 5" "-14.00 "
element "Value 6" "-10.00 "
element "Value 7" "-6.000 "
element "Value 8" "-2.000 "
element "Value 9" " 2.000 "
}
}
list XFORM "i2DC"
list XFORM "DC_Power"
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,0,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "HB"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "Value" " 1.000G"
element "Order" "7"
element "Saved Order" "5"
}
}
list XFORM "Load_mdm_MeasData"
list XFORM "i1DC"
list XFORM "i2DC"
list XFORM "DC_Power"
list XFORM "IndexRelations"
}
LINK SWEEP "VDC1" "711.501"
{
View draw_ds 0 "B,2073,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
list XFORM "DC_Power"
}
LINK SWEEP "VDC2" "711.501"
{
View draw_ds 0 "B,4202,-5"
View block_edit 0 "0,49"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "4"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
list XFORM "DC_Power"
}
LINK SWEEP "v_current_meter2" "711.501"
{
View draw_ds 0 "B,-2539,5152"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "P2aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK SWEEP "v_current_meter1" "711.501"
{
View draw_ds 0 "B,-65,5152"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "P1aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK OUT "v1" "711.501"
{
View draw_ds 0 "B,2409,5152"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
}
LINK OUT "i1" "711.501"
{
View draw_ds 0 "B,4178,5152"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "P1aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "i1DC"
list XFORM "DC_Power"
}
LINK OUT "v2" "711.501"
{
View draw_ds 0 "B,5974,5152"
View block_edit 0 "1,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
}
LINK OUT "i2" "711.501"
{
View draw_ds 0 "B,-2539,7224"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "P2aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "i2DC"
list XFORM "DC_Power"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 txt_HELP="Domain "&VAL$(WHOIS(".", "Parent Setup PartName"))&"
 ====================================================
 Typically for incrementing power levels, but also upon request vs. DC bias voltages,
 this Setup shows the DC bias currents and the DC power consumption (in dBm).
 
 
 
 
 Typical Parameter Influence (provided current param.values are not too small):
 ----------------------------------
 > external resistors (RG, RD): DC Power"
 
 
 
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_mdm_MeasData" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  GuiSensitivityDC			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityPin			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityXaxis		! show GUI item or not
 GLOBAL_VAR  xAxisChoices			! DUT Variable
 GLOBAL_VAR  NrPts				! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---activate/deactivate GUI selection items
 GuiSensitivityDC    = 1		! activate DC selection GUI
 GuiSensitivityPin   = 1		! activate pin selection GUI
 GuiSensitivityXaxis = 1		! activate x-axis selection GUI
 
 
 !---define possible x-Axis choices
 DIMENSION_ARRAY(xAxisChoices, 3)
 xAxisChoices[0]="pin"
 xAxisChoices[1]="VDC1"
 xAxisChoices[2]="VDC2"
 
 
 !---call central .mdm loading program and anticipate its GET_STRING
 Sweep1Name="pin"
 ICCAP_FUNC("../aux/Load_Data", "Execute", VAL$(WHOIS(".", "Parent Setup PartName")), VAL$(Sweep1Name))
 IF VAL$(ErrMsg) <> "" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---execute the dependent Xfms to re-establish the auto-execution link (may have been broken during ImportCreate)
 ICCAP_FUNC("i1DC", "Execute")
 ICCAP_FUNC("i2DC", "Execute")
 ICCAP_FUNC("DC_Power", "Execute")
 
 
 !---update nr.simul.pts info for GUI
 NrPts       = SIZEOF(freq)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK XFORM "_____________________1" "711.501"
{
}
LINK XFORM "i1DC" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !------------------------------------------------------------------------------
 !---this Program picks the DC current at Port1 from measured and simulated data
 !------------------------------------------------------------------------------
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---pick the data (for both y-Axis and x-Axis)
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_i1DC.B[TotalDataSize//(NrHarmonics+1)]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == 0 THEN
     tmp_i1DC.M[N] = REAL(i1.M[i]) + j*xAxisData[i]	! i1DC + j*xAxisData (for Plot x-Axis)
     tmp_i1DC.S[N] = REAL(i1.S[i])
     N = N + 1
   END IF
 NEXT i
 
 
 !---order the result to get a clean plot
 tmp_i1DC_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_i1DC)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_i1DC_", "STFV", "X Data", "IMAG(i1DC.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_i1DC_", "STFV", "Header", "i1_DC (Port1) vs. "&VAL$(xAxis))
 
 
 RETURN tmp_i1DC_Ordered	!i1DC + j*xAxisData (for Plot Axis)
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_i1DC_"
member OUT "i1"
member SWEEP "freq"
}
LINK XFORM "i2DC" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !------------------------------------------------------------------------------
 !---this Program picks the DC current at Port2 from measured and simulated data
 !------------------------------------------------------------------------------
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---pick the data (for both y-Axis and x-Axis)
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_i2DC.B[TotalDataSize//(NrHarmonics+1)]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == 0 THEN
     tmp_i2DC.M[N] = REAL(i2.M[i]) + j*xAxisData[i]	! i2DC + j*xAxisData (for Plot x-Axis)
     tmp_i2DC.S[N] = REAL(i2.S[i])
     N = N + 1
   END IF
 NEXT i
 
 
 !---order the result to get a clean plot
 tmp_i2DC_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_i2DC)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_i2DC_", "STFV", "X Data", "IMAG(i2DC.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_i2DC_", "STFV", "Header", "i2_DC (Port2) vs. "&VAL$(xAxis))
 
 
 RETURN tmp_i2DC_Ordered	!i2DC + j*xAxisData (for Plot Axis)
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_i2DC_"
member OUT "i2"
member SWEEP "freq"
member SWEEP "pin"
}
LINK XFORM "DC_Power" "711.501"
{
View block_edit 0 "0,3"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------------------------------------------------------
 !---calculating DC Power in dBm (useful when doing modeling of PAE=Gain/DC_Power) 
 !--------------------------------------------------------------------------------
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---pick the data (for both y-Axis and x-Axis)
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_P_DC.B[TotalDataSize//(NrHarmonics+1)]
 !---calc DC power in dBm
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == 0 THEN
     P_DC_M=ABS(VDC1[i])*REAL(i1.M[i]) + ABS(VDC2[i])*REAL(i2.M[i])
     P_DC_S=ABS(VDC1[i])*REAL(i1.S[i]) + ABS(VDC2[i])*REAL(i2.S[i])
     IF P_DC_M<>0 THEN tmp_P_DC.M[N]=10*LOG10(P_DC_M)+30
     IF P_DC_S<>0 THEN tmp_P_DC.S[N]=10*LOG10(P_DC_S)+30
     !---add VDC1 to satisfy Plot
     tmp_P_DC.M[N] = REAL(tmp_P_DC.M[N]) + j*xAxisData[i]	! DC_Power + j*xAxisData (for Plot x-Axis)
     tmp_P_DC.S[N] = REAL(tmp_P_DC.S[N])
     N = N + 1
   END IF
 NEXT i
 
 
 !---order the result to get a clean plot
 tmp_P_DC_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_P_DC)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_DC_Power_", "STFV", "X Data", "IMAG(DC_Power.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_DC_Power_", "STFV", "Header", "DC Power[dBm] vs. "&VAL$(xAxis))
 
 
 RETURN tmp_P_DC_Ordered	!DC_Power + j*xAxisData (for Plot Axis)
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_DC_Power_"
member OUT "i1"
member OUT "i2"
member SWEEP "VDC1"
member SWEEP "VDC2"
member SWEEP "freq"
member SWEEP "pin"
}
LINK XFORM "_____________________2" "711.501"
{
}
LINK XFORM "IndexRelations" "711.501"
{
View block_edit 0 "1779,36"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------------------------------
 ! This Program links the data index shown in the Plot
 ! with the index of the stimuli (Inputs)
 !--------------------------------------------------------
 
 
 !---apply the same data picking as above in the Programs for the Plots
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_IndexRelations[TotalDataSize//(NrHarmonics+1)]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == 0 THEN
     tmp_IndexRelations[N] = i
     N = N + 1
   END IF
 NEXT i
 
 
 RETURN tmp_IndexRelations
}
dataset
{
datasize COMMON 10 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK PLOT "MP_GUI_DC_Currents" "711.501"
{
View plot_window 0 "0,1,42481,28697,{_i1DC_:AUTO|XY| 800.0m, 1.000 ,4,5: 0.000 , 6.000m,6,5: 0.000 , 1.000 ,4,5&_i2DC_:AUTO|XY| 0.000 , 5.000 ,5,5: 0.000 , 250.0m,5,5: 0.000 , 1.000 ,4,5&_DC_Power_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC}"
View draw_ds 0 "B,561,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "3"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "2"
element "Header" "DC Currents"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_i1DC_"
element "Plot 1" "_i2DC_"
element "Plot 2" "_DC_Power_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "../TL_Settings"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_i1DC_" "711.501"
{
View plot_window 0 "103,468,11009,8998,{AUTO|XY| 800.0m, 1.000 ,4,5: 0.000 , 6.000m,6,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,561,3094"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(i1DC.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(i1DC.S)"
element "Header" "i1_DC (Port1) vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(i1DC.M)!!i1DC.M[A]"
element "Y Data 1" "REAL(i1DC.S)!!i1DC.S[A]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "i1DC"
}
LINK PLOT "_i2DC_" "711.501"
{
View plot_window 0 "91,143,11000,9000,{_i2DC_:AUTO|XY| 0.000 , 5.000 ,5,5: 0.000 , 250.0m,5,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,3964,3094"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(i2DC.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(i2DC.S)"
element "Header" "i2_DC (Port2) vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(i2DC.M)!!i2.M[A]"
element "Y Data 1" "REAL(i2DC.S)!!i2.S[A]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "i2DC"
}
LINK PLOT "_DC_Power_" "711.501"
{
View plot_window 0 "31,420,9000,9000"
View draw_ds 0 "B,561,7258"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(DC_Power.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(DC_Power.S)"
element "Header" "DC Power[dBm] vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(DC_Power.M)!!DC_Power.M[dBm]"
element "Y Data 1" "REAL(DC_Power.S)!!DC_Power.S[dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "DC_Power"
}
data "711.501"
{
}
}
LINK DAT "Pout_Gain_PAE" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "0.90405740609497 2960 3086"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 C23 P165"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "pin" "711.501"
{
View draw_ds 0 "B,0,0"
View block_edit 0 "0,1488"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "W"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_Pin"
element "- Node" "GROUND"
element "dBm(d)/Watts(W)" "d"
element "Resistance" " 50.00 "
element "Fund" "1"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "# of Values" "9"
}
HYPTABLE "List Table"
{
element "Value 1" "-30.00 "
element "Value 2" "-26.00 "
element "Value 3" "-22.00 "
element "Value 4" "-18.00 "
element "Value 5" "-14.00 "
element "Value 6" "-10.00 "
element "Value 7" "-6.000 "
element "Value 8" "-2.000 "
element "Value 9" " 2.000 "
}
}
list XFORM "Gain"
list PLOT "_Pout_Pin_"
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,-7728,2938"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "HB"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "Value" " 1.000G"
element "Order" "7"
element "Saved Order" "5"
}
}
list XFORM "Load_mdm_MeasData"
list XFORM "Gain"
list XFORM "PAE"
list XFORM "DC_Power"
list XFORM "calc_Pout_dBm"
list XFORM "IndexRelations"
}
LINK SWEEP "VDC1" "711.501"
{
View draw_ds 0 "B,-7728,4664"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
list XFORM "PAE"
list XFORM "DC_Power"
}
LINK SWEEP "VDC2" "711.501"
{
View draw_ds 0 "B,-7728,6996"
View block_edit 0 "0,49"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "4"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
list XFORM "PAE"
list XFORM "DC_Power"
}
LINK SWEEP "v_current_meter2" "711.501"
{
View draw_ds 0 "B,-7728,9328"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "P2aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK SWEEP "v_current_meter1" "711.501"
{
View draw_ds 0 "B,-7728,11256"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "P1aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK OUT "v1" "711.501"
{
View draw_ds 0 "B,-7728,13184"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "PAE"
}
LINK OUT "i1" "711.501"
{
View draw_ds 0 "B,-7728,14708"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "P1aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "PAE"
list XFORM "DC_Power"
}
LINK OUT "v2" "711.501"
{
View draw_ds 0 "B,-7728,16232"
View block_edit 0 "1,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "PAE"
list XFORM "calc_Pout_dBm"
}
LINK OUT "i2" "711.501"
{
View draw_ds 0 "B,-7728,17756"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "P2aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "PAE"
list XFORM "DC_Power"
list XFORM "calc_Pout_dBm"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 txt_HELP="Domain "&VAL$(WHOIS(".", "Parent Setup PartName"))&"
 ====================================================
 Typically for incrementing power levels, but also upon request vs. DC bias voltages,
 this Setup shows the plot 'Pout', plot 'Power Gain' (@ fundamental),
 and the 'Power Added Efficiency' (PAE) plot.
 And, additionally, also the plot 'DC power consumption' in dBm 
 (useful when doing modeling of PAE=Gain/DC_Power).
 
 
 Note: Gain is pretty useful to check DC&Spar modeling validity
 for nonlin-RF !
 
 
 
 Typical Parameter Influence (provided current param.values are not too small):
 ----------------------------------
 > external resistors (RG, RD): AC Gain, neutral on PAE
 > external inductors (LG, LD): ~
 > C10  -> Gain and PAE
 > C12  -> Gain and PAE
 > C20 ~
 > Tau  -> Gain and PAE
 Nomenclature: L1:  ind. between device and Port1
               C10: cap. between device Input -> Ground
               C12: cap. between device Input -> Output
               etc.
 "
 
 
 
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_mdm_MeasData" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  GuiSensitivityDC			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityPin			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityXaxis		! show GUI item or not
 GLOBAL_VAR  xAxisChoices			! DUT Variable
 GLOBAL_VAR  NrPts				! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---activate/deactivate GUI selection items
 GuiSensitivityDC    = 1		! activate DC selection GUI
 GuiSensitivityPin   = 1		! activate pin selection GUI
 GuiSensitivityXaxis = 1		! activate x-axis selection GUI
 
 
 !---define possible x-Axis choices
 DIMENSION_ARRAY(xAxisChoices, 3)
 xAxisChoices[0]="pin"
 xAxisChoices[1]="VDC1"
 xAxisChoices[2]="VDC2"
 
 
 !---call central .mdm loading program and anticipate its GET_STRING
 Sweep1Name="pin"
 ICCAP_FUNC("../aux/Load_Data", "Execute", VAL$(WHOIS(".", "Parent Setup PartName")), VAL$(Sweep1Name))
 IF VAL$(ErrMsg) <> "" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---execute the dependent Xfms to re-establish the auto-execution link (may have been broken during ImportCreate)
 ICCAP_FUNC("calc_Pout_dBm", "Execute")
 ICCAP_FUNC("Pout", "Execute")
 ICCAP_FUNC("Gain", "Execute")
 ICCAP_FUNC("PAE",  "Execute")
 ICCAP_FUNC("DC_Power", "Execute")
 
 
 !---update nr.simul.pts info for GUI
 NrPts       = SIZEOF(freq)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK XFORM "_____________________1" "711.501"
{
}
LINK XFORM "Pout" "711.501"
{
View block_edit 0 "0,49"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !------------------------------------------------------------------------------
 !---this Program takes the calc_Pout_dBm data and organizes them vs. any x-Axis
 !------------------------------------------------------------------------------
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 COMPLEX tmp_Pout_dBm.B[SIZEOF(calc_Pout_dBm)]
 !---get Pout from Xfm 'calc_Pout_dBm' and add x-axis info
 FOR i=0 TO SIZEOF(tmp_Pout_dBm)-1
   tmp_Pout_dBm.M[i] = REAL(calc_Pout_dBm.M[i]) + j*xAxisData[i]	! Pout_dBm + j*xAxisData (for Plot x-Axis)
   tmp_Pout_dBm.S[i] = REAL(calc_Pout_dBm.S[i])
 NEXT i
 
 
 
 !---order the data of Xfm 'calc_Pout_dBm' to get a clean plot
 tmp_Pout_dBm_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_Pout_dBm)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_Pout_", "STFV", "X Data", "IMAG(Pout.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_Pout_", "STFV", "Header", "Pout[dBm] @ DC, fund. & harmon. vs. "&VAL$(xAxis))
 
 
 RETURN tmp_Pout_dBm_Ordered	!Pout_dBm + j*xAxisData (for Plot Axis)
 
 
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "_Pout_"
member XFORM "calc_Pout_dBm"
}
LINK XFORM "Gain" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !------------------------------------------------------------------------------
 !---calculating Gain = Pout(fundamental)[dBm] - pin[dBm] 
 !------------------------------------------------------------------------------
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 
 !---pick the data (for both y-Axis and x-Axis)
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_Gain.B[TotalDataSize//(NrHarmonics+1)]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i]==FUNDFREQ THEN
     !---calc tmp_Gain, if data available  (calc_Pout_dBm returns -150dBm, when meas/simul data are 0)
     IF calc_Pout_dBm.M[i]>-150 THEN tmp_Gain.M[N] = (calc_Pout_dBm.M[i] - pin[i])
      tmp_Gain.M[N] = tmp_Gain.M[N] + j*xAxisData[i]	! Gain + j*xAxisData (for Plot x-Axis)
     IF calc_Pout_dBm.S[i]>-150 THEN tmp_Gain.S[N] = (calc_Pout_dBm.S[i] - pin[i])
     N = N + 1
   END IF
 NEXT i
 
 
 !---order the result to get a clean plot
 tmp_Gain_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_Gain)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_Gain_", "STFV", "X Data", "IMAG(Gain.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_Gain_", "STFV", "Header", "Gain vs. "&VAL$(xAxis))
 
 
 RETURN tmp_Gain_Ordered	!Gain + j*xAxisData (for Plot Axis)
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_Gain_"
member XFORM "calc_Pout_dBm"
member SWEEP "freq"
member SWEEP "pin"
}
LINK XFORM "PAE" "711.501"
{
View block_edit 0 "0,3"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !------------------------------------------------------------------------------
 !---calculating PAE[%] = 100*(Pout(fundamental)[W] - pin[W]) // P_DC[W]
 !------------------------------------------------------------------------------
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---calc the PAE (for y-Axis) and also return the corresponding x-Axis
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_P_DC.B[TotalDataSize//(NrHarmonics+1)]
 COMPLEX tmp_PAE.B[TotalDataSize//(NrHarmonics+1)]
 
 !---calc DC power
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == 0 THEN
     P_DC_M=ABS(VDC1[i])*REAL(i1.M[i]) + ABS(VDC2[i])*REAL(i2.M[i])
     P_DC_S=ABS(VDC1[i])*REAL(i1.S[i]) + ABS(VDC2[i])*REAL(i2.S[i])
     IF P_DC_M<>0 THEN tmp_P_DC.M[N]=P_DC_M
     IF P_DC_S<>0 THEN tmp_P_DC.S[N]=P_DC_S
     N = N + 1
   END IF
 NEXT i
 
 !---calc PAE[%]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i]==FUNDFREQ THEN
     !   calc Pin and Pout in rms
     Pin_M  = REAL(v1.M[i]//SQRT(2)*(CONJG(-i1.M[i]))//SQRT(2))	! we apply 'REAL' because we need to use the 'Real Power', and not 'MAG' what is 'Apparent Power'
     Pin_S  = REAL(v1.S[i]//SQRT(2)*(CONJG(-i1.S[i]))//SQRT(2))
     Pout_M = REAL(v2.M[i]//SQRT(2)*(CONJG(-i2.M[i]))//SQRT(2))
     Pout_S = REAL(v2.S[i]//SQRT(2)*(CONJG(-i2.S[i]))//SQRT(2))
     !---calc tmp_PAE
     IF tmp_P_DC.M[N]<>0 THEN tmp_PAE.M[N] = 100*(Pout_M-Pin_M)//tmp_P_DC.M[N] 
     tmp_PAE.M[N] = REAL(tmp_PAE.M[N]) + j*xAxisData[i]		! PAE.M + j*xAxisData (for Plot x-Axis)
     IF tmp_P_DC.S[N]<>0 THEN tmp_PAE.S[N] = 100*(Pout_S-Pin_S)//tmp_P_DC.S[N]			! PAE.S
     N = N + 1
   END IF
 NEXT i
 
 
 !---order the result to get a clean plot
 tmp_PAE_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_PAE)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_PAE_", "STFV", "X Data", "IMAG(PAE.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_PAE_", "STFV", "Header", "PAE[%] at fund. vs. "&VAL$(xAxis))
 
 
 RETURN tmp_PAE_Ordered	!PAE + j*xAxisData (for Plot Axis)
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_PAE_"
member OUT "i1"
member OUT "i2"
member OUT "v1"
member OUT "v2"
member SWEEP "VDC1"
member SWEEP "VDC2"
member SWEEP "freq"
}
LINK XFORM "DC_Power" "711.501"
{
View block_edit 0 "0,3"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------
 !---calculating DC Power in dBm
 !--------------------------------
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---pick the data (for both y-Axis and x-Axis)
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_P_DC.B[TotalDataSize//(NrHarmonics+1)]
 !---calc DC power in dBm
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == 0 THEN
     P_DC_M=ABS(VDC1[i])*REAL(i1.M[i]) + ABS(VDC2[i])*REAL(i2.M[i])
     P_DC_S=ABS(VDC1[i])*REAL(i1.S[i]) + ABS(VDC2[i])*REAL(i2.S[i])
     IF P_DC_M<>0 THEN tmp_P_DC.M[N]=10*LOG10(P_DC_M)+30
     IF P_DC_S<>0 THEN tmp_P_DC.S[N]=10*LOG10(P_DC_S)+30
     !---add VDC1 to satisfy Plot
     tmp_P_DC.M[N] = REAL(tmp_P_DC.M[N]) + j*xAxisData[i]	! DC_Power + j*xAxisData (for Plot x-Axis)
     tmp_P_DC.S[N] = REAL(tmp_P_DC.S[N])
     N = N + 1
   END IF
 NEXT i
 
 
 !---order the result to get a clean plot
 tmp_P_DC_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_P_DC)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_DC_Power_", "STFV", "X Data", "IMAG(DC_Power.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_DC_Power_", "STFV", "Header", "DC Power[dBm] vs. "&VAL$(xAxis))
 
 
 RETURN tmp_P_DC_Ordered	!DC_Power + j*xAxisData (for Plot Axis)
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_DC_Power_"
member OUT "i1"
member OUT "i2"
member SWEEP "VDC1"
member SWEEP "VDC2"
member SWEEP "freq"
}
LINK XFORM "_____________________2" "711.501"
{
}
LINK XFORM "calc_Pout_dBm" "711.501"
{
View block_edit 0 "0,2989"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B[SIZEOF(freq)]		!to satisfy the Plot
   RETURN tmp
 END IF
 !----------------------------------------
 
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !-------------------------------------------------------------------------------------------------------
 !---calc. port2 eff.power in dBm (out of v2 and i2)
 ! >>calc. DC case: 
 !         =======
 ! dBm = 10*LOG10(v2*(-i2)) + 30
 !
 ! >>calc. for fundamental & harmonics for ADS simulation.
 !             =======================
 !         NOTE: ADS calculates harmonics as peak data) 
 !         NOTE: the eff.values of the NVNA .mdf file (currents and voltages)
 !               have been converted to peak by the mdif-reader ModelFile !!!
 ! dBm =  10*LOG10(MAG(v2//SQRT(2)*(CONJG(-i2))//SQRT(2))) + 30
 ! Alternatively, but valid only for ZLOAD=Z0=50 Ohm,
 ! we can also calc. the port2 power in dBm out of v2.
 ! dBm = 10 + 20*LOG10(MAG(v2))
 ! This should give the same result (for the fund. and the harmonics), see notes at bottom of this Program
 !
 !
 ! NOTE: i2 goes 'into' device, see the netlist in DUT TestCircuit. Therefore, we apply (-i2)  !
 ! NOTE: when meas.or simul. data are 0, -200dBm is returned for that data point
 !-------------------------------------------------------------------------------------------------------
 
 COMPLEX tmp_Pout_dBm.B[SIZEOF(v2)]
 
 FOR i=0 TO SIZEOF(freq)-1
   tmp_Pout_dBm.M[i]=-200
   IF (v2.M[i] <> 0) AND (i2.M[i] <> 0) THEN
     IF freq[i] == 0 THEN
       !-include DC bias power in Plot
       tmp_Pout_dBm.M[i] = 10*LOG10(MAG(REAL(v2.M[i])    * REAL(-i2.M[i])))           + 30
     ELSE
       !-calc Pout from v2_rms and i2_rms
       tmp_Pout_dBm.M[i] = 10*LOG10(MAG(v2.M[i]//SQRT(2) * CONJG(-i2.M[i])//SQRT(2))) + 30
     END IF
   END IF
 
   tmp_Pout_dBm.S[i]=-200
   IF (v2.S[i] <> 0) AND (i2.S[i] <> 0) THEN
     IF freq[i] == 0 THEN	!include DC bias power in Plot
       tmp_Pout_dBm.S[i] = 10*LOG10(MAG(REAL(v2.S[i])    * REAL(-i2.S[i])))           + 30
     ELSE
       tmp_Pout_dBm.S[i] = 10*LOG10(MAG(v2.S[i]//SQRT(2) * CONJG(-i2.S[i])//SQRT(2))) + 30
     END IF
   END IF
 NEXT i
 
 
 
 RETURN tmp_Pout_dBm
 
 
 !-------------------------------------------------------------------------------------------------------
 ! Some notes about calculating power in dBm in a 50 Ohm system:
 !--------------------------------------------------------------
 
 ! Let's commence with the known electrical power formula
 ! for sinusoidal signals:
 !
 ! Power_eff = v/SQRT(2) * i_/SQRT(2)      i_: conjugate complex
 !
 ! When referring Pout and a load impedance
 ! of Z0 = 50 Ohm, it is
 !
 !              v * v_ / 50      v*v_
 ! Power_eff = ------------- = -------- [Watt]
 !                  2            100
 !
 ! -------------
 ! Power_eff_dBm = 10*log10(Power_eff[mW])
 ! ------------- 
 !               = 10*log10(1000 * Power_eff[W])
 !
 !		= 10*log10(1000*v*v_ / 100)
 !
 !		= 10*log10(10*v*v_) 
 !               
 !               = 10*log10(10) + 10*log10(v*v_)  
 !
 !               = 10 + 10*log10[(REAL(v))^2+(IMAG(v))^2] 
 !
 !		=  10 + 10*log10[(MAG(v))^2] =
 !
 !              -------------------------
 !               = 10 + 20*log10[MAG(v)]
 !              -------------------------
 
 ! This finally is the formula to calculate Pout[dBm] for Z0=50 Ohm.
 
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "Pout"
list XFORM "Gain"
list PLOT "_Pout_Pin_"
member OUT "i2"
member OUT "v2"
member SWEEP "freq"
}
LINK XFORM "IndexRelations" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------------------------------
 ! This Program links the data index shown in the Plot
 ! with the index of the stimuli (Inputs)
 !--------------------------------------------------------
 
 
 !---apply the same data picking as above in the Programs for the Plots
 
 MP_PlotIndex=LOOKUP_OBJ_ATTRIBUTE("MP_GUI_Pout_Gain_PAE", "SelectedPlot")
 
 IF MP_PlotIndex<>0 THEN
   ! it is not Plot '_Pout_'
   TotalDataSize = SIZEOF(freq)
   NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
   COMPLEX tmp_IndexRelations[TotalDataSize//(NrHarmonics+1)]
   N=0
   FOR i=0 TO TotalDataSize-1
     IF freq[i]==FUNDFREQ THEN
       tmp_IndexRelations[N] = i
       N = N + 1
     END IF
   NEXT i
 ELSE
   ! Plot '_Pout_' holds all stimuli data
   COMPLEX tmp_IndexRelations[SIZEOF(freq)]
   FOR i=0 TO SIZEOF(tmp_IndexRelations)-1
     tmp_IndexRelations[i] = i
   NEXT i
 
 END IF
 
 
 RETURN tmp_IndexRelations
}
dataset
{
datasize COMMON 1500 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK PLOT "MP_GUI_Pout_Gain_PAE" "711.501"
{
View plot_window 0 "0,1,42093,28697,{_Pout_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_PAE_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_Gain_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_DC_Power_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC}"
View draw_ds 0 "B,0,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "2"
element "Header" "Pout  Gain  PAE"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_Pout_"
element "Plot 1" "_PAE_"
element "Plot 2" "_Gain_"
element "Plot 3" "_DC_Power_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "../TL_Settings"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_Pout_" "711.501"
{
View plot_window 0 "13,481,10876,10083"
View draw_ds 0 "B,0,3196"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "Yes" "N"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "N"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(Pout.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(Pout.S)!!pin"
element "Header" "Pout[dBm] @ DC, fund. & harmon. vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Pout.M)!!Pout .M[dBm]"
element "Y Data 1" "REAL(Pout.S)!!Pout .S[dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "Pout"
}
LINK PLOT "_Gain_" "711.501"
{
View plot_window 0 "90,111,9000,9000"
View draw_ds 0 "B,0,7422"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(Gain.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(Gain.S)"
element "Header" "Gain vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Gain.M)!!Gain.M[dB]"
element "Y Data 1" "REAL(Gain.S)!!Gain.S[dB]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "Gain"
}
LINK PLOT "_PAE_" "711.501"
{
View plot_window 0 "31,420,9005,8990"
View draw_ds 0 "B,0,11648"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(PAE.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(PAE.S)"
element "Header" "PAE[%] at fund. vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(PAE.M)!!PAE.M[%]"
element "Y Data 1" "REAL(PAE.S)!!PAE.S[%]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "PAE"
}
LINK PLOT "_Pout_Pin_" "711.501"
{
View plot_window 0 "13,481,10875,10100,{_Pout_Pin_:AUTO|XY|-9.000 ,-4.000 ,5,5:-60.00 ,-25.00 ,7,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,15874"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "Yes" "N"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "N"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Pout[dBm] @ DC, fund. & harmon. vs. Pin[dBm]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(calc_Pout_dBm.M)!!Pout .M[dBm]"
element "Y Data 1" "REAL(calc_Pout_dBm.S)!!Pout .S[dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "calc_Pout_dBm"
member SWEEP "pin"
}
LINK PLOT "_DC_Power_" "711.501"
{
View plot_window 0 "31,420,9000,9000"
View draw_ds 0 "B,0,20100"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(DC_Power.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(DC_Power.S)"
element "Header" "DC Power[dBm] vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(DC_Power.M)!!DC_Power.M[dBm]"
element "Y Data 1" "REAL(DC_Power.S)!!DC_Power.S[dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "DC_Power"
}
data "711.501"
{
}
}
LINK DAT "AM_PM" "711.501"
{
View in_out 0 "0.44954932172468 1902 1546"
View plot 0 "0.82720588235294 2805 2824"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 C23 P165"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" "_______________________"
element 2 "Value" ""
element 3 "Name" ""
element 3 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "pin" "711.501"
{
View draw_ds 0 "B,8493,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "W"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_Pin"
element "- Node" "GROUND"
element "dBm(d)/Watts(W)" "d"
element "Resistance" " 50.00 "
element "Fund" "1"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "# of Values" "9"
}
HYPTABLE "List Table"
{
element "Value 1" "-30.00 "
element "Value 2" "-26.00 "
element "Value 3" "-22.00 "
element "Value 4" "-18.00 "
element "Value 5" "-14.00 "
element "Value 6" "-10.00 "
element "Value 7" "-6.000 "
element "Value 8" "-2.000 "
element "Value 9" " 2.000 "
}
}
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,0,0"
View block_edit 0 "0,15"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "HB"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "Value" " 1.000G"
element "Order" "7"
element "Saved Order" "5"
}
}
list XFORM "Load_mdm_MeasData"
list XFORM "AM_AM"
list XFORM "AM_PM"
list XFORM "S21calc"
list XFORM "IndexRelations"
}
LINK SWEEP "VDC1" "711.501"
{
View draw_ds 0 "B,-4205,7480"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "VDC2" "711.501"
{
View draw_ds 0 "B,-1998,7480"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "4"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "v_current_meter1" "711.501"
{
View draw_ds 0 "B,209,7480"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "P1aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK SWEEP "v_current_meter2" "711.501"
{
View draw_ds 0 "B,2683,7480"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "P2aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK OUT "v1" "711.501"
{
View draw_ds 0 "B,-4205,10480"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "AM_AM"
list XFORM "AM_PM"
list XFORM "S21calc"
}
LINK OUT "i1" "711.501"
{
View draw_ds 0 "B,-2436,10480"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "P1aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "AM_AM"
list XFORM "AM_PM"
list XFORM "S21calc"
}
LINK OUT "v2" "711.501"
{
View draw_ds 0 "B,-640,10480"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "AM_AM"
list XFORM "AM_PM"
list XFORM "S21calc"
}
LINK OUT "i2" "711.501"
{
View draw_ds 0 "B,1129,10480"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "P2aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "AM_AM"
list XFORM "AM_PM"
list XFORM "S21calc"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 txt_HELP="Domain "&VAL$(WHOIS(".", "Parent Setup PartName"))&"
 ====================================================
 Typically for incrementing power levels, but also upon request vs. DC bias voltages,
 this Setup shows the plots:
 -> AM-AM: change in MAG(amplification)
 -> AM-PM: change in PHASE(amplification)
 
 These plots basically show the change of the linear
 S-Parameter S21 dependent on the applied RF signal power:
 
 AM to AM characteristic: 
 MAG(B2_rms/A1_rms) = Gain in dB(V)  
 at the fundamental frequency, to be displayed vs. the power settings, 
 for given DC bias(es).
 
 AM to PM characteristics:
 PHASE(B2_rms/A1_rms)
 
 NOTE: 
 AM_AM => MAG(S21)   at fundamental, when small signal excitation (low 'Pin').
 AM_PM => PHASE(S21) at fundamental, when small signal excitation (low 'Pin').
 
 
 Typical Parameter Influence (provided current param.values are not too small):
 ----------------------------------
 > external resistors (RG, RD): AM-AM
 > external inductors (LG, LD): AM-PM
 > C10  -> AM-AM, AM-PM
 > C12  -> AM-AM, AM-PM
 > C20  -> AM-PM
 > Tau  -> AM-AM, AM-PM
 Nomenclature: L1:  ind. between device and Port1
               C10: cap. between device Input -> Ground
               C12: cap. between device Input -> Output
               etc.
 "
 
 
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_mdm_MeasData" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  GuiSensitivityDC			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityPin			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityXaxis		! show GUI item or not
 GLOBAL_VAR  xAxisChoices			! DUT Variable
 GLOBAL_VAR  NrPts				! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---activate/deactivate GUI selection items
 GuiSensitivityDC    = 1		! activate   DC selection GUI
 GuiSensitivityPin   = 1		! deactivate pin selection GUI, and keep all pin values of original .mdm file
 GuiSensitivityXaxis = 1		! activate x-axis selection GUI
 
 
 !---define possible x-Axis choices
 DIMENSION_ARRAY(xAxisChoices, 3)
 xAxisChoices[0]="pin"
 xAxisChoices[1]="VDC1"
 xAxisChoices[2]="VDC2"
 xAxisChoicesSel=0
 
 
 !---call central .mdm loading program and anticipate its GET_STRING
 Sweep1Name="pin"
 ICCAP_FUNC("../aux/Load_Data", "Execute", VAL$(WHOIS(".", "Parent Setup PartName")), VAL$(Sweep1Name))
 IF VAL$(ErrMsg) <> "" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---execute the dependent Xfms to re-establish the auto-execution link (may have been broken during ImportCreate)
 ICCAP_FUNC("AM_AM",   "Execute")
 ICCAP_FUNC("AM_PM",   "Execute")
 ICCAP_FUNC("S21calc", "Execute")
 
 
 !---update nr.simul.pts info for GUI
 NrPts       = SIZEOF(freq)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK XFORM "_____________________1" "711.501"
{
}
LINK XFORM "AM_AM" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !------------------------------------------------------------------------------
 ! This transform returns the AM to AM characteristic
 ! [B2_rms/A1_rms = Gain in dB(V)  (= S21 when small signal excitation)]
 ! at the fundamental frequency.
 !------------------------------------------------------------------------------
 
 Z0 =  50
 
 COMPLEX tmp_A1_peak.B[SIZEOF(v1)]
 COMPLEX tmp_B2_peak.B[SIZEOF(v1)]
 FOR i=0 TO SIZEOF(tmp_A1_peak)-1
   tmp_A1_peak.M[i] = (v1.M[i] + i1.M[i]*Z0)//(2*SQRT(Z0))
   tmp_A1_peak.S[i] = (v1.S[i] + i1.S[i]*Z0)//(2*SQRT(Z0))
   tmp_B2_peak.M[i] = (v2.M[i] - i2.M[i]*Z0)//(2*SQRT(Z0))
   tmp_B2_peak.S[i] = (v2.S[i] - i2.S[i]*Z0)//(2*SQRT(Z0))
 NEXT i
 
 !---calc. rms values of A1 and B2
 tmp_A1_rms = tmp_A1_peak // SQRT(2)
 tmp_B2_rms = tmp_B2_peak // SQRT(2)
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---get AM-AM of fundamental
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_AM_AM.B[TotalDataSize//(NrHarmonics+1)]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == FUNDFREQ THEN 
     IF MAG(tmp_A1_rms.M[i]) <> 0 THEN tmp_AM_AM.M[N] = 20*LOG10(ABS(tmp_B2_rms.M[i]//tmp_A1_rms.M[i]))
      tmp_AM_AM.M[N] = tmp_AM_AM.M[N] + j*xAxisData[i]		! AM_AM + j*xAxisData (for Plot x-Axis)
     IF MAG(tmp_A1_rms.S[i]) <> 0 THEN tmp_AM_AM.S[N] = 20*LOG10(ABS(tmp_B2_rms.S[i]//tmp_A1_rms.S[i]))
     N = N + 1
   END IF
 NEXT i
 
 
 !---order the data to get a clean plot
 tmp_AM_AM_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_AM_AM)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_AM_AM_", "STFV", "X Data", "IMAG(AM_AM.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_AM_AM_", "STFV", "Header", "AM_AM vs. "&VAL$(xAxis))
 
 
 RETURN tmp_AM_AM_Ordered	!AM_AM + j*xAxisData (for Plot Axis)
 
 
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_AM_AM_"
member OUT "i1"
member OUT "i2"
member OUT "v1"
member OUT "v2"
member SWEEP "freq"
}
LINK XFORM "AM_PM" "711.501"
{
View block_edit 0 "7942,189"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !------------------------------------------------------------------------------
 ! This transform returns the AM to PM characteristic (in degrees) 
 ! at the fundamental frequency
 !------------------------------------------------------------------------------
 
 
 Z0 =  50
 
 COMPLEX tmp_A1_peak.B[SIZEOF(v1)]
 COMPLEX tmp_B2_peak.B[SIZEOF(v1)]
 FOR i=0 TO SIZEOF(tmp_A1_peak)-1
   tmp_A1_peak.M[i] = (v1.M[i] + i1.M[i]*Z0)//(2*SQRT(Z0))
   tmp_A1_peak.S[i] = (v1.S[i] + i1.S[i]*Z0)//(2*SQRT(Z0))
   tmp_B2_peak.M[i] = (v2.M[i] - i2.M[i]*Z0)//(2*SQRT(Z0))
   tmp_B2_peak.S[i] = (v2.S[i] - i2.S[i]*Z0)//(2*SQRT(Z0))
 NEXT i
 
 
 !---calc. rms values of A1 and B2
 tmp_A1_rms = tmp_A1_peak // SQRT(2)
 tmp_B2_rms = tmp_B2_peak // SQRT(2)
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---get AM-PM of fundamental
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_AM_PM.B[TotalDataSize//(NrHarmonics+1)]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == FUNDFREQ THEN 
     IF tmp_A1_rms.M[i] <> 0 THEN tmp_AM_PM.M[N] = PHASE(tmp_B2_rms.M[i]//tmp_A1_rms.M[i])//(2PI)*360
       tmp_AM_PM.M[N] = tmp_AM_PM.M[N] + j*xAxisData[i]	! AM_PM + j*xAxisData (for Plot x-Axis)
     IF tmp_A1_rms.S[i] <> 0 THEN tmp_AM_PM.S[N] = PHASE(tmp_B2_rms.S[i]//tmp_A1_rms.S[i])//(2PI)*360
     N = N + 1
   END IF
 NEXT i
 
 !---order the data to get a clean plot
 tmp_AM_PM_Ordered = EVALUATE_TRANSFORM("/UTILITIES/PEL_UTILITIES/REORDER_SWEEPS/REORDER_DATA", tmp_AM_PM)
 
 
 !---update the plot header and x-Axis description (in case the user has changed it)
 ICCAP_FUNC("_AM_PM_", "STFV", "X Data", "IMAG(AM_PM.M)!!"&VAL$(xAxis))
 ICCAP_FUNC("_AM_PM_", "STFV", "Header", "AM_PM vs. "&VAL$(xAxis))
 
 
 RETURN tmp_AM_PM_Ordered	!AM_PM + j*xAxisData (for Plot Axis)
 
 
}
dataset
{
datasize BOTH 9 1 1
type MEAS
type SIMU
}
}
list PLOT "_AM_PM_"
list PLOT "_S21calc_"
member OUT "i1"
member OUT "i2"
member OUT "v1"
member OUT "v2"
member SWEEP "freq"
}
LINK XFORM "S21calc" "711.501"
{
View block_edit 0 "0,880"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR  xAxisChoices
 GLOBAL_VAR  xAxisChoicesSel
 GLOBAL_VAR  StopExec
 IF StopExec==1 THEN 
   COMPLEX tmp.B.22[1]	!return an empty 2x2 data set to satisfy the Plot entries
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !------------------------------------------------------------------------------
 ! This Transforms calculates S21 out of transmitted//injected power waves
 ! For low input power 'pin', assuming a linear device behavior, this calculation
 ! should match a linear S21 measurements
 !------------------------------------------------------------------------------
 
 
 Z0 =  50
 
 COMPLEX tmp_A1_peak.B[SIZEOF(v1)]
 COMPLEX tmp_B2_peak.B[SIZEOF(v1)]
 FOR i=0 TO SIZEOF(tmp_A1_peak)-1
   tmp_A1_peak.M[i] = (v1.M[i] + i1.M[i]*Z0)//(2*SQRT(Z0))
   tmp_A1_peak.S[i] = (v1.S[i] + i1.S[i]*Z0)//(2*SQRT(Z0))
   tmp_B2_peak.M[i] = (v2.M[i] - i2.M[i]*Z0)//(2*SQRT(Z0))
   tmp_B2_peak.S[i] = (v2.S[i] - i2.S[i]*Z0)//(2*SQRT(Z0))
 NEXT i
 
 
 !---calc. rms values of A1 and B2
 tmp_A1_rms = tmp_A1_peak // SQRT(2)
 tmp_B2_rms = tmp_B2_peak // SQRT(2)
 
 
 !---ask selected x-Axis
 xAxis = VAL$(xAxisChoices[xAxisChoicesSel])
 xAxisData = DATASET("quiet "&VAL$(xAxis))
 
 
 !---calc S21 of fundamental
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_S21.B.22[TotalDataSize//(NrHarmonics+1)]	!size: sweep1(=pin)*nr_overlaying_DC_biases
 N=0
 FOR i =0 TO TotalDataSize-1
   IF freq[i] == FUNDFREQ THEN 
     IF MAG(tmp_A1_rms.M[i]) <> 0 THEN tmp_S21.M.21[N] = tmp_B2_rms.M[i] // tmp_A1_rms.M[i]
     IF MAG(tmp_A1_rms.S[i]) <> 0 THEN tmp_S21.S.21[N] = tmp_B2_rms.S[i] // tmp_A1_rms.S[i]
     tmp_S21.11[N]=xAxisData[i]
     N = N + 1
   END IF
 NEXT i
 
 RETURN tmp_S21		! S21        = index  .21
 			! SweepData  = index  .11
 
}
dataset
{
datasize BOTH 9 2 2
type MEAS
type SIMU
}
}
list PLOT "_S21calc_"
member OUT "i1"
member OUT "i2"
member OUT "v1"
member OUT "v2"
member SWEEP "freq"
}
LINK XFORM "_____________________2" "711.501"
{
}
LINK XFORM "IndexRelations" "711.501"
{
View block_edit 0 "1779,36"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------------------------------
 ! This Program links the data index shown in the Plot
 ! with the index of the stimuli (Inputs)
 !--------------------------------------------------------
 
 
 !---apply the same data picking as above in the Programs for the Plots
 TotalDataSize = SIZEOF(freq)
 NrHarmonics   = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 COMPLEX tmp_IndexRelations[TotalDataSize//(NrHarmonics+1)]
 N=0
 FOR i=0 TO TotalDataSize-1
   IF freq[i] == FUNDFREQ THEN 
     tmp_IndexRelations[N] = i    
     N = N + 1
   END IF
 NEXT i
 
 
 RETURN tmp_IndexRelations
}
dataset
{
datasize COMMON 125 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK PLOT "MP_GUI_AM_PM" "711.501"
{
View plot_window 0 "1,1,42410,28697,{_AM_AM_:AUTO|XY|-30.00 , 10.00 ,4,5:-100.0 , 50.00 ,3,5: 0.000 , 1.000 ,4,5&_AM_PM_:AUTO|XY|-30.00 , 10.00 ,4,5:-100.0 , 50.00 ,3,5: 0.000 , 1.000 ,4,5&_S21calc_:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5}"
View draw_ds 0 "B,0,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "3"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "0"
element "Header" "AM_AM    AM_PM"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_AM_AM_"
element "Plot 1" "_AM_PM_"
element "Plot 2" "_S21calc_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "../TL_Settings"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_AM_AM_" "711.501"
{
View plot_window 0 "0,451,10875,10100,{_AM_AM_:AUTO|XY|-30.00 , 10.00 ,4,5:-100.0 , 50.00 ,3,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,2990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "Yes" "N"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "N"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(AM_AM.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(AM_AM.S)"
element "Header" "AM_AM vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(AM_AM.M)!!AM_AM.M[dB(V)]"
element "Y Data 1" "REAL(AM_AM.S)!!AM_AM.S[dB(V)]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "AM_AM"
}
LINK PLOT "_AM_PM_" "711.501"
{
View plot_window 0 "0,451,10876,10083,{_AM_PM_:AUTO|XY|-30.00 , 10.00 ,4,5:-100.0 , 50.00 ,3,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,0,7010"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "Yes" "N"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "N"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(AM_PM.M)!!pin"
element "# of Traces" "8"
element "Curve Data" "IMAG(AM_PM.S)"
element "Header" "AM_PM vs. pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(AM_PM.M)!!AM_PM.M[degree]"
element "Y Data 1" "REAL(AM_PM.S)!!AM_PM.S[degree]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "AM_PM"
}
LINK PLOT "_S21calc_" "711.501"
{
View draw_ds 0 "B,0,11030"
View plot_window 0 "13,293,9000,9000,{_S21calc_:AUTO|RI|RI: 0.000 , 0.000 , 1.000 ,5,5,5,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "POLAR PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "Sweep Data" "REAL(S21calc.M.11)!!Pin[dB(W)]"
element "# of Traces" "8"
element "Curve Data" "IMAG(AM_PM.S)"
element "Header" "S21 @ fund.freq"
element "Footer" ""
element "Polar Data 0" "S21calc.M.21!!S21.M"
element "Polar Data 1" "S21calc.S.21!!S21.S"
element "Polar Data 2" ""
element "Polar Data 3" ""
element "Polar Data 4" ""
element "Polar Data 5" ""
element "Polar Data 6" ""
element "Polar Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "AM_PM"
member XFORM "S21calc"
}
data "711.501"
{
}
}
LINK DAT "Time_Domain" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.1397058823529 2766 3890"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P191 P122 P203"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" "___________________1"
element 2 "Value" ""
element 3 "Name" "NrTimeSteps"
element 3 "Value" "60"
element 4 "Name" "NrOverlaySweeps"
element 4 "Value" "9"
element 5 "Name" "PLOT_TRACE_LINE_WIDTH"
element 5 "Value" "0"
element 5 "Comment" "Plot Lines Thickness (set to 0 for max. Plot speed)"
element 6 "Name" ""
element 6 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "pin" "711.501"
{
View draw_ds 0 "B,1900,1"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "W"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_Pin"
element "- Node" "GROUND"
element "dBm(d)/Watts(W)" "d"
element "Resistance" " 50.00 "
element "Fund" "1"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "# of Values" "9"
}
HYPTABLE "List Table"
{
element "Value 1" "-30.00 "
element "Value 2" "-26.00 "
element "Value 3" "-22.00 "
element "Value 4" "-18.00 "
element "Value 5" "-14.00 "
element "Value 6" "-10.00 "
element "Value 7" "-6.000 "
element "Value 8" "-2.000 "
element "Value 9" " 2.000 "
}
}
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,-12266,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "HB"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "Value" " 1.000G"
element "Order" "7"
element "Saved Order" "5"
}
}
list XFORM "Load_mdm_MeasData"
}
LINK SWEEP "VDC1" "711.501"
{
View draw_ds 0 "B,-10198,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "VDC2" "711.501"
{
View draw_ds 0 "B,-8064,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "4"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "v_current_meter2" "711.501"
{
View draw_ds 0 "B,-5930,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "P2aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK SWEEP "v_current_meter1" "711.501"
{
View draw_ds 0 "B,-3456,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "P1aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK OUT "v1" "711.501"
{
View draw_ds 0 "B,-982,0"
View block_edit 0 "0,2"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "v1_i1_v2_i2_time"
}
LINK OUT "i1" "711.501"
{
View draw_ds 0 "B,787,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "P1aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "v1_i1_v2_i2_time"
}
LINK OUT "v2" "711.501"
{
View draw_ds 0 "B,2583,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "v1_i1_v2_i2_time"
}
LINK OUT "i2" "711.501"
{
View draw_ds 0 "B,-14805,3018"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "P2aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "v1_i1_v2_i2_time"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 txt_HELP="Domain "&VAL$(WHOIS(".", "Parent Setup PartName"))&"
 ====================================================
 This Setup shows the time signals of v1, i1, v2 and i2, 
 composed from the Harmonic Balance simulations.
 The trajectory plots 'i1_v1' (Input), 'i2_v1' (Transfer) and 'i2_v2' (Output) 
 show how far the trajectories 'satellite around' the DC operating point,
 dependent on the applied RF power. 
 This is important for the capability to model DC-bias-dependent ModelParameters 
 from large-signal RF measurements.
 
 Example: 
 using the 'i2_v2' Plot for modelingthe Transit Time parameters TF, ITF, XTF, VTF 
 of a Gummel-Poon model, make sure that there is a sufficiently wide trajectory 
 visible the 'i2_v2' Plot, satelliting around the DC operating point. 
 I.e. make sure the selected RF signal power is large enough for your parameter extraction!
 
 
 Typical Parameter Influence (provided current param.values are not too small):
 ----------------------------------
 > external resistors (RG, RD): ~
 > external inductors (LG, LD): ~
 > C10  -> v1, i1, v2, i2, widening of trajectories except i2(v2)
 > C12  -> v1, i1, v2, i2, widening of trajectories except i2(v2)
 > C20 ~
 > Tau  -> v2, i2,         widening of trajectories i2(v1), i2(v2)
 Nomenclature: L1:  ind. between device and Port1
               C10: cap. between device Input -> Ground
               C12: cap. between device Input -> Output
               etc.
 Hint:
 ----------
 In order to not loose the S-parameter fitting, add the Sxx and Sxy Plot 
 of the Setup covering all DC biases and frequencies to the PlotOptimizer targets !!!
 
 NOTE: you can ignore the Warnings in the Status window about Plots and Data Size Mismatch"
 
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_mdm_MeasData" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  GuiSensitivityDC			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityPin			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityXaxis		! show GUI item or not
 GLOBAL_VAR  NrTimeSteps			! nr. of time steps in time Plots
 GLOBAL_VAR  NrOverlaySweeps			! nr. of sweeps on top of 1.st order freq (=HB) sweep
 GLOBAL_VAR  NrPts				! DUT Variable:  show nr. of currently loaded data points in GUI
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---activate/deactivate GUI selection items
 GuiSensitivityDC    = 1		! activate   DC selection GUI
 GuiSensitivityPin   = 1		! activate  pin selection GUI
 GuiSensitivityXaxis = 0		! deactivate x-axis selection GUI
 
 
 !---call central .mdm loading program and anticipate its GET_STRING
 Sweep1Name="freq"
 ICCAP_FUNC("../aux/Load_Data", "Execute", VAL$(WHOIS(".", "Parent Setup PartName")), VAL$(Sweep1Name))
 IF VAL$(ErrMsg) <> "" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---verify if max.5 harmonics are present (currently, the PELs in this Setup are programmed for exactly 5 harmonics
 AvailNrHarmonics=VAL(LOOKUP_TABLE_VAL("freq", "Saved Order", ErrMsg))
 IF  AvailNrHarmonics> 5 THEN
   GET_STRING "ERROR: only 5 harmonics are currently supported 
 	by the PEL programs in UTILITIES/NONLIN_RF_MDLG/TimeDomain!  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 
 !---idenfiy the nr. of sweeps overlaying the 1st order sweep 'freq' (=HB)
 TotalPts  = SIZEOF(freq)
 Sweep1Pts = USERC_num_of_points(1, ".")
 NrOverlaySweeps = TotalPts//Sweep1Pts
 
 
 !---set NrTimeSteps for trajectories
 NrTimeSteps=60
 
 
 !---execute the dependent Xfms to re-establish the auto-execution link (may have been broken during ImportCreate)
 ICCAP_FUNC("v1_i1_v2_i2_time", "Execute")
 ICCAP_FUNC("CurveData4Plot", "Execute")
 
 
 !---update nr.time pts info for GUI
 NrPts       = SIZEOF(freq)*NrTimeSteps
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK XFORM "_____________________1" "711.501"
{
}
LINK XFORM "v1_i1_v2_i2_time" "711.501"
{
View block_edit 0 "15694,566"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN 
   !---update CurveData 
   ICCAP_FUNC("CurveData4Plot", "Execute")
   !---return an empty 2x2 data set to satisfy the Plot entries
   COMPLEX tmp.B.22[1]	
   RETURN tmp
 END IF
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT SYSTEM$("date +%H:%M:%S")&": exec.Xfm "&WHOAMI()&"..."
 
 ! This Program calculates the time-domain data out of the harmonics
 
 
 tmp_v1 = v1
 ICCAP_FUNC("v_or_i_TimeDomain", "Execute", tmp_v1)
 tmp_v1 = v_or_i_TimeDomain
 
 
 tmp_i1 = i1
 ICCAP_FUNC("v_or_i_TimeDomain", "Execute", tmp_i1)
 tmp_i1 = v_or_i_TimeDomain
 
 
 tmp_v2 = v2
 ICCAP_FUNC("v_or_i_TimeDomain", "Execute", tmp_v2)
 tmp_v2 = v_or_i_TimeDomain
 
 
 tmp_i2 = i2
 ICCAP_FUNC("v_or_i_TimeDomain", "Execute", tmp_i2)
 tmp_i2 = v_or_i_TimeDomain
 
 
 !---gather all together
 COMPLEX tmp_all.B.22[SIZEOF(tmp_v1)]
 i=0
 WHILE i < SIZEOF(tmp_all)
   tmp_all.M.11[i] = tmp_v1.M[i]	!v1 + j*time
   tmp_all.S.11[i] = tmp_v1.S[i]
   tmp_all.M.12[i] = tmp_i1.M[i]	!i1 + j*time
   tmp_all.S.12[i] = tmp_i1.S[i]
   tmp_all.M.21[i] = tmp_v2.M[i]	!v2 + j*time
   tmp_all.S.21[i] = tmp_v2.S[i]
   tmp_all.M.22[i] = tmp_i2.M[i]	!i2 + j*time
   tmp_all.S.22[i] = tmp_i2.S[i]
   i = i + 1
 END WHILE
 
 !---update CurveData 
 ICCAP_FUNC("CurveData4Plot", "Execute")
 
 
 RETURN tmp_all		! volt or curr + j*time
 
}
dataset
{
datasize BOTH 540 2 2
type MEAS
type SIMU
}
}
list PLOT "_v1_time_"
list PLOT "_i1_time_"
list PLOT "_i2_time_"
list PLOT "_v2_time_"
list PLOT "_i1_v1_"
list PLOT "_i2_v1_"
list PLOT "_i2_v2_"
list PLOT "_v2_v1_"
member XFORM "v_or_i_TimeDomain"
member OUT "i1"
member OUT "i2"
member OUT "v1"
member OUT "v2"
}
LINK XFORM "_____________________2" "711.501"
{
}
LINK XFORM "v_or_i_TimeDomain" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT SYSTEM$("date +%H:%M:%S")&": exec.Xfm "&WHOAMI()&"..."
 
 ! This program calculates the (rel. to v1) phase-nomalized,
 ! scope-like time-domain signals.
 ! It is called by 'v1_i1_v2_i2_time'.
 ! => currently, it handles 5 harmonics, not more and not less !!  <==
 
 ! Note: phase normalization is applied to both meas. and simul. data
 
 
 GLOBAL_VAR  NrTimeSteps
 GLOBAL_VAR  NrOverlaySweeps
 GLOBAL_VAR  NrHarmonicsSel
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 GET_DATASET "HBDataSet [v1, i1, v2, i2]", "v1", HBDataSet
 
 
 !---get size of 1st order sweep 'freq'
 Sweep1Pts= USERC_num_of_points(1, ".")
 
 
 !---identify Output Data type [M, S, or B]
 DataType = LOOKUP_TABLE_VAL("v1", "Type")
 
 
 !---COMPLEX statement for calculated time-domain datasets
 IF VAL$(DataType)=="M" THEN COMPLEX TimeSignal.M[NrTimeSteps*NrOverlaySweeps]
 IF VAL$(DataType)=="S" THEN COMPLEX TimeSignal.S[NrTimeSteps*NrOverlaySweeps]
 IF VAL$(DataType)=="B" THEN COMPLEX TimeSignal.B[NrTimeSteps*NrOverlaySweeps]
 
 
 PhaseRef  = DATASET("quiet v1")
 FOR N=0 TO NrOverlaySweeps-1
   !---do phase normalization with respect to the fundamental of v1
   IF VAL$(DataType)=="M" OR VAL$(DataType)=="B" THEN 
     phase_normM=1
     IF PhaseRef.M[1+N*Sweep1Pts]<>0 THEN 		! index 0=DC, index 1=fundamental
       phase_normM = PhaseRef.M[1+N*Sweep1Pts]//MAG(PhaseRef.M[1+N*Sweep1Pts])
     END IF
   END IF
   IF VAL$(DataType)=="S" OR VAL$(DataType)=="B" THEN 
     phase_normS=1
     IF PhaseRef.S[1+N*Sweep1Pts]<>0 THEN 
       phase_normS = PhaseRef.S[1+N*Sweep1Pts]//MAG(PhaseRef.S[1+N*Sweep1Pts])
     END IF
   END IF
 
 
 
 
 
   !---calc sinusoidal time functions out of the 5 harmonics
   IF (VAL$(DataType)=="M") OR (VAL$(DataType)=="B") THEN
     FOR i=0 TO NrTimeSteps-1
       TimeStep        = FUNDFREQ^-1 * i//(NrTimeSteps-1)
       TimeSignal_DC   = REAL(HBDataSet.M[0+N*Sweep1Pts])						! DC
       TimeSignal_Fund = REAL(HBDataSet.M[1+N*Sweep1Pts]*EXP(j*1*2PI*FUNDFREQ*TimeStep)//(phase_normM^1))	! 1st harmonic = fundamental in time domain
       TimeSignal_2=0
       TimeSignal_3=0
       TimeSignal_4=0
       TimeSignal_5=0
       IF VAL(NrHarmonicsSel)>1 THEN TimeSignal_2    = REAL(HBDataSet.M[2+N*Sweep1Pts]*EXP(j*2*2PI*FUNDFREQ*TimeStep)//(phase_normM^2))	! 2nd harmonic (2* fundamental) in time domain
       IF VAL(NrHarmonicsSel)>2 THEN TimeSignal_3    = REAL(HBDataSet.M[3+N*Sweep1Pts]*EXP(j*3*2PI*FUNDFREQ*TimeStep)//(phase_normM^3))	! 3rd harmonic (3* fundamental) in time domain
       IF VAL(NrHarmonicsSel)>3 THEN TimeSignal_4    = REAL(HBDataSet.M[4+N*Sweep1Pts]*EXP(j*4*2PI*FUNDFREQ*TimeStep)//(phase_normM^4))	! 4th harmonic (4* fundamental) in time domain
       IF VAL(NrHarmonicsSel)>4 THEN TimeSignal_5    = REAL(HBDataSet.M[5+N*Sweep1Pts]*EXP(j*5*2PI*FUNDFREQ*TimeStep)//(phase_normM^5))	! 5th harmonic (5* fundamental) in time domain
       TimeSignal.M[i+N*NrTimeSteps]= TimeSignal_DC + TimeSignal_Fund + TimeSignal_2 + TimeSignal_3 + TimeSignal_4 + TimeSignal_5   +  j*TimeStep	!add time step as imag part, to satisfy the Plot
     NEXT i
   END IF
 
   IF (VAL$(DataType)=="S") OR (VAL$(DataType)=="B") THEN
     FOR i=0 TO NrTimeSteps-1
       TimeStep        = FUNDFREQ^-1 * i//(NrTimeSteps-1)
       TimeSignal_DC   = REAL(HBDataSet.S[0+N*Sweep1Pts])						! DC
       TimeSignal_Fund = REAL(HBDataSet.S[1+N*Sweep1Pts]*EXP(j*1*2PI*FUNDFREQ*TimeStep)//(phase_normS^1))	! 1st harmonic = fundamental in time domain
       TimeSignal_2=0
       TimeSignal_3=0
       TimeSignal_4=0
       TimeSignal_5=0
       IF VAL(NrHarmonicsSel)>1 THEN TimeSignal_2    = REAL(HBDataSet.S[2+N*Sweep1Pts]*EXP(j*2*2PI*FUNDFREQ*TimeStep)//(phase_normS^2))	! 2nd harmonic (2* fundamental) in time domain
       IF VAL(NrHarmonicsSel)>2 THEN TimeSignal_3    = REAL(HBDataSet.S[3+N*Sweep1Pts]*EXP(j*3*2PI*FUNDFREQ*TimeStep)//(phase_normS^3))	! 3rd harmonic (3* fundamental) in time domain
       IF VAL(NrHarmonicsSel)>3 THEN TimeSignal_4    = REAL(HBDataSet.S[4+N*Sweep1Pts]*EXP(j*4*2PI*FUNDFREQ*TimeStep)//(phase_normS^4))	! 4th harmonic (4* fundamental) in time domain
       IF VAL(NrHarmonicsSel)>4 THEN TimeSignal_5    = REAL(HBDataSet.S[5+N*Sweep1Pts]*EXP(j*5*2PI*FUNDFREQ*TimeStep)//(phase_normS^5))	! 5th harmonic (5* fundamental) in time domain
       TimeSignal.S[i+N*NrTimeSteps] = TimeSignal_DC + TimeSignal_Fund + TimeSignal_2 + TimeSignal_3 + TimeSignal_4 + TimeSignal_5   +  j*TimeStep	!add time step as imag part, to satisfy the Plot
     NEXT i
   END IF
 NEXT N
 
 
 RETURN TimeSignal	! volt or curr + j*time
 
}
dataset
{
datasize BOTH 540 1 1
type MEAS
type SIMU
}
}
list XFORM "v1_i1_v2_i2_time"
}
LINK XFORM "CurveData4Plot" "711.501"
{
View block_edit 0 "0,378"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 IF StopExec==1 THEN RETURN_VALUE 0
 !----------------------------------------
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT SYSTEM$("date +%H:%M:%S")&": exec.Xfm "&WHOAMI()&"..."
 
 
 !---provide a dataset for Plot's pen-up/pen-down
 !     Note: a pen-up/pen-down will occur at the data index 
 !     for which the value of the array entered 
 !     to the Plot field 'CurveData' changes.
 
 
 GLOBAL_VAR  NrTimeSteps
 GLOBAL_VAR  NrOverlaySweeps
 
 
 COMPLEX tmp.S[NrTimeSteps*NrOverlaySweeps]
 N=0
 FOR i=0 TO SIZEOF(tmp)-1
   tmp[i]=FLOOR(i//NrTimeSteps)
 NEXT i
 
 
 RETURN tmp
}
dataset
{
datasize SIMU 540 1 1
type SIMU
}
}
list PLOT "_v1_time_"
list PLOT "_i1_time_"
list PLOT "_i2_time_"
list PLOT "_v2_time_"
list PLOT "_i1_v1_"
list PLOT "_i2_v1_"
list PLOT "_i2_v2_"
list PLOT "_v2_v1_"
}
LINK XFORM "_____________________3" "711.501"
{
}
LINK XFORM "IndexRelations" "711.501"
{
View block_edit 0 "0,52"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT SYSTEM$("date +%H:%M:%S")&": exec.Xfm "&WHOAMI()&"..."
 
 
 
 !--------------------------------------------------------
 ! This Program links the data index shown in the Plot
 ! with the index of the stimuli (Inputs)
 !--------------------------------------------------------
 
 
 GLOBAL_VAR  NrTimeSteps
 GLOBAL_VAR  NrOverlaySweeps
 
 COMPLEX tmp.S[NrTimeSteps*NrOverlaySweeps]
 NrHarmonics = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 N=0
 FOR i=0 TO SIZEOF(tmp)-1
   tmp[i]=FLOOR(i//NrTimeSteps)*(NrHarmonics+1)
 NEXT i
 
 
 RETURN tmp
}
dataset
{
datasize SIMU 15000 1 1
type SIMU
}
}
}
LINK PLOT "MP_GUI_Time_Domain" "711.501"
{
View plot_window 0 "__iccapDataBlock"
TABLE "ICVIEWDATA"
{
1,0,42340,28520,{_v1_time_:AUTO|XY| 430.0p, 480.0p,5,5:-681.0m,-676.0m,5,5: 0.000 , 1.000 ,4,5&_i1_time_:AUTO|XY| 460.0p, 520.0p,6,5: 760.0m, 880.0m,6,4: 0.000 , 1.000 ,4,5&_v2_time_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_i2_time_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_i1_v1_:AUTO|XY|-700.0m,-500.0m,4,5:-1.000m, 1.000m,4,5: 0.000 , 1.000 ,4,5&_i2_v1_:AUTO|XY| 0.000 , 1.400 ,7,4:-200.0m, 200.0m,7,5
:AUTOMATIC&_i2_v2_:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&_v2_v1_:AUTO|XY| 760.0m, 840.0m,4,4: 985.0m, 1.010 ,4,5:AUTOMATIC}
__iccapDataBlockEnd
}
View draw_ds 0 "B,0,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "8"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "4"
element "Header" "Time Domain"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "_v1_time_"
element "Plot 1" "_i1_time_"
element "Plot 2" "_v2_time_"
element "Plot 3" "_i2_time_"
element "Plot 4" "_i1_v1_"
element "Plot 5" "_i2_v1_"
element "Plot 6" "_i2_v2_"
element "Plot 7" "_v2_v1_"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "../TL_Settings"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "_v1_time_" "711.501"
{
View draw_ds 0 "B,280,4312"
View plot_window 0 "0,412,11400,11400,{_v1_time_:AUTO|XY| 430.0p, 480.0p,5,5:-681.0m,-676.0m,5,5: 0.000 , 1.000 ,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "7" "N"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Dashed Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(v1_i1_v2_i2_time.11)!!time"
element "# of Traces" "8"
element "Curve Data" "REAL(CurveData4Plot)"
element "Header" "v1"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.11)!!v1.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.11)!!v1.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" "IMAG(CurveData4Plot)!!0V"
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
LINK PLOT "_i1_time_" "711.501"
{
View draw_ds 0 "B,280,8332"
View plot_window 0 "724,414,11400,11400,{_i1_time_:AUTO|XY| 460.0p, 520.0p,6,5: 760.0m, 880.0m,6,4: 0.000 , 1.000 ,4,5}"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "7" "N"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Dashed Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(v1_i1_v2_i2_time.12)!!time"
element "# of Traces" "8"
element "Curve Data" "REAL(CurveData4Plot)"
element "Header" "i1"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.12)!!i1.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.12)!!i1.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" "IMAG(CurveData4Plot)!!0V"
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
LINK PLOT "_i2_time_" "711.501"
{
View draw_ds 0 "B,280,12352"
View plot_window 0 "126,473,11400,11400"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "7" "N"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Dashed Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(v1_i1_v2_i2_time.22)!!time"
element "# of Traces" "8"
element "Curve Data" "REAL(CurveData4Plot)"
element "Header" "i2"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.22)!!i2.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.22)!!i2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" "IMAG(CurveData4Plot)!!0V"
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
LINK PLOT "_v2_time_" "711.501"
{
View draw_ds 0 "B,280,16372"
View plot_window 0 "89,416,11400,11400"
TABLE "Plot Options" "711.501"
{
TABLE "Trace Settings" "711.501"
{
element 0 "Name" "Data 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "7" "N"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
}
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Dashed Line" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(v1_i1_v2_i2_time.21)!!time"
element "# of Traces" "8"
element "Curve Data" "REAL(CurveData4Plot)"
element "Header" "v2"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.21)!!v2.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.21)!!v2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" "IMAG(CurveData4Plot)!!0V"
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
LINK PLOT "_i1_v1_" "711.501"
{
View plot_window 0 "17,479,10125,10125,{_i1_v1_:AUTO|XY|-700.0m,-500.0m,4,5:-1.000m, 1.000m,4,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,280,20392"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(v1_i1_v2_i2_time.11)!!v1"
element "# of Traces" "8"
element "Curve Data" "CurveData4Plot"
element "Header" "Input Trajectory [i1 vs. v1]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.12)!!i1.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.12)!!i1.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
LINK PLOT "_i2_v1_" "711.501"
{
View plot_window 0 "19,474,10125,10125,{_i2_v1_:AUTO|XY| 0.000 , 1.400 ,7,4:-200.0m, 200.0m,7,5:AUTOMATIC}"
View draw_ds 0 "B,280,24412"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(v1_i1_v2_i2_time.11)!!v1"
element "# of Traces" "8"
element "Curve Data" "CurveData4Plot"
element "Header" "Transfer Trajectory [i2 vs. v1]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.22)!!i2.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.22)!!i2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
LINK PLOT "_i2_v2_" "711.501"
{
View plot_window 0 "22,472,10125,10125"
View draw_ds 0 "B,280,28432"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(v1_i1_v2_i2_time.21)!!v2"
element "# of Traces" "8"
element "Curve Data" "CurveData4Plot"
element "Header" "Output Trajectory [i2 vs. v2]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.22)!!i2.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.22)!!i2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
LINK PLOT "_v2_v1_" "711.501"
{
View plot_window 0 "41,466,10125,10125,{_v2_v1_:AUTO|XY| 760.0m, 840.0m,4,4: 985.0m, 1.010 ,4,5:AUTOMATIC}"
View draw_ds 0 "B,280,32452"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "REAL(v1_i1_v2_i2_time.11)!!v1"
element "# of Traces" "8"
element "Curve Data" "CurveData4Plot"
element "Header" "Voltage Trajectory [v2 vs. v1]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1_i1_v2_i2_time.M.21)!!v2.M"
element "Y Data 1" "REAL(v1_i1_v2_i2_time.S.21)!!v2.S"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "CurveData4Plot"
member XFORM "v1_i1_v2_i2_time"
}
data "711.501"
{
}
}
LINK DAT "IP2_IP3_vs_Pin" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "0.90383593196315 4081 3084"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 C23 P165"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" "_______________________"
element 2 "Value" ""
element 3 "Name" ""
element 3 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "pin" "711.501"
{
View draw_ds 0 "B,-15051,0"
View block_edit 0 "0,229"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "W"
element "Sweep Type" "LIN"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_Pin"
element "- Node" "GROUND"
element "dBm(d)/Watts(W)" "d"
element "Resistance" " 50.00 "
element "Fund" "1"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "Start" "-30.00 "
element "Stop" " 2.000 "
element "# of Points" "9"
element "Step Size" " 4.000 "
}
}
list XFORM "Pout_dBm"
list XFORM "calc_IPx"
list XFORM "IndexRelations"
list PLOT "MagPout_Pin"
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,-17478,0"
View block_edit 0 "0,229"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "HB"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "Value" " 1.000G"
element "Order" "7"
element "Saved Order" "5"
}
}
list XFORM "Load_mdm_MeasData"
list XFORM "Pout_dBm"
list XFORM "calc_IPx"
list XFORM "IndexRelations"
}
LINK SWEEP "VDC1" "711.501"
{
View draw_ds 0 "B,-15410,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "VDC2" "711.501"
{
View draw_ds 0 "B,-13203,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "4"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "v_current_meter2" "711.501"
{
View draw_ds 0 "B,-10996,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "P2aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK SWEEP "v_current_meter1" "711.501"
{
View draw_ds 0 "B,-8522,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "P1aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK OUT "v1" "711.501"
{
View draw_ds 0 "B,-6048,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
}
LINK OUT "i1" "711.501"
{
View draw_ds 0 "B,-20017,7672"
View block_edit 0 "0,82"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "P1aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
}
LINK OUT "v2" "711.501"
{
View draw_ds 0 "B,-18221,7672"
View block_edit 0 "0,81"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "Pout_dBm"
}
LINK OUT "i2" "711.501"
{
View draw_ds 0 "B,-16452,7672"
View block_edit 0 "0,79"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "P2aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "Pout_dBm"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 txt_HELP="Domain "&VAL$(WHOIS(".", "Parent Setup PartName"))&"
 ====================================================
 IP2: derived from the plot 'Pout vs. Pin',
      IP2_out (IP2_in) is the y-axis (x-axis) intersect point between two lines:
      one fitted to the fundamental (per 'Pin' index),
      the other to the 2nd harmonic.
 
 IP3: the same, applied to the 3rd harmonic.
 
 Usually, IP2 > IP3"
 
 
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_mdm_MeasData" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  GuiSensitivityDC			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityPin			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityXaxis		! show GUI item or not
 GLOBAL_VAR  NrPts				! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---activate/deactivate GUI selection items
 GuiSensitivityDC    = 1		! activate   DC selection GUI
 GuiSensitivityPin   = 0		! deactivate pin selection GUI, and keep all pin values of original .mdm file
 GuiSensitivityXaxis = 0		! deactivate x-axis selection GUI
 
 
 !---call central .mdm loading program and anticipate its GET_STRING
 Sweep1Name="pin"
 ICCAP_FUNC("../aux/Load_Data", "Execute", VAL$(WHOIS(".", "Parent Setup PartName")), VAL$(Sweep1Name))
 IF VAL$(ErrMsg) <> "" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---execute the dependent Xfms to re-establish the auto-execution link (may have been broken during ImportCreate)
 ICCAP_FUNC("Pout_dBm", "Execute")
 ICCAP_FUNC("IP2", "Execute")
 ICCAP_FUNC("IP3", "Execute")
 
 
 !---update nr.simul.pts info for GUI
 NrPts       = SIZEOF(freq)
 
 
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK XFORM "_____________________1" "711.501"
{
}
LINK XFORM "Pout_dBm" "711.501"
{
View block_edit 0 "0,470"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 
 IF StopExec==1 THEN 
   COMPLEX tmp.B[SIZEOF(pin)]		! to satisfy the Plot
   RETURN tmp
 END IF
 !----------------------------------------
 
 
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !-------------------------------------------------------------------------------------------------------
 !---calc. port2 eff.power in dBm (out of v2 and i2)
 ! >>calc. DC case: 
 !         =======
 ! dBm = 10*LOG10(v2*(-i2)) + 30
 !
 ! >>calc. for fundamental & harmonics for ADS simulation.
 !             =======================
 !         NOTE: ADS calculates harmonics as peak data) 
 !         NOTE: the eff.values of the NVNA .mdf file (currents and voltages)
 !               have been converted to peak by the mdif-reader ModelFile !!!
 ! dBm =  10*LOG10(MAG(v2//SQRT(2)*(CONJG(-i2))//SQRT(2))) + 30
 ! Alternatively, we can also calc. port2 power in dBm (out of v2 and for Z0=50 Ohm).
 ! dBm = 10 + 20*LOG10(MAG(v2))
 ! This should give the same result (for the fund. and the harmonics), see notes at bottom of this Program
 !
 !
 ! NOTE: i2 goes 'into' device, see the netlist in DUT TestCircuit. Therefore, we apply (-i2)  !
 ! NOTE: when meas.or simul. data are 0, -200dBm is returned for that data point
 !-------------------------------------------------------------------------------------------------------
 
 COMPLEX tmp_Pout_dBm.B[SIZEOF(v2)]
 MinPoutdBm = -200
 FOR i=0 TO SIZEOF(freq)-1
   tmp_Pout_dBm.M[i]=MinPoutdBm
   IF (v2.M[i] <> 0) AND (i2.M[i] <> 0) THEN
     IF freq[i] == 0 THEN
       !-include DC bias power in Plot
       tmp_Pout_dBm.M[i] = 10*LOG10(MAG(REAL(v2.M[i])    * REAL(-i2.M[i])))           + 30
     ELSE
       !-calc. rms Pout from v2 and i2
       tmp_Pout_dBm.M[i] = 10*LOG10(MAG(v2.M[i]//SQRT(2) * CONJG(-i2.M[i])//SQRT(2))) + 30
     END IF
   END IF
 
   tmp_Pout_dBm.S[i]=MinPoutdBm
   IF (v2.S[i] <> 0) AND (i2.S[i] <> 0) THEN
     IF freq[i] == 0 THEN
       !-include DC bias power in Plot
       tmp_Pout_dBm.S[i] = 10*LOG10(MAG(REAL(v2.S[i])    * REAL(-i2.S[i])))           + 30
     ELSE
       !-calc. rms Pout from v2 and i2
       tmp_Pout_dBm.S[i] = 10*LOG10(MAG(v2.S[i]//SQRT(2) * CONJG(-i2.S[i])//SQRT(2))) + 30
     END IF
   END IF
 NEXT i
 
 !PRINT "   Pout.M DC @min.RF: ";tmp_Pout_dBm.M[0];"dBm"
 !PRINT "   Pout.S DC @min.RF: ";tmp_Pout_dBm.S[0];"dBm"
 
 
 RETURN tmp_Pout_dBm
 
 
 !-------------------------------------------------------------------------------------------------------
 ! Some notes about calculating power in dBm in a 50 Ohm system:
 !--------------------------------------------------------------
 
 ! Let's commence with the known electrical power formula
 ! for sinusoidal signals:
 !
 ! Power_eff = v/SQRT(2) * i_/SQRT(2)      i_: conjugate complex
 !
 ! When referring Pout and a load impedance
 ! of Z0 = 50 Ohm, it is
 !
 !              v * v_ / 50      v*v_
 ! Power_eff = ------------- = -------- [Watt]
 !                  2            100
 !
 ! -------------
 ! Power_eff_dBm = 10*log10(Power_eff[mW])
 ! ------------- 
 !               = 10*log10(1000 * Power_eff[W])
 !
 !		= 10*log10(1000*v*v_ / 100)
 !
 !		= 10*log10(10*v*v_) 
 !               
 !               = 10*log10(10) + 10*log10(v*v_)  
 !
 !               = 10 + 10*log10[(REAL(v))^2+(IMAG(v))^2] 
 !
 !		=  10 + 10*log10[(MAG(v))^2] =
 !
 !              -------------------------
 !               = 10 + 20*log10[MAG(v)]
 !              -------------------------
 
 ! This finally is the formula to calculate Pout[dBm] for Z0=50 Ohm.
 
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list XFORM "IP2"
list XFORM "IP3"
list PLOT "MagPout_Pin"
member OUT "i2"
member OUT "v2"
member SWEEP "freq"
member SWEEP "pin"
}
LINK XFORM "IP2" "711.501"
{
View block_edit 0 "0,30"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 GLOBAL_VAR NrHarmonics
 GLOBAL_VAR NrHarmonicsSel
 
 IF StopExec==1 THEN RETURN_VALUE 1
 
 IF SIZEOF(NrHarmonics)>0 THEN
   IF VAL(NrHarmonics[NrHarmonicsSel])<2 THEN 
     ICCAP_FUNC("IP2_Pin", "STFV", "Header", "No 2nd harmonic available !")
     RETURN_VALUE 0
   END IF
 END IF
 !--------------------------------------------------------
 
 ! This transform returns the IP2 characteristic
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("IP2_Pin", "STFV", "Header", "IP2 vs. Pin")	!clear error message on Plot
 
 ICCAP_FUNC("calc_IPx", "Execute", Pout_dBm, 2)
 
 RETURN DATASET("quiet calc_IPx")
}
dataset
{
datasize COMMON 54 1 1
type COMMON
}
}
list PLOT "IP2_Pin"
list PLOT "IP2_IP3_Pin"
member XFORM "Pout_dBm"
}
LINK XFORM "IP3" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 GLOBAL_VAR StopExec
 GLOBAL_VAR NrHarmonics
 GLOBAL_VAR NrHarmonicsSel
 
 IF StopExec==1 THEN RETURN_VALUE 1
 
 IF SIZEOF(NrHarmonics)>0 THEN
   IF VAL(NrHarmonics[NrHarmonicsSel])<3 THEN 
     ICCAP_FUNC("IP3_Pin", "STFV", "Header", "No 3rd harmonic available !")
     RETURN_VALUE 0
   END IF
 END IF
 !----------------------------------------
 
 ! This transform returns the IP3 characteristic
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 ICCAP_FUNC("IP3_Pin", "STFV", "Header", "IP3 vs. Pin")	!clear error message on Plot
 
 ICCAP_FUNC("calc_IPx", "Execute", Pout_dBm, 3)
 
 RETURN DATASET("quiet calc_IPx")
}
dataset
{
datasize COMMON 54 1 1
type COMMON
}
}
list PLOT "IP3_Pin"
list PLOT "IP2_IP3_Pin"
member XFORM "Pout_dBm"
}
LINK XFORM "calc_IPx" "711.501"
{
View block_edit 0 "0,30"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 ! This transform returns the IP2 or IP3 characteristic
 
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---this is answered by the calling Program
 GET_DATASET "Pout_dBm", Pout
 GET_INT "IP2 [2]  or  IP3 [3] ?", IPx
 
 
 !---idenfiy the nr. of sweeps overlaying the 1st order sweep 'pin'
 TotalPts  = SIZEOF(pin)
 Sweep1Pts = USERC_num_of_points(1, ".")
 AvailNrHarmonics = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 
 NrOverlaySweeps = TotalPts//Sweep1Pts//(AvailNrHarmonics+1)	!Harmonics plus DC
 
 
 !---get fundamental and 2nd/3rd harmonic from 'pin' and 'Pout'
 COMPLEX tmp_Pin[Sweep1Pts*NrOverlaySweeps]
 COMPLEX tmp_Pout1.B[Sweep1Pts*NrOverlaySweeps]	!fundamental (1st harmonic)
 COMPLEX tmp_Pout2.B[Sweep1Pts*NrOverlaySweeps]	!2nd/3rd harmonic
 
 N1=0
 N2=0
 FOR i=0 TO SIZEOF(pin)-1
  IF freq[i]==FUNDFREQ THEN
     tmp_Pin[N1]=pin[i]
     tmp_Pout1.M[N1]=Pout.M[i]
     tmp_Pout1.S[N1]=Pout.S[i]
     N1 = N1 + 1
   END IF
   IF freq[i]==IPx*FUNDFREQ THEN
     tmp_Pout2.M[N2]=Pout.M[i]
     tmp_Pout2.S[N2]=Pout.S[i]
     N2 = N2 + 1
   END IF
 NEXT i
 
 IF MEAN(tmp_Pin)==0 THEN RETURN
 
 !---calc. slope and y-intersects   y = mx +b
 COMPLEX IP2_Pin.B[Sweep1Pts*NrOverlaySweeps]
 COMPLEX IP2_Pout.B[Sweep1Pts*NrOverlaySweeps]
 
 FOR N=0 TO NrOverlaySweeps-1
   FOR i = 0 TO Sweep1Pts-2
     ! calc. slopes and y-intersects   y = mx + b
     !   of fundamental and 2nd/3rd harmonic
     ! m = (y[i+1] - y[i]) / (x[i+1] - x[i])
     ! b = (x[i+1]*y[i] - x[i]*y[i+1]) / (x[i+1] -x[i])
 
     m1_M = (tmp_Pout1.M[i+1+N*Sweep1Pts] - tmp_Pout1.M[i+N*Sweep1Pts]) // (tmp_Pin[i+1+N*Sweep1Pts] - tmp_Pin[i+N*Sweep1Pts])
     m1_S = (tmp_Pout1.S[i+1+N*Sweep1Pts] - tmp_Pout1.S[i+N*Sweep1Pts]) // (tmp_Pin[i+1+N*Sweep1Pts] - tmp_Pin[i+N*Sweep1Pts])
     b1_M = (tmp_Pin.M[i+1+N*Sweep1Pts]*tmp_Pout1.M[i+N*Sweep1Pts] - tmp_Pin.M[i+N*Sweep1Pts]*tmp_Pout1.M[i+1+N*Sweep1Pts]) // (tmp_Pin.M[i+1+N*Sweep1Pts] - tmp_Pin.M[i+N*Sweep1Pts])
     b1_S = (tmp_Pin.S[i+1+N*Sweep1Pts]*tmp_Pout1.S[i+N*Sweep1Pts] - tmp_Pin.S[i+N*Sweep1Pts]*tmp_Pout1.S[i+1+N*Sweep1Pts]) // (tmp_Pin.S[i+1+N*Sweep1Pts] - tmp_Pin.S[i+N*Sweep1Pts])
     m2_M = (tmp_Pout2.M[i+1+N*Sweep1Pts] - tmp_Pout2.M[i+N*Sweep1Pts]) // (tmp_Pin[i+1+N*Sweep1Pts] - tmp_Pin[i+N*Sweep1Pts])
     m2_S = (tmp_Pout2.S[i+1+N*Sweep1Pts] - tmp_Pout2.S[i+N*Sweep1Pts]) // (tmp_Pin[i+1+N*Sweep1Pts] - tmp_Pin[i+N*Sweep1Pts])
     b2_M = (tmp_Pin.M[i+1+N*Sweep1Pts]*tmp_Pout2.M[i+N*Sweep1Pts] - tmp_Pin.M[i+N*Sweep1Pts]*tmp_Pout2.M[i+1+N*Sweep1Pts]) // (tmp_Pin.M[i+1+N*Sweep1Pts] - tmp_Pin.M[i+N*Sweep1Pts])
     b2_S = (tmp_Pin.S[i+1+N*Sweep1Pts]*tmp_Pout2.S[i+N*Sweep1Pts] - tmp_Pin.S[i+N*Sweep1Pts]*tmp_Pout2.S[i+1+N*Sweep1Pts]) // (tmp_Pin.S[i+1+N*Sweep1Pts] - tmp_Pin.S[i+N*Sweep1Pts])
 
     ! calc. intersection points of the two lines
     !  y = m1*x + b1 == m2*x + b2
     ! -> x_intersect = (b2-b1) / (m2-m1)
 
     !  x = (y-b1)/m1 == (y-b2)/m2
     ! -> y_intersect = (m2*b1 - m1*b2) / (m2-m1)
 
     IF (m2_M - m1_M)<>0 THEN
       IP2_Pin.M[i+N*Sweep1Pts] = (b2_M - b1_M) // (m2_M - m1_M)
       IP2_Pout.M[i+N*Sweep1Pts]= (m2_M*b1_M - m1_M*b2_M) // (m2_M - m1_M)
     END IF
 
     IF (m2_S - m1_S)<>0 THEN
       IP2_Pin.S[i+N*Sweep1Pts] = (b2_S - b1_S) // (m2_S - m1_S)
       IP2_Pout.S[i+N*Sweep1Pts]= (m2_S*b1_S - m1_S*b2_S) // (m2_S - m1_S)
     END IF
 
     !---fill up index 0  (was left out in above summing)
     IF i==Sweep1Pts-2 THEN
       IP2_Pin.M[i+1+N*Sweep1Pts] = IP2_Pin.M[i+N*Sweep1Pts]
       IP2_Pin.S[i+1+N*Sweep1Pts] = IP2_Pin.S[i+N*Sweep1Pts]
       IP2_Pout.M[i+1+N*Sweep1Pts]= IP2_Pout.M[i+N*Sweep1Pts]
       IP2_Pout.S[i+1+N*Sweep1Pts]= IP2_Pout.S[i+N*Sweep1Pts]
     END IF
 
   NEXT i
 NEXT N
 
 
 !---gather the corresponding pin values (for the Plot x-axis)
 COMPLEX tmp_pin[Sweep1Pts*NrOverlaySweeps]
 N=0
 FOR i=0 TO NrOverlaySweeps -1
   FOR iSweep1 = 0 TO Sweep1Pts-1
     tmp_pin[N] = pin[iSweep1]
     N = N + 1
   NEXT iSweep1
 NEXT i
 
 
 !---make your choice
 !RETURN IP2_Pin  + j*tmp_pin		! IP2-Pin value   + j*pin
 RETURN IP2_Pout + j*tmp_pin		! IP2-Pout value  + j*pin
}
dataset
{
datasize COMMON 54 1 1
type COMMON
}
}
member SWEEP "freq"
member SWEEP "pin"
}
LINK XFORM "_____________________2" "711.501"
{
}
LINK XFORM "IndexRelations" "711.501"
{
View block_edit 0 "0,238"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------------------------------
 ! This Program links the data index shown in the Plot
 ! with the index of the stimuli (Inputs)
 !--------------------------------------------------------
 
 
 !---apply the same data picking as above in the Programs for the Plots
 TotalPts  = SIZEOF(pin)
 Sweep1Pts = USERC_num_of_points(1, ".")
 AvailNrHarmonics = VAL(LOOKUP_TABLE_VAL("freq", "Saved Order"))
 NrOverlaySweeps = TotalPts//Sweep1Pts//(AvailNrHarmonics+1)	!Harmonics plus DC
 
 
 COMPLEX tmp_IndexRelations[Sweep1Pts*NrOverlaySweeps]
 N=0
 FOR i=0 TO SIZEOF(freq)-1
   IF freq[i]==FUNDFREQ THEN
     tmp_IndexRelations[N] = i
     N = N + 1
   END IF
 NEXT i
 
 
 RETURN tmp_IndexRelations
  
}
dataset
{
datasize COMMON 10 1 1
type COMMON
}
}
member SWEEP "freq"
member SWEEP "pin"
}
LINK PLOT "MP_GUI_IP2_IP3_vs_Pin" "711.501"
{
View plot_window 0 "1,5,42163,28520,{IP2_Pin:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&IP3_Pin:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&IP2_IP3_Pin:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&MagPout_Pin:AUTO|XY| 0.000 , 7.000 ,7,5:-10.00 , 10.00 ,4,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,580,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each highest order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "4"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "0"
element "Header" "IP2  IP3"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "IP2_Pin"
element "Plot 1" "IP3_Pin"
element "Plot 2" "IP2_IP3_Pin"
element "Plot 3" "MagPout_Pin"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "../TL_Settings"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "MagPout_Pin" "711.501"
{
View plot_window 0 "191,424,10875,10100,{MagPout_Pin:AUTO|XY| 0.000 , 7.000 ,7,5:-10.00 , 10.00 ,4,5: 0.000 , 1.000 ,4,5}"
View draw_ds 0 "B,580,3252"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "Yes" "N"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "N"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dB(W)]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "Pout[dBm]  DC, Fundamental Frequency and Harmonics vs. Pin[dBm]"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(Pout_dBm)!!Pout [dBm]"
element "Y Data 1" ""
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "Pout_dBm"
member SWEEP "pin"
}
LINK PLOT "IP2_Pin" "711.501"
{
View plot_window 0 "687,522,9000,9000"
View draw_ds 0 "B,580,7592"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(IP2.M)!!Pin[dB(W)]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "IP2 vs. Pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(IP2.M)!!IP2_out.M[dBm]"
element "Y Data 1" "REAL(IP2.S)!!IP2_out.S[dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "IP2"
}
LINK PLOT "IP3_Pin" "711.501"
{
View plot_window 0 "823,565,9000,9000"
View draw_ds 0 "B,580,11932"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(IP3.M)!!Pin[dB(W)]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "IP3 vs. Pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(IP3.M)!!IP3_out.M[dBm]"
element "Y Data 1" "REAL(IP3.S)!!IP3_out.S[dBm]"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "IP3"
}
LINK PLOT "IP2_IP3_Pin" "711.501"
{
View plot_window 0 "687,522,9000,9000"
View draw_ds 0 "B,580,16272"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "IMAG(IP2.M)!!Pin[dB(W)]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "IP2 IP3 vs. Pin"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(IP2.M)!!IP2_out.M[dBm]"
element "Y Data 1" "REAL(IP2.S)!!IP2_out.S[dBm]"
element "Y Data 2" "REAL(IP3.M)!!IP3_out.M[dBm]"
element "Y Data 3" "REAL(IP3.S)!!IP3_out.S[dBm]"
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member XFORM "IP2"
member XFORM "IP3"
}
data "711.501"
{
}
}
LINK DAT "Nonlin_i_v" "711.501"
{
View in_out 0 "0.44954932172468 1902 1546"
View plot 0 "1.1498936924167 5192 3924"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P11 P190 P198"
element 0 "Name" "!MDM_FILE_PATH"
element 0 "Value" "a DUT Variable"
element 1 "Name" "!MDM_FILE_NAME"
element 1 "Value" "a DUT Variable"
element 2 "Name" ""
element 2 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "pin" "711.501"
{
View draw_ds 0 "B,5525,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "W"
element "Sweep Type" "LIN"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_Pin"
element "- Node" "GROUND"
element "dBm(d)/Watts(W)" "d"
element "Resistance" " 50.00 "
element "Fund" "1"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "Start" "-30.00 "
element "Stop" " 2.000 "
element "# of Points" "9"
element "Step Size" " 4.000 "
}
}
list PLOT "REAL_v1"
list PLOT "REAL_i1"
list PLOT "REAL_v2"
list PLOT "REAL_i2"
list PLOT "IMAG_v1"
list PLOT "IMAG_i1"
list PLOT "IMAG_v2"
list PLOT "IMAG_i2"
}
LINK SWEEP "freq" "711.501"
{
View draw_ds 0 "B,0,0"
View block_edit 0 "0,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "HB"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "2"
element "Value" " 1.000G"
element "Order" "7"
element "Saved Order" "5"
}
}
list XFORM "Load_mdm_MeasData"
list XFORM "IndexRelations"
}
LINK SWEEP "VDC1" "711.501"
{
View draw_ds 0 "B,2068,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "3"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "VDC2" "711.501"
{
View draw_ds 0 "B,4275,0"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "LIST"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2_DC"
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "4"
element "# of Values" "1"
}
HYPTABLE "List Table"
{
element "Value 1" " 600.0m"
}
}
}
LINK SWEEP "v_current_meter2" "711.501"
{
View draw_ds 0 "B,-104,3802"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P2"
element "- Node" "P2aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK SWEEP "v_current_meter1" "711.501"
{
View draw_ds 0 "B,-89,1838"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" "P1"
element "- Node" "P1aux"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK OUT "v1" "711.501"
{
View draw_ds 0 "B,2409,3120"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P1"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "REAL_v1"
list PLOT "IMAG_v1"
}
LINK OUT "i1" "711.501"
{
View draw_ds 0 "B,4178,3120"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P1"
element "From Node" "P1aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "REAL_i1"
list PLOT "IMAG_i1"
}
LINK OUT "v2" "711.501"
{
View draw_ds 0 "B,5974,3120"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "V"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "+ Node" "P2"
element "- Node" "GROUND"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "REAL_v2"
list PLOT "IMAG_v2"
}
LINK OUT "i2" "711.501"
{
View draw_ds 0 "B,2412,4678"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "I"
element "Unit" ""
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "To Node" "P2"
element "From Node" "P2aux"
}
dataset
{
datasize BOTH 54 1 1
type MEAS
type SIMU
}
}
list PLOT "REAL_i2"
list PLOT "IMAG_i2"
}
LINK XFORM "README" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 
 !NOTE: you can execute this Transform to get a separate GUI window for your convenience
 
 GLOBAL_VAR txt_HELP
 GLOBAL_VAR  NrPts			! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 txt_HELP="Domain "&VAL$(WHOIS(".", "Parent Setup PartName"))&"
 ====================================================
 This Setup shows the nonlinear voltages and currents v1, i1, v2 and i2.
 It represents both, the direct results (!) of the NVNA harmonic measurement,
 and also the HarmonicBalance simulation result"
 
 
 
 !---open the HELP GUI
 ICCAP_FUNC("../LA_Help", "Display Modeless GUI", "HELP")
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Load_mdm_MeasData" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  GuiSensitivityDC			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityPin			! show GUI item or not
 GLOBAL_VAR  GuiSensitivityXaxis		! show GUI item or not
 GLOBAL_VAR  xAxisChoices			! DUT Variable
 GLOBAL_VAR  xAxisChoicesSel			! DUT Variable
 GLOBAL_VAR  NrPts				! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ErrMsg=""
 
 !---activate/deactivate GUI selection items
 GuiSensitivityDC    = 1		! activate   DC selection GUI
 GuiSensitivityPin   = 0		! deactivate pin selection GUI, and keep all pin values of original .mdm file
 GuiSensitivityXaxis = 1		! deactivate x-axis selection GUI
 
 
 !---define possible x-Axis choices
 DIMENSION_ARRAY(xAxisChoices, 2)
 xAxisChoices[0]="pin"
 xAxisChoices[1]="harmonics"
 IF VAL(xAxisChoicesSel)>1 THEN xAxisChoicesSel=0
 
 
 !---adjust Plot x-axis
 xAxis= "pin!!Pin[dBm]"
 IF VAL(xAxisChoicesSel)== 1 THEN xAxis= "freq!!harmonics"
 ICCAP_FUNC("REAL_v1", "STFV", "X Data", VAL$(xAxis))
 ICCAP_FUNC("IMAG_v1",  "STFV", "X Data", VAL$(xAxis))
 ICCAP_FUNC("REAL_i1", "STFV", "X Data", VAL$(xAxis))
 ICCAP_FUNC("IMAG_i1",  "STFV", "X Data", VAL$(xAxis))
 ICCAP_FUNC("REAL_v2", "STFV", "X Data", VAL$(xAxis))
 ICCAP_FUNC("IMAG_v2",  "STFV", "X Data", VAL$(xAxis))
 ICCAP_FUNC("REAL_i2", "STFV", "X Data", VAL$(xAxis))
 ICCAP_FUNC("IMAG_i2",  "STFV", "X Data", VAL$(xAxis))
 
 
 !---call central .mdm loading program and anticipate its GET_STRING
 Sweep1Name="pin"
 IF VAL(xAxisChoicesSel)==1 THEN Sweep1Name="freq"
 ICCAP_FUNC("../aux/Load_Data", "Execute", VAL$(WHOIS(".", "Parent Setup PartName")), VAL$(Sweep1Name))
 IF VAL$(ErrMsg) <> "" THEN
   GET_STRING VAL$(ErrMsg)&"  [OK]", dummy
   RETURN_VALUE 0
 END IF
 
 
 !---update nr.simul.pts info for GUI
 NrPts       = SIZEOF(freq)
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK XFORM "_____________________1" "711.501"
{
}
LINK XFORM "IndexRelations" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !--------------------------------------------------------
 ! This Program links the data index shown in the Plot
 ! with the index of the stimuli (Inputs)
 !--------------------------------------------------------
 
 
 
 COMPLEX tmp_IndexRelations[SIZEOF(freq)]
 FOR i=0 TO SIZEOF(tmp_IndexRelations)-1
   tmp_IndexRelations[i] = i
 NEXT i
 
 
 RETURN tmp_IndexRelations
}
dataset
{
datasize COMMON 60 1 1
type COMMON
}
}
member SWEEP "freq"
}
LINK PLOT "MP_GUI_Nonlin_i_v" "711.501"
{
View plot_window 0 "4,23,42234,28520,{MAG_v1:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&PH_v1:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&MAG_i1:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&PH_i1:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&MAG_v2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&PH_v2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&MAG_i2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC&PH_i2:AUTO|XY|AUTOMATIC:AUTOMATIC:AUTOMATIC}"
View draw_ds 0 "B,460,0"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "MULTI PLOT"
}
HYPTABLE "Edit Plot Def"
{
element "# of Plots" "8"
element "# of GUIs" "1"
element "Orientation" "H"
element "Plots Per Row" "4"
element "Header" "Nonlin.  Currents  and Voltages (peak)"
element "Footer" ""
}
HYPTABLE "Multi Table"
{
element "Plot 0" "REAL_v1"
element "Plot 1" "REAL_i1"
element "Plot 2" "REAL_v2"
element "Plot 3" "REAL_i2"
element "Plot 4" "IMAG_v1"
element "Plot 5" "IMAG_i1"
element "Plot 6" "IMAG_v2"
element "Plot 7" "IMAG_i2"
}
HYPTABLE "Multi GUI Table"
{
element "GUI 1" "../TL_Settings"
element "GUI 1 Location" "R"
}
PlotOptimizerOpt Enable 0
}
}
LINK PLOT "REAL_v1" "711.501"
{
View draw_ds 0 "B,899,7984"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "REAL(v1)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v1.m)"
element "Y Data 1" "REAL(v1.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "v1"
member SWEEP "pin"
}
LINK PLOT "REAL_i1" "711.501"
{
View draw_ds 0 "B,884,16024"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "REAL(i1)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(i1.m)"
element "Y Data 1" "REAL(i1.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "i1"
member SWEEP "pin"
}
LINK PLOT "REAL_v2" "711.501"
{
View draw_ds 0 "B,899,24064"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "REAL(v2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(v2.m)"
element "Y Data 1" "REAL(v2.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "v2"
member SWEEP "pin"
}
LINK PLOT "REAL_i2" "711.501"
{
View draw_ds 0 "B,899,32104"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "REAL(i2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "REAL(i2.m)"
element "Y Data 1" "REAL(i2.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "i2"
member SWEEP "pin"
}
LINK PLOT "IMAG_v1" "711.501"
{
View draw_ds 0 "B,-17414,3964"
View plot_window 0 "0,2,8969,8954"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "IMAG(v1)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(v1.m)"
element "Y Data 1" "IMAG(v1.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "v1"
member SWEEP "pin"
}
LINK PLOT "IMAG_i1" "711.501"
{
View draw_ds 0 "B,-17438,12793"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "IMAG(i1)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(i1.m)"
element "Y Data 1" "IMAG(i1.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "i1"
member SWEEP "pin"
}
LINK PLOT "IMAG_v2" "711.501"
{
View draw_ds 0 "B,-17414,20283"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "IMAG(v2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(v2.m)"
element "Y Data 1" "IMAG(v2.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "v2"
member SWEEP "pin"
}
LINK PLOT "IMAG_i2" "711.501"
{
View draw_ds 0 "B,-17422,28084"
View plot_window 0 "4,23,9005,8990"
TABLE "Plot Options" "711.501"
{
TABLE "Plot Settings" "711.501"
{
element 0 "Multicolor" "Change color with each 2nd order curve" "N"
element 0 "Measured Trace" "Solid Line with Symbols" "A"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "Yes" "A"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "A"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
data
{
HYPTABLE "Edit plot Info"
{
element "Report Type" "XY GRAPH"
}
HYPTABLE "Edit Plot Def"
{
element "X Data" "pin!!Pin[dBm]"
element "# of Traces" "8"
element "Curve Data" ""
element "Header" "IMAG(i2)"
element "Footer" ""
element "X Axis Type" "LINEAR"
element "Y Axis Type" "LINEAR"
element "Y2 Axis Type" "LINEAR"
element "Y2 Data" ""
element "Y Data 0" "IMAG(i2.m)"
element "Y Data 1" "IMAG(i2.s)"
element "Y Data 2" ""
element "Y Data 3" ""
element "Y Data 4" ""
element "Y Data 5" ""
element "Y Data 6" ""
element "Y Data 7" ""
}
PlotOptimizerOpt Enable 0
}
member OUT "i2"
member SWEEP "pin"
}
data "711.501"
{
}
}
LINK DAT "aux" "711.501"
{
View in_out 0 "1.8 2000 2000"
View plot 0 "1.8 8127 6143"
TABLE "Variable Table" "711.501"
{
View par_var_table 0 "V530 P15 C19 P201"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "711.501"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "711.501"
{
View draw_ds 0 "B,839,539"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "Load_Data" "711.501"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !---link to (DUT-)Variables
 GLOBAL_VAR  ErrMsg
 GLOBAL_VAR  mdm_DirFileName
 GLOBAL_VAR  GuiSensitivityDC		! activate/deactivate  DC selection GUI
 GLOBAL_VAR  GuiSensitivityPin		! activate/deactivate pin selection GUI, and keep all pin values of original .mdm file
 GLOBAL_VAR  StopExec		! DUT Variable, to stop auto-execution in analysis Setups during data loading
 GLOBAL_VAR  NrPts			! DUT Variable:  show nr. of currently loaded data points in GUI
 
 
 GET_STRING "RF Domain Name (Setup)", "DC_Operating_Points", DomainName
 Path2Domain = "../"&VAL$(DomainName)
 GET_STRING "1st order sweep Input Name", "pin", InputNameSweep1
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 ErrMsg=""
 
 StopExec=1	! stop auto-executing of Transforms in calling Setup
 
 
 ICCAP_FUNC(Path2Domain, "ImportCreate", VAL$(mdm_DirFileName))
 
 
 !---check if original .mdm data file has pin as 1st order sweep
 pin_SweepOrder = VAL(LOOKUP_TABLE_VAL(Path2Domain&"/pin", "Sweep Order"))
 IF pin_SweepOrder<>1 THEN
   ErrMsg="ERROR: In .mdm file, Input 'pin' does not have Sweep Order 1"
   RETURN_VALUE 0
 END IF
 
 
 !---adjust Inputs to read the user-selected DC bias
 IF VAL(GuiSensitivityDC) == 1 THEN  ICCAP_FUNC("Adjust_Inputs_VDCx", "Execute", Path2Domain)
 
 
 !---adjust Inputs to read the user-selected Input Power
 IF VAL(GuiSensitivityPin) == 1 THEN  ICCAP_FUNC("Adjust_Input_pin", "Execute", Path2Domain)
 
 
 !---adjust Input 'freq' to read user-selected nr.harmonics
 ICCAP_FUNC("Adjust_Input_freq", "Execute", Path2Domain)
 
 
 !---change requested Input to sweep order 1
 ICCAP_FUNC(VAL$(Path2Domain)&"/"&VAL$(InputNameSweep1), "STFV", "Sweep Order", 1)
 
 
 !---import selected data into calling Setup
 ICCAP_FUNC(Path2Domain, "Import Measured Data", VAL$(mdm_DirFileName))
 
 
 !---update info for GUI
 tmpfreq=DATASET("quiet "&VAL$(Path2Domain)&"/freq")
 NrPts       = SIZEOF(tmpfreq)
 
 
 StopExec=0
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Adjust_Inputs_VDCx" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 
 !  This Program changes the Inputs 'VDC1' and 'VDC2' to Type 'LIST',
 !  and enters the user-selected 'VDC1' and 'VDC2' value(s)
 
 
 !---link to (DUT-)Variables
 GLOBAL_VAR  VDC1_ValuesAvail
 GLOBAL_VAR  VDC1_ValuesAvailSel
 GLOBAL_VAR  VDC2_ValuesAvail
 GLOBAL_VAR  VDC2_ValuesAvailSel
 
 
 GET_STRING "Path2Domain", "../DC_Operating_Points", Path2Domain
 
 
 !---adjust Input 'VDC1' to the user-selected DC bias(es)
 ICCAP_FUNC(Path2Domain&"/VDC1", "STFV", "Sweep Type", "LIST")
 ICCAP_FUNC(Path2Domain&"/VDC1", "STFV", "# of Values", SIZEOF(VDC1_ValuesAvailSel))
 FOR i=0 TO SIZEOF(VDC1_ValuesAvailSel)-1
   ICCAP_FUNC(Path2Domain&"/VDC1", "STFV", "Value "&VAL$(i+1), VAL$(VDC1_ValuesAvail[VDC1_ValuesAvailSel[i]]))
 NEXT i
 
 !---adjust Input 'VDC2' to the user-selected DC bias(es)
 ICCAP_FUNC(Path2Domain&"/VDC2", "STFV", "Sweep Type", "LIST")
 ICCAP_FUNC(Path2Domain&"/VDC2", "STFV", "# of Values", SIZEOF(VDC2_ValuesAvailSel))
 FOR i=0 TO SIZEOF(VDC2_ValuesAvailSel)-1
   ICCAP_FUNC(Path2Domain&"/VDC2", "STFV", "Value "&VAL$(i+1), VAL$(VDC2_ValuesAvail[VDC2_ValuesAvailSel[i]]))
 NEXT i
 
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Adjust_Input_pin" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !  This Program changes the Input 'pin' to Type 'LIST',
 !  and enters the user-selected 'pin'-value(S)
 
 !---link to (DUT-)Variables
 GLOBAL_VAR pin_ValuesAvail
 GLOBAL_VAR pin_ValuesAvailSel
 
 
 
 GET_STRING "Path2Domain", "../DC_Operating_Points", Path2Domain
 
 !---adjust Input 'pin' to the user-selected RF input power(s)
 ICCAP_FUNC(Path2Domain&"/pin", "STFV", "Sweep Type", "LIST")
 ICCAP_FUNC(Path2Domain&"/pin", "STFV", "# of Values", SIZEOF(pin_ValuesAvailSel))
 FOR i=0 TO SIZEOF(pin_ValuesAvailSel)-1
   ICCAP_FUNC(Path2Domain&"/pin", "STFV", "Value "&VAL$(i+1), VAL$(pin_ValuesAvail[pin_ValuesAvailSel[i]]))
 NEXT i
 
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "Adjust_Input_freq" "711.501"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  Debug		!a DUT Variable
 IF VAL(Debug)==1 THEN PRINT "exec.Xfm "&WHOAMI()&"..."
 
 !  This Program changes the Input 'freq' 
 !  and enters the user-selected nr. of harmonics
 
 
 !---link to (DUT-)Variables
 GLOBAL_VAR NrHarmonics
 GLOBAL_VAR NrHarmonicsSel
 
 
 
 GET_STRING "Path2Domain", "../DC_Operating_Points", Path2Domain
 
 !---adjust Input 'freq' to the user-selected nr. of harmonics
 !   -> set nr. ADS of harmonics *used within IC-CAP*
 ICCAP_FUNC(Path2Domain&"/freq", "STFV", "Saved Order", NrHarmonics[NrHarmonicsSel])
 
 
 !  NOTE:
 !   We change the entry field 'Saved Order' in Input 'freq',
 !   and not the total nr. of ADS HB simulation harmonics 
 !   (Entry Field 'Order' in Input 'freq').
 !   This value is recommended to be set to >2 harmonics bigger 
 !   than what was measured by the NVNA, 
 !   to emulate the fact that in the real world, 
 !   we have more harmonics present than the number of harmonics we measure.
 !   And since we have measured e.g. 5 harmonics, 
 !   we should *always* simulate 5+2 harmonics in ADS,
 !   even when we only use less than 5 harmonics in IC-CAP (Plots, PEL etc).
 
 
 !---in Input 'freq', set entry field 'Value' to variable 'FUNDFREQ'
 ICCAP_FUNC(Path2Domain&"/freq", "STFV", "Value", "FUNDFREQ")
 
 RETURN_VALUE 1
}
dataset
{
datasize COMMON 1 1 1
type COMMON
}
}
}
LINK XFORM "___________________1" "711.501"
{
}
data "711.501"
{
}
}
}
}
